define("b2eb623f-c8a3-4c1c-824a-0eb66535bd15_0.1.0",["tslib","@ms/sp-telemetry","@microsoft/sp-image-helper","@ms/odsp-core-bundle","@microsoft/sp-lodash-subset","@ms/sp-dataproviders","@microsoft/sp-core-library","@microsoft/sp-page-context","@ms/sp-component-utilities","@microsoft/sp-diagnostics","@microsoft/sp-http","@ms/odsp-utilities-bundle"],function(n,a,i,r,o,s,c,d,l,u,f,p){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(a,i,function(t){return e[t]}.bind(null,i));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",function(){var e,t=document.getElementsByTagName("script"),a="undefined"!=typeof spScriptNamePattern?spScriptNamePattern:/sp-news-data-provider_en-us_c1b43ebdcacbee91cd06\.js/i;if(t&&t.length)for(var i=0;i<t.length;i++)if(t[i]){var r=t[i].getAttribute("src");if(r&&r.match(a)){e=r.substring(0,r.lastIndexOf("/")+1);break}}if(!e)for(var o in window.__setWebpackPublicPathLoaderSrcRegistry__)if(o&&o.match(a)){e=o.substring(0,o.lastIndexOf("/")+1);break}n.p=e}(),n(n.s="mwqp")}({"17wl":function(e,t){e.exports=n},"2q6Q":function(e,t){e.exports=a},"8dK2":function(e,t){e.exports=i},B07Q:function(e){e.exports=JSON.parse('{"p":"Keep your team updated with news on your team site","f":"From the site home page you\\u0027ll be able to quickly author a news post - a status update, trip report, or even just highlight a document with some additional context provided to the team.","m":"https://go.microsoft.com/fwlink/p/?linkid=827920","h":"What is a team site?","_":"A SharePoint team site connects you and your team to the content, information, and apps you rely on every day. For example, you can use a team site to store and collaborate on files or to create and manage lists of information. On a team site home page, you can view links to important team files, apps, and web pages and see recent site activity in the activity feed.","b":"https://go.microsoft.com/fwlink/p/?linkid=827918","v":"Add a page to a site","g":"Using pages is a great way to share ideas using images, Excel, Word and PowerPoint documents, video, and more. You can create and publish pages quickly and easily, and they look great on any device. When you create a page, you add and customize web parts with a toolbox available right in the editing pane. And, you can publish with just a click.","y":"https://go.microsoft.com/fwlink/p/?linkid=827919","I":"Welcome to the new team site experience","D":"Quickly author a new news post, a status update, or a trip report on the new team site home page.","S":"SharePoint","w":"News","x":"Hub News","O":"My News","C":"Multi-site News","n":"Create a news post","i":"No news posts are available right now","t":"Keep your audience engaged by sharing your latest updates.","a":"Check back later to see the latest News.","l":"Title of news post","d":"Preview that shows the first few lines of the article.","c":"Author name","u":"A few seconds ago","e":"Automatic","r":"Build successful portals","o":"Modern SharePoint branding","s":"SharePoint News reaches more users"}')},K9kD:function(e,t){e.exports=r},Pk8u:function(e,t){e.exports=o},QVYh:function(e,t,n){var a=n("K9kD");e.exports=a.SPAlternativeUrls},QZHX:function(e,t){e.exports=s},UWqr:function(e,t){e.exports=c},"X+PM":function(e,t){e.exports=d},"hiL/":function(e,t){e.exports=l},mwqp:function(e,t,n){"use strict";n.r(t),n.d(t,"NewsUtilities",function(){return B}),n.d(t,"news",function(){return j}),n.d(t,"viewCounts",function(){return V}),n.d(t,"currentViewCounts",function(){return z}),n.d(t,"hubNews",function(){return G}),n.d(t,"newsDigest",function(){return K}),n.d(t,"multiSiteNews",function(){return W}),n.d(t,"myNews",function(){return q}),n.d(t,"staleViewCounts",function(){return Q}),n.d(t,"NewsDataSource",function(){return l}),n.d(t,"newsDataSourceProp",function(){return u}),n.d(t,"_appendAudienceFilteringQueryParam",function(){return f}),n.d(t,"_appendLanguageOverrideQueryParam",function(){return p}),n.d(t,"_getExtraDataForLogging",function(){return m}),n.d(t,"NewsEmptyStateType",function(){return x}),n.d(t,"ExchangeViewCountsDataProvider",function(){return Y}),n.d(t,"HubNewsDataProvider",function(){return ye}),n.d(t,"MicroServiceNewsDataProvider",function(){return le}),n.d(t,"NewsDataProvider",function(){return Oe}),n.d(t,"NewsDigestDataProvider",function(){return Ee}),n.d(t,"NewsDigestUtilities",function(){return Ae}),n.d(t,"NewsSearchDataProvider",function(){return Le}),n.d(t,"MultiSiteNewsDataProvider",function(){return Ie}),n.d(t,"MyNewsDataProvider",function(){return ke}),n.d(t,"tryGetAuthoritativeSiteDetails",function(){return C}),n.d(t,"ServerError",function(){return te});var a=n("UWqr"),i=n("ut3N"),r=n("8dK2"),o=n("X+PM"),s=n("y88i"),c=n("QVYh"),d=n("hiL/"),l={CurrentSite:1,Hub:2,ChooseSites:3,MyNews:4},u="newsDataSourceProp";function f(e){return e.audienceTargetingEnabled?"&".concat("filterByAudience","=true"):""}function p(e,t){void 0===t&&(t=!1);var n=e.languageOverride;return n?t?"&languageOverride='".concat(n,"'"):"&languageOverride=".concat(n):""}function m(e,t){var n="noFilter";e.serializedFilterQuery?n="filterCAMLQueryAdded":e.filterKQLQuery&&(n="filterKQLQueryAdded");var a={audienceTargetingEnabled:(!!e.audienceTargetingEnabled).toString(),isOnSeeAllPage:B.isOnSeeAllPage.toString(),isAdvanceMode:(!!e.languageOverride).toString(),alias:n};return t&&t.legacyPageContext&&t.legacyPageContext.isHubSite&&(a.service="HubSite"),a}var _=n("B07Q"),h=n.p+"helpitemimg1_b63e7aeb743f50317c8deaf9e7873746.png",b=n.p+"helpitemimg1-2x_259ca7a5dba92c747ffd388635f91b0d.png",g=n.p+"helpitemimg2_d84b4722fd2bbf6f4acb60151d55265d.png",v=n.p+"helpitemimg2-2x_3facee48e4834cd856c0efb2e81f38d0.png",y=n.p+"helpitemimg3_0fd326f3b39edd4ae85e028efc53e3be.png",S=n.p+"helpitemimg3-2x_8cc0b9498a098eabc56d754c0f242b94.png",D=n.p+"odm_Modernize_News_5ab11672.svg",I=function(){function e(){}return e.getIconUrl=function(t){t!==e._modernizedImageKey||e._assetIconsMap[this._modernizedImageKey]||(e._assetIconsMap[this._modernizedImageKey]=[D,D]);var n=e._assetIconsMap[t];return n[window.devicePixelRatio>=2&&n.length>=2?1:0]},e._assetIconsMap={HelpImg1:[h,b],HelpImg2:[g,v],HelpImg3:[y,S]},e._modernizedImageKey="HelpImgModern",e}(),x={None:0,TeamSite:1,CommSite:2,Carousel:3};function C(e,t,n){if(e&&t&&n.legacyPageContext&&n.legacyPageContext.organizationNewsSiteReference){var i=a.Guid.tryParse(e),r=a.Guid.tryParse(t);if(i&&r&&n.legacyPageContext.organizationNewsSiteReference)for(var o=0,s=n.legacyPageContext.organizationNewsSiteReference;o<s.length;o++){var c=s[o];if(O(i,r,c))return c}}}function O(e,t,n){var i=a.Guid.tryParse(n.SiteId),r=a.Guid.tryParse(n.WebId);return!!(i&&r&&e.equals(i)&&t.equals(r))}function w(){return a._SPKillSwitch.isActivated("b35f5ad6-6538-41ec-bbfa-14c8109a4b44")}function E(){return a._SPKillSwitch.isActivated("f6d6f28c-002c-42c8-8825-59c0be23c8a4")}function A(){return a._SPKillSwitch.isActivated("ac52d2d0-e041-4af4-9eaa-addeba264ba3")}function L(){return a._SPKillSwitch.isActivated("79ba8433-8a6e-40cb-8f3b-14f771cb9510")}function k(){return a._SPKillSwitch.isActivated("642458f5-6b5d-4745-961c-1dfc8d1d49c2")}function M(){return a._SPKillSwitch.isActivated("90258c51-970d-4c43-bb14-4fd635bde388")}var P,T=n("QZHX"),U=n("Pk8u"),F="newsProcessBannerImageUrl",H="",R={filterType:T.FilterType.TitleContaining,value:"",values:[]},N=function(e){this["OData-Version"]="3.0",this["If-Match"]="*",this["X-HTTP-Method"]=e},B=function(){function e(){}return e._isHaukShadowcallsKillSwitchActivated=function(){return a._SPKillSwitch.isActivated("79c0fa86-b3e9-44e2-988d-d3990317c384")},e._isPPSShadowcallsKillSwitchActivated=function(){return a._SPKillSwitch.isActivated("612dd0c0-cbf8-4314-802a-a8896fc00709")},e.isCallToActionEnabled=function(){return a._SPFlight.isEnabled(60497)},e.cacheViewCountsValue=function(t,n,a){var i=e.viewCountsDictionary[t+"/"+n];(void 0===i||i<a)&&(e.viewCountsDictionary[t+"/"+n]=a)},e._internalGetTeamSiteHelpItems=function(t,n){var a=void 0!==t&&t<=3?t:3,i=[],r=!1;n&&n.whenFinished(function(){var e=n.consume(o.PageContext.serviceKey);r=e.legacyPageContext.IsHomepageModernized});for(var s=[{description:r?_.D:_.f,title:r?_.I:_.p,url:r?e._mdrnHelpUrl:_.m},{description:_._,title:_.h,url:_.b},{description:_.g,title:_.v,url:_.y}],c=0;c<a;c++){var d="f7752afa-9c69-49c8-bc62-5b5b35d01775",l=r&&0===c?"Modern":"".concat(c+1);i.push({author:_.S,authorInitial:"SP",authorAccountName:"",description:s[c].description,email:"",image:I.getIconUrl("HelpImg"+l),publishedOn:new Date,publishedOnRelativeTime:"",title:s[c].title,url:s[c].url,listItemId:"",viewCounts:void 0,isHelpArticle:!0,uniqueId:d,siteId:d,webId:d})}return i},e.isValidNewsSource=function(e){return e===l.CurrentSite||e===l.Hub||e===l.ChooseSites||e===l.MyNews},e.getEmptyStateItems=function(t,n,a,i){switch(t){case x.CommSite:return e.getCommSiteHelpArticles(a);case x.TeamSite:return e._internalGetTeamSiteHelpItems(a,n);case x.Carousel:return e.getEmptyCarouselItems(a,i);default:return[]}},e.getCommSiteHelpArticles=function(e){for(var t=void 0!==e&&e<=3?e:3,n=[],i=0;i<t;i++){var r=a.Guid.newGuid().toString();n.push({author:_.c,authorAccountName:"",description:_.d,email:"",image:"",publishedOn:void 0,publishedOnRelativeTime:_.u,title:_.l,url:void 0,listItemId:"",viewCounts:void 0,isHelpArticle:!0,uniqueId:r,siteId:r,webId:r})}return n},e.getEmptyCarouselItems=function(e,t){for(var n=void 0!==e&&e<=3?e:3,i=[],o=[_.r,_.o,_.s],s=0;s<n;s++){var c=a.Guid.newGuid().toString(),l=d.DefaultImageHelper.getDefaultNewsCarouselImageById(s);l=r._ThumbnailUrlGenerator.getThumbnailUrl({absoluteUrl:l,spResource:l,width:t,callerId:"EmptyCarouselItems"}),i.push({author:"",authorAccountName:"",description:"",email:"",image:l,publishedOn:void 0,publishedOnRelativeTime:"",title:o[s],url:void 0,listItemId:"",viewCounts:void 0,isHelpArticle:!0,uniqueId:c,siteId:c,webId:c})}return i},Object.defineProperty(e,"autofillItem",{get:function(){var e=a.Guid.newGuid().toString();return{author:"",authorAccountName:"",description:"",image:"",publishedOn:void 0,publishedOnRelativeTime:_.u,title:_.e,url:void 0,listItemId:"",viewCounts:void 0,isHelpArticle:!0,uniqueId:e,siteId:e,webId:e}},enumerable:!1,configurable:!0}),e.getTipActionNewsItem=function(e,t){var n=a.Guid.newGuid().toString();return{author:"",authorAccountName:"",description:e?_.t:_.a,image:"",isContributorActionCard:e,publishedOn:void 0,publishedOnRelativeTime:"",title:e?_.n:_.i,url:e?s.Uri.concatenate(t,"/_layouts/15/CreateSitePage.aspx?source=")+s.UriEncoding.encodeURIComponent(window.location.pathname)+"&promotedState=1":_.m,listItemId:"",viewCounts:void 0,isHelpArticle:!0,uniqueId:n,siteId:n,webId:n}},e.extractNewsItemsFromSearch=function(t,n){return t.map(function(t){var i=t.SiteID?a.Guid.parse(t.SiteID).toString():void 0,r=t.WebId?a.Guid.parse(t.WebId).toString():void 0,o=t.ListId?a.Guid.parse(t.ListId).toString():void 0,s=t.UniqueID?a.Guid.parse(t.UniqueID).toString():void 0,c=t.ViewCountLifetime,l="number"==typeof c?c:void 0,u=C(i,r,n),f=t.SPWebUrl,p=e._handleDefaultBanner(t.PictureThumbnailURL);return{author:e._getUserDisplayNameFromSearch(t.CreatedBy),authorAccountName:t.AuthorOWSUSER,description:t.Description||"",email:e._getAuthorEmail(t.AuthorOWSUSER),isAuthoritative:!!u,image:p||H,publishedOn:new Date(t.FirstPublishedDate),publishedOnRelativeTime:"",title:t.Title||t.FileName,url:E()?e.encodeSegments(t.Path):d.UrlUtility.encodeSegments(t.Path),listItemId:t.ListItemId,originalSourceItemId:void 0,originalSourceUrl:E()?e.encodeSegments(t.OriginalPath):d.UrlUtility.encodeSegments(t.OriginalPath),path:t.Path,siteTitle:e._getSiteTitle(t,i,r,n),siteUrl:f,viewCounts:l,isHelpArticle:!1,uniqueId:s,siteId:i,webId:r,listId:o}})},e.extractNewsItems=function(t,n){var i=this;return t.map(function(t){var r,o,c,l,u,f=function(e){return a.Guid.parse(e).toString()},p=t.SiteID?f(t.SiteID):n.site.id.toString(),m=t.WebId?f(t.WebId):n.web.id.toString(),_=t.ListId?f(t.ListId):null===(o=null===(r=n.list)||void 0===r?void 0:r.id)||void 0===o?void 0:o.toString(),h=t.UniqueId?f(t.UniqueId):null===(l=null===(c=n.listItem)||void 0===c?void 0:c.id)||void 0===l?void 0:l.toString(),b=C(p,m,n),g=t.BannerImageUrl,v=t.BannerThumbnailUrl;u=a._SPFlight.isEnabled(1047)&&g&&g.toUpperCase().indexOf("/_LAYOUTS/IMAGES/")>-1?e._handleDefaultBanner(g):e._handleDefaultBanner(v||g);var y=!i._isUseRedirectPageUrlKillSwitchActivated()&&n.web&&n.web.absoluteUrl&&t.Path&&t.Path.DecodedUrl?s.Uri.concatenate(n.web.absoluteUrl,"/",t.Path.DecodedUrl):t.AbsoluteUrl;return{author:t.CreatedBy.Name,authorAccountName:t.CreatedBy.AccountName,callToAction:i.isCallToActionEnabled()?t.CallToAction:void 0,description:t.Description?t.Description:"",email:e._getAuthorEmail(t.CreatedBy.AccountName),isAuthoritative:!!b,image:u||H,publishedOn:new Date(t.FirstPublished),publishedOnRelativeTime:"",title:t.Title||t.FileName,url:E()?e.encodeSegments(y):d.UrlUtility.encodeSegments(y),listItemId:t.Id,originalSourceItemId:t.OriginalSourceItemId,originalSourceUrl:E()?e.encodeSegments(t.OriginalSourceUrl):d.UrlUtility.encodeSegments(t.OriginalSourceUrl),path:t.Path&&t.Path.DecodedUrl,siteTitle:b?e._getSiteTitle(t,p,m,n):void 0,siteUrl:n.web.absoluteUrl,viewCounts:void 0,isHelpArticle:!1,uniqueId:h,siteId:p,webId:m,listId:_}})},e.extractMicroserviceNewsItems=function(t,n,i){return t.map(function(t){var r,o,s,c=t.Site&&t.Site.ItemReference,l=t.Library,u=a.Guid.tryParse(c&&c.SiteId);r=(null==u?void 0:u.toString())||(i?n.site.id.toString():void 0);var f=a.Guid.tryParse(c&&c.WebId);o=(null==f?void 0:f.toString())||(i?n.web.id.toString():void 0);var p=a.Guid.tryParse(l&&l.ListId);s=p&&p.toString();var m=t.UniqueId?a.Guid.parse(t.UniqueId).toString():void 0,_=C(r,o,n),h=t.Site&&t.Site.Url?t.Site.Url:t.SiteUrl||n.site.absoluteUrl,b=e._handleDefaultBanner(t.ImageUrl);return{author:t.Author&&t.Author.Title?t.Author.Title:"",authorAccountName:t.Author&&t.Author.AccountName?t.Author.AccountName:"",description:t.Description,email:e._getAuthorEmail(t.Author&&t.Author.AccountName?t.Author.AccountName:""),isAuthoritative:t.IsAuthoritativeNews||!!_,image:b||H,publishedOn:new Date(t.FirstPublishedDate),publishedOnRelativeTime:"",title:t.Title,url:E()?e.encodeSegments(t.Url):d.UrlUtility.encodeSegments(t.Url),viewCounts:void 0,isHelpArticle:!1,siteTitle:e._getSiteTitle(t,r,o,n),siteUrl:h,listItemId:t.ListItemId,originalSourceItemId:t.OriginalSourceItemId,originalSourceUrl:E()?e.encodeSegments(t.OriginalSourceurl):d.UrlUtility.encodeSegments(t.OriginalSourceUrl),path:t.Path&&t.Path.DecodedUrl,uniqueId:m,siteId:r,webId:o,listId:s}})},e.extractVroomNewsItems=function(t,n){return t.map(function(t){var a,i,r,o,s,c,l,u,f,p,m,_,h,b,g,v,y,S,D,I=(null===(a=t.sharepointIds)||void 0===a?void 0:a.siteUrl)||n.site.absoluteUrl,x=(null===(i=t.sharepointIds)||void 0===i?void 0:i.siteId)||n.site.id.toString(),O=(null===(r=t.sharepointIds)||void 0===r?void 0:r.webId)||n.web.id.toString(),w=C(x,O,n),A=t.thumbnails?t.thumbnails[0]:void 0,L=A?e._handleDefaultBanner(A.source.url):void 0,k=null!==(s=null===(o=null==t?void 0:t.news)||void 0===o?void 0:o.isBoosted)&&void 0!==s&&s;return{author:(null===(l=null===(c=t.createdBy)||void 0===c?void 0:c.user)||void 0===l?void 0:l.displayName)||"",authorAccountName:"",description:t.description,email:null===(f=null===(u=t.createdBy)||void 0===u?void 0:u.user)||void 0===f?void 0:f.email,isAuthoritative:!!w,isBoostedNews:k,image:L||H,publishedOn:new Date(t.firstPublishedDate),publishedOnRelativeTime:"",title:t.title,url:E()?e.encodeSegments(t.webUrl):d.UrlUtility.encodeSegments(t.webUrl),viewCounts:null===(_=null===(m=null===(p=t.analytics)||void 0===p?void 0:p.allTime)||void 0===m?void 0:m.access)||void 0===_?void 0:_.actionCount,isHelpArticle:!1,siteTitle:(null===(h=t.parentReference)||void 0===h?void 0:h.siteTitle)||e._getSiteTitle(t,x,O,n),siteUrl:I,listItemId:null===(b=t.sharepointIds)||void 0===b?void 0:b.listItemId,originalSourceItemId:null===(g=t.originalSourceIds)||void 0===g?void 0:g.listItemUniqueId,originalSourceUrl:E()?e.encodeSegments(null===(v=t.originalSourceIds)||void 0===v?void 0:v.url):d.UrlUtility.encodeSegments(null===(y=t.originalSourceIds)||void 0===y?void 0:y.url),uniqueId:null===(S=t.sharepointIds)||void 0===S?void 0:S.listItemUniqueId,siteId:x,webId:O,listId:null===(D=t.sharepointIds)||void 0===D?void 0:D.listId}})},e.processBannerImageUrlPart=function(t,n,a,r,o,s,c){try{return e._processBannerImageUrlPartCore(t,n,a,r,o,s,c)}catch(e){var d={defaultUniqueId:n,imageWidth:r};return o&&(d.siteId=o),s&&(d.webId=o),new i._QosMonitor("News.processBannerImageUrlPart").writeExpectedFailure("UrlError",e,d),""}},e.getResourceFromPrivateCDNUrl=function(e){if(r._ThumbnailUrlGenerator.getThumbnailProvider(e)===r._ThumbnailProviderType.PrivateCDN){var t=new r._SPResourcePath(e);e=(e="https:/".concat(t.path)).split("?")[0]}return e},e.isPrefetchStale=function(e){return!(!M()||void 0===this._initialUrl&&(this._initialUrl=e,1))},e.extractParamFromUrl=function(e,t){var n=new RegExp("[?&]".concat(e,"=([^?&]+)(&|$)")).exec(t);return n?decodeURIComponent(n[1]):void 0},e.isNewsItemInList=function(t,n){return!(!t||!n)&&t.some(function(t,a){return t&&e.getNewsItemKey(t,"".concat(a))===e.getNewsItemKey(n,"".concat(a))})},e.getPaddingCount=function(e,t){var n=0;return e.emptyItemType&&(n=e.count-t,n=e.emptyItemsCount?Math.min(e.emptyItemsCount,n):n),n},e.hasSameSetOfPosts=function(e,t){if(!e||!t||e.length!==t.length)return!1;var n=!0;return e.every(function(e){return n=n&&t.some(function(t){return e.url===t.url})}),n},e.hasSameOrderOfPosts=function(e,t){if(!e||!t||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0},e.removeQueryParam=function(e,t){if(e&&t){var n=new s.Uri(e);return n.removeQueryParameter(t),n.toString()}return e},e.didRenderedPropertiesChange=function(e,t){return e&&t&&(e.description!==t.description||e.image!==t.image||e.title!==t.title)},e.trackPrefetchDataUpdated=function(e,t){var n=T.TieredCacheHelperOnDemand.getPrefetchDataProvider(e),a="_spNewsWebPartData",i={alias:"FirstParty_NewsWebPart_News",prefetchUpdateOptions:t};null==n||n.trackPrefetchDataUpdated(a,i,"".concat(a,"Loaded"))},e.getNewsItemKey=function(e,t){return e.isHelpArticle?t:"".concat(e.siteId,"-").concat(e.webId,"-").concat(e.listId,"-").concat(e.uniqueId)},Object.defineProperty(e,"isOnSeeAllPage",{get:function(){var e=new s.Uri(window.location.href);return s.StringHelper.doesStringEndWith(e.getPath(!0).toLowerCase(),"/_layouts/15/news.aspx")},enumerable:!1,configurable:!0}),e.getFilterQueryBody=function(e){return void 0===e&&(e=""),JSON.stringify(e)},e.encodeSegments=function(e){if(!e)return e;var t="/"===e.substring(e.length-1)?"/":"",n=new r._SPResourcePath(e);if(!n.authority&&!n.domain)return e;var a=new RegExp(".+.aspx"),i=new RegExp("^(?:[^%]|%[0-9A-Fa-f]{2})+$"),o=n.segments.filter(function(e){return!!e}).map(function(e){try{var t=a.exec(i.test(e)?decodeURIComponent(e):e);if(t){var n=t[0];return e.replace(a,encodeURIComponent(n))}return e}catch(t){return e}});return s.Uri.concatenate.apply(s.Uri,[n.authority].concat(o))+t+n.searchParamString},e.getDefaultFilter=function(){return JSON.stringify([Object(U.cloneDeep)(R)])},e._shouldDeprecateDocViz=function(){return r._ThumbnailUrlGenerator.isVROOMThumbnailEnabled()},e._getSiteTitle=function(e,t,n,i){var r=e.SiteTitle;if(!r){var o=a.Guid.tryParse(t),s=a.Guid.tryParse(n);(null==o?void 0:o.equals(i.site.id))&&(null==s?void 0:s.equals(i.web.id))&&(r=i.web.title)}return r},e._getUserDisplayNameFromSearch=function(e){var t=e,n=null==e?void 0:e.split("|");return n&&n.length>1&&(t=n[1]),t||""},e._handleDefaultBanner=function(t){return e._isDefaultBannerImage(t)?H:t},e._extractImageFromBanner=function(e){var t=e.split(", ");return t[t.length>1?1:0].trim()},e._isDefaultBannerImage=function(t){return!t||s.StringHelper.doesStringEndWith(e._extractImageFromBanner(t),"/images/sitepagethumbnail.png")},e._isUseRedirectPageUrlKillSwitchActivated=function(){return a._SPKillSwitch.isActivated("5a9dc530-5eb2-4032-b8b9-b6d4222ad8ad")},e._processBannerImageUrlPartCore=function(t,n,a,o,l,u,f){var p=e._extractImageFromBanner(t),m=f||a.web.absoluteUrl,_="".concat(F,":"),h=e._tryGetExternalBanner(a,p,_);if(h)return h;if(e._isDefaultBannerImage(p))return"";var b=r._ThumbnailUrlGenerator.getThumbnailProvider(p);if(b===r._ThumbnailProviderType.PrivateCDN&&!Object(c.isAlterantiveUrlFresh)(p)){var g=new r._SPResourcePath(p);p=(p="https:/".concat(g.path)).split("?")[0],b=r._ThumbnailProviderType.Original}var v=new r._SPResourcePath(p),y=v.path.toLowerCase();if(b===r._ThumbnailProviderType.Stock)return p;if(b===r._ThumbnailProviderType.VROOMMeTACache||b===r._ThumbnailProviderType.PrivateCDN||b===r._ThumbnailProviderType.PublicCDN||b===r._ThumbnailProviderType.MeTA)return r._ThumbnailUrlGenerator.updateThumbnailWidth(p,o);if(b===r._ThumbnailProviderType.DocViz){if(i._TraceLogger.logVerbose(e._logSource,"".concat(_," already from GetPreview")),e._shouldDeprecateDocViz()){var S=r._ThumbnailUrlGenerator.fromGetPreview(p,F,o);if(S)return S}var D=r._PreviewUtility.normalizeWidthToResolution(o),I=new s.Uri(p);return I.setQueryParameter(r._PreviewHelper.RESOLUTION,D.toString()),I.toString()}var x=b!==r._ThumbnailProviderType.SharePointHost&&b!==r._ThumbnailProviderType.MySite;if(b!==r._ThumbnailProviderType.Unknown&&x)return r._ThumbnailUrlGenerator.updateThumbnailWidth(p,o);var C={absoluteUrl:v.authority||m,fileType:r._PreviewUtility.getFileExtension(v),spResource:y,width:o,callerId:F};return r._ThumbnailUrlGenerator.getThumbnailUrl(C,d.DefaultImageHelper.getDefaultImage(v))},e._tryGetExternalBanner=function(t,n,a){var o=new r._SPResourcePath(n),s=H;if(o&&(s=o.authority),s&&!d.UrlUtility.isInternalResource(n,t))return i._TraceLogger.logVerbose(e._logSource,"".concat(a," external host")),n},e._getAuthorEmail=function(e){var t;if(e){var n=e.split("|");t=n[n.length-1]}return t},e.aliasPrefix="FirstParty_NewsWebPart_",e.viewCountsDictionary={},e._logSource=i._LogSource.create("NewsUtilities"),e._mdrnHelpUrl=" https://go.microsoft.com/fwlink/?linkid=2103711",e}(),j="news",V="viewCounts",z="currentViewCounts",G="hubNews",K="newsDigest",W="multiSiteNews",q="myNews",Q="staleViewCounts",Y=function(){function e(e){var t=this;this.id="ExchangeViewCounts",this.title="",this.options=e,this.options.serviceScope.whenFinished(function(){t._pageContext=t.options.serviceScope.consume(o.PageContext.serviceKey),t._viewCountDataSource=t.options.serviceScope.consume(T.ViewCountDataProvider.serviceKey)})}return e._getViewCountFromCacheIfAvailable=function(e){this._viewCountCache.hasOwnProperty(e.uniqueId)&&(e.viewCounts=this._viewCountCache[e.uniqueId])},e._cacheViewCounts=function(e){var t=this;e.forEach(function(e){void 0!==e.uniqueId&&(t._viewCountCache[e.uniqueId]=e.viewCounts)})},e.prototype.requestData=function(e){var t=Object(U.chunk)(e,10);return Promise.all(t.map(this._createRequestForItems.bind(this))).then(function(){return e})},e.prototype._addViewCountsToItems=function(e,t){return e.filter(this._needsViewCount).map(function(e){var n=t.filter(function(t){return t.uniqueId===e.uniqueId||t.siteId===e.siteId&&t.webId===e.webId&&t.listItemId===Number(e.listItemId)})[0];return e.viewCounts=void 0!==n?Number(n.viewCount):void 0,e})},e.prototype._createRequestForItems=function(t){var n=this;return this._viewCountDataSource.getViewCounts(this._buildRequest(t)).then(function(a){return t=n._addViewCountsToItems(t,a),e._cacheViewCounts(t),t})},e.prototype._buildRequest=function(e){var t=this._pageContext.site.id.toString(),n=this._pageContext.web.id.toString();return e.filter(this._needsViewCount).map(function(e){return{listItemId:Number(e.listItemId)||0,uniqueId:e.uniqueId,siteId:e.siteId||t,webId:e.webId||n,listId:e.listId}})},e.prototype._needsViewCount=function(t){e._getViewCountFromCacheIfAvailable(t);var n=t.viewCounts;return null==n||"number"!=typeof n},e._viewCountCache={},e}(),J=n("17wl"),X=n("vlQI"),Z=n("2q6Q");function $(){return a._SPFlight.isEnabled(60373)}function ee(){return a._SPFlight.isEnabled(60878)&&(1===Z._SPPerfExperiment.getVariantAndTrackExperiment(Z._PerformanceExperiment.NewsCustomerPromiseExperiment)||a._SPFlight.isEnabled(60872))}!function(e){function t(){return a._SPFlight.isEnabled(60465)}function n(){return a._SPFlight.isEnabled(60229)}function i(){return a._SPFlight.isEnabled(60705)}e.isNewsHaukAPIFlightEnabled=t,e.isNewsHaukAPIModelEnabled=function(){return 1===Z._SPPerfExperiment.getVariantAndTrackExperiment(Z._PerformanceExperiment.NewsHaukAPIExperiment)||t()},e.isAsyncPrefetchPatternEnabled=function(){return(1===Z._SPPerfExperiment.getVariantAndTrackExperiment(Z._PerformanceExperiment.AsyncDataFlushExperiment,!0)||a._SPFlight.isEnabled(Z._PerformanceFlight.AsyncDataFlushFlight))&&a._SPFlight.isEnabled(Z._PerformanceFlight.AsyncDataPrefetchClientNewsFlight)},e.isMyNewsHaukAPIFlightEnabled=n,e.isMyNewsHaukAPIModelEnabled=function(){return 1===Z._SPPerfExperiment.getVariantAndTrackExperiment(Z._PerformanceExperiment.MyNewsHaukAPIExperiment)||n()},e.useGetMultiSiteForThisSite=i,e.isGetMultiSiteForThisSiteEnabled=function(e){return(1===Z._SPPerfExperiment.getVariantAndTrackExperiment(Z._PerformanceExperiment.NewsUseGetMultiSiteForThisSiteExp)||i())&&!e}}(P||(P={}));var te=function(e){function t(t,n){var a=e.call(this,n)||this;return a.errorCode=t,a}return Object(J.__extends)(t,e),t}(Error),ne="EmptyResponse",ae="ExpectedError",ie="_Response_Parse_Error",re="Cache",oe="Server",se="UnexpectedError",ce="UnexpectedRetryableError",de="MicroServiceNews",le=function(){function e(e){var t=this;this._maxRetryCount=3,this.parsedResponseCount=0,this.canCompare=!1,this._extraData={},this._retryCount=0,this._processMicroserviceServiceResponse=function(e,n,a){var i;if(B._isHaukShadowcallsKillSwitchActivated())i=e;else{t.canCompare=!!e.clone;var r=t.parsedResponseCount>0&&t.canCompare;t.parsedResponseCount++,i=r?e.clone():e}return i.json().then(function(i){var r=m(n,t._pageContext);return r.retryCount=t._retryCount,t._processMicroserviceServiceResponseCore(i,n,r,a,e)})},this._onCacheThenNetworkServerDataNotReturned=function(e,n){t._onCacheThenNetworkServerDataReturned(Promise.resolve([]),e,n)},this._onCacheThenNetworkServerDataReturned=function(e,n,a){var i=n&&a,r=i?re:"";e.then(function(e){var a=t._isEmptyResponse(e);if(a||i){var o=a?oe:"";t._writeToEmptyResultsMonitor(t._extraData,n,"".concat(r).concat(o).concat(ne))}}).catch(function(e){t._writeToEmptyResultsMonitor(t._extraData,n,"".concat(r).concat(oe).concat(ie),e)})},this._isEmptyResponse=function(e){var t=e&&e.filter(function(e){return!(null==e?void 0:e.isHelpArticle)});return!(null==t?void 0:t.length)},this._isRawData=function(e){return void 0!==(null==e?void 0:e.Items)},this._parseHttpClientResponse=function(e,n,a){var i=m(n);i.responseStatus=e.status.toString();var r=Object(T.hasResponseMSCV)(i.MSCV,i.URL),o=Object(T.getMicroServiceErrorCode)(e.status,r);return e.ok?e.json().then(function(e){var r=t._processRawData(e,n,a);return a.writeSuccess(i),r}).catch(function(e){throw a.writeUnexpectedFailure(o,e,i),e}):(a.writeUnexpectedFailure(o,new Error(se),i),Promise.reject())},this._processRawData=function(e,n,a){var i=B.getPaddingCount(n,e.Items?e.Items.length:0),r=!e.Items||0===e.Items.length;t._logEmptyResultToQos(t._extraData,r,e);var o=r?[]:t.extractMicroserviceNewsItems(e.Items);return o=o.concat(B.getEmptyStateItems(n.emptyItemType,t.options.serviceScope,i,n.webpartWidth)),a.writeSuccess(t._extraData),o},this.options=e,this.options.serviceScope.whenFinished(function(){t._pageContext=t.options.serviceScope.consume(o.PageContext.serviceKey),t._sphomeHttpClient=t.options.serviceScope.consume(T.SPHomeHttpClient.serviceKey),t._spHttpClient=t.options.serviceScope.consume(X.SPHttpClient.serviceKey)})}return Object.defineProperty(e.prototype,"isMicroserviceUnavailable",{get:function(){return this._sphomeHttpClient.isServiceAvailable},enumerable:!1,configurable:!0}),e.prototype.requestData=function(t){var n=this;this._retryCount=0;var a=e._requestCount++;return this._addPageUsageStartData(a),this._requestData(t).then(function(e){return n._addPageUsageEndData(a),e}).catch(function(e){if(++n._retryCount<n._maxRetryCount&&n.shouldRetryDataFetch(e))return n._requestData(t).then(function(e){return n._addPageUsageEndData(a),e});throw n._addPageUsageEndData(a,!0),e})},e.prototype.extractMicroserviceNewsItems=function(e){return B.extractMicroserviceNewsItems(e,this._pageContext)},e.prototype.shouldRetryDataFetch=function(e){return e.message===ce},e.prototype._processHttpClientResponsePromise=function(e,t,n,a,i){var r,o=this;return e.then(function(e){if(B._isHaukShadowcallsKillSwitchActivated())r=e;else{o.canCompare=!!e.clone;var t=(!!i||o.parsedResponseCount>0)&&o.canCompare;o.parsedResponseCount++,r=t?e.clone():e}return r.json()}).then(function(e){return o._processMicroserviceServiceResponseCore(e,t,n,a,r)})},e.prototype._applyCacheAndNetwork=function(e,t,n,r){var o=this;if(e.serverResponse&&e.cachedResponse){var s=new i._QosMonitor("".concat(this.qosMonitorLabel,".getNewsItemsInSmartRace")),c=this._processHttpClientResponsePromise(e.serverResponse,t,n,s).then(function(e){var n=o._isEmptyResponse(e);return t.onServerResponseResolved(n),e}).catch(function(e){throw t.onServerResponseFailed(e),e}),l=new i._QosMonitor("".concat(this.qosMonitorLabel,".getCachedNewsItemsInSmartRace")),u=T.TieredCacheHelper.processResponseRawData(e.cachedResponse,this._isRawData,this._processRawData,t,l).then(function(e){var n=o._isEmptyResponse(e);return t.onCacheResponseResolved(n),e||[]}).catch(function(e){throw l.writeUnexpectedFailure("ParseCacheResultsFailed",e),t.onCacheResponseFailed(e),e}),f=a.Guid.parse("9b794e3a-a041-4fb4-870d-a1121ca57ca7"),p=a.Guid.parse("4d757517-a42f-4546-a76a-8d0da7dd2a07"),m=[{raceablePromise:u,raceId:f},{raceablePromise:c,raceId:p}];return d.SmartRace.race(m).then(function(e){return e.raceId===f&&c.then(function(e){t.onServerResponseResolvedWithCache(e)}).catch(function(){}),r.writeSuccess({cacheStatus:e.raceId===f?"WonRace":"LostRace"}),e.raceablePromise}).catch(function(e){throw r.writeUnexpectedFailure("SmartRaceFailed",e),e})}},e.prototype._addPageUsageStartData=function(e){var t=Z._PageUsageAdapter.getInstance(),n=t.elapsedTime();t.markFeature("".concat(de,"-").concat(this.qosMonitorLabel,"-").concat("StartTime","-").concat(e),n.toFixed(2))},e.prototype._addPageUsageEndData=function(e,t){var n=Z._PageUsageAdapter.getInstance(),a=n.elapsedTime();n.markFeature("".concat(de,"-").concat(this.qosMonitorLabel,"-").concat("EndTime","-").concat(e,"-").concat(this._retryCount),a.toFixed(2)),t&&n.markFeature("".concat(de,"-").concat(this.qosMonitorLabel,"-")+"".concat(e,"-").concat(this._retryCount,"-").concat("Failure"))},e.prototype._addMoreAdditionalFields=function(e,t){t.spHomeServer=e.headers.get("sphome-server");var n=e.headers.get("sphome-sharepointid");n&&(t.spHomeSharepointId=n)},e.prototype._addCacheAndServerEmptyStateLogs=function(e,t,n,a,i){var r=this,o=n&&a,s=o?re:"";return e.then(function(e){var a=r._isEmptyResponse(e);if(i.onServerResponseResolved(a),a||o){var c=a?oe:"";r._writeToEmptyResultsMonitor(t,n,"".concat(s).concat(c).concat(ne))}return e}).catch(function(e){throw r._writeToEmptyResultsMonitor(t,n,"".concat(s).concat(oe).concat(ie),e),i.onServerResponseFailed(e),e})},e.prototype._getIsExpectedError=function(e){return e>=400&&e<500&&!Object(T.isThrottledResponse)(e)},e.prototype._getIsUnExpectedRetryableError=function(e){return e>=500&&e<600&&!Object(T.isThrottledResponse)(e)},e.prototype._logEmptyResultToQos=function(e,t,n){var a=new i._QosMonitor("".concat(this.qosMonitorLabel,".getNewsItems.EmptyResults"));t?a.writeUnexpectedFailure(ne,new Error("200 ".concat(n.Items?"0 Items":"No Items")),e):a.writeSuccess(e)},e.prototype._logThrottledResultToQos=function(e,t){if(Object(T.isThrottledResponse)(t)){var n=new i._QosMonitor("GetNewsItems.ThrottledResult");e.dataProvider=this.qosMonitorLabel,n.writeSuccess(e)}},e.prototype._parseClientCachableResponse=function(e,t,n,a){var i=this,r=e.cachedResponse?T.TieredCacheHelper.processResponseRawData(e.cachedResponse,this._isRawData,this._processRawData,t,a):void 0,o=e.serverResponse?this._processHttpClientResponsePromise(e.serverResponse,t,n,a):void 0;return r?(r.then(function(e){var a=i._isEmptyResponse(e);if(t.onCacheResponseResolved(a),o)i._addCacheAndServerEmptyStateLogs(o,n,!0,a,t).then(function(e){t.onServerResponseResolvedWithCache(e)}).catch(function(){});else{var r=a?re:"";a&&i._writeToEmptyResultsMonitor(n,!0,"".concat(r).concat(ne))}}).catch(function(e){t.onCacheResponseFailed(e)}),r):(a.writeSuccess(n),this._addCacheAndServerEmptyStateLogs(o,n,!1,!0,t))},e.prototype._processMicroserviceServiceResponseCore=function(e,t,n,a,i){n.URL=B.removeQueryParam(i.url,"mainSiteUrl"),n.MSCV=i.headers.get("MS-CV"),this._extraData=n,this._addMoreAdditionalFields(i,n);var r=Object(T.hasResponseMSCV)(n.MSCV,n.URL);if(i.ok&&r)return this._processRawData(e,t,a);var o=i.status,s=Object(T.getMicroServiceErrorCode)(o,r);n.statusCode=o.toString(),n.responseStatus=i.statusText;var c=void 0,d=e;throw this._getIsExpectedError(o)?(c=ee()?new te(i.status,ae):new Error(ae),n.id=d.ErrorLabel,a.writeExpectedFailure(s,c,n)):(this._getIsUnExpectedRetryableError(o)?c=ee()?new te(i.status,ce):new Error(ce):(c=ee()?new te(i.status,se):new Error(se),this._logThrottledResultToQos(n,o)),n.id=d.ErrorLabel,a.writeUnexpectedFailure(s,c,n)),c},e.prototype._requestData=function(e){var t=this;if(!A()){var n={parseHttpClientResponse:this._processMicroserviceServiceResponse,isEmptyResponse:this._isEmptyResponse,isRawData:this._isRawData,processRawData:this._processRawData,qosMonitorLabel:this.qosMonitorLabel,onServerResponseResolvedWithCache:e.onServerResponseResolvedWithCache,onServerResponseResolved:e.onServerResponseResolved,onServerResponseFailed:e.onServerResponseFailed,onCacheResponseResolved:e.onCacheResponseResolved,onCacheResponseFailed:e.onCacheResponseFailed,onCacheThenNetworkServerDataReturned:this._onCacheThenNetworkServerDataReturned,onCacheThenNetworkServerDataNotReturned:this._onCacheThenNetworkServerDataNotReturned};return T.TieredCacheHelper.executeCacheStrategy(n,this.executeRequest,e)}var a=new i._QosMonitor("".concat(this.qosMonitorLabel,".getNewsItems")),r=m(e,this._pageContext);return r.retryCount=this._retryCount,this.executeRequest(e).then(function(n){if(n instanceof X.HttpClientResponse)return t._parseHttpClientResponse(n,e,a);var i=n,o=t._applyCacheAndNetwork(i,e,r,a);if(o)return o;var s=n;return t._parseClientCachableResponse(s,e,r,a)}).catch(function(e){if(!a.hasEnded&&0===r.retryCount)if(e instanceof T.SPHomeMicroserviceNotAvailableError)a.writeUnexpectedFailure("TokenNotAvailable",e,r);else{var t=e.message;e=new Error(se),a.writeUnexpectedFailure(t,e,r)}throw e})},e.prototype._writeToEmptyResultsMonitor=function(e,t,n,a){var r=new i._QosMonitor("GetNewsItems.ZeroResult");e.mySiteCacheHit=t,e.dataProvider=this.qosMonitorLabel,e.source=n,a?r.writeUnexpectedFailure(n,a,e):t&&n==="".concat(re).concat(oe).concat(ne)?r.writeExpectedFailure(n,new Error("Expected Cache and Server Empty Result"),e):r.writeSuccess(e)},e._requestCount=0,e}(),ue=n("K9kD");function fe(e){var t,n=e.webAbsoluteUrl,i=e.multiGeoInfo;if(!a._SPKillSwitch.isActivated("3d261ee4-bce3-46e4-a64f-6a6bf694277e")){if(!n||!i||!i.length)return;try{var r=new ue.Uri(n).getHost();return null===(t=i.filter(function(e){return new ue.Uri(e.RootSiteUrl).getHost()===r})[0])||void 0===t?void 0:t.InstanceId}catch(e){return}}}var pe="EmptyResponse",me="Cache",_e="Server",he=function(){function e(e){var t=this;this._extraData={},this.requestData=function(e){return t._requestData(e)},this.executeRequest=function(e){var n=void 0;return a._SPKillSwitch.isActivated("381ce7de-c105-43a5-973d-3fa81c146c46")?"POST"===t.httpMethod&&(n={body:JSON.stringify(t.getRequestBody(e)),headers:new N("POST"),method:"POST"}):t._getHeaders(e)&&(n={headers:t._getHeaders(e),method:t.httpMethod},"POST"===t.httpMethod&&(n.body=JSON.stringify(t.getRequestBody(e)))),w()?t.httpClient instanceof X.HttpClient?t.httpClient.fetch(t.getAPIPath(e),X.HttpClient.configurations.v1,n,t.getRequestCacheOptions(e)):t.httpClient.fetch(t.getAPIPath(e),X.SPHttpClient.configurations.v1,n,t.getRequestCacheOptions(e)):t.getRequestCacheOptionsAsync(e).then(function(a){return t.httpClient instanceof X.HttpClient?t.httpClient.fetch(t.getAPIPath(e),X.HttpClient.configurations.v1,n,a):t.httpClient.fetch(t.getAPIPath(e),X.SPHttpClient.configurations.v1,n,a)})},this.getCacheProps=function(e){return{parseHttpClientResponse:t.parseHttpClientResponse,isEmptyResponse:t._isEmptyResponse,isRawData:t.isRawData,processRawData:t.processRawData,qosMonitorLabel:t.qosMonitorLabel,onServerResponseResolvedWithCache:e.onServerResponseResolvedWithCache,onServerResponseResolved:e.onServerResponseResolved,onServerResponseFailed:e.onServerResponseFailed,onCacheResponseResolved:e.onCacheResponseResolved,onCacheResponseFailed:e.onCacheResponseFailed,onCacheThenNetworkServerDataReturned:t._onCacheThenNetworkServerDataReturned,onCacheThenNetworkServerDataNotReturned:function(n,a){return t._onCacheThenNetworkServerDataNotReturned(n,a,e)}}},this.getExtraHeaders=function(e){},this.getRequestBody=function(e){return{}},this.getRequestCacheOptions=function(e){var n,a=new Map;if(a.set(T.TieredCacheHelper.useStalePropName,!0),P.isAsyncPrefetchPatternEnabled()){if(a.set(T.TieredCacheHelper.enableDataPrefetch,!0),!L()){var r=null===(n=t._pageContext.listItem)||void 0===n?void 0:n.uniqueId;if(r){var o={folderPath:T.TieredCacheHelperOnDemand.getWebPartDefaultCachePath(r)};a.set(T.TieredCacheHelper.mySiteCacheConfiguration,o)}}if(!M()&&e.prefetchUpdateOptions){var s=e.prefetchUpdateOptions.onDataUpdated;e.prefetchUpdateOptions.onDataUpdated=function(n){var a=t.processRawData(JSON.parse(n.data),e,new i._QosMonitor("".concat(t.qosMonitorLabel,".onPrefetchDataUpdated")));s(a)},a.set(T.TieredCacheHelper.prefetchUpdateOptions,e.prefetchUpdateOptions)}}var c={alias:B.aliasPrefix+t.id,id:e.webpartId,expirationDuration:6e5,cacheStrategy:P.isAsyncPrefetchPatternEnabled()?X._CacheStrategy.CacheThenNetwork:X._CacheStrategy.CacheAndNetwork,extraProps:a};return e.canCacheRequest&&!t.isPaginationRequest(e)||(c.cacheStrategy=X._CacheStrategy.NetworkOnly),c},this.getRequestCacheOptionsAsync=function(e){var n=t._getCacheKeyOverrideAsync(e);return n?n.then(function(n){var a,r=new Map;if(r.set(T.TieredCacheHelper.useStalePropName,!0),P.isAsyncPrefetchPatternEnabled()){if(r.set(T.TieredCacheHelper.enableDataPrefetch,!0),!L()){var o=null===(a=t._pageContext.listItem)||void 0===a?void 0:a.uniqueId;if(o){var s={folderPath:T.TieredCacheHelperOnDemand.getWebPartDefaultCachePath(o)};r.set(T.TieredCacheHelper.mySiteCacheConfiguration,s)}}if(!M()&&e.prefetchUpdateOptions){var c=e.prefetchUpdateOptions.onDataUpdated;e.prefetchUpdateOptions.onDataUpdated=function(n){var a=t.processRawData(JSON.parse(n.data),e,new i._QosMonitor("".concat(t.qosMonitorLabel,".onPrefetchDataUpdated")));c(a)},r.set(T.TieredCacheHelper.prefetchUpdateOptions,e.prefetchUpdateOptions)}}n&&r.set(T.TieredCacheHelper.cacheKeyOverride,n);var d={alias:B.aliasPrefix+t.id,id:e.webpartId,expirationDuration:6e5,cacheStrategy:P.isAsyncPrefetchPatternEnabled()?X._CacheStrategy.CacheThenNetwork:X._CacheStrategy.CacheAndNetwork,extraProps:r};return e.canCacheRequest&&!t.isPaginationRequest(e)||(d.cacheStrategy=X._CacheStrategy.NetworkOnly),d}):Promise.resolve(t.getRequestCacheOptions(e))},this.parseHttpClientResponse=function(e,n,a){t._extraData=m(n),t._extraData.responseStatus="".concat(e.status);var i="".concat(e.correlationId),r="".concat(e.statusMessage),o="".concat(e.statusText);if(t._extraData.correlationId=i,t._extraData.message=r,t._extraData.statusText=o,e.ok)return e.json().then(function(e){return t.processRawData(e,n,a)}).catch(function(e){throw a.writeUnexpectedFailure("Unexpected",e,t._extraData),e});var s=new Error(r||o);return a.writeUnexpectedFailure("Unexpected",s,t._extraData),ee()?Promise.reject(new te(e.status,s.message)):Promise.reject(s)},this.processRawData=function(e,n,a){var i=t.getRawItems(e),r=B.getPaddingCount(n,i?i.length:0),o=!i||0===i.length;t._logEmptyResultToQos(o,e);var s=o?[]:t._extractNewsItems(i);return s=s.concat(B.getEmptyStateItems(n.emptyItemType,t.options.serviceScope,r,n.webpartWidth)),a.writeSuccess(t._extraData),s},this._extractNewsItems=function(e){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];return t.extractNewsItemsCallback(e,t._pageContext,n)},this._getBaseCacheKey=function(e){var n,r={userId:null===(n=t._pageContext.aadInfo)||void 0===n?void 0:n.userId.toString(),source:t.id,count:e.count};if(a._SPKillSwitch.isActivated("2dd92e7a-2f47-4ce7-b680-630d2dbf8afd"))r=Object(J.__assign)(Object(J.__assign)({},r),{rootUrl:t.rootUrl});else{r=Object(J.__assign)(Object(J.__assign)({},r),{spInstanceId:fe(t._pageContext.legacyPageContext)});var o=new i._QosMonitor("".concat(t.qosMonitorLabel,".SPInstanceId.Availability"));r.spInstanceId?o.writeSuccess():o.writeUnexpectedFailure("SPInstanceIdNotAvailable")}return r},this._getCacheKeyOverrideAsync=function(e){if(t.cacheKeyOverrideEnabled)return T.TieredCacheHelperOnDemand.generateCacheKey(t.getKeyOverride(e))},this._getHeaders=function(e){var n=t.getExtraHeaders(e);if(a._SPKillSwitch.isActivated("a3571ffd-77f7-4329-b518-6f9038ef21d4")||(n||(n=new Map),a._SPKillSwitch.isActivated("cb7ada7b-46f9-4dc0-b833-b7da78c63ded")?n.set("Caller","PagesWeb"):n.set("Caller",e.callerHeader)),"POST"===t.httpMethod||n){var i=new N(t.httpMethod);return null==n||n.forEach(function(e,t){i[t]=e}),i}},this._onCacheThenNetworkServerDataNotReturned=function(e,n,a){var i;ee()&&(null===(i=a.onCacheThenNetworkServerDataNotReturned)||void 0===i||i.call(a,e,n)),t._onCacheThenNetworkServerDataReturned(Promise.resolve([]),e,n)},this._onCacheThenNetworkServerDataReturned=function(e,n,a){var i=n&&a,r=i?me:"";e.then(function(e){var a=t._isEmptyResponse(e);if(a||i){var o=a?_e:"";t._writeToEmptyResultsMonitor(n,"".concat(r).concat(o).concat(pe))}}).catch(function(e){t._writeToEmptyResultsMonitor(n,"".concat(r).concat(_e).concat("_Response_Parse_Error"),e)})},this._isEmptyResponse=function(e){var t=e&&e.filter(function(e){return!(null==e?void 0:e.isHelpArticle)});return!(null==t?void 0:t.length)},this._logEmptyResultToQos=function(e,n){var a=new i._QosMonitor("".concat(t.qosMonitorLabel,".getNewsItems.EmptyResults"));e?a.writeUnexpectedFailure(pe,new Error("200 ".concat(t.getRawItems(n)?"0 Items":"No Items")),t._extraData):a.writeSuccess(t._extraData)},this._requestData=function(e){return T.TieredCacheHelper.executeCacheStrategy(t.getCacheProps(e),t.executeRequest,e)},this._writeToEmptyResultsMonitor=function(e,n,a){var r=new i._QosMonitor("GetNewsItems.ZeroResult");t._extraData.mySiteCacheHit=e,t._extraData.dataProvider=t.qosMonitorLabel,t._extraData.source=n,a?r.writeUnexpectedFailure(n,a,t._extraData):e&&n==="".concat(me).concat(_e).concat(pe)?r.writeExpectedFailure(n,new Error("Expected Cache and Server Empty Result"),t._extraData):r.writeSuccess(t._extraData)},this.options=e,this.options.serviceScope.whenFinished(function(){t._pageContext=t.options.serviceScope.consume(o.PageContext.serviceKey)})}return e.prototype.getKeyOverride=function(e){return this._getBaseCacheKey(e)},e}(),be=function(e){function t(t){var n=e.call(this,t)||this;return n.paginationCompleted=!1,n.getRawItems=function(e){return e["@odata.nextLink"]?n.nextLink=e["@odata.nextLink"]:n.paginationCompleted=!0,e.value},n.isRawData=function(e){return!!e.value},n.isPaginationRequest=function(e){return!!e.isPaginationRequest&&!!n.nextLink},n.extractNewsItemsCallback=function(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];return B.extractVroomNewsItems(e,t)},n.options.serviceScope.whenFinished(function(){n.httpClient=n.options.serviceScope.consume(X.SPHttpClient.serviceKey)}),n}return Object(J.__extends)(t,e),Object.defineProperty(t.prototype,"cacheKeyOverrideEnabled",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"httpMethod",{get:function(){return"POST"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rootUrl",{get:function(){return s.UriEncoding.escapeUrlForCallback(this._pageContext.web.absoluteUrl.replace(this._pageContext.web.serverRelativeUrl,""))},enumerable:!1,configurable:!0}),t.prototype.getKeyOverride=function(t){return Object(J.__assign)(Object(J.__assign)({},e.prototype.getKeyOverride.call(this,t)),this.getRequestBody(t))},t}(he),ge=be,ve=function(e,t,n){var a=this;this.newsApiPromises=new Map,this.newsApiResults=new Map,this.newsDataProviderIndex=new Map,this.addApiPromise=function(e,t,n){a.newsApiPromises.set(t,n),a.newsDataProviderIndex.set(t,e),n.then(function(e){a.addApiResult(t,e)}).catch(function(e){})},this.handleRacing=function(){var e=new i._QosMonitor("NewsAPIComparer.handleRacing"),t=[],n=[],r={};a.newsApiPromises.forEach(function(e,i){var o=1;r["dataProvider-".concat(o++)]=a.newsDataProviderIndex.get(i),t.push(e),n.push({raceablePromise:e,raceId:i})}),d.SmartRace.race(n).then(function(n){var i=function(t){r=Object(J.__assign)(Object(J.__assign)({},r),{fasterAPI:a.newsDataProviderIndex.get(n.raceId),"error.name":null==t?void 0:t.name,"error.message":null==t?void 0:t.message,"error.stack":null==t?void 0:t.stack}),e.writeSuccess(r)};Promise.all(t).then(function(){r=a.compareNewsItemsArray(r),i()}).catch(function(e){i(e)})}).catch(function(t){throw e.writeUnexpectedFailure("SmartRaceFailed",t,r),t})},this.addApiResult=function(e,t){a.newsApiResults.set(e,t)},this.compareNewsItemsArray=function(e){var t,n=a.newsApiResults.get(a.baseApiGuid)||[],r=(null===(t=a.newsApiResults.get(a.baseApiGuid))||void 0===t?void 0:t.length)||0;return a.newsApiResults.forEach(function(t,o){if(a.baseApiGuid!==o){var s=a.newsDataProviderIndex.get(o),c={baseDataProvider:a.newsDataProviderIndex.get(a.baseApiGuid),compareToDataProvider:s};a.baseApiPromiseStringified!==JSON.stringify(t)?(c["baseDataProvider.length"]="".concat(r),c["compareToDataProvider.length"]="".concat(t.length),c=a.compareNewsItems(n,t,c),i._EngagementLogger.logEventWithLogEntry(new i._LogEntry("NewsComparer","DifferentArrays_Base",i._LogType.Event,e)),i._EngagementLogger.logEventWithLogEntry(new i._LogEntry("NewsComparer","DifferentArrays_Details",i._LogType.Event,c))):(i._EngagementLogger.logEventWithLogEntry(new i._LogEntry("NewsComparer","SameResults_Base",i._LogType.Event,e)),i._EngagementLogger.logEventWithLogEntry(new i._LogEntry("NewsComparer","SameResults_Details",i._LogType.Event,c)))}}),e},this.compareNewsItems=function(e,t,n){for(var i=Array.from(Array(2),function(){return new Array(Math.max(e.length,t.length))}),r=0;r<e.length;r++)if(!i[0][r])for(var o=0;o<t.length;o++)i[0][o]||(a._compareEqualItem(e[r],t[o])?(i[0][r]=i[1][o]=!0,n["itemsEqualAtIndex-".concat(r,"-").concat(o)]="".concat(!0),n=a._logFieldMismatch(e[r],t[o],n,r,o),++r):(n["itemsEqualAtIndex-".concat(r,"-").concat(o)]="".concat(!1),e[r].isHelpArticle||t[o].isHelpArticle?(e[r].isHelpArticle&&(n["baseItemStartsHelpArticlesAt-".concat(r,"-").concat(o)]="".concat(!0),r=e.length),t[o].isHelpArticle&&(n["compareToItemStartsHelpArticlesAt-".concat(r,"-").concat(o)]="".concat(!0),o=t.length)):e[r].publishedOn>t[o].publishedOn?n["baseItemNewerAtIndex-".concat(r,"-").concat(o)]="".concat(!0):n["baseItemNewerAtIndex-".concat(r,"-").concat(o)]="".concat(!1)));return n},this._logFieldMismatch=function(e,t,n,a,i){return["author","description","email","isAuthoritative","image","publishedOn","title","url","siteTitle","siteUrl","listItemId","originalSourceItemId","originalSourceUrl","uniqueId","siteId","webId","listId"].forEach(function(r){e[r]&&t[r]&&e[r].toString()!==t[r].toString()&&(n["fieldisEqual-".concat(r,"-").concat(a,"-").concat(i)]="".concat(!1))}),n},this._getItemKeyCallback=function(e){return B.getNewsItemKey(e,"".concat(e.siteId,"-").concat(e.webId,"-").concat(e.uniqueId))},this._compareEqualItem=function(e,t){var n=a._getItemKeyCallback;return n(e)===n(t)&&e.siteUrl==e.siteUrl},this.baseApiGuid=t,this.addApiPromise(e,t,n),n.then(function(e){a.addApiResult(t,e),a.baseApiPromiseStringified=JSON.stringify(e)})},ye=function(){function e(e){return this.id="hubNews",this.title=_.x,P.isNewsHaukAPIModelEnabled()&&!e.shouldUseMicroservice?this.instance=new Se(e):this.instance=new De(e),this.instance}return Object.defineProperty(e.prototype,"qosMonitorLabel",{get:function(){return"HubNewsDataProvider"},enumerable:!1,configurable:!0}),e.prototype.requestData=function(e){return this.instance.requestData(e)},e}(),Se=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="hubNews",t.title=_.x,t.getRequestBody=function(e){if(w())return{hubs:["".concat(e.hubId)],filterByAudience:!!e.audienceTargetingEnabled,preferredLanguage:e.languageOverride};var t={hubs:["".concat(e.hubId)],filterByAudience:!!e.audienceTargetingEnabled};return e.languageOverride&&(t.preferredLanguage=e.languageOverride),t},t.getAPIPath=function(e){var n=s.UriEncoding.escapeUrlForCallback(t._pageContext.web.absoluteUrl),a="?$expand=analytics($expand=allTime),thumbnails&$top=".concat(e.count);return t.isPaginationRequest(e)?t.nextLink:n+"/_api/v2.1/getMultiHubNews"+a},t}return Object(J.__extends)(t,e),Object.defineProperty(t.prototype,"qosMonitorLabel",{get:function(){return"VroomHubNewsDataProvider"},enumerable:!1,configurable:!0}),t}(ge),De=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="hubNews",t.title=_.x,t.executeRequest=function(e){var n={alias:B.aliasPrefix+t.id,id:e.webpartId,expirationDuration:6e5,cacheStrategy:X._CacheStrategy.CacheAndNetwork,extraProps:new Map([[T.TieredCacheHelper.useStalePropName,!0]])};e.canCacheRequest||(n.cacheStrategy=X._CacheStrategy.NetworkOnly);var a=t._sphomeHttpClient.post(t.getMicroservicePath(e),B.getFilterQueryBody(e.filterKQLQuery),void 0,void 0,n);return B._isHaukShadowcallsKillSwitchActivated()||t._compareNewAPIs(a,e),a},t}return Object(J.__extends)(t,e),Object.defineProperty(t.prototype,"qosMonitorLabel",{get:function(){return"HubNewsDataSource"},enumerable:!1,configurable:!0}),t.prototype.extractMicroserviceNewsItems=function(e){return B.extractMicroserviceNewsItems(e,this._pageContext,!0)},t.prototype.getMicroservicePath=function(e){var t="departmentId=".concat(e.hubId,"&start=").concat(e.skip,"&count=").concat(e.count);return t+=f(e),t+=p(e),"".concat("news/hub/filtered","?").concat(t)},t.prototype._compareNewAPIs=function(e,t){var n=this;setTimeout(function(){if(n.canCompare){var r=e.then(function(e){if(!(e instanceof X.HttpClientResponse)&&e.serverResponse){var a=new i._QosMonitor("SPHomeQualityTest.getHubProcessedResponse");return n._processHttpClientResponsePromise(e.serverResponse,t,{},a,!0)}return[]}),o=new ve("SPHomeMicroservice",a.Guid.parse("92d60991-5b57-4828-9f5f-da94e71c6257"),r),s=t;s.canCacheRequest=!1;var c=new i._QosMonitor("News.HubsiteVroom"),d=new Se(n.options).requestData(s).then(function(e){return c.writeSuccess(),e}).catch(function(e){return c.writeUnexpectedFailure("Error",e),[]});o.addApiPromise("VroomAPI",a.Guid.parse("4a609117-4832-4b81-a400-c222a06d25be"),d),o.handleRacing()}},3e3)},t}(le),Ie=function(){function e(e){return this.id="MultiSiteNews",this.title=_.C,P.isNewsHaukAPIModelEnabled()&&!e.shouldUseMicroservice?this.instance=new xe(e):this.instance=new Ce(e),this.instance}return Object.defineProperty(e.prototype,"qosMonitorLabel",{get:function(){return"MultiSiteNewsDataProvider"},enumerable:!1,configurable:!0}),e.prototype.requestData=function(e){return this.instance.requestData(e)},e}(),xe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="MultiSiteNews",t.title=_.C,t.getRequestBody=function(e){var t=[];if(e.siteList.forEach(function(e){t.push("".concat(e.ItemReference.SiteId,",").concat(e.ItemReference.WebId))}),w())return{sites:t,filterByAudience:!!e.audienceTargetingEnabled,preferredLanguage:e.languageOverride};var n={sites:t,filterByAudience:!!e.audienceTargetingEnabled};return e.languageOverride&&(n.preferredLanguage=e.languageOverride),n},t.getAPIPath=function(e){var n=s.UriEncoding.escapeUrlForCallback(t._pageContext.web.absoluteUrl),a="?$expand=analytics($expand=allTime),thumbnails&$top=".concat(e.count);return t.isPaginationRequest(e)?t.nextLink:n+"/_api/v2.1/getMultiSiteNews"+a},t}return Object(J.__extends)(t,e),Object.defineProperty(t.prototype,"qosMonitorLabel",{get:function(){return"VroomMultiSiteNewsDataProvider"},enumerable:!1,configurable:!0}),t}(ge),Ce=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="MultiSiteNews",t.title=_.C,t.executeRequest=function(e){var n={alias:B.aliasPrefix+t.id,id:e.webpartId,expirationDuration:6e5,cacheStrategy:X._CacheStrategy.CacheAndNetwork,extraProps:new Map([[T.TieredCacheHelper.useStalePropName,!0]])};e.canCacheRequest||(n.cacheStrategy=X._CacheStrategy.NetworkOnly);var a=t._sphomeHttpClient.post(t.getMicroservicePath(e),t._getSiteListAndFilterBody(e.siteList,e.filterKQLQuery),void 0,void 0,n);return B._isHaukShadowcallsKillSwitchActivated()||t._compareNewAPIs(a,e),a},t}return Object(J.__extends)(t,e),Object.defineProperty(t.prototype,"qosMonitorLabel",{get:function(){return"MultiSiteNewsDataSource"},enumerable:!1,configurable:!0}),t.prototype.requestData=function(t){var n;return(null===(n=t.siteList)||void 0===n?void 0:n.length)?e.prototype.requestData.call(this,t):Promise.resolve(this._getNewsItemsWithPadding(t,0))},t.prototype.extractMicroserviceNewsItems=function(e){return B.extractMicroserviceNewsItems(e,this._pageContext,!0)},t.prototype.getMicroservicePath=function(e){var t="mainSiteUrl=".concat(this._pageContext.site.absoluteUrl,"&"),n="start=".concat(e.skip,"&count=").concat(e.count);n+=f(e),n+=p(e);var a=this._shouldQueryCurrentSite(e.siteList||[]);return"".concat("news/sites/filtered","?").concat(a?t:"").concat(n)},t.prototype._getNewsItemsWithPadding=function(e,t){var n=B.getPaddingCount(e,t);return B.getEmptyStateItems(e.emptyItemType,this.options.serviceScope,n,e.webpartWidth)},t.prototype._shouldQueryCurrentSite=function(e){var t=this._pageContext.site.id.toString(),n=this._pageContext.web.id.toString();return U.findIndex(e,function(e){return e.ItemReference.SiteId===t&&e.ItemReference.WebId===n})>-1},t.prototype._getSiteListAndFilterBody=function(e,t){return JSON.stringify({ReferenceList:this._getSiteListBody(e),FilterQuery:t})},t.prototype._getSiteListBody=function(e){return e.map(function(e){return{Type:"SiteReference",SiteId:e.ItemReference.SiteId,WebId:e.ItemReference.WebId}})},t.prototype._compareNewAPIs=function(e,t){var n=this;setTimeout(function(){if(n.canCompare){var r=e.then(function(e){if(!(e instanceof X.HttpClientResponse)&&e.serverResponse){var a=new i._QosMonitor("SPHomeQualityTest.getMultiSiteProcessedResponse");return n._processHttpClientResponsePromise(e.serverResponse,t,{},a,!0)}return[]}),o=new ve("SPHomeMicroservice",a.Guid.parse("364f9d77-37e1-4060-b45c-d85d631f2ebf"),r),s=t;s.canCacheRequest=!1;var c=new i._QosMonitor("News.MultisiteVroom"),d=new xe(n.options).requestData(s).then(function(e){return c.writeSuccess(),e}).catch(function(e){return c.writeUnexpectedFailure("Error",e),[]});o.addApiPromise("VroomAPI",a.Guid.parse("3e2b65bb-803a-4b31-9189-4c88a3aa9836"),d),o.handleRacing()}},3e3)},t}(le),Oe=function(){function e(e){var t,n=this;return this.id="News",this.title=_.w,this.qosMonitorLabel="NewsreelDataSource",this._executeRequest=function(e){var t={metadataFilter:e.serializedFilterQuery,languageOverride:e.languageOverride},a={body:JSON.stringify(t),headers:new N("POST"),method:"POST"},i={alias:B.aliasPrefix+n.id,id:e.webpartId,expirationDuration:6e5,cacheStrategy:X._CacheStrategy.CacheAndNetwork,extraProps:new Map([[T.TieredCacheHelper.useStalePropName,!0]])};return e.canCacheRequest||(i.cacheStrategy=X._CacheStrategy.NetworkOnly),n._spHttpClient.fetch(n._getNewsItemsUrl(e),X.SPHttpClient.configurations.v1,a,i)},this._isEmptyResponse=function(e){var t=null==e?void 0:e.filter(function(e){return!(null==e?void 0:e.isHelpArticle)});return!(null==t?void 0:t.length)},this._isRawData=function(e){return null==e?void 0:e.value},this._parseSPHttpClientResponse=function(e,t,a){var i=m(t),r=n._isInSmartRace?"NewsreelDataSource.getNewsItemsInSmartRace":"NewsreelDataSource.getNewsItems",o=a||new Z._QosMonitor(r);if(i.correlationId="".concat(e.correlationId),i.responseStatus="".concat(e.status),i.message=e.statusMessage,e.ok)return e.json().then(function(e){var a=n._processRawData(e,t);return o.writeSuccess(i),a}).catch(function(t){throw o.writeUnexpectedFailure("Unexpected",t,i),ee()?new te(e.status,t.message):t});var s=new Error(e.statusMessage);return o.writeUnexpectedFailure("Unexpected",s,i),ee()?Promise.reject(new te(e.status,s.message)):Promise.reject(s)},this._processRawData=function(e,t){var a=B.getPaddingCount(t,e.value?e.value.length:0);return(e.value&&e.value.length>0?B.extractNewsItems(e.value,n._pageContext):[]).concat(B.getEmptyStateItems(t.emptyItemType,n.options.serviceScope,a,t.webpartWidth))},this.options=e,this.options.serviceScope.whenFinished(function(){var e;n._spHttpClient=n.options.serviceScope.consume(X.SPHttpClient.serviceKey),n._pageContext=n.options.serviceScope.consume(o.PageContext.serviceKey),n._absoluteUrl=null===(e=n._pageContext)||void 0===e?void 0:e.web.absoluteUrl}),s.Locale.language||(s.Locale.language="en-us"),this._isOneBox="onebox"===(null===(t=this._pageContext.legacyPageContext)||void 0===t?void 0:t.env2),P.isGetMultiSiteForThisSiteEnabled(this._isOneBox)&&(this._defaultFilter=B.getDefaultFilter(),this._multiSiteDataProvider=new we(this.options)),this}return e.prototype.requestData=function(e){var t=this;if(this._shouldUseMultiSiteDataProvider(e))return this._requestMultiSiteData(e);if(!A()){var n={parseHttpClientResponse:this._parseSPHttpClientResponse,isEmptyResponse:this._isEmptyResponse,isRawData:this._isRawData,processRawData:this._processRawData,qosMonitorLabel:this.qosMonitorLabel,onServerResponseResolvedWithCache:e.onServerResponseResolvedWithCache,onServerResponseResolved:e.onServerResponseResolved,onServerResponseFailed:e.onServerResponseFailed,onCacheResponseResolved:e.onCacheResponseResolved,onCacheResponseFailed:e.onCacheResponseFailed};return T.TieredCacheHelper.executeCacheStrategy(n,this._executeRequest,e)}return this._executeRequest(e).then(function(n){if(n instanceof X.SPHttpClientResponse)return t._parseSPHttpClientResponse(n,e);var a=n;return t._applyCacheAndNetwork(a,e)||t._parseClientCachableResponse(n,e)})},e.prototype._applyCacheAndNetwork=function(e,t){var n=this;if(e.serverResponse&&e.cachedResponse){this._isInSmartRace=!0;var i=e.serverResponse.then(function(e){return n._parseSPHttpClientResponse(e,t)}).then(function(e){var a=n._isEmptyResponse(e);return t.onServerResponseResolved(a),e}).catch(function(e){throw t.onServerResponseFailed(e),e}),r=T.TieredCacheHelper.processResponseRawData(e.cachedResponse,this._isRawData,this._processRawData.bind(this),t).then(function(e){var a=n._isEmptyResponse(e);return t.onCacheResponseResolved(a),e||[]}).catch(function(e){throw t.onCacheResponseFailed(e),e}),o=a.Guid.parse("9b794e3a-a041-4fb4-870d-a1121ca57ca7"),s=a.Guid.parse("4d757517-a42f-4546-a76a-8d0da7dd2a07"),c=[{raceablePromise:r,raceId:o},{raceablePromise:i,raceId:s}];return d.SmartRace.race(c).then(function(e){return e.raceId===o&&i.then(function(e){t.onServerResponseResolvedWithCache(e)}).catch(function(){}),e.raceablePromise})}},e.prototype._getNewsItemsUrl=function(e){var t=s.UriEncoding.escapeUrlForCallback(this._absoluteUrl),n="/_api/sitepages/pages/"+(e.audienceTargetingEnabled?"FeedTargeted":"feed")+"?promotedstate=2&published=true",a="&$skip="+(e.skip?e.skip.toString():"0"),i="&$top="+(e.count>0?e.count.toString():""),r="";$()&&(r="&$filter=not startswith(ContentTypeId ,'0x0101009D1CB255DA76424F860D91F20E6C4118002A50BFCFB7614729B56886FADA02339B00873E381CC9DD4F2E808A377A72C311BB')");var o="&$select=Description,BannerImageUrl,BannerThumbnailUrl,AbsoluteUrl,FirstPublished,Title,FileName,Id,UniqueId,ListId,OriginalSourceItemId,OriginalSourceUrl,Path";return B.isCallToActionEnabled()&&(o+=",CallToAction"),t+n+r+a+i+"&$expand=CreatedBy"+o},e.prototype._parseClientCachableResponse=function(e,t){var n,a=this,i=null===(n=e.serverResponse)||void 0===n?void 0:n.then(function(e){return a._parseSPHttpClientResponse(e,t)}).then(function(e){var n=a._isEmptyResponse(e);return t.onServerResponseResolved(n),e}).catch(function(e){throw t.onServerResponseFailed(e),e});return e.cachedResponse?(i&&i.then(function(e){t.onServerResponseResolvedWithCache(e)}).catch(function(){}),T.TieredCacheHelper.processResponseRawData(e.cachedResponse,this._isRawData,this._processRawData.bind(this),t).then(function(e){var n=a._isEmptyResponse(e);return t.onCacheResponseResolved(n),e||[]}).catch(function(e){throw t.onCacheResponseFailed(e),e})):i},e.prototype._shouldUseMultiSiteDataProvider=function(e){var t,n=JSON.stringify(e.filters)!==this._defaultFilter;return P.isNewsHaukAPIModelEnabled()&&P.isGetMultiSiteForThisSiteEnabled(null!==(t=e.isOneBox)&&void 0!==t&&t)&&!e.isCallToActionEnabled&&!n},e.prototype._requestMultiSiteData=function(e){var t=new Z._QosMonitor("NewsreelDataSource.requestMultiSiteData"),n={Acronym:"",Title:"",BannerColor:"",Url:this._absoluteUrl,Type:"",ItemReference:{SiteId:"".concat(this._pageContext.site.id),WebId:"".concat(this._pageContext.web.id),Type:""}};return e.siteList=[n],this._multiSiteDataProvider.requestData(e).then(function(e){return t.writeSuccess(),e}).catch(function(e){throw t.writeUnexpectedFailure("Unexpected",e),e})},e}(),we=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.title=_.w,t}return Object(J.__extends)(t,e),Object.defineProperty(t.prototype,"qosMonitorLabel",{get:function(){return"CurrentSiteNewsDataProviderVroom"},enumerable:!1,configurable:!0}),t}(xe),Ee=function(){function e(e){this.id=K,this.title="NewsDigest",this.options=e}return e.prototype.requestData=function(e){var t=this.options.newsItems||[];return Promise.resolve(t)},e}(),Ae=function(){function e(e,t,n){return a.Validate.isNotNullOrUndefined(e,"pageContext"),this._pageContext=e,this._spHttpClient=t,this._newsDigestBubbleType=n,this._absoluteUrl=this._pageContext.web.absoluteUrl,this}return Object.defineProperty(e.prototype,"_newsDigestFirstExperienceBitRestApiUrl",{get:function(){return this._absoluteUrl+"/_api/SP.Directory.DirectorySession/GetGraphUser(principalName='"+s.UriEncoding.encodeURIComponent(this._pageContext.user.loginName)+"')"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_newsDigestFirstExperienceBitRestUrl",{get:function(){return this._newsDigestFirstExperienceBitRestApiUrl+"?$select="+this._newsDigestBubbleType},enumerable:!1,configurable:!0}),e.readCachedFirstRunExperience=function(e){var t=window.localStorage.getItem(e);if(t)return"true"===t},e.prototype.writeCachedFirstRunExperience=function(t){var n=this._newsDigestBubbleType,a=window.localStorage.getItem(n),r=String(t);if(a!==r)try{window.localStorage.setItem(n,r)}catch(t){i._TraceLogger.logError(e._logSource,t)}},e.prototype.showFirstRun=function(){var t=e.readCachedFirstRunExperience(this._newsDigestBubbleType);return!0===t?(i._TraceLogger.logVerbose(e._logSource,this._newsDigestBubbleType+" is true in the local storage"),Promise.resolve(!1)):!1===t?(i._TraceLogger.logVerbose(e._logSource,this._newsDigestBubbleType+" is false in the local storage"),Promise.resolve(!0)):this.getFirstRunBitApi()},e.prototype.setFirstRunSeen=function(t){var n=this,a=new Z._QosMonitor("SetNewsDigestFirstRunExperienceAPI"),r={};r[this._newsDigestBubbleType]=Boolean(t);var o="application/json; odata=minimalmetadata",s=new Headers;return s.append("Accept","*/*, ".concat(o)),s.append("Content-Type",o),s.append("X-HTTP-Method","PATCH"),s.append("X-ClientType","NewsDigest_SetFirstRunBit"),this._spHttpClient.post(this._newsDigestFirstExperienceBitRestApiUrl,X.SPHttpClient.configurations.v1,{body:JSON.stringify(r),headers:s}).then(function(r){i._TraceLogger.logVerbose(e._logSource,"Set news digest first run bit to API: ".concat(t)),a.writeSuccess(),n.writeCachedFirstRunExperience(t)}).catch(function(t){throw i._TraceLogger.logError(e._logSource,t),a.writeUnexpectedFailure("SetNewsDigestFirstRunExperienceAPI",t),t})},e.prototype.getFirstRunBitApi=function(){var t=this,n=new Z._QosMonitor("GetNewsDigestFirstRunExperienceAPI"),a=new Headers;return a.append("X-ClientType","NewsDigest_GetFirstRunBit"),this._spHttpClient.get(this._newsDigestFirstExperienceBitRestUrl,X.SPHttpClient.configurations.v1,{headers:a}).then(function(e){return e.json()}).then(function(a){var r=a[t._newsDigestBubbleType];return i._TraceLogger.logVerbose(e._logSource,"Get news digest first run bit from API, status: ".concat(r)),n.writeSuccess(),t.writeCachedFirstRunExperience(r),!r}).catch(function(t){return i._TraceLogger.logError(e._logSource,t),n.writeUnexpectedFailure("FailedToGetNewsDigestFirstExperienceError",t),!1})},e._logSource=i._LogSource.create("NewsDigestFirstRunDataProvider"),e}(),Le=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._mapResponse=function(e){var n=B.extractNewsItemsFromSearch(e.rows,t._pageContext);return Promise.resolve(n)},t}return Object(J.__extends)(t,e),t._requestNewsData=function(e){var n="0x0101009D1CB255DA76424F860D91F20E6C4118",a=$()?"ContentTypeId:".concat(n,"* AND PromotedState:2 AND (NOT ContentTypeId:").concat("0x0101009D1CB255DA76424F860D91F20E6C4118002A50BFCFB7614729B56886FADA02339B00873E381CC9DD4F2E808A377A72C311BB","*)"):"ContentTypeId:".concat(n,"* AND PromotedState:2"),i=[];return e.uniqueIdGuids?(i.push("".concat(a," AND (")),e.uniqueIdGuids.forEach(function(e,t){0===t?i.push("UniqueID:".concat(e.toString())):i.push(" OR UniqueID:".concat(e.toString())),i.push(" OR UniqueID:{".concat(e.toString(),"}"))}),i.push(")")):i.push("{searchterms} ".concat(a)),t._request(e,i.join(""))},t._request=function(e,n){return new t({serviceScope:e.serviceScope}).requestData({searchOptions:{query:{contentLocation:e.contentLocation}},searchAPIQueryOptions:{Properties:[{Name:"EnableDynamicGroups",Value:{BoolVal:!0,QueryPropertyValueTypeIndex:3}},{Name:"EnableMultiGeoSearch",Value:{BoolVal:!0,QueryPropertyValueTypeIndex:3}}],Querytext:e.searchText||"",QueryTemplate:n,RowLimit:e.rowLimit,SelectProperties:["CreatedBy","AuthorOWSUSER","Description","PictureThumbnailURL","FirstPublishedDate","Title","FileName","ListItemId","OriginalPath","Path","SiteTitle","SPSiteURL","SPWebUrl","ViewCountLifetime","UniqueID","SiteID","WebId","ListId"],SortList:[{Property:"LastModifiedTime",Direction:T.SearchAPISortDirection.descending}],StartRow:e.startRow,TrimDuplicates:!0}})},t}(T.SearchDataProvider),ke=function(){function e(e){return this.id="myNews",this.title=_.O,P.isMyNewsHaukAPIModelEnabled()&&!e.shouldUseMicroservice?this._instance=new Me(e):this._instance=new Pe(e),this._instance}return Object.defineProperty(e.prototype,"qosMonitorLabel",{get:function(){return"MyNewsDataSource"},enumerable:!1,configurable:!0}),e.prototype.requestData=function(e){return this._instance.requestData(e)},e}(),Me=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="myNews",t.title=_.O,t.getAPIPath=function(e){var n=s.UriEncoding.escapeUrlForCallback(t._pageContext.web.absoluteUrl),a="section=SharePointNewsFeedTargeted&$expand=analytics($expand=allTime),thumbnails&$top=".concat(e.count);if(t.isPaginationRequest(e))return t.nextLink;var i=new s.Uri(s.Uri.concatenate(n,"/_api/v2.1/getNewsFeed"));return!k()&&e.languageOverride&&i.setQueryParameter("preferredLanguage",e.languageOverride),i.setQuery(a),i.toString()},t.getExtraHeaders=function(e){var t=new Map;return t.set("scenario","SPNewsWebpart"),t},t}return Object(J.__extends)(t,e),Object.defineProperty(t.prototype,"httpMethod",{get:function(){return"GET"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"qosMonitorLabel",{get:function(){return"VroomMyNewsDataSource"},enumerable:!1,configurable:!0}),t}(ge),Pe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="myNews",t.title=_.O,t.executeRequest=function(e){var n={alias:B.aliasPrefix+t.id,id:e.webpartId,expirationDuration:6e5,cacheStrategy:X._CacheStrategy.CacheAndNetwork,extraProps:new Map([[T.TieredCacheHelper.useStalePropName,!0]])};e.canCacheRequest||(n.cacheStrategy=X._CacheStrategy.NetworkOnly);var a=t._sphomeHttpClient.post(t.getMicroservicePath(e),B.getFilterQueryBody(e.filterKQLQuery),void 0,void 0,n);return B._isPPSShadowcallsKillSwitchActivated()||t._compareNewAPIs(a,e),a},t}return Object(J.__extends)(t,e),Object.defineProperty(t.prototype,"qosMonitorLabel",{get:function(){return"MyNewsDataSource"},enumerable:!1,configurable:!0}),t.prototype.getMicroservicePath=function(e){var t="start=".concat(e.skip,"&count=").concat(e.count);return t+=f(e),t+=p(e),"".concat("news/filtered","?").concat(t)},t.prototype._compareNewAPIs=function(e,t){var n=this;setTimeout(function(){if(n.canCompare){var r=e.then(function(e){if(!(e instanceof X.HttpClientResponse)&&e.serverResponse){var a=new i._QosMonitor("SPHomeQualityTest.getMyNewsProcessedResponse");return n._processHttpClientResponsePromise(e.serverResponse,t,{},a,!0)}return[]}),o=new ve("SPHomeMicroservice",a.Guid.parse("92d60991-5b57-4828-9f5f-da94e71c6257"),r),s=t;s.canCacheRequest=!1;var c=new i._QosMonitor("News.MyNewsPPS"),d=new Me(n.options).requestData(s).then(function(e){return c.writeSuccess(),e}).catch(function(e){return c.writeUnexpectedFailure("Error",e),[]});o.addApiPromise("VroomAPI",a.Guid.parse("4a609117-4832-4b81-a400-c222a06d25be"),d),o.handleRacing()}},4e3)},t}(le)},ut3N:function(e,t){e.exports=u},vlQI:function(e,t){e.exports=f},y88i:function(e,t){e.exports=p}})});