define("20745d7d-8581-4a6c-bf26-68279bc123fc_0.1.0",["tslib","@ms/sp-telemetry","@microsoft/sp-image-helper","@microsoft/sp-loader","@ms/odsp-core-bundle","@microsoft/office-ui-fabric-react-bundle","@microsoft/sp-lodash-subset","@ms/sp-dataproviders","@ms/sp-webpart-shared","@microsoft/sp-core-library","@microsoft/sp-page-context","@ms/i18n-utilities","react","react-dom","@ms/uifabric-styling-bundle","@ms/sp-component-utilities","@microsoft/load-themed-styles","@ms/sp-flex-layout","@ms/sp-deferred-component","@ms/sp-rich-image","@microsoft/sp-diagnostics","@ms/sp-carousel-layout","@ms/odsp-utilities-bundle","@ms/sp-event-data-provider"],function(n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y,S,D,I,x,C){return function(e){function t(t){for(var n,i,r=t[0],o=t[1],s=0,c=[];s<r.length;s++)i=r[s],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&c.push(a[i][0]),a[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(d&&d(t);c.length;)c.shift()()}var n={},a={1:0};function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.e=function(t){for(var n=[],o=function(e){return{0:[{i:"974a7777-0990-4136-8fa6-95d80114c2e0",v:"1.16.0",m:"br4S"},{i:"c79b9f88-6338-40fb-b463-3aad22a88b15",v:"0.1.0",m:"9poL"}]}[e]||[]}(t),s=0;s<o.length;s++)e[o[s].m]||function(t){n.push(r.SPComponentLoader.loadComponentById(t.i,t.v).then(function(n){e[t.m]=function(e){e.exports=n}}))}(o[s]);var c=a[t];if(0!==c)if(c)n.push(c[2]);else{var d=new Promise(function(e,n){c=a[t]=[e,n]});n.push(c[2]=d);var l,u=document.createElement("script");u.charset="utf-8",u.timeout=120,i.nc&&u.setAttribute("nonce",i.nc),u.src=function(e){return i.p+"chunk."+({0:"events-web-part-property-pane-configuration",2:"vendors~events-web-part-property-pane-con~579c1526"}[e]||e)+"_"+(["en-us","none"])[{"0":0,"2":1}[e]]+"_"+{0:"1d6a5f637f881ba2611d",2:"288432c4a6bb15e309c2"}[e]+".js"}(t),0!==u.src.indexOf(window.location.origin+"/")&&(u.crossOrigin="anonymous");var f=new Error;l=function(e){u.onerror=u.onload=null,clearTimeout(p);var n=a[t];if(0!==n){if(n){var i=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;f.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",f.name="ChunkLoadError",f.type=i,f.request=r,n[1](f)}a[t]=void 0}};var p=setTimeout(function(){l({type:"timeout",target:u})},12e4);u.onerror=u.onload=l,document.head.appendChild(u)}return Promise.all(n)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var r=i("I6O9");i.oe=function(e){throw console.error(e),e};var o=window.webpackJsonp_20745d7d_8581_4a6c_bf26_68279bc123fc_0_1_0=window.webpackJsonp_20745d7d_8581_4a6c_bf26_68279bc123fc_0_1_0||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var d=s;return function(){var e,t=document.getElementsByTagName("script"),n="undefined"!=typeof spScriptNamePattern?spScriptNamePattern:/sp-events-webpart_en-us_3fa45eff507c01212526\.js/i;if(t&&t.length)for(var a=0;a<t.length;a++)if(t[a]){var r=t[a].getAttribute("src");if(r&&r.match(n)){e=r.substring(0,r.lastIndexOf("/")+1);break}}if(!e)for(var o in window.__setWebpackPublicPathLoaderSrcRegistry__)if(o&&o.match(n)){e=o.substring(0,o.lastIndexOf("/")+1);break}i.p=e}(),i(i.s="vepZ")}({"/5y9":function(e,t,n){"use strict";n.d(t,"d",function(){return s}),n.d(t,"t",function(){return c}),n.d(t,"a",function(){return d}),n.d(t,"r",function(){return l}),n.d(t,"i",function(){return u}),n.d(t,"o",function(){return f}),n.d(t,"c",function(){return p}),n.d(t,"e",function(){return m}),n.d(t,"s",function(){return _}),n.d(t,"n",function(){return h});var a=n("Xmcm"),i=n("Ycni"),r=n("X+PM"),o=n("ut3N");function s(e){return e.user.preferUserTimeZone?e.user.timeZoneInfo:e.web.timeZoneInfo}function c(e,t){var n=new i.SPDate({fullYear:e.getUTCFullYear(),month:e.getUTCMonth(),date:e.getUTCDate(),hours:e.getUTCHours(),minutes:e.getUTCMinutes(),seconds:e.getUTCSeconds(),milliseconds:e.getUTCMilliseconds(),timezoneOffset:0}).convertFromUTC(s(t));return new Date(n.fullYear,n.month,n.date,n.hours,n.minutes,n.seconds,n.milliseconds)}var d=[a.t.Sunday,a.t.Monday,a.t.Tuesday,a.t.Wednesday,a.t.Thursday,a.t.Friday,a.t.Saturday];function l(e){var t=e.user.preferUserTimeZone?e.user.firstDayOfWeek:e.web.firstDayOfWeek;return void 0!==t?t:r.SPDayOfWeek.Sunday}function u(e){return e?i.LocaleFormat.formatDate(e,{skeleton:"yMMMEd"}):""}function f(e){var t=e.getFullYear().toString(),n=("00"+(e.getMonth()+1)).slice(-2),a=("00"+e.getDate()).slice(-2);return"".concat(t,"-").concat(n,"-").concat(a)}function p(e){var t=e.split("-").map(Number);return new Date(t[0],t[1]-1,t[2])}function m(e){var t=new Date(e);return t.setDate(t.getDate()+1),t.toISOString().split("T")[0]}function _(e,t){var n=function(e,t){if(0===e)throw new Error("DateRangeOption.Upcoming should not be handled in function getStartEndDate");var n,a,i,r,o,s,d,l,u=c(new Date,t);switch(e){case 1:(n=new Date(u.toISOString())).setDate(n.getDate()+b(u.getDay(),t));break;case 2:(n=new Date(u.toISOString())).setDate(n.getDate()+b(u.getDay(),t)+14);break;case 3:n=new Date(u.getFullYear(),u.getMonth()+1,0);break;case 4:i=(a=new Date(u.getFullYear(),u.getMonth(),u.getDate())).getFullYear(),r=new Date(a.getTime()),o=new Date(i,2,31),s=new Date(i,5,30),d=new Date(i,8,30),l=new Date(i,11,31),n=r<=o?o:r<=s?s:r<=d?d:l;break;default:throw new Error("Unexpected date range option: ".concat(e))}return[u,n]}(e,t),a=n[0],i=n[1];return[f(a),f(i)]}function h(e,t){if(/^\d{4}-\d{2}-\d{2}$/.test(e)){var n=e.split("-").map(Number),a=new i.SPDate({fullYear:n[0],month:n[1]-1,date:n[2],hours:0,minutes:0,seconds:0,milliseconds:0}).convertToUTC(t);return new Date(Date.UTC(a.fullYear,a.month,a.date,a.hours,a.minutes,a.seconds)).toISOString()}var r=o._LogSource.create("EventsWebPartUtilities");return o._TraceLogger.logError(r,new Error("date string ".concat(e," is not valid"))),e}function b(e,t){var n=l(t)-e;return(n>0?n:n+7)-1}},"17wl":function(e,t){e.exports=n},"2q6Q":function(e,t){e.exports=a},"8dK2":function(e,t){e.exports=i},I6O9:function(e,t){e.exports=r},K9kD:function(e,t){e.exports=o},KL1q:function(e,t){e.exports=s},KpAv:function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"m",function(){return o}),n.d(t,"u",function(){return s}),n.d(t,"d",function(){return c}),n.d(t,"f",function(){return d}),n.d(t,"l",function(){return l}),n.d(t,"t",function(){return u}),n.d(t,"i",function(){return f}),n.d(t,"r",function(){return p}),n.d(t,"o",function(){return m}),n.d(t,"c",function(){return _}),n.d(t,"a",function(){return h}),n.d(t,"p",function(){return b}),n.d(t,"n",function(){return g}),n.d(t,"s",function(){return v});var a=n("UWqr"),i=n("hiL/"),r=new i.KillSwitch("0b08e573-a70b-428a-83d4-4e89d97c2f80"),o=new i.KillSwitch("51098fdf-82bc-429b-8194-ee94d46b56cf");function s(){return a._SPKillSwitch.isActivated("4c2161e1-109f-419b-9691-9beb86cdab72")}function c(){return a._SPKillSwitch.isActivated("522e33a7-536f-4004-bf63-0842b7d39d7e")}function d(){return a._SPKillSwitch.isActivated("b39526c6-c60d-428b-9db2-d0cc6b724734")}function l(){return a._SPKillSwitch.isActivated("8d286442-38bb-4d27-8963-b4ebe867371e")}function u(){return a._SPKillSwitch.isActivated("5e1041d5-22a2-4952-b981-e0d787fffe44")}function f(){return a._SPKillSwitch.isActivated("2fba3a67-5ac3-4621-b436-78df947a4934")}function p(){return a._SPKillSwitch.isActivated("98c450ad-08ed-486b-b898-ee6548b775f7")}function m(){return a._SPKillSwitch.isActivated("ec902ef7-f0fc-4ca2-b0aa-a0e7e2c43c50")}function _(){return a._SPKillSwitch.isActivated("8400a555-1cb8-4863-adbc-4a6f01dc7d8b")}function h(){return a._SPKillSwitch.isActivated("6e3f649d-bfa5-473d-ab88-20cb6a57d3bd")}function b(){return a._SPKillSwitch.isActivated("e7a8878e-98e5-447b-b462-bcbb1df03ac8")}function g(){return a._SPKillSwitch.isActivated("cadf6edb-12b4-4ae5-b77e-d963a8643610")}function v(){return a._SPKillSwitch.isActivated("4b2b1929-6cbb-49a1-a58f-7b4a2a538577")}},OaQ3:function(e,t,n){"use strict";var a=n("fglE");n.o(a,"concatStyleSets")&&n.d(t,"concatStyleSets",function(){return a.concatStyleSets})},PMge:function(e){e.exports=JSON.parse('{"t":"Add event","o":"Tuesday 12:00 AM - 1:00 PM","p":"{0} {1} Event {2}. {3} {4} {5} {6}","r":"{0} Event {1}. {2}","c":"{0} {1} {2}","e":"Use up or down arrow keys to navigate inside the item.","u":"Starts on {0}","l":"at {0}.","d":"Link of","n":"Press enter to download the calendar file to your device.","a":"Add to my calendar","m":"; ","f":"This event is from the web site {0}.","i":"This event is targeted to specific audiences.","s":"Month"}')},Pk8u:function(e,t){e.exports=c},QW9R:function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o}),n.d(t,"n",function(){return s}),n.d(t,"a",function(){return c});var a=n("2q6Q"),i=n("UWqr");function r(){return i._SPFlight.isEnabled(60218)||1===a._SPPerfExperiment.getVariantAndTrackExperiment(a._PerformanceExperiment.SOXEventUpdate)}function o(){return i._SPFlight.isEnabled(60278)}function s(){return i._SPFlight.isEnabled(60402)||1===a._SPPerfExperiment.getVariantAndTrackExperiment(a._PerformanceExperiment.WEXMySiteCacheTCExpEvents)}function c(){return i._SPFlight.isEnabled(60668)}},QZHX:function(e,t){e.exports=d},U4ag:function(e,t){e.exports=l},UWqr:function(e,t){e.exports=u},"X+PM":function(e,t){e.exports=f},Xmcm:function(e,t,n){"use strict";var a,i,r,o;n.d(t,"t",function(){return a}),n.d(t,"a",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"e",function(){return o}),function(e){e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday"}(a||(a={})),function(e){e[e.January=0]="January",e[e.February=1]="February",e[e.March=2]="March",e[e.April=3]="April",e[e.May=4]="May",e[e.June=5]="June",e[e.July=6]="July",e[e.August=7]="August",e[e.September=8]="September",e[e.October=9]="October",e[e.November=10]="November",e[e.December=11]="December"}(i||(i={})),function(e){e[e.FirstDay=0]="FirstDay",e[e.FirstFullWeek=1]="FirstFullWeek",e[e.FirstFourDayWeek=2]="FirstFourDayWeek"}(r||(r={})),function(e){e[e.Day=0]="Day",e[e.Week=1]="Week",e[e.Month=2]="Month",e[e.WorkWeek=3]="WorkWeek"}(o||(o={}))},Ycni:function(e,t){e.exports=p},cDcd:function(e,t){e.exports=m},dEWz:function(e,t,n){var a=n("fglE");e.exports=a._Utilities},faye:function(e,t){e.exports=_},fglE:function(e,t){e.exports=h},"hiL/":function(e,t){e.exports=b},jOlS:function(e,t){e.exports=g},jqkI:function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"t",function(){return s});var a=n("17wl"),i=n("I6O9"),r=n("qjmy"),o=function(){function e(){}return e.loadModule=function(){return e._loadedModulePromise||(e._loadedModulePromise=i.SPComponentLoader.loadComponentById("7ad20b0d-6a5d-43c3-a111-8c7f425b6bf2")),e._loadedModulePromise},e}(),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype._internalLoad=function(){return o.loadModule().then(function(e){return e.SitesPickerLoader.load()})},t}(r._DeferredComponent)},mGD9:function(e){e.exports=JSON.parse('{"r":"Create an event","i":"When you add an event, it will show here where your readers can see it.","o":"Category","c":"Title of event","s":"Location","O":"No upcoming events","w":"No events","C":"No upcoming events are scheduled. Check back again later.","x":"There are no events for the selected date range and/or category.","t":"Add event","u":"There are no events lists on the site, or you don\\u0027t have access to an events list. Contact your site administrator.","d":"{0}, {1}","n":"All day","I":"There may be too many sites selected or too many filters added. Try Selecting fewer sites or remove some filters to continue.","e":"Add an event","P":"See all events from selected events list.","k":"See all events from this site.","M":"See all events from this site collection.","A":"See all events from all sites.","L":"See all events from all sites in the hub.","T":"See all events from selected sites.","l":"Events web part","m":"Events list. Use right and left arrow keys to move between events.","_":"Events list. Use right and left arrow keys to move between events. Press enter to go to the details page for a selected event.","h":"Events list. Use up and down arrow keys to move between events.","b":"Events list. Use up and down arrow keys to move between events. Press enter to go to the details page for a selected event.","D":"Events list. Use left and right arrow keys to move between events. Press enter to go to the details page for a selected event.","f":"Events list in carousel layout film strip mode. Press enter to navigate inside carousel items. Use left and right arrow keys to move between events in the carousel.","p":"{0} Press enter to go to the details page for a selected event.","v":"Filmstrip","g":"Compact","E":"Note: Compact layout is always used in 1/3 column.","a":"Content is updated.","y":"{0} events are showing||{0} event is showing||{0} events are showing","S":"0||1||2-"}')},phXu:function(e,t){e.exports=v},qjmy:function(e,t){e.exports=y},tGpx:function(e,t){e.exports=S},ut3N:function(e,t){e.exports=D},vepZ:function(e,t,n){"use strict";n.r(t);var a,i=n("17wl"),r=n("cDcd"),o=n("KL1q"),s=n("ut3N"),c=n("Pk8u"),d=n("X+PM"),l=n("hiL/"),u=n("QZHX"),f=n("zY5M"),p=n("U4ag"),m=n("w0FV"),_=n("phXu"),h=n("UWqr"),b=n("2q6Q"),g=n("Ycni"),v=n("y88i"),y=n("/5y9"),S=n("KpAv"),D=function(){function e(){}return Object.defineProperty(e,"dataVersion",{get:function(){return h.Version.parse("1.4")},enumerable:!1,configurable:!0}),e.upgrade=function(t,n){return n&&!n.lessThan(h.Version.parse("1.1"))||e.updargdeToDataVersion1_1(t),n&&!n.lessThan(h.Version.parse("1.2"))||e.updargdeToDataVersion1_2(t),n&&!n.lessThan(h.Version.parse("1.3"))||e.updargdeToDataVersion1_3(t),n&&!n.lessThan(h.Version.parse("1.4"))||e.updargdeToDataVersion1_4(t),t},e.updargdeToDataVersion1_1=function(e){e.layout||(e.layout="Filmstrip")},e.updargdeToDataVersion1_2=function(e){e.dataSource||(e.dataSource=u.ContentLocation.CurrentSiteEventsList),e.sites||(e.sites=[]),e.maxItemsPerPage||(e.maxItemsPerPage=20)},e.updargdeToDataVersion1_3=function(e){e.audienceTarget||(e.audienceTarget=!1)},e.updargdeToDataVersion1_4=function(e){e.showImage||(e.showImage=!0)},e}(),I=r.createElement("svg",null,r.createElement("g",null,r.createElement("path",{className:"themeableSvgPath",d:"M0,0v14h32V0H0z M2,2h9v10H2V2z M30,12H13V2h17V12z"}),r.createElement("path",{className:"themeableSvgPath",d:"M0,0v14h32V0H0z M2,2h9v10H2V2z M30,12H13V2h17V12z"}),r.createElement("path",{className:"themeableSvgPath",d:"M0,0v14h32V0H0z M2,2h9v10H2V2z M30,12H13V2h17V12z"})),r.createElement("g",null,r.createElement("path",{className:"themeableSvgPath",d:"M0,32h32V18H0V32z M30,30H13V20h17V30z M2,20h9v10H2V20z"}),r.createElement("path",{className:"themeableSvgPath",d:"M0,32h32V18H0V32z M30,30H13V20h17V30z M2,20h9v10H2V20z"}),r.createElement("path",{className:"themeableSvgPath",d:"M0,32h32V18H0V32z M30,30H13V20h17V30z M2,20h9v10H2V20z"}))),x=r.createElement("svg",null,r.createElement("path",{className:"themeableSvgPath",d:"M10,0v28h12V0H10z M20,26h-8V2h8V26z"}),r.createElement("polygon",{className:"themeableSvgPath",points:"0,2 5,2 5,26 0,26 0,28 7,28 7,0 0,0 "}),r.createElement("rect",{x:"9",y:"30",className:"themeableSvgPath",width:"2",height:"2"}),r.createElement("rect",{x:"15",y:"30",className:"themeableSvgPath",width:"2",height:"2"}),r.createElement("polygon",{className:"themeableSvgPath",points:"32,2 32,0 25,0 25,28 32,28 32,26 27,26 27,2 "}),r.createElement("rect",{x:"21",y:"30",className:"themeableSvgPath",width:"2",height:"2"}));!function(e){e[e.normal=0]="normal",e[e.compact=1]="compact"}(a||(a={}));var C=Object(o.classNamesFunction)(),O=function(e){function t(t){var n=e.call(this,t)||this;return n._rootElement=r.createRef(),n._onClick=function(e){n._onAction(e)},n._onKeyDown=function(e){e.which!==o.KeyCodes.enter&&e.which!==o.KeyCodes.space||n._onAction(e)},n._onAction=function(e){var t=n.props,a=t.onClick,i=t.onClickHref,r=t.onClickTarget;a?a(e):!a&&i&&(r?window.open(i,r,"noreferrer noopener nofollow"):window.location.href=i,e.preventDefault(),e.stopPropagation())},Object(o.initializeComponentRef)(n),Object(o.warnDeprecations)("DocumentCard",t,{accentColor:void 0}),n}return Object(i.__extends)(t,e),t.prototype.render=function(){var e,t=this.props,n=t.onClick,s=t.onClickHref,c=t.children,d=t.type,l=t.accentColor,u=t.styles,f=t.theme,p=t.className,m=Object(o.getNativeProps)(this.props,o.divProperties,["className","onClick","type","role"]),_=!(!n&&!s);this._classNames=C(u,{theme:f,className:p,actionable:_,compact:d===a.compact}),d===a.compact&&l&&(e={borderBottomColor:l});var h=this.props.role||(_?n?"button":"link":void 0),b=_?0:void 0;return r.createElement("div",Object(i.__assign)({ref:this._rootElement,tabIndex:b,"data-is-focusable":_,role:h,className:this._classNames.root,onKeyDown:_?this._onKeyDown:void 0,onClick:_?this._onClick:void 0,style:e},m),c)},t.prototype.focus=function(){this._rootElement.current&&this._rootElement.current.focus()},t.defaultProps={type:a.normal},t}(r.Component),w={root:"ms-DocumentCard",rootActionable:"ms-DocumentCard--actionable",rootCompact:"ms-DocumentCard--compact"},E=Object(o.styled)(O,function(e){var t,n,a=e.className,i=e.theme,r=e.actionable,s=e.compact,c=i.palette,d=i.fonts,l=i.effects,u=Object(o.getGlobalClassNames)(w,i);return{root:[u.root,{WebkitFontSmoothing:"antialiased",backgroundColor:c.white,border:"1px solid "+c.neutralLight,maxWidth:"320px",minWidth:"206px",userSelect:"none",position:"relative",selectors:(t={":focus":{outline:"0px solid"}},t["."+o.IsFocusVisibleClassName+" &:focus"]=Object(o.getInputFocusStyle)(c.neutralSecondary,l.roundedCorner2),t[".ms-DocumentCardLocation + .ms-DocumentCardTitle"]={paddingTop:"4px"},t)},r&&[u.rootActionable,{selectors:{":hover":{cursor:"pointer",borderColor:c.neutralTertiaryAlt},":hover:after":{content:'" "',position:"absolute",top:0,right:0,bottom:0,left:0,border:"1px solid "+c.neutralTertiaryAlt,pointerEvents:"none"}}}],s&&[u.rootCompact,{display:"flex",maxWidth:"480px",height:"108px",selectors:(n={},n[".ms-DocumentCardPreview"]={borderRight:"1px solid "+c.neutralLight,borderBottom:0,maxHeight:"106px",maxWidth:"144px"},n[".ms-DocumentCardPreview-icon"]={maxHeight:"32px",maxWidth:"32px"},n[".ms-DocumentCardActivity"]={paddingBottom:"12px"},n[".ms-DocumentCardTitle"]={paddingBottom:"12px 16px 8px 16px",fontSize:d.mediumPlus.fontSize,lineHeight:"16px"},n)}],a]}},void 0,{scope:"DocumentCard"}),A=Object(o.classNamesFunction)(),L=function(e){var t=e.root,n=e.isCompactCard,a=e.variantTheme,r=Object(o.getTheme)(),s=!r.isInverted&&a.isInverted||r.isInverted&&!a.isInverted,c=s?r.semanticColors.primaryButtonBackgroundHovered:r.semanticColors.primaryButtonBackground,d=s?r.semanticColors.primaryButtonTextHovered:r.semanticColors.primaryButtonText;return{root:[t,{borderColor:"transparent",marginBottom:n?void 0:"10px",selectors:{"&:focus":{borderColor:a.semanticColors.focusBorder}}}],normalCard:["normalCard",{backgroundColor:r.semanticColors.bodyBackground,borderColor:a.semanticColors.variantBorder+" !important",borderRadius:r.effects.roundedCorner2,boxShadow:r.effects.elevation4,selectors:{"&:hover":{boxShadow:r.effects.elevation8},".ms-DocumentCard--actionable&:hover":{borderColor:void 0},".ms-DocumentCard--actionable&:hover:after":{content:"none"},"& .box":{borderColor:void 0}}}],compactCard:["compactCard",{backgroundColor:"transparent !important",color:a.semanticColors.bodyText,selectors:Object(i.__assign)({"& .box":{backgroundColor:r.semanticColors.bodyBackground,borderColor:void 0},"& .title":{color:a.semanticColors.bodyText},"& .datetime":{color:a.semanticColors.bodySubtext},"& .emptyStateDescription ":{color:a.semanticColors.bodySubtext},"&:focus":{borderColor:a.semanticColors.focusBorder}},{"&:hover:after":{content:"none !important"}})}],dateBox:["box"],emptyStatePreviewContainer:["emptyStatePreviewContainer",{backgroundColor:c}],emptyStatePreview:["emptyStatePreview",{color:d}],emptyStateDescription:["emptyStateDescription",{color:r.semanticColors.bodySubtext}],addEventLabel:["addEventLabel",{color:r.semanticColors.primaryButtonText}],icon:["icon",Object(i.__assign)({color:r.semanticColors.primaryButtonText},r.fonts.mediumPlus)],category:["category",Object(i.__assign)({color:r.semanticColors.bodySubtext},r.fonts.small)],location:["location",Object(i.__assign)({color:r.semanticColors.bodySubtext},r.fonts.small)],datetime:["datetime",Object(i.__assign)(Object(i.__assign)({color:r.semanticColors.bodyText},r.fonts.small),{fontWeight:"600"})],title:["title",Object(i.__assign)(Object(i.__assign)({color:r.semanticColors.bodyText},r.fonts.mediumPlus),{fontWeight:"600"})],separator:["separator",{backgroundColor:r.semanticColors.variantBorder,height:1,border:0}],addToMyCalendar:["addToMyCalendar",{borderColor:"transparent",selectors:{"& .ms-Button-label":{color:r.semanticColors.actionLink},"&:hover .ms-Button-label, &:focus .ms-Button-label, &:active .ms-Button-label":{color:r.semanticColors.actionLinkHovered+" !important"},"& .ms-Button-icon":{color:r.semanticColors.link},"&:hover .ms-Button-icon, &:focus .ms-Button-icon, &:active .ms-Button-icon":{color:r.semanticColors.linkHovered+" !important"}}}],webLink:Object(i.__assign)(Object(i.__assign)({color:r.semanticColors.link},r.fonts.small),{textDecoration:"none !important",selectors:{"&:hover":{color:r.semanticColors.linkHovered}}})}},k=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t.prototype.getStyles=function(e){return L(e)},t}(p.BaseEmphasisComponentStyles),M=k,P=n("PMge");function T(e){var t="audienceTargetedIcon-".concat(Math.random().toString().substr(2,6));return r.createElement(o.TooltipHost,{styles:{root:[e.className,{height:16}]},content:P.i,calloutProps:{gapSpace:0,target:"#".concat(t)}},r.createElement(o.Icon,{id:t,iconName:"People",styles:{root:{width:16,height:16}},"aria-label":P.i,"data-is-focusable":!0,"data-automation-id":"eventTargetedIcon"}))}var U=n("jOlS");U.loadStyles('.b_b_ce1e465e{border-width:1px;border-style:solid;box-sizing:border-box}.b_b_ce1e465e .ms-DocumentCard::-moz-focus-inner{border:0}.b_b_ce1e465e .ms-DocumentCard{outline:transparent;position:relative}.b_b_ce1e465e.ms-Fabric.is-focusVisible .ms-DocumentCard:focus:after,.ms-Fabric.is-focusVisible .b_b_ce1e465e .ms-DocumentCard:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;border:1px solid "[theme:neutralsecondary, default: #605e5c]";border-radius:inherit;pointer-events:none}.b_b_ce1e465e .c_b_ce1e465e{display:flex;align-items:center;padding:2px;border:none;height:68px}.b_b_ce1e465e.e_b_ce1e465e{outline:transparent}.f_b_ce1e465e,.g_b_ce1e465e{display:flex;flex-direction:column;justify-content:center;align-items:center}.f_b_ce1e465e{font-weight:400}.f_b_ce1e465e [data-icon-name=Event]{display:block}.h_b_ce1e465e{font-size:12px;font-weight:400}.i_b_ce1e465e .j_b_ce1e465e{display:flex;flex-direction:column;justify-content:center;align-items:center}.i_b_ce1e465e .f_b_ce1e465e{font-size:42px;font-weight:100}.i_b_ce1e465e .f_b_ce1e465e.k_b_ce1e465e{font-size:48px}.i_b_ce1e465e .l_b_ce1e465e{font-size:15px;font-weight:400;margin:auto 0;line-height:40px;vertical-align:middle}.i_b_ce1e465e .l_b_ce1e465e .m_b_ce1e465e{vertical-align:top;margin:0 4px}.i_b_ce1e465e .l_b_ce1e465e .n_b_ce1e465e{margin:0 4px}.i_b_ce1e465e .l_b_ce1e465e .n_b_ce1e465e:not(.o_b_ce1e465e){font-size:16px}.i_b_ce1e465e .p_b_ce1e465e,[dir=rtl] .i_b_ce1e465e .p_b_ce1e465e{padding:0 16px 16px}.i_b_ce1e465e .p_b_ce1e465e.o_b_ce1e465e{height:156px}.i_b_ce1e465e .p_b_ce1e465e:not(.o_b_ce1e465e){height:172px}.i_b_ce1e465e .q_b_ce1e465e{margin-bottom:4px}.i_b_ce1e465e .r_b_ce1e465e{margin-bottom:20px;height:44px;line-height:22px}.i_b_ce1e465e .r_b_ce1e465e.s_b_ce1e465e{height:22px}.i_b_ce1e465e .r_b_ce1e465e:not(.o_b_ce1e465e){font-size:17px;font-weight:300}.i_b_ce1e465e .t_b_ce1e465e{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;word-wrap:normal;display:block;height:22px}.i_b_ce1e465e .t_b_ce1e465e:not(.o_b_ce1e465e){font-size:12px;font-weight:400}.i_b_ce1e465e .t_b_ce1e465e.o_b_ce1e465e{font-weight:600}.u_b_ce1e465e{position:absolute}[dir=rtl] .u_b_ce1e465e{left:0}[dir=ltr] .u_b_ce1e465e{right:0}.u_b_ce1e465e.v_b_ce1e465e{margin:8px 9px 0 8px}.c_b_ce1e465e .w_b_ce1e465e{margin:auto 14px auto 0;min-width:64px}[dir=rtl] .c_b_ce1e465e .w_b_ce1e465e{margin:auto 0 auto 14px}[dir=ltr] .c_b_ce1e465e .g_b_ce1e465e{margin-right:14px}[dir=rtl] .c_b_ce1e465e .g_b_ce1e465e{margin-left:14px}.c_b_ce1e465e .x_b_ce1e465e{min-width:0}.c_b_ce1e465e .f_b_ce1e465e{font-size:28px;font-weight:100;min-width:66px;height:64px}.c_b_ce1e465e .r_b_ce1e465e{margin:0 0 3px;max-height:38px;line-height:19px}.c_b_ce1e465e .r_b_ce1e465e:not(.o_b_ce1e465e){font-size:15px;font-weight:400}.q_b_ce1e465e,.y_b_ce1e465e,.z_b_ce1e465e{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;word-wrap:normal;height:18px}.q_b_ce1e465e:not(.o_b_ce1e465e),.y_b_ce1e465e:not(.o_b_ce1e465e),.z_b_ce1e465e:not(.o_b_ce1e465e){font-size:12px;font-weight:400}.r_b_ce1e465e{display:block;overflow:hidden;word-wrap:break-word;word-break:break-word}.r_b_ce1e465e.o_b_ce1e465e{font-size:"[theme:mediumFontSize, default: 14px]";font-weight:"[theme:mediumFontWeight, default: 400]";font-weight:600}.r_b_ce1e465e:not(.o_b_ce1e465e){font-weight:400}.aa_b_ce1e465e{margin:15px -16px 0}.ab_b_ce1e465e{font-size:14px;font-weight:400}[dir=ltr] .ab_b_ce1e465e{margin-left:-8px}[dir=rtl] .ab_b_ce1e465e{margin-right:-8px}.ab_b_ce1e465e.o_b_ce1e465e{height:36px}.ab_b_ce1e465e:not(.o_b_ce1e465e){margin-top:10px}',!0);var F="f_b_ce1e465e",H="g_b_ce1e465e",R="h_b_ce1e465e",N="o_b_ce1e465e",B="p_b_ce1e465e",j="q_b_ce1e465e",V="u_b_ce1e465e",z="w_b_ce1e465e",G="x_b_ce1e465e",K="y_b_ce1e465e",W=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._focusZoneRef=r.createRef(),t._eventCardStyles=new M,t._handleKeyDown=function(e){var n;t.props.isCompactCard||e.which!==o.KeyCodes.up&&e.which!==o.KeyCodes.down||(null===(n=t._focusZoneRef.current)||void 0===n||n.focus(),e.preventDefault(),e.stopPropagation())},t._handleClickWrapper=function(e){t.props.onClick&&t.props.onClick(e)},t._logClickWebLink=function(){b._EngagementLogger.logEvent("EventCard.WebLink.Click")},t}return Object(i.__extends)(t,e),Object.defineProperty(t.prototype,"_deprecatedClassNames",{get:function(){return A(L,{root:"cardWrapper",isCompactCard:Boolean(this.props.isCompactCard),variantTheme:this.props.theme})},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e;this._updateClassNames(),this._isEmptyStateCard=!!this.props.getEmptyStateOptions;var t={className:Object(o.css)(this._deprecatedClassNames.root,"b_b_ce1e465e",(e={},e.c_b_ce1e465e=this.props.isCompactCard,e[this._deprecatedClassNames.compactCard]=this.props.isCompactCard,e.e_b_ce1e465e=!Object(S.f)(),e)),style:{width:this.props.width},role:S.m.isActivated()?"listitem":void 0,"data-is-focusable":!this.props.isPlaceholderCard,"data-is-focus-item":!0,"data-sp-a11y-skipkeys":o.KeyCodes.enter,onKeyDown:this._handleKeyDown,onClick:this._handleClickWrapper};return r.createElement("div",Object(i.__assign)({},t),this.props.isCompactCard?this._renderCompactCard():this._renderNormalCard())},t.prototype._renderNormalCard=function(){return r.createElement(E,{"aria-label":this._getAriaLabel(),className:Object(o.css)(this._deprecatedClassNames.normalCard,"i_b_ce1e465e"),onClick:this.props.onClick,onClickHref:this.props.detailsLink,"data-automation-id":"event-card","data-is-focusable":!1},r.createElement(o.FocusZone,{direction:o.FocusZoneDirection.vertical,isCircularNavigation:!0,componentRef:this._focusZoneRef},this._normalCardPreview,this._normalCardDetails))},t.prototype._renderCompactCard=function(){return r.createElement(E,{"aria-label":this._getAriaLabel(),className:Object(o.css)(this._deprecatedClassNames.compactCard,"c_b_ce1e465e"),onClick:this.props.onClick,onClickHref:this.props.detailsLink,type:a.compact,"data-automation-id":"compact-card","data-is-focusable":!1},this._compactCardPreview,this._compactCardDetails)},Object.defineProperty(t.prototype,"_normalCardPreview",{get:function(){var e,t,n={height:Math.floor(this.props.width/16*9)},a=Object(o.css)(this._deprecatedClassNames.emptyStatePreviewContainer,H);return this._isEmptyStateCard?r.createElement("div",{className:a,style:n,"data-automation-id":"empty-state-preview"},r.createElement("div",{className:Object(o.css)(this._deprecatedClassNames.emptyStatePreview,F,Object(S.d)()?{}:"k_b_ce1e465e")},r.createElement(o.Icon,{iconName:"Event","aria-hidden":"true"}),Object(S.d)()&&(null===(t=(e=this.props).getEmptyStateOptions)||void 0===t?void 0:t.call(e).isCreateEventCard)&&r.createElement("div",{className:Object(o.css)(this._deprecatedClassNames.addEventLabel,"l_b_ce1e465e")},r.createElement(o.Icon,{iconName:"Add",className:Object(o.css)(this._deprecatedClassNames.icon,"n_b_ce1e465e",N)}),r.createElement("span",{className:"m_b_ce1e465e"},P.t)))):r.createElement("div",{className:"j_b_ce1e465e",style:n,"data-automation-id":"normal-card-preview"},r.createElement(p.DateBox,{startDate:this.props.startDate,endDate:this.props.endDate,size:p.DateBoxSize.Medium,className:Object(o.css)(this._deprecatedClassNames.dateBox,z)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_normalCardDetails",{get:function(){var e,t,n=this.props.getAddToCalendarButtonProps?this.props.getAddToCalendarButtonProps():void 0,a=this.props.startDate||this.props.endDate,s=a?this.props.formatDate(a):P.o,c=Object(o.css)(this._deprecatedClassNames.emptyStateDescription,R);return this._isEmptyStateCard?r.createElement("div",{className:Object(o.css)(B,N)},r.createElement("div",{className:Object(o.css)(this._deprecatedClassNames.category,j,N)}),this._eventTitle,r.createElement("div",{className:c},(null===(t=(e=this.props).getEmptyStateOptions)||void 0===t?void 0:t.call(e).description)||"")):r.createElement("div",{className:Object(o.css)(B,N)},r.createElement("div",{className:Object(o.css)(this._deprecatedClassNames.category,j,N)},this._displayCategory(this.props.category)),this._webLink,this._eventTitle,r.createElement("div",{className:Object(o.css)(this._deprecatedClassNames.datetime,K,N)},s),r.createElement("div",{className:Object(o.css)(this._deprecatedClassNames.location,"z_b_ce1e465e",N)},this.props.location),r.createElement("hr",{className:Object(o.css)(this._deprecatedClassNames.separator,"aa_b_ce1e465e")}),r.createElement(r.Fragment,null,n&&r.createElement(o.ActionButton,Object(i.__assign)({iconProps:{iconName:"AddEvent"},className:Object(o.css)(this._deprecatedClassNames.addToMyCalendar,"ab_b_ce1e465e",N),ariaDescription:P.n},!Object(S.t)()&&{title:P.a},n)),this.props.showAudiencesIcon&&r.createElement(T,{className:Object(o.css)(V,"v_b_ce1e465e")})))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_compactCardPreview",{get:function(){var e=Object(o.css)(this._deprecatedClassNames.emptyStatePreviewContainer,H);return this._isEmptyStateCard?r.createElement("div",{className:e,"data-automation-id":"empty-state-preview"},r.createElement("div",{className:Object(o.css)(this._deprecatedClassNames.emptyStatePreview,F)},r.createElement(o.Icon,{iconName:"Event","aria-hidden":"true"}))):r.createElement("div",{"data-automation-id":"normal-card-preview"},r.createElement(p.DateBox,{startDate:this.props.startDate,endDate:this.props.endDate,size:p.DateBoxSize.Small,className:Object(o.css)(this._deprecatedClassNames.dateBox,z)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_compactCardDetails",{get:function(){var e,t,n=this.props.startDate||this.props.endDate,a=n?this.props.formatDate(n):P.o,i=Object(o.css)(this._deprecatedClassNames.emptyStateDescription,R);return this._isEmptyStateCard?r.createElement("div",{className:G},this._eventTitle,r.createElement("div",{className:i},(null===(t=(e=this.props).getEmptyStateOptions)||void 0===t?void 0:t.call(e).description)||"")):r.createElement("div",{className:G},this._eventTitle,r.createElement("div",{className:Object(o.css)(this._deprecatedClassNames.datetime,K,N)},a,this.props.showAudiencesIcon&&r.createElement(T,{className:V})))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_eventTitle",{get:function(){var e,t,n=Object(o.css)(this._deprecatedClassNames.title,"r_b_ce1e465e",N,this.props.showWebLink&&"s_b_ce1e465e");return r.createElement("div",{"data-automation-id":"event-card-title",className:n},this._isEmptyStateCard?(null===(t=(e=this.props).getEmptyStateOptions)||void 0===t?void 0:t.call(e).title)||"":this.props.title)},enumerable:!1,configurable:!0}),t.prototype._getAriaLabel=function(){var e,t;if(this.props.ariaLabel)return this.props.ariaLabel;var n=null===(t=(e=this.props).getEmptyStateOptions)||void 0===t?void 0:t.call(e);if(this._isEmptyStateCard){var a=(null==n?void 0:n.title)||"",i=(null==n?void 0:n.description)||"";return v.StringHelper.format(P.c,a,i,"")}return this.props.isCompactCard?v.StringHelper.format(P.r,this.props.detailsLink?P.d:"",this.props.title,this.props.startDate?v.StringHelper.format(P.u,this.props.formatDate(this.props.startDate)):""):v.StringHelper.format(P.p,this.props.detailsLink?P.d:"",this.props.category||"",this.props.title,this.props.startDate?v.StringHelper.format(P.u,this.props.formatDate(this.props.startDate)):"",this.props.location?v.StringHelper.format(P.l,this.props.location):".",this.props.showWebLink&&this.props.webName?v.StringHelper.format(P.f,this.props.webName):"",this.props.getAddToCalendarButtonProps?P.e:"")},t.prototype._displayCategory=function(e){var t=typeof e;return"string"===t?e:e&&"object"===t?e.join(P.m):void 0},Object.defineProperty(t.prototype,"_webLink",{get:function(){if(this.props.showWebLink&&this.props.webName)return r.createElement(o.Link,{className:Object(o.css)("t_b_ce1e465e",this._deprecatedClassNames.webLink,N),href:this.props.webUrl,onClick:this._logClickWebLink},this.props.webName)},enumerable:!1,configurable:!0}),t.prototype._updateClassNames=function(){return this._eventCardStyles.getClassNames({root:"cardWrapper",isCompactCard:Boolean(this.props.isCompactCard),variantTheme:this.props.theme})},t.defaultProps={id:"",listId:"",title:"",category:"",location:"",detailsLink:void 0,ariaLabel:"",onClick:void 0,isCompactCard:!1,showWebLink:!1,webName:void 0,webUrl:"",bannerUrl:"",showImage:!1,getEmptyStateOptions:void 0,getAddToCalendarButtonProps:void 0,formatDate:function(e){return g.LocaleFormat.formatDate(e,{skeleton:"MMMEdhm"})},formatMonth:function(e){return g.LocaleFormat.formatDate(e,{skeleton:"MMM"}).toUpperCase()},formatDay:function(e){return g.LocaleFormat.formatDate(e,{skeleton:"d"})}},t}(r.PureComponent),q=Object(o.customizable)("EventCard",["theme"])(W),Q=n("faye"),Y=Object(o.createComponent)(function(e){if(0===r.Children.count(e.children))return null;e.block,e.className;var t=e.as,n=void 0===t?"span":t,a=(e.variant,e.nowrap,Object(i.__rest)(e,["block","className","as","variant","nowrap"])),s=Object(o.getSlots)(e,{root:n});return Object(o.withSlots)(s.root,Object(i.__assign)({},Object(o.getNativeProps)(a,o.htmlElementProperties)))},{displayName:"Text",styles:function(e,t){var n=e.as,a=e.className,i=e.block,r=e.nowrap,o=e.variant,s=t.fonts[o||"medium"];return{root:[t.fonts.medium,{display:i?"td"===n?"table-cell":"block":"inline",fontFamily:s.fontFamily,fontSize:s.fontSize,fontWeight:s.fontWeight,color:s.color,mozOsxFontSmoothing:s.MozOsxFontSmoothing,webkitFontSmoothing:s.WebkitFontSmoothing},r&&{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},a]}}}),J=n("8dK2"),X=n("tGpx"),Z=n("OaQ3"),$=n("dEWz"),ee=n("fglE"),te=i.__assign;function ne(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];var o=e;return o.isSlot?0===(n=r.Children.toArray(n)).length?o(t):o(Object(i.__assign)(Object(i.__assign)({},t),{children:n})):r.createElement.apply(r,Object(i.__spreadArrays)([e,t],n))}function ae(e,t){void 0===t&&(t={});var n=t.defaultProp,a=void 0===n?"children":n;return function(t,n,o,s,c){if(r.isValidElement(n))return n;var d=function(e,t){var n,a;return"string"==typeof t||"number"==typeof t||"boolean"==typeof t?((n={})[e]=t,a=n):a=t,a}(a,n),l=function(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];for(var i={},r=[],o=0,s=n;o<s.length;o++){var c=s[o];r.push(c&&c.className),te(i,c)}return i.className=Object(ee.mergeCss)([e,r],{rtl:Object($.getRTL)(t)}),i}(s,c,t,d);if(o){if(o.component){var u=o.component;return r.createElement(u,Object(i.__assign)({},l))}if(o.render)return o.render(l,e)}return r.createElement(e,Object(i.__assign)({},l))}}var ie=Object($.memoizeFunction)(function(e){return ae(e)});function re(e,t){var n={},a=e,i=function(e){if(t.hasOwnProperty(e)){var i=function(n){for(var i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];if(i.length>0)throw new Error("Any module using getSlots must use withSlots. Please see withSlots javadoc for more info.");return oe(t[e],n,a[e],a.slots&&a.slots[e],a._defaultStyles&&a._defaultStyles[e],a.theme)};i.isSlot=!0,n[e]=i}};for(var r in t)i(r);return n}function oe(e,t,n,a,i,r){return void 0!==e.create?e.create(t,n,a,i):ie(e)(t,n,a,i,r)}function se(e,t){void 0===t&&(t={});var n=t.factoryOptions,a=(void 0===n?{}:n).defaultProp,o=function(n){var a,o,s,c,d=(a=t.displayName,o=r.useContext($.CustomizerContext),s=t.fields,c=["theme","styles","tokens"],$.Customizations.getSettings(s||c,a,o.customizations)),l=t.state;l&&(n=Object(i.__assign)(Object(i.__assign)({},n),l(n)));var u=n.theme||d.theme,f=ce(n,u,t.tokens,d.tokens,n.tokens),p=function(e,t,n){for(var a=[],i=3;i<arguments.length;i++)a[i-3]=arguments[i];return Z.concatStyleSets.apply(void 0,a.map(function(a){return"function"==typeof a?a(e,t,n):a}))}(n,u,f,t.styles,d.styles,n.styles),m=Object(i.__assign)(Object(i.__assign)({},n),{styles:p,tokens:f,_defaultStyles:p,theme:u});return e(m)};return o.displayName=t.displayName||e.name,a&&(o.create=ae(o,{defaultProp:a})),te(o,t.statics),o}function ce(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];for(var r={},o=0,s=n;o<s.length;o++){var c=s[o];c&&(c="function"==typeof c?c(e,t):c,Array.isArray(c)&&(c=ce.apply(void 0,Object(i.__spreadArrays)([e,t],c))),te(r,c))}return r}var de={root:"ms-CardItem"},le={padding:0},ue={margin:0},fe=se(function(e){return ne(re(e,{root:o.Stack.Item}).root,Object(i.__assign)({},e))},{displayName:"CardItem",styles:function(e,t,n){var a=Object(o.getGlobalClassNames)(de,t);return{root:[t.fonts.large,a.root,{margin:n.margin,padding:n.padding}]}},tokens:function(e,t){return[le,e.fill&&ue]}}),pe={root:"ms-CardSection"},me={padding:0},_e={margin:0},he=se(function(e){var t=e.children,n=Object(i.__rest)(e,["children"]);return r.Children.count(t)<1?null:ne(re(e,{root:o.Stack}).root,Object(i.__assign)({},n),t)},{displayName:"CardSection",styles:function(e,t,n){var a=Object(o.getGlobalClassNames)(pe,t);return{root:[t.fonts.large,a.root,{margin:n.margin,padding:n.padding}]}},tokens:function(e,t){return[me,e.fill&&_e]}});function be(e){return!!e&&"object"==typeof e&&!!e.type}var ge={root:"ms-Card"},ve=function(e,t){return{boxShadow:t.effects.elevation4,childrenGap:12,childrenMargin:0,cursor:"default",height:"inherit",highContrastBoxShadow:"0 1.6px 3.6px 0 Highlight, 0 0.3px 0.9px 0 Highlight",minHeight:"348px",minWidth:"212px",maxWidth:"286px"}},ye={height:"auto",minWidth:"300px",maxWidth:"500px"},Se=function(e,t){var n=t.effects;return{borderFocused:"1px solid black",boxShadowFocused:n.elevation8,boxShadowHovered:n.elevation8,cursor:"pointer",highContrastBoxShadowHovered:"0 3.2px 7.2px 0 Highlight, 0 0.6px 1.8px 0 Highlight"}},De=se(function(e){var t=re(e,{root:o.Stack}),n=e.children,a=(e.styles,e.tokens),s=e.horizontal,c=e.onClick,d=e.onKeyDown,l=Object(i.__rest)(e,["children","styles","tokens","horizontal","onClick","onKeyDown"]),u=Object(o.getNativeProps)(l,o.htmlElementProperties),f=a&&a.childrenGap,p=a&&a.childrenMargin,m=r.Children.count(n),_=r.Children.map(n,function(e,t){if(!e)return null;var n,a=be(n=e)&&n.type.displayName===fe.displayName,c=function(e){return be(e)&&e.type.displayName===he.displayName}(e);if(a||c){if(!f&&!p)return e;var d=e.props,l=d.fill,u=d.tokens,_=Object(i.__rest)(d,["fill","tokens"]),h=0;if(p&&!l){var b=0===t?p:0,g=t===m-1?p:0;h=s?p+"px "+g+"px "+p+"px "+b+"px":b+"px "+p+"px "+g+"px"}var v=Object(i.__assign)({margin:h,childrenGap:c?f:void 0},u);return r.cloneElement(e,Object(i.__assign)({tokens:v},_))}return Object(o.warn)("The children of a Card component should be of type CardItem or CardSection."),e});return ne(t.root,Object(i.__assign)({onClick:c,onKeyDown:function(e){d?d(e):c&&e&&(e.which===o.KeyCodes.enter||e.which===o.KeyCodes.space)&&(c(),e.preventDefault())},role:c?"button":"presentation",tabIndex:c?0:-1},u,{horizontal:s,horizontalAlign:s?"start":"stretch",tokens:a,verticalAlign:"start",verticalFill:!0}),_)},{displayName:"Card",styles:function(e,t,n){var a,i,r;return{root:[Object(o.getGlobalClassNames)(ge,t).root,{borderRadius:"2px",boxShadow:n.boxShadow,cursor:n.cursor,height:n.height,maxWidth:n.maxWidth,minWidth:n.minWidth,outline:"none",transition:"box-shadow 0.5s ease",width:n.width,selectors:(a={":focus":{border:n.borderFocused,boxShadow:n.boxShadowFocused,selectors:(i={},i[o.HighContrastSelector]={boxShadow:n.highContrastBoxShadowFocused},i)},":hover":{boxShadow:n.boxShadowHovered,selectors:(r={},r[o.HighContrastSelector]={boxShadow:n.highContrastBoxShadowHovered},r)}},a[o.HighContrastSelector]={boxShadow:n.highContrastBoxShadow},a)}]}},tokens:function(e,t){return[ve,e.horizontal&&ye,e.onClick&&Se]},statics:{Item:fe,Section:he}}),Ie=function(){function e(){}return e.getThemeVariables=function(e,t){var n=!e.isInverted&&t.isInverted||e.isInverted&&!t.isInverted;return{conditionalEmptyBg:n?e.semanticColors.primaryButtonBackgroundHovered:e.semanticColors.primaryButtonBackground,conditionalEmptyText:n?e.semanticColors.primaryButtonTextHovered:e.semanticColors.primaryButtonText}},e.getBackgroundStyles=Object(o.memoizeFunction)(function(e,t){return{backgroundCardSectionStyles:{root:{height:Math.floor(t/16*9)}},backgroundImageCardSectionStyles:{root:{backgroundImage:"url("+e+")",height:Math.floor(t/16*9)}}}}),e.getStyles=Object(o.memoizeFunction)(function(e,t){return{cardStyles:{root:{backgroundColor:e.semanticColors.bodyBackground,border:"1px solid "+t.semanticColors.variantBorder+" !important",dataAutomationId:"event-card-fluent"}},cardTokens:{childrenGap:0,boxShadowHovered:e.effects.elevation16},categoryTextStyles:{root:{color:e.semanticColors.bodySubtext}},dayTextStyles:{root:{color:e.semanticColors.bodyText}},footerCardSectionStyles:{root:{borderTop:"1px solid "+e.semanticColors.variantBorder,height:36}},descriptionSectionStyles:{root:{borderTop:"1px solid "+e.semanticColors.variantBorder}},iconStyles:{root:{height:36,selectors:{"& .ms-Button-icon":{color:e.semanticColors.link},"&:hover .ms-Button-icon, &:focus .ms-Button-icon, &:active .ms-Button-icon":{color:e.semanticColors.linkHovered+" !important"}}}},monthTextStyles:{root:{color:e.semanticColors.bodyText}},placeTextStyles:{root:{color:e.semanticColors.bodySubtext}},timeTextStyles:{root:{color:e.semanticColors.bodyText}},titleTextStyles:{root:{color:e.semanticColors.bodyText}}}}),e.getEmptyStateCardStyles=Object(o.memoizeFunction)(function(t,n,a){var i=e.getThemeVariables(t,n);return{backgroundCardSectionStyles:{root:{backgroundColor:i.conditionalEmptyBg,height:Math.floor(a/16*9)}},iconStyles:{root:{color:i.conditionalEmptyText,fontSize:o.FontSizes.superLarge,fontWeight:o.FontWeights.regular}},descriptionTextStyles:{root:{color:t.semanticColors.bodySubtext}},titleTextStyles:{root:{color:t.semanticColors.bodyText}}}}),e.getCompactBackgroundStyles=Object(o.memoizeFunction)(function(e,t){return{backgroundImageCardSectionStyles:{root:{backgroundImage:"url("+t+")",boxShadow:e.effects.elevation4,selectors:{"&:hover":{boxShadow:e.effects.elevation16}}}}}}),e.getCompactStyles=Object(o.memoizeFunction)(function(e,t){return{backgroundCardSectionStyles:{root:{backgroundColor:e.semanticColors.bodyBackground,boxShadow:e.effects.elevation4,border:"1px solid "+t.semanticColors.variantBorder+" !important",selectors:{"&:hover":{boxShadow:e.effects.elevation16}}}},dayAndMonthTextStyles:{root:{color:e.semanticColors.bodyText}},timeTextStyles:{root:{color:t.semanticColors.bodyText}},titleTextStyles:{root:{color:t.semanticColors.bodyText}}}}),e.getCompactEmptyStateCardStyles=Object(o.memoizeFunction)(function(t,n){var a=e.getThemeVariables(t,n);return{backgroundCardSectionStyles:{root:{backgroundColor:a.conditionalEmptyBg}},iconStyles:{root:{color:a.conditionalEmptyText,fontSize:o.FontSizes.size28,fontWeight:o.FontWeights.regular}},titleTextStyles:{root:{color:n.semanticColors.bodyText}},descriptionTextStyles:{root:{color:n.semanticColors.bodySubtext}}}}),e}();U.loadStyles(".ac_c_ce1e465e{height:162px;display:flex;flex-flow:column nowrap;justify-content:flex-end;border-top-left-radius:2px;border-top-right-radius:2px;position:relative}.ac_c_ce1e465e.ae_c_ce1e465e{color:#fff;background-image:linear-gradient(1turn,rgba(51,51,51,.9),rgba(51,51,51,0) 97.92%)}.af_c_ce1e465e{height:66px;width:66px;display:flex;flex-flow:column nowrap;justify-content:flex-end;border-radius:2px;overflow:hidden}.af_c_ce1e465e.ae_c_ce1e465e{color:#fff;background-image:linear-gradient(1turn,rgba(51,51,51,.9),rgba(51,51,51,0) 97.92%)}.ag_c_ce1e465e{margin-bottom:12px}.ah_c_ce1e465e{background-position:50%;background-size:cover}.ai_c_ce1e465e,.ah_c_ce1e465e{justify-content:center;align-items:center}.aj_c_ce1e465e{background-position:50%;background-size:cover;border-radius:2px}.c_c_ce1e465e{min-width:206px;max-width:480px;margin-bottom:6px;height:68px}.c_c_ce1e465e .aj_c_ce1e465e{height:66px;width:66px;min-width:66px}[dir=ltr] .c_c_ce1e465e .aj_c_ce1e465e{margin-right:16px}[dir=rtl] .c_c_ce1e465e .aj_c_ce1e465e{margin-left:16px}.ak_c_ce1e465e{cursor:pointer}.al_c_ce1e465e .c_c_ce1e465e{align-items:center}.am_c_ce1e465e{height:24px;margin-bottom:-5px;white-space:nowrap;overflow:hidden;font-size:18px;font-weight:600}[dir=ltr] .am_c_ce1e465e{margin-left:14px}[dir=rtl] .am_c_ce1e465e{margin-right:14px}[dir=ltr] .am_c_ce1e465e{margin-right:12px}[dir=rtl] .am_c_ce1e465e{margin-left:12px}.an_c_ce1e465e{height:42px;margin-bottom:9px;line-height:42px;white-space:nowrap;overflow:hidden;font-size:42px;font-weight:700}[dir=ltr] .an_c_ce1e465e{margin-left:12px}[dir=ltr] .an_c_ce1e465e,[dir=rtl] .an_c_ce1e465e{margin-right:12px}[dir=rtl] .an_c_ce1e465e{margin-left:12px}.ao_c_ce1e465e .ap_c_ce1e465e{font-size:12px;margin-bottom:-1px}.ao_c_ce1e465e .aq_c_ce1e465e{font-size:24px;line-height:24px;margin-bottom:6px}.ar_c_ce1e465e .ap_c_ce1e465e{font-size:12px;line-height:12px;margin-bottom:2px}.ar_c_ce1e465e .aq_c_ce1e465e{font-size:12px;font-weight:700;line-height:12px;margin-bottom:7px}.as_c_ce1e465e .ap_c_ce1e465e{font-size:12px;line-height:12px;margin-bottom:2px}.as_c_ce1e465e .aq_c_ce1e465e{font-size:12px;line-height:12px;margin-bottom:8px}.as_c_ce1e465e .at_c_ce1e465e{font-weight:600}.as_c_ce1e465e .au_c_ce1e465e{font-weight:700}[dir=ltr] .as_c_ce1e465e .au_c_ce1e465e{margin-left:2px}[dir=rtl] .as_c_ce1e465e .au_c_ce1e465e{margin-right:2px}.aq_c_ce1e465e{overflow:hidden;white-space:nowrap;display:flex;font-weight:700}[dir=ltr] .aq_c_ce1e465e{margin-left:6px}[dir=rtl] .aq_c_ce1e465e{margin-right:6px}[dir=ltr] .aq_c_ce1e465e{margin-right:2px}[dir=rtl] .aq_c_ce1e465e{margin-left:2px}.ap_c_ce1e465e{line-height:12px;overflow:hidden;display:flex;font-weight:600}[dir=ltr] .ap_c_ce1e465e{margin-left:6px}[dir=rtl] .ap_c_ce1e465e{margin-right:6px}[dir=ltr] .ap_c_ce1e465e{margin-right:2px}[dir=rtl] .ap_c_ce1e465e{margin-left:2px}.av_c_ce1e465e{height:16px;overflow:hidden;text-overflow:ellipsis;word-break:normal;white-space:nowrap;font-size:12px;font-weight:600}.aw_c_ce1e465e:hover{-webkit-text-decoration-line:underline;text-decoration-line:underline}.ax_c_ce1e465e{font-size:14px;font-weight:600;overflow:hidden;text-overflow:ellipsis;word-break:normal}.ay_c_ce1e465e,.az_c_ce1e465e{font-size:12px;font-weight:600}.ba_c_ce1e465e,.az_c_ce1e465e{height:16px;overflow:hidden;text-overflow:ellipsis;word-break:normal}.ba_c_ce1e465e{white-space:nowrap;margin-top:11px;margin-bottom:10px;font-size:12px}[dir=ltr] .ba_c_ce1e465e{margin-left:12px}[dir=ltr] .ba_c_ce1e465e,[dir=rtl] .ba_c_ce1e465e{margin-right:12px}[dir=rtl] .ba_c_ce1e465e{margin-left:12px}.t_c_ce1e465e{font-weight:600;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;word-wrap:normal;font-size:12px;display:block;height:22px;padding-top:6px}[dir=ltr] .t_c_ce1e465e{margin-left:12px}[dir=rtl] .t_c_ce1e465e{margin-right:12px}.bb_c_ce1e465e{margin-top:28px;overflow:hidden;height:38px;font-size:14px;font-weight:600}[dir=ltr] .bb_c_ce1e465e{margin-left:12px}[dir=ltr] .bb_c_ce1e465e,[dir=rtl] .bb_c_ce1e465e{margin-right:12px}[dir=rtl] .bb_c_ce1e465e{margin-left:12px}.bc_c_ce1e465e{margin-top:13px;height:78px;overflow:hidden;word-break:normal;font-size:12px}[dir=ltr] .bc_c_ce1e465e{margin-left:12px}[dir=ltr] .bc_c_ce1e465e,[dir=rtl] .bc_c_ce1e465e{margin-right:12px}[dir=rtl] .bc_c_ce1e465e{margin-left:12px}.i_c_ce1e465e{width:100%;margin-top:2px;border-radius:2px}[dir=ltr] .i_c_ce1e465e{margin-left:2px}[dir=ltr] .i_c_ce1e465e,[dir=rtl] .i_c_ce1e465e{margin-right:2px}[dir=rtl] .i_c_ce1e465e{margin-left:2px}.i_c_ce1e465e .av_c_ce1e465e{margin-top:11px}[dir=ltr] .i_c_ce1e465e .av_c_ce1e465e{margin-left:12px}[dir=ltr] .i_c_ce1e465e .av_c_ce1e465e,[dir=rtl] .i_c_ce1e465e .av_c_ce1e465e{margin-right:12px}[dir=rtl] .i_c_ce1e465e .av_c_ce1e465e{margin-left:12px}.i_c_ce1e465e .ax_c_ce1e465e{margin-bottom:0;height:38px}[dir=ltr] .i_c_ce1e465e .ax_c_ce1e465e{margin-left:12px}[dir=ltr] .i_c_ce1e465e .ax_c_ce1e465e,[dir=rtl] .i_c_ce1e465e .ax_c_ce1e465e{margin-right:12px}[dir=rtl] .i_c_ce1e465e .ax_c_ce1e465e{margin-left:12px}.i_c_ce1e465e .az_c_ce1e465e{margin-top:14px;white-space:nowrap}[dir=ltr] .i_c_ce1e465e .az_c_ce1e465e{margin-left:12px}[dir=ltr] .i_c_ce1e465e .az_c_ce1e465e,[dir=rtl] .i_c_ce1e465e .az_c_ce1e465e{margin-right:12px}[dir=rtl] .i_c_ce1e465e .az_c_ce1e465e{margin-left:12px}.i_c_ce1e465e .n_c_ce1e465e{font-size:48px}.be_c_ce1e465e{width:100%;overflow:hidden;vertical-align:center}.be_c_ce1e465e .ax_c_ce1e465e{max-height:38px;margin-bottom:5px}.be_c_ce1e465e .bf_c_ce1e465e{height:16px}.be_c_ce1e465e .u_c_ce1e465e{font-size:12px;margin:2px 0 0}[dir=rtl] .be_c_ce1e465e .u_c_ce1e465e{margin:2px 0 0}.u_c_ce1e465e.bg_c_ce1e465e{font-size:14px;margin:10px 8px 0 0}[dir=rtl] .u_c_ce1e465e.bg_c_ce1e465e{margin:10px 0 0 8px}.bf_c_ce1e465e{display:flex;width:100%;justify-content:space-between}",!0);var xe="ae_c_ce1e465e",Ce="aj_c_ce1e465e",Oe="ak_c_ce1e465e",we="ap_c_ce1e465e",Ee="aq_c_ce1e465e",Ae="at_c_ce1e465e",Le="au_c_ce1e465e",ke="aw_c_ce1e465e",Me="ax_c_ce1e465e",Pe="az_c_ce1e465e",Te="be_c_ce1e465e",Ue="bf_c_ce1e465e",Fe="u_c_ce1e465e",He={margin:0,childrenGap:0},Re={childrenGap:0},Ne={padding:0},Be={maxWidth:286},je={boxShadow:"0 0 rgba(0, 0, 0, 0)",childrenGap:0,padding:2},Ve=function(e){function t(t){var n=e.call(this,t)||this;return n._focusZoneRef=r.createRef(),n._handleKeyDown=function(e){var t;n.props.isCompactCard||e.which!==o.KeyCodes.up&&e.which!==o.KeyCodes.down||(null===(t=n._focusZoneRef.current)||void 0===t||t.focus(),e.preventDefault(),e.stopPropagation())},n._handleClickWrapper=function(e){n.props.onClick&&n.props.onClick(e)},n._logClickWebLink=function(){b._EngagementLogger.logEvent("EventCard.WebLink.Click")},n.state={hasThumbnail:!1,thumbnailUrl:""},n._imageAspectRatio=1,n._maxCardWidth=300,n._updateDateString(),n}return Object(i.__extends)(t,e),t.prototype.componentDidMount=function(){if(this.props.showImage&&this.props.bannerUrl&&"https://none"!==this.props.bannerUrl){this.props.width>this._maxCardWidth&&(this._maxCardWidth=this.props.width),Object(S.p)()||(this._imageAspectRatio=this.props.bannerImageAspectRatio||1);var e=this._maxCardWidth;this._imageAspectRatio>16/9&&(e=this._maxCardWidth*(9/16)*this._imageAspectRatio),this._generateThumbnail(this.props.bannerUrl,e)}},t.prototype.render=function(){var e,t;this._checkSameDate(this._startDate,this.props.startDate)&&this._checkSameDate(this._endDate,this.props.endDate)||this._updateDateString();var n=Object(o.getTheme)(),a=this.props.getEmptyStateOptions?null===(t=(e=this.props).getEmptyStateOptions)||void 0===t?void 0:t.call(e):void 0,s=this.props.isCompactCard?void 0:Ie.getStyles(n,this.props.theme),c={style:{width:this.props.width},role:S.m.isActivated()?"listitem":void 0,"data-is-focusable":!this.props.isPlaceholderCard,"data-is-focus-item":!0,"data-sp-a11y-skipkeys":o.KeyCodes.enter,onKeyDown:this._handleKeyDown,onClick:this._handleClickWrapper};return r.createElement("div",Object(i.__assign)({},c),this.props.isCompactCard?this._renderCompactCard(n,a):this._renderNormalCard(n,s,a))},t.prototype.componentDidUpdate=function(e){if(e.showImage===this.props.showImage&&this._checkSameUrl(e.bannerUrl,this.props.bannerUrl)||this._resetThumbnailVariables(),this.props.showImage&&this.props.bannerUrl&&"https://none"!==this.props.bannerUrl&&(!e.showImage||e.bannerUrl!==this.props.bannerUrl||this.props.width>this._maxCardWidth)){this.props.width>this._maxCardWidth&&(this._maxCardWidth=this.props.width);var t=this._maxCardWidth;Object(S.p)()||(this._imageAspectRatio=this.props.bannerImageAspectRatio||1),this._imageAspectRatio>16/9&&(t=this._maxCardWidth*(9/16)*this._imageAspectRatio),this._generateThumbnail(this.props.bannerUrl,t)}},t.prototype._checkSameUrl=function(e,t){return e&&t?e===t:!e&&!t},t.prototype._resetThumbnailVariables=function(){!this.state.hasThumbnail&&this.state.thumbnailUrl||this.setState({hasThumbnail:!1,thumbnailUrl:""}),this._imageAspectRatio=1},t.prototype._updateThumbnailState=function(e){e===this.state.thumbnailUrl&&this.state.hasThumbnail||this.setState({thumbnailUrl:e,hasThumbnail:!!Object(S.o)()||this.props.showImage})},t.prototype._generateThumbnail=function(e,t){var n=this,a=new b._QosMonitor("EventsWebPart.GenerateThumbnail");this._loadThumbnailImage({imageData:{imageUrl:e},serviceScope:this.props.serviceScope,thumbnailWidth:t,callerId:4,getDefaultImage:l.DefaultImageHelper.getDefaultImage}).then(function(i){if(Object(S.n)()||a.writeSuccess(),Object(S.a)()||n.props.bannerUrl===e)if(l.DefaultImageHelper.isStockImage(new J._SPResourcePath(i.src)))n.state.hasThumbnail&&n.setState({hasThumbnail:!1});else{var r=i.width/i.height;r<16/9||i.height>n.props.width/16*9||Math.abs(r-n._imageAspectRatio)<.01?(n._updateThumbnailState(i.src),r>16/9&&(n._imageAspectRatio=r)):(t=n._maxCardWidth*(9/16)*r,n._loadThumbnailImage({imageData:{imageUrl:e},serviceScope:n.props.serviceScope,thumbnailWidth:t,callerId:5,getDefaultImage:l.DefaultImageHelper.getDefaultImage}).then(function(t){(Object(S.a)()||n.props.bannerUrl===e)&&(n._imageAspectRatio=r,n._updateThumbnailState(t.src))}).catch(function(){(Object(S.a)()||n.props.bannerUrl===e)&&n.state.hasThumbnail&&n.setState({hasThumbnail:!1})}))}}).catch(function(){if(!Object(S.n)()){var t="Failed to generate thumbnail for ".concat(e);a.writeUnexpectedFailure("GenerateThumbnailFailed",new Error(t))}(Object(S.a)()||n.props.bannerUrl===e)&&n.state.hasThumbnail&&n.setState({hasThumbnail:!1})})},t.prototype._getNormalEmptyStateCard=function(e,t,n){var a=Ie.getEmptyStateCardStyles(e,this.props.theme,this.props.width);return r.createElement(r.Fragment,null,r.createElement(De.Section,{fill:!0,verticalAlign:"end",className:"ah_c_ce1e465e",styles:a.backgroundCardSectionStyles,"data-automation-id":"empty-state-preview"},r.createElement(o.Icon,{iconName:"Event","aria-hidden":"true",styles:a.iconStyles,className:"n_c_ce1e465e"})),r.createElement(De.Section,{tokens:He,styles:null==t?void 0:t.descriptionSectionStyles},r.createElement(Y,{className:"bb_c_ce1e465e",styles:a.titleTextStyles},n.title)),r.createElement(De.Section,{tokens:Re},r.createElement(Y,{className:"bc_c_ce1e465e",styles:a.descriptionTextStyles},n.description)))},Object.defineProperty(t.prototype,"_webLink",{get:function(){if(this.props.showWebLink&&this.props.webName)return r.createElement(o.Link,{className:"t_c_ce1e465e",href:this.props.webUrl,onClick:this._logClickWebLink},this.props.webName)},enumerable:!1,configurable:!0}),t.prototype._normalCardPreviewAndDetails=function(e){var t=this.props.getAddToCalendarButtonProps?this.props.getAddToCalendarButtonProps():void 0,n=Ie.getBackgroundStyles(this.state.thumbnailUrl,this.props.width);return r.createElement(r.Fragment,null,r.createElement(De.Section,{fill:!0,verticalAlign:"end",className:Ce,styles:this.state.hasThumbnail?n.backgroundImageCardSectionStyles:n.backgroundCardSectionStyles,"data-automation-id":"normal-card-preview"},r.createElement("div",{className:Object(o.css)(this.state.hasThumbnail?xe:{},"ac_c_ce1e465e")},r.createElement(Y,{className:"am_c_ce1e465e",styles:this.state.hasThumbnail?{}:null==e?void 0:e.monthTextStyles},this._isEventSameDay||this._isEventSameMonth?this._monthStr:this._multiMonthStr),r.createElement(Y,{className:"an_c_ce1e465e",styles:this.state.hasThumbnail?{}:null==e?void 0:e.dayTextStyles},this._isEventSameDay?this._dayStr:this._multiDayStr))),r.createElement(De.Section,{tokens:He,styles:null==e?void 0:e.descriptionSectionStyles},r.createElement(Y,{className:"av_c_ce1e465e",styles:null==e?void 0:e.categoryTextStyles},this.props.category),this._webLink,r.createElement(Y,{className:Object(o.css)(Me,this._isNoDate?"":ke),styles:null==e?void 0:e.titleTextStyles,"data-automation-id":"event-card-title","data-is-focusable":"true"},this.props.title)),r.createElement(De.Section,{tokens:Re},r.createElement(Y,{className:Pe,styles:null==e?void 0:e.timeTextStyles},this._dateTimeStr),r.createElement(Y,{className:"ba_c_ce1e465e",styles:null==e?void 0:e.placeTextStyles},this.props.location)),r.createElement(De.Section,{horizontal:!0,styles:null==e?void 0:e.footerCardSectionStyles,tokens:Ne},r.createElement("div",{className:Ue},t&&r.createElement(o.ActionButton,Object(i.__assign)({iconProps:{iconName:"AddEvent"},styles:null==e?void 0:e.iconStyles,ariaDescription:Object(S.i)()?P.n:void 0,ariaLabel:Object(S.i)()?void 0:P.n},!Object(S.t)()&&{title:P.a},t)),this.props.showAudiencesIcon&&r.createElement(T,{className:Object(o.css)(Fe,"bg_c_ce1e465e")}))))},t.prototype._renderNormalCard=function(e,t,n){return r.createElement(o.Stack,{horizontal:!0,tokens:Be,className:"ag_c_ce1e465e"},r.createElement(De,{"aria-label":this._getAriaLabel(n),onClick:this.props.onClick,className:"i_c_ce1e465e",styles:null==t?void 0:t.cardStyles,tokens:null==t?void 0:t.cardTokens,"data-automation-id":"event-card-fluent"},r.createElement(o.FocusZone,{direction:o.FocusZoneDirection.vertical,isCircularNavigation:!0,componentRef:this._focusZoneRef},n?this._getNormalEmptyStateCard(e,t,n):this._normalCardPreviewAndDetails(t))))},t.prototype._getCompactEmptyStateCard=function(e,t){var n=Ie.getCompactEmptyStateCardStyles(e,this.props.theme);return r.createElement(r.Fragment,null,r.createElement(De.Section,{verticalAlign:"end",className:Object(o.css)(Ce,"ai_c_ce1e465e",Oe),styles:n.backgroundCardSectionStyles,"data-automation-id":"empty-state-preview"},r.createElement(o.Icon,{iconName:"Event",styles:n.iconStyles})),r.createElement(De.Section,{className:Te,tokens:He},r.createElement(Y,{className:Me,styles:n.titleTextStyles},t.title),r.createElement(Y,{className:"ay_c_ce1e465e",styles:n.descriptionTextStyles},t.description)))},t.prototype._getCompactPreviewAndDetails=function(e){var t=Ie.getCompactBackgroundStyles(e,this.state.thumbnailUrl),n=Ie.getCompactStyles(e,this.props.theme),a=this.state.hasThumbnail?{}:n.dayAndMonthTextStyles,i=r.createElement(r.Fragment,null,r.createElement(Y,{styles:a,className:we},this._monthStr),r.createElement(Y,{styles:a,className:Ee},this._dayStr)),s=r.createElement(r.Fragment,null,r.createElement(Y,{styles:a,className:we},r.createElement("div",{className:Ae},this._firstDateMonthStr),r.createElement("div",{className:Le},this._firstDateDayStr)),r.createElement(Y,{styles:a,className:Ee},r.createElement("div",{className:Ae},this._lastDateMonthStr),r.createElement("div",{className:Le},this._lastDateDayStr)));return r.createElement(r.Fragment,null,r.createElement(De.Section,{verticalAlign:"end",styles:this.state.hasThumbnail?t.backgroundImageCardSectionStyles:n.backgroundCardSectionStyles,className:Ce,"data-automation-id":"compact-card-preview"},r.createElement("div",{className:Object(o.css)("af_c_ce1e465e",this.state.hasThumbnail?xe:{},this._isEventSameDay?"ao_c_ce1e465e":this._isEventSameMonth?"ar_c_ce1e465e":"as_c_ce1e465e")},this._isEventSameDay||this._isEventSameMonth?i:s)),r.createElement(De.Section,{tokens:He,className:Te},r.createElement(Y,{className:Object(o.css)(Me,this._isNoDate?"":ke),styles:n.titleTextStyles,"data-automation-id":"event-card-title"},this.props.title),r.createElement("div",{className:Ue},r.createElement(Y,{className:Pe,styles:n.timeTextStyles},this._dateTimeStr),this.props.showAudiencesIcon&&r.createElement(T,{className:Fe}))))},t.prototype._renderCompactCard=function(e,t){return r.createElement(o.Stack,{className:"al_c_ce1e465e"},r.createElement(De,{"aria-label":this._getAriaLabel(t),horizontal:!0,tokens:je,className:Object(o.css)("c_c_ce1e465e",!this._isNoDate||t?Oe:""),"data-automation-id":"compact-card-fluent"},t?this._getCompactEmptyStateCard(e,t):this._getCompactPreviewAndDetails(e)))},t.prototype._updateDateString=function(){this._startDate=this.props.startDate,this._endDate=this.props.endDate;var e=this._startDate||this._endDate,t=!!this._startDate&&!!this._endDate,n=!(this._startDate&&this._endDate||!e);this._isEventSameDay=t&&Object(p.isSameDay)(this._startDate,this._endDate),this._isEventSameDay=this._isEventSameDay||n||!e,this._isEventSameMonth=t&&this._startDate.getMonth()===this._endDate.getMonth(),this._isNoDate=!e,t?(this._monthStr=this.props.formatMonth(e),this._dayStr=this.props.formatDay(e),this._dateTimeStr=this.props.formatDate(e),this._isEventSameDay||(this._isEventSameMonth?this._dayStr=this.props.formatDay(this._startDate)+"-"+this.props.formatDay(this._endDate):this._multiMonthStr=this.props.formatMonth(this._startDate)+"-"+this.props.formatMonth(this._endDate),this._multiDayStr=this.props.formatDay(this._startDate)+"-"+this.props.formatDay(this._endDate),this._firstDateMonthStr=this.props.formatMonth(this._startDate),this._firstDateDayStr=this.props.formatDay(this._startDate),this._lastDateMonthStr=this.props.formatMonth(this._endDate),this._lastDateDayStr=this.props.formatDay(this._endDate))):(this._monthStr=P.s,this._dayStr="01",this._dateTimeStr=P.o)},t.prototype._checkSameDate=function(e,t){return!e&&!t||!(!e&&t||e&&!t)&&Object(p.isSameDay)(e,t)},t.prototype._getAriaLabel=function(e){if(this.props.ariaLabel)return this.props.ariaLabel;if(e){var t=e.title||"",n=e.description||"";return h.Text.format(P.c,t,n,"")}return this.props.isCompactCard?h.Text.format(P.r,this.props.detailsLink?P.d:"",this.props.title,this.props.startDate?h.Text.format(P.u,this.props.formatDate(this.props.startDate)):""):h.Text.format(P.p,this.props.detailsLink?P.d:"",this.props.category||"",this.props.title,this.props.startDate?h.Text.format(P.u,this.props.formatDate(this.props.startDate)):"",this.props.location?h.Text.format(P.l,this.props.location):".",this.props.showWebLink&&this.props.webName?h.Text.format(P.f,this.props.webName):"",this.props.getAddToCalendarButtonProps?P.e:"")},t.prototype._loadThumbnailImage=function(e){return new Promise(function(t,n){var a=document.createElement("div");e.disableBlobRevoke=!0,Q.render(r.createElement(X.SPImg,Object(i.__assign)(Object(i.__assign)({},e),{onImageLoad:function(e){t(null==e?void 0:e.target),Q.unmountComponentAtNode(a)},onImageLoadFailure:function(e,t){"stockImage"===e&&(n(e),Q.unmountComponentAtNode(a))},renderedInDetachedDOM:!0})),a)})},t.defaultProps={id:"",listId:"",title:"",category:"",location:"",detailsLink:void 0,ariaLabel:"",onClick:void 0,isCompactCard:!1,showWebLink:!1,webName:void 0,webUrl:"",bannerUrl:"",showImage:!1,getEmptyStateOptions:void 0,getAddToCalendarButtonProps:void 0,formatDate:function(e){return g.LocaleFormat.formatDate(e,{skeleton:"MMMEdhm"})},formatMonth:function(e){return g.LocaleFormat.formatDate(e,{skeleton:"MMM"}).toUpperCase()},formatDay:function(e){return g.LocaleFormat.formatDate(e,{skeleton:"d"})}},t}(r.PureComponent),ze=Object(o.customizable)("EventCardFluent",["theme"])(Ve),Ge=n("I6O9"),Ke=function(){function e(){}return e.loadCarousel=function(){return Ge.SPComponentLoader.loadComponentById(e.carouselComponentId).then(function(e){return e.CarouselLayoutLoader.loadCarousel()})},e.loadCardLayout=function(){return Ge.SPComponentLoader.loadComponentById(e.cardLayoutComponentId).then(function(e){return e.CardLayoutLoader.loadCardLayout()})},e.carouselComponentId="8ac0c53c-e8d0-4e3e-87d0-7449eb0d4027",e.cardLayoutComponentId="62680648-d047-46ec-81e0-475ee78e482d",e}(),We=n("jqkI"),qe=n("QW9R"),Qe=n("K9kD"),Ye=n("mGD9"),Je="FilmStrip",Xe="Flex",Ze="EventsWebPart",$e=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._customerPromiseStatus={totalTimesDataRendered:0,didRenderFromCache:!1,didRenderFromServer:!1},t._customerPromiseDataProviderStatus={dataSource:""},t._customerPromiseLKGStatus={hit:!1},t._didRequestCustomerPromiseLogging=!1,t.onServerResponseResolved=function(e){t._customerPromiseStatus=p.CustomerPromiseUtilities.updateCustomerPromiseStatus(t._customerPromiseStatus,!0,void 0),t._customerPromiseDataProviderStatus=p.CustomerPromiseUtilities.updateCustomerDataProviderStatus(t._customerPromiseDataProviderStatus,t.properties.dataProviderId,e)},t.onServerResponseFailed=function(e){t._customerPromiseStatus=p.CustomerPromiseUtilities.updateCustomerPromiseStatus(t._customerPromiseStatus,!1,void 0),t._customerPromiseDataProviderStatus=p.CustomerPromiseUtilities.updateCustomerDataProviderStatus(t._customerPromiseDataProviderStatus,t.properties.dataProviderId,void 0,e)},t.renderedFromCacheData=function(e){t._customerPromiseStatus=p.CustomerPromiseUtilities.updateCustomerPromiseStatus(t._customerPromiseStatus,void 0,!0),t._customerPromiseLKGStatus=p.CustomerPromiseUtilities.updateCustomerPromiseLKGStatus(t._customerPromiseLKGStatus,e)},t.onCacheResponseFailed=function(e){t._customerPromiseStatus=p.CustomerPromiseUtilities.updateCustomerPromiseStatus(t._customerPromiseStatus,void 0,!1),t._customerPromiseLKGStatus=p.CustomerPromiseUtilities.updateCustomerPromiseLKGStatus(t._customerPromiseLKGStatus,void 0,e)},t.setResponseAndRender=function(n){(null==n?void 0:n.length)&&e.prototype.setResponseAndRender.call(t,n)},t._onRenderFilmStripItem=function(e,n,a,i){var o=Object(m.getItemWidth)(t.width,i),s=t._getEventCardProps(e,o);return Object(qe.t)()||t.properties.dataSource!==u.ContentLocation.CurrentSiteEventsList&&(s.showImage=!1),Object(qe.e)()?r.createElement(ze,s):r.createElement(q,s)},t._onRenderListItem=function(e,n,a){var i=t._getEventCardProps(e,a);return Object(qe.t)()||t.properties.dataSource!==u.ContentLocation.CurrentSiteEventsList&&(i.showImage=!1),Object(qe.e)()?r.createElement(ze,i):r.createElement(q,i)},t._calculateItemHeight=function(e){var n=Math.floor(e/16*9);return t._isMobileView||"Compact"===t.properties.layout?68:n+188+m.CAROUSEL_CONSTANTS.ITEM_MARGIN},t._handlePaginationPageChange=function(e,n){n===p.PageType.Next?(t._currentPageNumber++,b._EngagementLogger.logEvent("EventsWebpart.PaginationNextButton.Click")):(t._currentPageNumber--,b._EngagementLogger.logEvent("EventsWebpart.PaginationPrevButton.Click")),t._currentPageEventItems=t._cachedResponse.slice(4*(t._currentPageNumber-1),4*t._currentPageNumber),t.setResponseAndRender(t._currentPageEventItems)},t._handleError=function(n){return 401!==n.httpStatus&&403!==n.httpStatus&&404!==n.httpStatus?e.prototype.onInit.call(t).then(function(){throw new Error(n.message)}):t.displayMode===h.DisplayMode.Read?e.prototype.onInit.call(t).then(t.delayedGetDataAndRender):void 0},t._checkSelectedListPermission=function(){return t._eventsListDataProvider.getEventsListPermission(t._listIdForAddingEvent).then(function(e){t._parsePermission(e),t._hasViewListItemsPermission||(t._messageView=t.displayMode===h.DisplayMode.Edit?{message:Ye.u,messageBarType:o.MessageBarType.error}:void 0)})},t._getEmptyStateOptions=function(){return{title:t._getEmptyStateCardTitle(),description:t._getEmptyStateCardDescription(),isCreateEventCard:t._shouldShowCreateEventCard()}},t._handleSelectStartDate=function(e){e&&(t.properties.startDate=Object(y.o)(e),e>Object(y.c)(t.properties.endDate)&&(t.properties.endDate=Object(y.o)(e),t.context.propertyPane.refresh()),t.delayedGetDataAndRender())},t._handleSelectEndDate=function(e){e&&(t.properties.endDate=Object(y.o)(e),e<Object(y.c)(t.properties.startDate)&&(t.properties.startDate=Object(y.o)(e),t.context.propertyPane.refresh()),t.delayedGetDataAndRender())},t}return Object(i.__extends)(t,e),t._getOffsetFromStartEndDate=function(e,t){var n=Object(y.c)(e),a=Object(y.c)(t).getTime()-n.getTime();return Math.ceil(a/864e5)},t.prototype.onInit=function(){var t=this;this._preferTime24=!1,this._eventDataProvider=new f.EventDataProvider({serviceScope:this.context.serviceScope}),this._eventsListDataProvider=new f.EventsListDataProvider(this.context.serviceScope),this._hasAddListItemsPermission=!1,this._hasViewListItemsPermission=!1,this._propertyPaneRenderedOnce=!1,this._isMobileView=this.width<=480,this.properties.layoutId=this._layoutId,this._shouldPrepareList=!0,this._cachedResponse=[],this._currentPageNumber=1,this._currentPageEventItems=[],this._listIdForAddingEvent=this.properties.selectedListId,this.properties.dateRangeOption=this.properties.dateRangeOption||0,this._preferTime24=this.context.pageContext.user.preferUserTimeZone?this.context.pageContext.legacyPageContext.userTime24:this.context.pageContext.legacyPageContext.webTime24,this._webAbsoluteUrl=h.UrlUtilities.removeEndSlash(this.context.pageContext.web.absoluteUrl);var n=[new p.MappedField("id",{sources:["id"]}),new p.MappedField("listId",{sources:["listId"]}),new p.MappedField("isCompactCard",{sources:["isCompactCard"]}),new p.MappedField("title",{sources:["title"]}),new p.MappedField("startDate",{sources:["startDate"]}),new p.MappedField("endDate",{sources:["endDate"]}),new p.MappedField("category",{sources:["category"]}),new p.MappedField("location",{sources:["location"]}),new p.MappedField("allDay",{sources:["allDay"]}),new p.MappedField("getEmptyStateOptions",{sources:["getEmptyStateOptions"]}),new p.MappedField("getAddToCalendarButtonProps",{sources:["getAddToCalendarButtonProps"]}),new p.MappedField("formatDate",{sources:["formatDate"]}),new p.MappedField("prevPageQuery",{sources:["prevPageQuery"]}),new p.MappedField("nextPageQuery",{sources:["nextPageQuery"]}),new p.MappedField("webName",{sources:["webName"]}),new p.MappedField("webUrl",{sources:["webUrl"]})];n.push(new p.MappedField("showAudiencesIcon",{sources:["containsAudiences"]})),Object(qe.e)()&&(n.push(new p.MappedField("bannerUrl",{sources:["bannerUrl"]})),n.push(new p.MappedField("showImage",{sources:["showImage"]})),n.push(new p.MappedField("isAllDayEvent",{sources:["isAllDayEvent"]})),Object(S.p)()||n.push(new p.MappedField("bannerImageAspectRatio",{sources:["bannerImageAspectRatio"]}))),this._displayFieldMap=new p.DisplayFieldMap(n),this._ensureDefaultDataSource();var a=this.context.webPartTag;return b._PerformanceLogger.trackWebpartExperiment(a,b._PerformanceExperiment.SOXEventUpdate),b._PerformanceLogger.trackWebpartFlight(a,b._PerformanceFlight.FluentEventsWebPart),Object(S.c)()||(b._PerformanceLogger.trackWebpartFlight(a,b._PerformanceFlight.WEXMySiteCacheManagementTieredCachingEvents),b._PerformanceLogger.trackWebpartExperiment(a,b._PerformanceExperiment.WEXMySiteCacheTCExpEvents)),this.properties.audienceTarget&&b._EngagementLogger.logEventWithLogEntry(new s._LogEntry("EventsWebPart","Render",s._LogType.Event,{audienceTargetingEnabled:Boolean(this.properties.audienceTarget).toString()})),this._customerPromise=new Qe.CustomerPromise({scenario:"EventsWebPartRender"}),this.properties.dataSource===u.ContentLocation.CurrentSite||this.properties.dataSource===u.ContentLocation.CurrentSiteCollection||this.properties.dataSource===u.ContentLocation.AllSites||this.properties.dataSource===u.ContentLocation.AllSitesInTheHub||this.properties.dataSource===u.ContentLocation.SelectedSites?(this.setDataProviderById("Search"),this._eventsListDataProvider.ensureEventsList().then(function(e){return t._listIdForAddingEvent=e.Id}).then(function(){return e.prototype.onInit.call(t)}).then(function(){t._startPermissionCheckAndRender()}).catch(this._handleError)):(this.setDataProviderById("Event"),this._prepareListAndRender().catch(this._handleError))},t.prototype.onPreRender=function(e,t,n){var a={addButton:this._getAddButtonOptions(),seeAllLink:this._getSeeAllLinkOptions(),messageView:this._messageView,paginationProps:this._getPaginationProps(e)};return this._customerPromiseStatus.totalTimesDataRendered++,Promise.resolve(a)},t.prototype.onPostRender=function(){var e=this;return!this._didRequestCustomerPromiseLogging&&Object(qe.n)()&&(this._didRequestCustomerPromiseLogging=!0,setTimeout(function(){e.logCustomerPromise()},3500)),Promise.resolve(void 0)},t.prototype.logCustomerPromise=function(){var e;if(this.isReadyToResolveCustomerPromise()){var t=p.CustomerPromiseUtilities.getCustomerPromiseBaseEndSchema(this._customerPromiseDataProviderStatus,this._customerPromiseLKGStatus);t.extraData=Object(i.__assign)(Object(i.__assign)({},t.extraData),{dataProvider:!!this._customerPromiseDataProviderStatus&&this._customerPromiseDataProviderStatus.dataSource,renderedFromCache:this._customerPromiseStatus.didRenderFromCache,renderedServerAPIData:this._customerPromiseStatus.didRenderFromServer,totalTimesRendered:this.rendersCompleted,totalTimesEventDataRendered:this._customerPromiseStatus.totalTimesDataRendered}),null===(e=this._customerPromise)||void 0===e||e.end(t)}},t.prototype.isReadyToResolveCustomerPromise=function(){var e=this.rendersRequested===this.rendersCompleted+this.failedRendersCompleted;return this.rendersRequested>1&&e},t.prototype.onDisplayModeChanged=function(n){var a=this;this._layoutId===Je?this.updateActiveLayoutProp("edit",n===h.DisplayMode.Read):this._layoutId===Xe&&this.updateActiveLayoutProp("ariaLabel",this._flexLayoutAriaLabel),n===h.DisplayMode.Edit&&this._usingListDataProvider()?this._checkSelectedListPermission().then(function(){return e.prototype.onDisplayModeChanged.call(a,n)}).catch(function(e){s._TraceLogger.logError(t._logSource,e,"CheckSelectedListPermissionWhenDisplayModeChanged")}):e.prototype.onDisplayModeChanged.call(this,n)},Object.defineProperty(t.prototype,"options",{get:function(){return{qosPrefix:"EventsWebPart",requirePageContextVariables:!0,showTitle:!this.properties.isOnSeeAllPage,deprecated_canCacheResults:this._useMySiteCache,temporary_isTieredCacheImplementedInDataProvider:Object(qe.n)()}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataVersion",{get:function(){return D.dataVersion},enumerable:!1,configurable:!0}),t.prototype.onAfterDeserialize=function(e,t){return D.upgrade(e,t)},Object.defineProperty(t.prototype,"layouts",{get:function(){var e=this;return[{id:Je,loadLayout:Ke.loadCarousel,componentId:Ke.carouselComponentId,option:{key:"Filmstrip",isSelected:"Filmstrip"===this.properties.layout,title:Ye.v,imageSrc:"".concat("Filmstrip",".svg"),themableSvg:x},properties:{settings:{autoplay:!1,dots:!0,filmStrip:!0},edit:this.displayMode===h.DisplayMode.Edit,strings:{containerAriaLabelEditMode:Ye.f,containerAriaLabelReadMode:v.StringHelper.format(Ye.p,Ye.f)},onRenderItem:this._onRenderFilmStripItem}},{id:Xe,loadLayout:_.FlexLayoutLoader.loadFlexLayout,componentId:"0447e11d-bed9-4898-b600-8dbcd95e9cc2",option:{key:"Compact",isSelected:"Compact"===this.properties.layout,title:Ye.g,imageSrc:"".concat("Compact",".svg"),themableSvg:I},properties:{ariaLabel:this._flexLayoutAriaLabel,isMobileView:function(){return e._isMobileView},itemSetting:{minWidth:m.CAROUSEL_CONSTANTS.ITEM_MIN_WIDTH,maxWidth:m.CAROUSEL_CONSTANTS.ITEM_MAX_WIDTH,marginLeft:this.properties.isOnSeeAllPage?7:10,marginRight:this.properties.isOnSeeAllPage?7:10,marginTop:0,marginBottom:this.properties.isOnSeeAllPage?14:10,maxItemCountPerRow:4,visibleRowCount:5},calculateItemHeight:this._calculateItemHeight,onRequestPage:function(t){e._currentPageQuery=t,e.delayedGetDataAndRender()},onRenderItem:this._onRenderListItem}}]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataProviders",{get:function(){return[{id:"Event",title:"Event",loadDataProvider:this.loadEventDataProvider},{id:"Search",title:"Search",loadDataProvider:this.loadEventsSearchDataProvider}]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataCacheConfiguration",{get:function(){return{dataSource:this.properties.dataSource,dateRangeOption:this.properties.dateRangeOption,endDate:this.properties.endDate,isOnSeeAllPage:this.properties.isOnSeeAllPage,maxItemsPerPage:this.properties.maxItemsPerPage,selectedCategory:this.properties.selectedCategory,selectedListId:this.properties.selectedListId,sites:this.properties.sites,startDate:this.properties.startDate}},enumerable:!1,configurable:!0}),t.prototype.getRequest=function(e){var t,n=this.displayMode===h.DisplayMode.Read&&this.properties.audienceTarget;switch(e){case"Search":var a=!1;this.properties.dataSource===u.ContentLocation.CurrentSite?a=Boolean(this.context.pageContext.site.group)&&(null===(t=this.context.pageContext.site.group)||void 0===t?void 0:t.type)===d.O365GroupAssociationType.Private:this.properties.dataSource===u.ContentLocation.SelectedSites&&(a=this.properties.sites.some(function(e){return"Group"===e.Type}));var i={EventsRollUpCategory:u.ManagedDataType.Text,EventsRollUpEndDate:u.ManagedDataType.DateTime,EventsRollUpStartDate:u.ManagedDataType.DateTime},r=f.EventsSearchDataProvider.selectProperties;if(r.push("ModernAudienceAadObjectIds"),S.e.isActivated())return{searchOptions:{isPrivateGroup:a,queryableManagedProperties:i,clientType:Ze,enableMultiGeoSearch:this._shouldEnableMultiGeoSearch(),hubSiteId:this.context.pageContext.legacyPageContext.hubSiteId,maxItemsPerPage:this._maxItemsPerPage,query:this._buildSearchQuery(),selectProperties:r,siteId:this.properties.siteId,webId:this.properties.webId,siteIds:this.properties.sites.map(function(e){return{siteId:e.ItemReference.SiteId,webId:e.ItemReference.WebId}}),audienceTarget:n}};var o={isPrivateGroup:a,queryableManagedProperties:i,enableMultiGeoSearch:this._shouldEnableMultiGeoSearch(),hubSiteId:this.context.pageContext.legacyPageContext.hubSiteId,query:this._buildSearchQuery(),selectProperties:r,siteId:this.properties.siteId,webId:this.properties.webId,siteIds:this.properties.sites.map(function(e){return{siteId:e.ItemReference.SiteId,webId:e.ItemReference.WebId}}),audienceTarget:n},s=u.KQLQueryBuilder.generateQuery(o,this.pageContext),l=u.KQLQueryBuilder.generateSearchAPIQueryOptions(s.queryTemplate,s.timeZoneId,o);return{searchAPIQueryOptions:{Querytext:this.properties.selectedCategory?'EventsRollUpCategory="'.concat(Object(u.sanitizeSearchQueryParameter)(this.properties.selectedCategory),'"'):"",QueryTemplate:"{searchterms} ".concat(l.QueryTemplate),ClientType:Ze,RowLimit:this._maxItemsPerPage,RowsPerPage:this._maxItemsPerPage,TimeZoneId:l.TimeZoneId,SelectProperties:l.SelectProperties,Properties:l.Properties,SortList:l.SortList,SourceId:l.SourceId,TrimDuplicates:l.TrimDuplicates}};case"Event":var p={listId:h.Guid.parse(this.properties.selectedListId),category:this.properties.selectedCategory,rowLimit:this._rowLimit,pageQuery:this._currentPageQuery,audienceTarget:n,orderBy:{field:"EventDate",direction:"Asc"},onServerResponseResolvedWithCache:this.setResponseAndRender,onServerResponseResolved:this.onServerResponseResolved,onServerResponseFailed:this.onServerResponseFailed,onCacheResponseResolved:this.renderedFromCacheData,onCacheResponseFailed:this.onCacheResponseFailed,webpartId:this.context.instanceId};if(Object(qe.e)()&&this.properties.showImage&&(p.cdnRewriteBannerUrl=!0),this.properties.isOnSeeAllPage||10===this.properties.dateRangeOption)return c.extend({},p,{startDate:this.properties.startDate,endDate:this.properties.endDate});if(0===this.properties.dateRangeOption)return p;var m=Object(y.s)(this.properties.dateRangeOption,this.context.pageContext),_=m[0],b=m[1];return c.extend({},p,{startDate:_,endDate:b})}},t.prototype.getDisplayFieldMap=function(e,t){return this._displayFieldMap},t.prototype.transposeRow=function(e,t,n){var a,i,r,o=this;this._usingListDataProvider()?(i=n.allDay,a=this.properties.selectedListId,r=this._webAbsoluteUrl):(i=n.isAllDayEvent,a=n.listId,r=n.webUrl);var s="Compact"===this.properties.layout||this._isMobileView,d=n.getAddToCalendarButtonProps||this._getAddToCalendarButtonProps(r,a,n.id);return this.displayMode!==h.DisplayMode.Read&&this.properties.audienceTarget||(n.containsAudiences=!1),c.extend({},n,{formatDate:function(e){return v.StringHelper.format(Ye.d,g.LocaleFormat.formatDate(e,{skeleton:"MMMEd"}),i?Ye.n:g.LocaleFormat.formatDate(e,{skeleton:o._preferTime24?"Hm":"hm"}))},getAddToCalendarButtonProps:d,isAllDayEvent:i,isCompactCard:s,listId:a,webUrl:r,endDate:n.endTime?new Date(n.endTime):void 0,getEmptyStateOptions:n.isEmptyStateCard?this._getEmptyStateOptions:void 0,showImage:this.properties.showImage,startDate:n.startTime?new Date(n.startTime):void 0})},t.prototype.getEmptyStateRows=function(e,t){var n={category:void 0,location:void 0,nextPageQuery:"",prevPageQuery:"",isEmptyStateCard:!0,getEmptyStateOptions:this._getEmptyStateOptions},a={category:Ye.o,isPlaceholderCard:!0,location:Ye.s,nextPageQuery:"",prevPageQuery:"",title:Ye.c,getAddToCalendarButtonProps:this._getAddToCalendarButtonProps(void 0,void 0,void 0)};return this._hasAddListItemsPermission?[n,a,a,a]:[n]},t.prototype.transposeItems=function(t,n,a){var i=this;if(this.response&&this.response[0]&&this.response[0].isEmptyStateCard){if(!Object(S.r)()&&this.properties.isSeeAllSubsequentChange){var r=v.StringHelper.formatWithLocalizedCountValue(Ye.y,Ye.S,0);l.ScreenReaderAlert.read(r,l.ReadingMode.ReadImmediately)}return this.getEmptyStateRows(t,n).map(function(e){return i.transposeRow(t,n,e)})}return!Object(S.r)()&&this.properties.isSeeAllSubsequentChange&&(r=v.StringHelper.formatWithLocalizedCountValue(Ye.y,Ye.S,a.length),l.ScreenReaderAlert.read(r,l.ReadingMode.ReadImmediately)),Object(qe.e)()&&this._logEventAndImageNumber(a),e.prototype.transposeItems.call(this,t,n,a)},t.prototype.loadPropertyPaneResources=function(){var e=this,t=Promise.all([n.e(2),n.e(0)]).then(n.bind(null,"ySbN")).then(function(t){e._getPropertyPaneConfiguration=t.EventsPropertyPane.getPropertyPaneConfiguration}),a=We.e.loadModule().then(function(t){e._sitesPickerModule=t}),i=[t];if(!this._checkSPHomeServicePromise){var r=this.context.serviceScope.consume(u.SPHomeHttpClient.serviceKey);this._checkSPHomeServicePromise=r.isServiceAvailable}return i.push(this._checkSPHomeServicePromise.then(function(t){if(e._isSPHomeServiceAvailable=t,t)return a;b._EngagementLogger.logEvent("EventsWebpart.SPHomeServiceNotAvailable")})),Promise.all(i).then(function(){})},t.prototype.getPropertyPaneConfiguration=function(){var e=this;this._propertyPaneRenderedOnce||(this._propertyPaneRenderedOnce=!0,this._eventsLists||this._eventsListDataProvider.getEventsLists().then(function(t){return e._eventsLists=t}).then(function(){return e.context.propertyPane.refresh()}).catch(function(e){s._TraceLogger.logError(t._logSource,e,"GetEventsLists")}),this._categories||this._refreshCategoryDropdownOnPropertyPane());var n={serviceScope:this.context.serviceScope};return this._getPropertyPaneConfiguration({eventsLists:this._eventsLists,selectedListId:this.properties.selectedListId,categories:this._categories,selectedCategory:this.properties.selectedCategory,dateRangeOption:this.properties.dateRangeOption,dataSource:this.properties.dataSource,hubSiteId:this.context.pageContext.legacyPageContext.hubSiteId,layout:this.properties.layout,propertyPaneLayoutOptions:this.propertyPaneLayoutOptions,hintMessageForLayout:this._propertyPaneLayoutHint,sites:this.properties.sites,isSPHomeServiceAvailable:!!this._isSPHomeServiceAvailable,sitesPickerDataProviderOptions:this._sitesPickerModule&&{sitesSearchDataProvider:new this._sitesPickerModule.SitesSearchDataProvider(n),sitesSPHomeDataProvider:new this._sitesPickerModule.SitesSPHomeDataProvider(n),enableMultiGeoSearch:this.context.pageContext.legacyPageContext.isMultiGeoTenant,enableHybridSearch:!1},datesPickerProps:10===this.properties.dateRangeOption?{firstDayOfWeek:y.a[Object(y.r)(this.context.pageContext)],startDate:Object(y.c)(this.properties.startDate),onSelectStartDate:this._handleSelectStartDate,endDate:Object(y.c)(this.properties.endDate),onSelectEndDate:this._handleSelectEndDate}:void 0})},t.prototype.onPropertyPaneFieldChanged=function(t,n,a){switch(this._currentPageNumber=1,this._messageView=void 0,t){case"dataSource":this._handleDataSourceChanged(a);break;case"selectedListId":this._refreshCategory(),this._listIdForAddingEvent=a;break;case"maxItemsPerPage":this.properties.maxItemsPerPage=this._convertMaxItemsPerPageToInteger(a);break;case"layout":this._currentPageQuery=void 0,this.setLayoutById(this._layoutId);break;case"dateRangeOption":if(!(10!==this.properties.dateRangeOption||this.properties.startDate&&this.properties.endDate)){var i=Object(y.t)(new Date,this.context.pageContext),r=new Date(i.toString());r.setDate(i.getDate()+30),this.properties.startDate=Object(y.o)(i),this.properties.endDate=Object(y.o)(r)}break;case"audienceTarget":b._EngagementLogger.logEvent(a?"EventsWebPart.AudienceTargetingToggle.Enable":"EventsWebPart.AudienceTargetingToggle.Disable");break;case"showImage":b._EngagementLogger.logEvent(a?"EventsWebPart.ShowEventImagesToggle.Enable":"EventsWebPart.ShowEventImagesToggle.Disable")}this._usingListDataProvider()&&this._configPermissionAndMessageView(),this.delayedGetDataAndRender(),l.ScreenReaderAlert.read(Ye.a,l.ReadingMode.ReadImmediately),e.prototype.onPropertyPaneFieldChanged.call(this,t,n,a)},t.prototype.onPropertyPaneConfigurationComplete=function(){e.prototype.onPropertyPaneConfigurationComplete.call(this);var n=new s._LogEntry("EventsWebPart","Properties",s._LogType.Event,{dataSource:String(this.properties.dataSource),dateRangeOption:String(this.properties.dateRangeOption),CustomDateRangeDuration:10===this.properties.dateRangeOption&&this.properties.startDate&&this.properties.endDate?String(t._getOffsetFromStartEndDate(this.properties.startDate,this.properties.endDate)):"not set",layoutId:String(this.properties.layoutId),maxItemsPerPage:String(this.properties.maxItemsPerPage),numberOfSelectedSites:this.properties.sites?String(this.properties.sites.length):"not set",isSetSelectedCategory:this.properties.selectedCategory?"true":"false"});b._EngagementLogger.logEventWithLogEntry(n)},t.prototype.onAfterResize=function(e){var t=this.width<=480;this._isMobileView!==t?(this._isMobileView=t,this.setLayoutById(this._layoutId),this.delayedGetDataAndRender()):this.render()},t.prototype.requestData=function(t){var n=this;return this.properties.dataSource===u.ContentLocation.SelectedSites&&this.properties.sites&&0===this.properties.sites.length?Promise.resolve(this.getEmptyStateRows(this.activeLayoutInfo.id,this.activeDataProviderInfo.id)):e.prototype.requestData.call(this,t).then(function(e){return!n.properties.isOnSeeAllPage&&e.length>0&&"Filmstrip"===n.properties.layout&&n.properties.layoutId===Xe?(n._cachedResponse=e,n._totalPagesNumber=Math.ceil(n._cachedResponse.length/4),n._currentPageEventItems=n._cachedResponse.slice(4*(n._currentPageNumber-1),4*n._currentPageNumber),n.setResponseAndRender(n._currentPageEventItems),n._currentPageEventItems):e})},t.prototype._getAddButtonOptions=function(){return{show:!this.properties.isOnSeeAllPage&&!h._BrowserUtilities.isMobileBrowser()&&this._canCreateInTeams,disabled:this.displayMode===h.DisplayMode.Edit||!this._hasAddListItemsPermission,href:this._addEventHref,label:Ye.t,ariaLabel:Ye.e,automationId:"eventsAddButton",onClick:function(){return b._EngagementLogger.logEvent("EventsWebpart.AddEventButton.Click")}}},Object.defineProperty(t.prototype,"accessibleTitle",{get:function(){return this.properties.title||Ye.l},enumerable:!1,configurable:!0}),t.prototype.renderError=function(t){var n,a,i=null===(a=null===(n=t.innerError)||void 0===n?void 0:n["odata.error"])||void 0===a?void 0:a.code,r=t.message;if(i&&-1!==i.indexOf("SearchServiceException")&&r&&-1!==r.indexOf("BadSearchResponse")){var s=this.getEmptyStateRows(this._layoutId,this.properties.dataProviderId);this._messageView={message:Ye.I,messageBarType:o.MessageBarType.error},this.setResponseAndRender(s)}else e.prototype.renderError.call(this,t)},t.prototype._handleDataSourceChanged=function(e){this._categories=void 0,this.properties.selectedCategory="",this.context.propertyPane.refresh(),e===u.ContentLocation.CurrentSiteEventsList?(this.setDataProviderById("Event"),this._refreshCategory(),this._shouldPrepareList&&(this._prepareList().catch(function(e){s._TraceLogger.logError(t._logSource,e,"PrepareListWhenDataSourceChanged")}),this._shouldPrepareList=!1)):this.setDataProviderById("Search")},t.prototype._shouldShowCreateEventCard=function(){return!(this.displayMode!==h.DisplayMode.Read||!this._listIdForAddingEvent||!this._hasAddListItemsPermission)},t.prototype._getSeeAllLinkOptions=function(){if(!this.properties.isOnSeeAllPage){var e=this._usingListDataProvider()?this._eventsListSeeAllPageUri:this._webPartInstanceSeeAllPageUri;if(10===this.properties.dateRangeOption)e.setQueryParameter("StartDate",this.properties.startDate),e.setQueryParameter("EndDate",this.properties.endDate);else if(0!==this.properties.dateRangeOption){var t=Object(y.s)(this.properties.dateRangeOption,this.context.pageContext),n=t[0],a=t[1];e.setQueryParameter("StartDate",n),e.setQueryParameter("EndDate",a)}this.properties.selectedCategory&&e.setQueryParameter("Category",encodeURIComponent(this.properties.selectedCategory)),e.setQueryParameter("AudienceTarget",String(this.properties.audienceTarget));var i=void 0;switch(this.properties.dataSource){case u.ContentLocation.CurrentSiteEventsList:i=Ye.P;break;case u.ContentLocation.CurrentSite:i=Ye.k;break;case u.ContentLocation.CurrentSiteCollection:i=Ye.M;break;case u.ContentLocation.AllSitesInTheHub:i=Ye.L;break;case u.ContentLocation.AllSites:i=Ye.A;break;case u.ContentLocation.SelectedSites:i=Ye.T;break;default:throw new Error("Unknown data source: ".concat(this.properties.dataSource))}return{show:!0,disabled:this.displayMode===h.DisplayMode.Edit||!this._hasViewListItemsPermission,href:e.toString(),ariaLabel:i,onClick:function(){return b._EngagementLogger.logEvent("EventsWebpart.SeeAllLink.Click")}}}},t.prototype._getPaginationProps=function(e){var t,n,a;if(!this.properties.isOnSeeAllPage&&"Compact"!==this.properties.layout)return t=this._currentPageNumber>1,n=this._currentPageNumber<this._totalPagesNumber,a=this._handlePaginationPageChange,Xe===e&&(t||n)?{hasPrevPage:t,hasNextPage:n,onPageChange:a,showPageNum:!1}:void 0},t.prototype._refreshCategoryDropdownOnPropertyPane=function(){var e=this;this._eventDataProvider.getInUsedCategories(h.Guid.parse(this.properties.selectedListId)).then(function(t){return e._categories=t}).then(function(){return e.context.propertyPane.refresh()}).catch(function(e){s._TraceLogger.logError(t._logSource,e,"RefreshCategoryDropdownOnPropertyPane")})},t.prototype._refreshCategory=function(){this._categories=void 0,this.properties.selectedCategory="",this.context.propertyPane.refresh(),this._refreshCategoryDropdownOnPropertyPane()},Object.defineProperty(t.prototype,"_layoutId",{get:function(){return this.properties.isOnSeeAllPage||"Compact"===this.properties.layout||this._isMobileView?Xe:Je},enumerable:!1,configurable:!0}),t.prototype._getEventCardProps=function(e,t){var n=this,a=Object(i.__assign)(Object(i.__assign)({},e),{width:this._isMobileView?this.width:t}),r=!(!a.getEmptyStateOptions||!this._hasAddListItemsPermission),o=this.displayMode===h.DisplayMode.Read&&(!!a.id||r);return a.onClick=o?function(e){return n._handleEventCardClick(a,e)}:void 0,a.serviceScope=this.context.serviceScope,a.showWebLink=this.properties.dataSource===u.ContentLocation.CurrentSiteCollection||this.properties.dataSource===u.ContentLocation.AllSites||this.properties.dataSource===u.ContentLocation.AllSitesInTheHub||this.properties.dataSource===u.ContentLocation.SelectedSites,a},Object.defineProperty(t.prototype,"_flexLayoutAriaLabel",{get:function(){return this.properties.isOnSeeAllPage?Ye.D:Object(S.u)()||this._isMobileView?this.displayMode===h.DisplayMode.Edit?Ye.h:Ye.b:this.displayMode===h.DisplayMode.Edit?Ye.m:Ye._},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_rowLimit",{get:function(){return this.properties.isOnSeeAllPage?void 0:this._maxItemsPerPage},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_maxItemsPerPage",{get:function(){return this.properties.isOnSeeAllPage?200:this.properties.maxItemsPerPage},enumerable:!1,configurable:!0}),t.prototype._prepareListAndRender=function(){var t=this;return this.properties.selectedListId?e.prototype.onInit.call(this).then(function(){t._startPermissionCheckAndRender()}):this._eventsListDataProvider.ensureEventsList().then(function(e){t.properties.selectedListId=e.Id,t._listIdForAddingEvent=e.Id}).then(function(){return e.prototype.onInit.call(t)}).then(function(){t._startPermissionCheckAndRender()}).then(this.delayedGetDataAndRender)},t.prototype._prepareList=function(){var e=this;return this.properties.selectedListId?this._checkSelectedListPermission():this._eventsListDataProvider.ensureEventsList().then(function(t){e.properties.selectedListId=t.Id,e._listIdForAddingEvent=t.Id}).then(this._checkSelectedListPermission)},t.prototype._startPermissionCheckAndRender=function(){this._checkSelectedListPermission().then(this.render).catch(function(e){s._TraceLogger.logError(t._logSource,e,"CheckSelectedListPermissionAndRender")})},t.prototype._parsePermission=function(e){e&&(this._hasAddListItemsPermission=e.hasPermission(d.SPPermission.addListItems),this._hasViewListItemsPermission=e.hasPermission(d.SPPermission.viewListItems))},Object.defineProperty(t.prototype,"_addEventHref",{get:function(){var e=new v.Uri("".concat(this._webAbsoluteUrl,"/_layouts/15/Event.aspx"));return e.setQueryParameter("ListGuid",this._listIdForAddingEvent),e.setQueryParameter("Mode","Edit"),e.toString()},enumerable:!1,configurable:!0}),t.prototype._handleEventCardClick=function(e,t){var n;if(e.getEmptyStateOptions)null==t||t.stopPropagation(),h._BrowserUtilities.isMobileBrowser()||(n=this._addEventHref,this.properties.isOnSeeAllPage?b._EngagementLogger.logEvent("EventsSeeAllPage.CreateEventCard.Click"):b._EngagementLogger.logEvent("EventsWebpart.CreateEventCard.Click"));else if("BUTTON"!==(null==t?void 0:t.target).tagName.toUpperCase()){null==t||t.stopPropagation(),n=e.webUrl?"".concat(e.webUrl,"/_layouts/15/Event.aspx?ListGuid=").concat(e.listId,"&ItemId=").concat(e.id):"";var a=this.properties.isOnSeeAllPage?"EventsSeeAllPage.EventCard":"EventsWebpart.EventCard";b._EngagementLogger.logEventWithLogEntry(new s._LogEntry(a,"Click",s._LogType.Event,{dataSource:String(this.properties.dataSource)}))}if(n){var i=document.createElement("a");i.setAttribute("href",n),this.domElement.appendChild(i),i.click(),this.domElement.removeChild(i)}},t.prototype._getEmptyStateCardTitle=function(){return this.displayMode===h.DisplayMode.Read&&this._hasAddListItemsPermission&&this._canCreateInTeams?Ye.r:10===this.properties.dateRangeOption?Ye.w:Ye.O},t.prototype._getEmptyStateCardDescription=function(){return this.displayMode===h.DisplayMode.Read?this._hasAddListItemsPermission?Ye.i:Ye.C:Ye.x},t.prototype._getAddToCalendarButtonProps=function(e,t,n){var a=this;if(e&&t&&n&&!h._BrowserUtilities.isMobileBrowser())return function(){return{onClick:function(i){i.stopPropagation(),b._EngagementLogger.logEventWithLogEntry(new s._LogEntry("EventsWebpart.AddToCalendarButton","Click",s._LogType.Event,{isSameDomain:String(a._getHost(e)===a._getHost(a._webAbsoluteUrl))})),a._addToCalendar(e,t,n)}}}},t.prototype._addToCalendar=function(e,n,a){var i=this;this._eventDataProvider.requestUTCEventItem(e,h.Guid.parse(n),a).then(function(e){var t={id:e.id,name:e.title,location:e.location,startDate:e.startTime,endDate:e.endTime,categories:Array.isArray(e.category)?e.category:[e.category],bodyContent:i._formatICSDescription(e.linkUrl,e.description,e.linkName),allDayInfo:e.isAllDayEvent?{timezone:Object(y.d)(i.context.pageContext),allDayFormat:"Inclusive"}:void 0};return l.IcsFileGenerator.GenerateIcsFileAsync(t)}).catch(function(e){s._TraceLogger.logError(t._logSource,e,"AddEventToCalendar")})},t.prototype._formatICSDescription=function(e,t,n){var a=e?'<a href="'.concat(e,'">')+'<span style="font-size:16.0pt;color:#0066CC">'+"".concat(n)+"</span></a>":"";return"".concat(a).concat(t||"")},Object.defineProperty(t.prototype,"_useMySiteCache",{get:function(){return!this.properties.isOnSeeAllPage},enumerable:!1,configurable:!0}),t.prototype.loadEventDataProvider=function(e){return Promise.resolve(new f.EventDataProvider(e))},t.prototype.loadEventsSearchDataProvider=function(e){return Promise.resolve(new f.EventsSearchDataProvider(e))},t.prototype._buildSearchQuery=function(){var e,t=Object(y.d)(this.context.pageContext);if(this.properties.isOnSeeAllPage||10===this.properties.dateRangeOption)e=[{fieldname:"EventsRollUpEndDate ",filterType:u.FilterType.Field,op:u.FilterOperator.GreaterThanOrEqualTo,value:Object(y.n)(this.properties.startDate,t)},{fieldname:"EventsRollUpStartDate",filterType:u.FilterType.Field,op:u.FilterOperator.LessThan,value:Object(y.n)(Object(y.e)(this.properties.endDate),t)}];else if(0===this.properties.dateRangeOption){var n=(new Date).toISOString();e=[{fieldname:"EventsRollUpEndDate",filterType:u.FilterType.Field,op:u.FilterOperator.GreaterThanOrEqualTo,value:n}]}else{n=(new Date).toISOString();var a=Object(y.s)(this.properties.dateRangeOption,this.context.pageContext)[1],i=Object(y.n)(Object(y.e)(a),t);e=[{fieldname:"EventsRollUpEndDate",filterType:u.FilterType.Field,op:u.FilterOperator.GreaterThanOrEqualTo,value:n},{fieldname:"EventsRollUpStartDate",filterType:u.FilterType.Field,op:u.FilterOperator.LessThan,value:i}]}S.e.isActivated()&&this.properties.selectedCategory&&e.push({fieldname:"EventsRollUpCategory",filterType:u.FilterType.Field,op:u.FilterOperator.Equals,value:Object(u.sanitizeSearchQueryParameter)(this.properties.selectedCategory)}),e.push({fieldname:"IsExternalContent",filterType:u.FilterType.Field,op:u.FilterOperator.Equals,value:"false"});var r={filters:e,logicalOperator:"AND"};return{contentLocation:this.properties.dataSource,contentTypes:[u.ContentType.Event],filterGroup:r,sortField:"EventsRollUpStartDate",sortType:u.SortType.FieldAscending}},t.prototype._shouldEnableMultiGeoSearch=function(){var e=this;return this.context.pageContext.legacyPageContext.isMultiGeoTenant&&(this.properties.dataSource===u.ContentLocation.AllSites||this.properties.dataSource===u.ContentLocation.AllSitesInTheHub||this.properties.dataSource===u.ContentLocation.SelectedSites&&this.properties.sites.some(function(t){return e._getHost(t.Url)!==e._getHost(e.pageContext.web.absoluteUrl)}))},t.prototype._getHost=function(e){return e&&new v.Uri(e).getHost()},t.prototype._usingListDataProvider=function(){return"Event"===this.activeDataProviderInfo.id},t.prototype._configPermissionAndMessageView=function(){this._hasViewListItemsPermission=!0,this._messageView=void 0},t.prototype._convertMaxItemsPerPageToInteger=function(e){return parseInt(e.toString(),10)},Object.defineProperty(t.prototype,"_seeAllPageBaseUri",{get:function(){return"".concat(this._webAbsoluteUrl,"/_layouts/15/Events.aspx")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_webPartInstanceSeeAllPageUri",{get:function(){var e=new v.Uri(this._seeAllPageBaseUri);return e.setQueryParameter("Page",window.location.pathname),e.setQueryParameter("InstanceId",this.context.instanceId),e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_eventsListSeeAllPageUri",{get:function(){var e=new v.Uri(this._seeAllPageBaseUri);return e.setQueryParameter("ListGuid",this.properties.selectedListId),e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_propertyPaneLayoutHint",{get:function(){return"Filmstrip"===this.properties.layout?Ye.E:""},enumerable:!1,configurable:!0}),t.prototype._ensureDefaultDataSource=function(){!this.context.pageContext.legacyPageContext.isHubSite||this.properties.isOnSeeAllPage||this._renderedFromPersistedData||(this.properties.dataSource=u.ContentLocation.AllSitesInTheHub),this.properties.dataSource!==u.ContentLocation.AllSitesInTheHub||this.context.pageContext.legacyPageContext.hubSiteId||(this.properties.dataSource=u.ContentLocation.CurrentSiteEventsList),Object(S.s)()||this.properties.dataSource||(this.properties.dataSource=u.ContentLocation.CurrentSiteEventsList)},t.prototype._logEventAndImageNumber=function(e){var t=e.reduce(function(e,t){return t.bannerUrl&&"https://none"!==t.bannerUrl?e+1:e},0),n=new s._LogEntry("EventsWebPart","Properties",s._LogType.Event,{fluentEventNumber:String(e.length),fluentEventImageNumber:String(t)});b._EngagementLogger.logEventWithLogEntry(n)},Object.defineProperty(t.prototype,"_canCreateInTeams",{get:function(){return!h._BrowserUtilities.isEmbedded()},enumerable:!1,configurable:!0}),t._logSource=s._LogSource.create("EventsWebPart"),t}(p.BaseCollectionWebPart);t.default=$e},w0FV:function(e,t){e.exports=I},y88i:function(e,t){e.exports=x},zY5M:function(e,t){e.exports=C}})});