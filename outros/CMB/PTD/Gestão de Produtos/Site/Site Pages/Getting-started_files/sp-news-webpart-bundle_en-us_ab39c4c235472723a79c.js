define("8c88f208-6c77-4bdb-86a0-0c47b4316588_1.0.0",["tslib","@ms/sp-telemetry","@microsoft/sp-loader","@ms/odsp-core-bundle","@microsoft/office-ui-fabric-react-bundle","@ms/sp-news-data-provider","@microsoft/sp-lodash-subset","@ms/sp-dataproviders","@ms/sp-webpart-shared","@microsoft/sp-core-library","@microsoft/sp-page-context","@ms/i18n-utilities","react","react-dom","@ms/sp-component-utilities","@microsoft/load-themed-styles","@ms/sp-rich-image","@microsoft/sp-diagnostics","@ms/odsp-utilities-bundle"],function(n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y){return function(e){function t(t){for(var n,i,r=t[0],o=t[1],s=0,c=[];s<r.length;s++)i=r[s],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&c.push(a[i][0]),a[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(d&&d(t);c.length;)c.shift()()}var n={},a={5:0};function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.e=function(t){for(var n=[],o=function(e){var t={i:"22f2362e-b1b6-4aa8-8a0f-89bf3a9682fb",v:"0.1.0",m:"34g2"},n={i:"fa4155f6-2498-4a20-8406-5cb3b385b142",v:"0.5.0",m:"qjmy"};return{4:[t],6:[n],0:[t,{i:"05ed6956-59ad-4aa6-9e4e-b832c96ae87b",v:"0.8.0",m:"ytfe"},{i:"f9e737b7-f0df-4597-ba8c-3060f82380db",v:"1.16.0",m:"26ea"},{i:"6da60671-741f-47c5-b35b-5078edaf312f",v:"0.1.0",m:"bXd7"}],2:[n,{i:"974a7777-0990-4136-8fa6-95d80114c2e0",v:"1.16.0",m:"br4S"},{i:"c79b9f88-6338-40fb-b463-3aad22a88b15",v:"0.1.0",m:"9poL"}],1:[t]}[e]||[]}(t),s=0;s<o.length;s++)e[o[s].m]||function(t){n.push(r.SPComponentLoader.loadComponentById(t.i,t.v).then(function(n){e[t.m]=function(e){e.exports=n}}))}(o[s]);var c=a[t];if(0!==c)if(c)n.push(c[2]);else{var d=new Promise(function(e,n){c=a[t]=[e,n]});n.push(c[2]=d);var l,u=document.createElement("script");u.charset="utf-8",u.timeout=120,i.nc&&u.setAttribute("nonce",i.nc),u.src=function(e){return i.p+"chunk."+({0:"newswebpart-news-pinning-panel~newswebpar~1486f810",1:"newswebpart-news-pinning-panel",2:"newswebpart-property-pane-configuration",4:"sp-news-digest-layout",6:"sp-news-webpart-edit",7:"sp-news-webpart-seeall",10:"vendors~newswebpart-news-pinning-panel",11:"vendors~sp-news-webpart-seeall"}[e]||e)+"_"+(["en-us","none"])[{"0":1,"1":1,"2":0,"4":1,"6":1,"7":1,"10":1,"11":1}[e]]+"_"+{0:"8ba3f2ed40a13c9878fb",1:"98284e4bc38b5c0d7f0a",2:"56745e237857a86a1e6e",4:"eb8385640977937f1e6b",6:"7161ef37c60b3ece7c1a",7:"d9a5d193f74475acb587",10:"6ae6c3ab1cd8a9d41ed5",11:"1082432021358fed4849"}[e]+".js"}(t),0!==u.src.indexOf(window.location.origin+"/")&&(u.crossOrigin="anonymous");var f=new Error;l=function(e){u.onerror=u.onload=null,clearTimeout(p);var n=a[t];if(0!==n){if(n){var i=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;f.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",f.name="ChunkLoadError",f.type=i,f.request=r,n[1](f)}a[t]=void 0}};var p=setTimeout(function(){l({type:"timeout",target:u})},12e4);u.onerror=u.onload=l,document.head.appendChild(u)}return Promise.all(n)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var r=i("I6O9");i.oe=function(e){throw console.error(e),e};var o=window.webpackJsonpa1755d29515a50b0273334bcce93d764=window.webpackJsonpa1755d29515a50b0273334bcce93d764||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var d=s;return function(){var e,t=document.getElementsByTagName("script"),n="undefined"!=typeof spScriptNamePattern?spScriptNamePattern:/sp-news-webpart-bundle_en-us_ab39c4c235472723a79c\.js/i;if(t&&t.length)for(var a=0;a<t.length;a++)if(t[a]){var r=t[a].getAttribute("src");if(r&&r.match(n)){e=r.substring(0,r.lastIndexOf("/")+1);break}}if(!e)for(var o in window.__setWebpackPublicPathLoaderSrcRegistry__)if(o&&o.match(n)){e=o.substring(0,o.lastIndexOf("/")+1);break}i.p=e}(),i(i.s="ZfdM")}({"17wl":function(e,t){e.exports=n},"2q6Q":function(e,t){e.exports=a},"4h6m":function(e,t,n){"use strict";n("jOlS").loadStyles('.x_f_91bed31b{color:"[theme:neutralLight, default: #edebe9]";margin-bottom:20px;padding-bottom:20px}.x_f_91bed31b .e_f_91bed31b{width:100%}.y_f_91bed31b{display:flex;flex-direction:row}.z_f_91bed31b .aa_f_91bed31b{padding-bottom:16px;margin-bottom:16px}[dir=ltr] .z_f_91bed31b .aa_f_91bed31b{padding-right:16px}[dir=rtl] .z_f_91bed31b .aa_f_91bed31b{padding-left:16px}.ab_f_91bed31b .aa_f_91bed31b{padding-bottom:14px;margin-bottom:20px}[dir=ltr] .ab_f_91bed31b .aa_f_91bed31b{padding-right:20px}[dir=rtl] .ab_f_91bed31b .aa_f_91bed31b{padding-left:20px}.ac_f_91bed31b .x_f_91bed31b{margin-bottom:32px;padding-bottom:32px}.ac_f_91bed31b .aa_f_91bed31b{padding-bottom:18px;margin-bottom:24px}[dir=ltr] .ac_f_91bed31b .aa_f_91bed31b{padding-right:24px}[dir=rtl] .ac_f_91bed31b .aa_f_91bed31b{padding-left:24px}.ae_f_91bed31b{padding-right:30px}.af_f_91bed31b,.ab_f_91bed31b,.z_f_91bed31b{content:none}.ag_f_91bed31b{color:#333}',!0),t.e={itemArea:"x_f_91bed31b",item:"e_f_91bed31b",itemAreaFlex:"y_f_91bed31b",listNewsLayout__small:"z_f_91bed31b",compactItemArea:"aa_f_91bed31b",listNewsLayout__medium:"ab_f_91bed31b",listNewsLayout__large:"ac_f_91bed31b",checkbox:"ae_f_91bed31b",listNewsLayout:"af_f_91bed31b",iconArea:"ag_f_91bed31b"}},"6X2r":function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n("ut3N"),i="News",r=function(){function e(){}return e.logNewsEngagement=function(t){var n,r,o,s,c,d,l,u,f,p=t.component,m=t.extraData,_=t.isIntentional,h=void 0===_||_,b=t.item,g=t.layoutId,v=t.logTag,y=t.pageType,S=t.usageType,D=void 0===S?"Click":S,I=t.workload;b&&(n=e._getArticleTypeLabel(b.isHelpArticle),r=b.uniqueId,o=b.siteId,s=b.webId,c=b.listId,d=b.listItemId,l=b.publishedOn.toString(),u=b.uniqueId,f=b.url);var x={name:"".concat(i).concat(n||"",".").concat(v,".").concat(D),feature:i,component:p,isIntentional:h},C=t.siteType;I&&!C&&(C=e._getSiteTypeFromWorkload(I)),x.extraData=m||{},r&&(x.extraData.pageId=r),y&&(x.extraData.pageType=y),g&&(x.extraData.layoutId=g),c&&(x.extraData.newsListId=c),d&&(x.extraData.newsListItemId=d),l&&(x.extraData.newsPublishedDate=l),o&&(x.extraData.newsSiteId=o),C&&(x.extraData.siteType=C),u&&(x.extraData.uniqueId=u),f&&(x.extraData.newsUrl=f),D&&(x.extraData.usageType=D),I&&(x.extraData.siteType=I),s&&(x.extraData.newsWebId=s),a._EngagementLogger.log(x)},e._getSiteTypeFromWorkload=function(e){switch(e.substr(e.lastIndexOf(".")+1)){case"CommSite":return"CommunicationSite";case"TeamSite":return"TeamSite";case"GroupSite":return"GroupSite";case"PublishingSite":return"PublishingSite";default:return}},e._getArticleTypeLabel=function(e){return e?"HelpArticle":""},e}()},"7yaZ":function(e,t,n){"use strict";n.d(t,"t",function(){return s}),n.d(t,"e",function(){return c});var a=n("17wl"),i=n("cDcd"),r=n("I6O9"),o=n("hiL/"),s=function(){function e(){}return e.loadModule=function(){return e._loadedModulePromise||(e._loadedModulePromise=r.SPComponentLoader.loadComponentById(e.heroComponentId)),e._loadedModulePromise},e.loadHeroLayout=function(){return e.loadModule().then(function(e){return e.HeroPattern})},e.heroComponentId="9586b262-54de-4b27-9eb9-34c671400c33",Object(a.__decorate)([Object(o.monitor)("News.loadHeroLayout")],e,"loadHeroLayout",null),e}(),c=i.lazy(function(){return s.loadHeroLayout().then(function(e){return{default:e}})})},"84oY":function(e,t,n){"use strict";var a=n("17wl"),i=n("cDcd"),r=n("y88i"),o=n("KL1q"),s=n("UWqr"),c=n("Pk8u"),d=n("hiL/"),l=n("OZbH"),u=n("lgTv"),f=n("ox9S"),p=n("ZQz3"),m=n("NTtI"),_=n("Vm5Y"),h=n("4h6m"),b=n("IGle"),g=n("i5pg"),v=n("h4zy"),y=function(e){function t(n){var a,l,m=e.call(this,n)||this;m._breakpointValues=((a={})[d.BREAKPOINT_SIZE.SM]={maxWidth:575,className:h.e.listNewsLayout__small,newsItemSize:1},a[d.BREAKPOINT_SIZE.MD]={maxWidth:750,className:h.e.listNewsLayout__medium,newsItemSize:2},a[d.BREAKPOINT_SIZE.LG]={maxWidth:999999,className:h.e.listNewsLayout__large,newsItemSize:3},a),m._checkboxes=[],m._isInnerZoneKeyStroke=function(e){return e.which===o.KeyCodes.right||e.which===o.KeyCodes.left},m._getItemCountForPage=function(e,t){return 7},m._onRenderCell=function(e,t){var n,a=m.props,l=a.allowInfiniteScrolling,p=a.compactMode,_=a.items,b=a.infiniteScrollCallback,v=a.itemCountOnInfiniteScroll,y=a.locale,S=!(e&&e.isHelpArticle);_.length-1===t&&!Object(c.isEqual)(m._lastItem,e)&&(Object(g.d)()||m._requestScrollAtIndexRendered<=t)&&S&&l&&b&&(m._lastItem=e,m._requestScrollAtIndexRendered+=v,b());var D=r.StringHelper.format(f.y,e.title,r.StringHelper.format(f.b,e.author,u.i._getFormattedDate(e.publishedOnRelativeTime,e.publishedOn,y)),""===e.description?f._:r.StringHelper.format(f.t,e.description)),I=p&&m.getCurrentBreakpoint()===d.BREAKPOINT_SIZE.SM,x=m.props,C=x.displayMode,O=x.emphasisTheme,w=x.isEligibleForCssTextTruncate,E=x.logClickEvent,A=x.onImageRender,L=x.pageContext,k=x.serviceScope,M=x.showNewsMetadata,P=x.width,T=x.workload,U={isDisabled:(e.isContributorActionCard||e.isHelpArticle)&&C===s.DisplayMode.Edit,displayMode:C,isEligibleForCssTextTruncate:w,isFeatured:!1,isLoading:!1,index:t,layout:m._layout,locale:y,newsItem:Object(c.cloneDeep)(e),logClickEvent:E,onImageRender:A,pageContext:L,serviceScope:k,shouldHideDescription:I,showNewsMetadata:M,size:m._breakpointValues[m.getCurrentBreakpoint()].newsItemSize,theme:O,workload:T,webpartWidth:P},F=i.createElement(p?u.e:u.a,U),H=i.createElement("div",{className:Object(o.css)(h.e.item,m._classNames.item)},F);return i.createElement("div",{className:Object(o.css)(h.e.itemArea,m._classNames.itemArea,(n={},n[h.e.compactItemArea]=p,n[h.e.itemAreaFlex]=1===m.state.viewMode,n)),tabIndex:0,"data-is-focusable":!0,key:m._getKey(t+1),role:"presentation","aria-label":1===m.state.viewMode?D:"",onKeyDown:m._handleKeyDownOnSelectableNewsItem(e,t)},m._getCheckBoxElement(e,t),i.createElement(o.FocusZone,{direction:o.FocusZoneDirection.horizontal,isCircularNavigation:!0},H))},m._renderItems=function(e,t){var n=[];t=Math.min(t,e.length);for(var a=0;a<t;a++)n.push(m._onRenderCell(e[a],a));return n},m._handleSelectedNewsItem=function(e,t){e?m._selectedItems.push(t):m._selectedItems.splice(m._selectedItems.indexOf(t),1),t.isSelected=e},m._handleKeyDownOnSelectableNewsItem=function(e,t){return function(n){var a,i;n.which===o.KeyCodes.enter&&(1===m.state.viewMode?(null===(i=null===(a=m._checkboxes[t])||void 0===a?void 0:a.current)||void 0===i||i.toggle(),n.stopPropagation()):m._handleKeyDownReadMode(e))}},m._createNewsDigestEventHandler=function(e){m._selectedItems=[];var t=m.props.digestModeCallback;t&&t(),m._createCheckBoxRef(),m.setState({isSelectingItems:!0,viewMode:1})},m._continueNewsDigestCreationEventHandler=function(e){m._selectedItems&&m._selectedItems.length>0&&s._SPEventManager.instance.raiseEvent(t.completeNewsDigestCreationCustomEventName,{detail:m._selectedItems})},m._cancelNewsDigestEventHandler=function(e){m.props.items.forEach(function(e){return e.isSelected=!1}),m._selectedItems=[];var t=m.props.switchOutOfDigestModeCallback;t&&t(),m.setState({isSelectingItems:!1,viewMode:0})},m._layout=p.e.getLayoutId(m._layoutType),m._requestScrollAtIndexRendered=n.itemCountOnInfiniteScroll-1,m._responsiveUI=new d.ResponsiveUI,m._responsiveUI.screenBreakpoints=((l={})[m._breakpointValues[d.BREAKPOINT_SIZE.SM].maxWidth]=d.BREAKPOINT_SIZE.SM,l[m._breakpointValues[d.BREAKPOINT_SIZE.MD].maxWidth]=d.BREAKPOINT_SIZE.MD,l[m._breakpointValues[d.BREAKPOINT_SIZE.LG].maxWidth]=d.BREAKPOINT_SIZE.LG,l);var _=m.props,b=_.items,v=_.showCheckboxes;m._selectedItems=[],b.map(function(e){e.isSelected=!1}),v&&m._createCheckBoxRef();var y=p.e.getCurrentElementBreakpoint(m._responsiveUI,n.width);m.state={currentBreakpoint:y,isSelectingItems:v,viewMode:0};var S=m._getNumberOfItems();return m._initializeImages(S>7?7:S),m}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"_classNames",{get:function(){var e=this.props.emphasisTheme;return b.e.getClassNames({root:"FeaturedNewsLayout",theme:e})},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){this._isMounted=!0,this._resizeComponent(this.props.width),this._addEventListeners(),s._SPEventManager.instance.raiseEvent(t.completeListNewsRenderCustomEventName,{})},t.prototype.componentWillUnmount=function(){this._isMounted=!1,this._removeEventListeners()},t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.props.width!==e.width&&this._resizeComponent(e.width)},t.prototype.getCurrentBreakpoint=function(){return this.state.currentBreakpoint?this.state.currentBreakpoint:d.BREAKPOINT_SIZE.SM},t.prototype.render=function(){return this.renderLayout(1===this._layoutType)},t.prototype.renderLayout=function(e){var t=f.p,n="listNewsLayout";return e||(t=f.v,n="digestNewsLayout"),i.createElement("div",{"aria-label":t,className:Object(o.css)("listNewsLayout",h.e.listNewsLayout,this._breakpointValues[this.getCurrentBreakpoint()].className),"data-automation-id":n},this._renderNewsContent())},Object.defineProperty(t.prototype,"_layoutType",{get:function(){return 1},enumerable:!1,configurable:!0}),t.prototype._addEventListeners=function(){var e=this.props.registerEvent;e(t.startNewsDigestCreationCustomEventName,this._createNewsDigestEventHandler),e(t.continueNewsDigestCreationCustomEventName,this._continueNewsDigestCreationEventHandler),e(t.cancelNewsDigestCustomEventName,this._cancelNewsDigestEventHandler)},t.prototype._removeEventListeners=function(){var e=this.props.unregisterEvent;e(t.startNewsDigestCreationCustomEventName,this._createNewsDigestEventHandler),e(t.continueNewsDigestCreationCustomEventName,this._continueNewsDigestCreationEventHandler),e(t.cancelNewsDigestCustomEventName,this._cancelNewsDigestEventHandler)},t.prototype._renderNewsContent=function(){var e=this.props,t=e.items,n=e.showAddButton,a=e.totalItemsToRender,r=v.e.isNewsCommonCustomerPromiseEnabled()?this._getNewsItems():n?t:m.e.filterOutContributorActionCard(t),s=v.e.isNewsCommonCustomerPromiseEnabled()?this._getNumberOfItems():a===Number.MAX_VALUE?r.length:a,c=i.createElement("div",{role:l.NewsUtilities.isOnSeeAllPage?void 0:"list"},1!==this._layoutType||l.NewsUtilities.isOnSeeAllPage?i.createElement(o.List,{key:this.state.viewMode,items:r,getItemCountForPage:this._getItemCountForPage,renderedWindowsAhead:1,renderedWindowsBehind:1,renderCount:s,onRenderCell:this._onRenderCell,role:l.NewsUtilities.isOnSeeAllPage?"list":void 0}):this._renderItems(r,s));return i.createElement(o.FocusZone,{direction:o.FocusZoneDirection.vertical,isCircularNavigation:!0,isInnerZoneKeystroke:this._isInnerZoneKeyStroke},c)},t.prototype._resizeComponent=function(e){var t=this._responsiveUI.getCurrentElementBreakpoint(e);this.state.currentBreakpoint!==t&&this._isMounted&&this.setState({currentBreakpoint:t})},t.prototype._getKey=function(e){var t=this.props,n=t.compactMode,a=t.items;if(a[e]){var i="_".concat(n);return l.NewsUtilities.getNewsItemKey(a[e],e.toString())+i}return e.toString()},t.prototype._getNewsItems=function(){var e=this.props,t=e.items;return e.showAddButton?t:m.e.filterOutContributorActionCard(t)},t.prototype._getNumberOfItems=function(){var e=this.props.totalItemsToRender,t=this._getNewsItems();return e===Number.MAX_VALUE?t.length:e},t.prototype._initializeImages=function(e){v.e.isNewsCommonCustomerPromiseEnabled()&&m.e.initializeImages(this.props.items,this.props.initializeImages,e)},t.prototype._getCheckBoxElement=function(e,t){return this.state.isSelectingItems?i.createElement(_.e,{ref:this._checkboxes[t],defaultChecked:e.isSelected,item:e,onChange:this._handleSelectedNewsItem}):void 0},t.prototype._handleKeyDownReadMode=function(e){this.props.displayMode!==s.DisplayMode.Edit&&postMessage("router://".concat(e.url),location.origin)},t.prototype._createCheckBoxRef=function(){for(var e=Math.min(this.props.totalItemsToRender,this.props.items.length),t=0;t<e;t++)this._checkboxes[t]=i.createRef()},t.startNewsDigestCreationCustomEventName="NewsDigestCreation",t.continueNewsDigestCreationCustomEventName="ContinueNewsDigestCreation",t.completeNewsDigestCreationCustomEventName="CompleteNewsDigestCreation",t.cancelNewsDigestCustomEventName="CancelNewsDigestCreation",t.completeListNewsRenderCustomEventName="CompleteListNewsRender",t}(o.BaseComponent);t.e=y},"8zjT":function(e){e.exports=JSON.parse('{"t":"{0} views||{0} view||{0} views","e":"0||1||2-"}')},F2ap:function(e,t,n){"use strict";n("jOlS").loadStyles('.cy_l_91bed31b,.cz_l_91bed31b{height:100%;box-sizing:border-box;overflow:hidden;position:relative}.cz_l_91bed31b:not(.cy_l_91bed31b){display:flex}.ea_l_91bed31b:not(.eb_l_91bed31b).ec_l_91bed31b{min-height:96px}.ea_l_91bed31b:not(.eb_l_91bed31b).ee_l_91bed31b{min-width:112px}.ea_l_91bed31b:not(.eb_l_91bed31b).ef_l_91bed31b{min-height:156px}.cy_l_91bed31b{flex-direction:column}[dir=ltr] .cy_l_91bed31b .eg_l_91bed31b{margin-right:0}[dir=rtl] .cy_l_91bed31b .eg_l_91bed31b{margin-left:0}.cy_l_91bed31b .eh_l_91bed31b,.cy_l_91bed31b .ei_l_91bed31b{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;margin-bottom:1px}.cy_l_91bed31b .eh_l_91bed31b{font-size:12px}.cy_l_91bed31b .ei_l_91bed31b:not(.b_l_91bed31b){font-size:15px;font-weight:600}.cy_l_91bed31b .ei_l_91bed31b.b_l_91bed31b{font-size:"[theme:mediumFontSize, default: 14px]";font-weight:"[theme:mediumFontWeight, default: 400]";font-weight:600}.ej_l_91bed31b{padding-top:3px}.ek_l_91bed31b .ei_l_91bed31b{height:2.8em;white-space:normal}.ek_l_91bed31b .ei_l_91bed31b.b_l_91bed31b{font-size:"[theme:mediumFontSize, default: 14px]";font-weight:"[theme:mediumFontWeight, default: 400]";font-weight:600}.ek_l_91bed31b .el_l_91bed31b,.ek_l_91bed31b .em_l_91bed31b{width:100%;padding-top:56.1%;position:relative}.ek_l_91bed31b .en_l_91bed31b,.ek_l_91bed31b .eg_l_91bed31b{position:absolute;top:0;bottom:0}[dir=ltr] .ek_l_91bed31b .en_l_91bed31b,[dir=ltr] .ek_l_91bed31b .eg_l_91bed31b{left:0}[dir=ltr] .ek_l_91bed31b .en_l_91bed31b,[dir=ltr] .ek_l_91bed31b .eg_l_91bed31b,[dir=rtl] .ek_l_91bed31b .en_l_91bed31b,[dir=rtl] .ek_l_91bed31b .eg_l_91bed31b{right:0}[dir=rtl] .ek_l_91bed31b .en_l_91bed31b,[dir=rtl] .ek_l_91bed31b .eg_l_91bed31b{left:0}.ek_l_91bed31b .eg_l_91bed31b{border:0;width:100%}[dir=ltr] .ek_l_91bed31b .eg_l_91bed31b{margin-right:0}[dir=rtl] .ek_l_91bed31b .eg_l_91bed31b{margin-left:0}.ek_l_91bed31b .en_l_91bed31b{display:flex;align-items:center;justify-content:center;flex:0 1 auto}.ek_l_91bed31b.eo_l_91bed31b .ei_l_91bed31b{height:auto}.ek_l_91bed31b.ep_l_91bed31b .el_l_91bed31b,.ek_l_91bed31b.ep_l_91bed31b .em_l_91bed31b{padding-top:42.7%}.ek_l_91bed31b.eq_l_91bed31b .el_l_91bed31b,.ek_l_91bed31b.eq_l_91bed31b .em_l_91bed31b{padding-top:56.1%}.er_l_91bed31b{font-size:64px;color:"[theme:white, default: #ffffff]"}.es_l_91bed31b{padding:7px 10px 10px}.et_l_91bed31b:not(.eb_l_91bed31b):not(.b_l_91bed31b){padding:20px}.et_l_91bed31b:not(.eb_l_91bed31b):not(.b_l_91bed31b).ef_l_91bed31b{padding:34px}.et_l_91bed31b:not(.eb_l_91bed31b):not(.b_l_91bed31b).eu_l_91bed31b{padding:40px}.et_l_91bed31b:not(.eb_l_91bed31b):not(.b_l_91bed31b).ev_l_91bed31b{padding:48px}.ee_l_91bed31b.et_l_91bed31b.eb_l_91bed31b,.ef_l_91bed31b.et_l_91bed31b.eb_l_91bed31b,.eu_l_91bed31b.et_l_91bed31b.eb_l_91bed31b,.ev_l_91bed31b.et_l_91bed31b.eb_l_91bed31b,.ch_l_91bed31b{flex-direction:column}.ch_l_91bed31b{display:flex;flex-basis:0;flex-grow:1;justify-content:space-between;margin-bottom:-6px;margin-top:-2px;max-width:100%;overflow:hidden}.ew_l_91bed31b{color:"[theme:white, default: #ffffff]";text-decoration:none;font-size:16px;display:flex;align-items:center}.ex_l_91bed31b{font-size:14px}.ey_l_91bed31b{margin-left:10px;height:12px}.ez_l_91bed31b{overflow:"hidden";text-overflow:ellipsis;white-space:nowrap}.fa_l_91bed31b{margin-top:3px;padding-bottom:4px}.fa_l_91bed31b.b_l_91bed31b{font-size:"[theme:mediumFontSize, default: 14px]";font-weight:"[theme:mediumFontWeight, default: 400]";font-weight:600}.ee_l_91bed31b.et_l_91bed31b.eb_l_91bed31b .ch_l_91bed31b,.ef_l_91bed31b.et_l_91bed31b.eb_l_91bed31b .ch_l_91bed31b,.eu_l_91bed31b.et_l_91bed31b.eb_l_91bed31b .ch_l_91bed31b,.ev_l_91bed31b.et_l_91bed31b.eb_l_91bed31b .ch_l_91bed31b{flex-basis:auto}.ei_l_91bed31b{display:block;text-decoration:none;word-break:break-word;width:calc(100% - 2px)}[dir=ltr] .ei_l_91bed31b{margin-left:1px}[dir=rtl] .ei_l_91bed31b{margin-right:1px}[dir=ltr] .ei_l_91bed31b{margin-right:-1px}[dir=rtl] .ei_l_91bed31b{margin-left:-1px}.ei_l_91bed31b.b_l_91bed31b{font-weight:600}.ec_l_91bed31b .ei_l_91bed31b:not(.b_l_91bed31b),.fb_l_91bed31b .ei_l_91bed31b:not(.b_l_91bed31b){font-size:15px}.ec_l_91bed31b .ei_l_91bed31b.b_l_91bed31b,.fb_l_91bed31b .ei_l_91bed31b.b_l_91bed31b{font-size:"[theme:mediumPlusFontSize, default: 16px]";font-weight:"[theme:mediumPlusFontWeight, default: 400]";font-weight:600}.et_l_91bed31b.ee_l_91bed31b .ei_l_91bed31b:not(.b_l_91bed31b),.et_l_91bed31b.ef_l_91bed31b .ei_l_91bed31b:not(.b_l_91bed31b),.et_l_91bed31b.eu_l_91bed31b .ei_l_91bed31b:not(.b_l_91bed31b){font-size:17px;font-weight:400}.et_l_91bed31b.ee_l_91bed31b .ei_l_91bed31b.b_l_91bed31b,.et_l_91bed31b.ef_l_91bed31b .ei_l_91bed31b.b_l_91bed31b,.et_l_91bed31b.eu_l_91bed31b .ei_l_91bed31b.b_l_91bed31b{font-size:"[theme:largeFontSize, default: 18px]";font-weight:"[theme:largeFontWeight, default: 400]";font-weight:600}.ef_l_91bed31b .ei_l_91bed31b:not(.b_l_91bed31b),.eu_l_91bed31b .ei_l_91bed31b:not(.b_l_91bed31b){font-size:21px;font-weight:300}.ef_l_91bed31b .ei_l_91bed31b.b_l_91bed31b,.eu_l_91bed31b .ei_l_91bed31b.b_l_91bed31b{font-size:"[theme:xLargeFontSize, default: 20px]";font-weight:"[theme:xLargeFontWeight, default: 600]"}.ef_l_91bed31b .fc_l_91bed31b.b_l_91bed31b{font-size:"[theme:mediumPlusFontSize, default: 16px]";font-weight:"[theme:mediumPlusFontWeight, default: 400]"}[dir=ltr] .ev_l_91bed31b.fe_l_91bed31b .eg_l_91bed31b{margin-right:40px}[dir=rtl] .ev_l_91bed31b.fe_l_91bed31b .eg_l_91bed31b{margin-left:40px}.ev_l_91bed31b.fe_l_91bed31b .fc_l_91bed31b{line-height:1.5}.ev_l_91bed31b.fe_l_91bed31b .fc_l_91bed31b:not(.b_l_91bed31b){font-size:17px}.ev_l_91bed31b.fe_l_91bed31b .fc_l_91bed31b.b_l_91bed31b{font-size:"[theme:largeFontSize, default: 18px]";font-weight:"[theme:largeFontWeight, default: 400]"}.ev_l_91bed31b .ei_l_91bed31b:not(.b_l_91bed31b){font-size:21px}.ev_l_91bed31b .ei_l_91bed31b.b_l_91bed31b{font-size:"[theme:xLargeFontSize, default: 20px]";font-weight:"[theme:xLargeFontWeight, default: 600]"}.ev_l_91bed31b:not(.et_l_91bed31b) .ei_l_91bed31b{font-size:28px}.ev_l_91bed31b:not(.et_l_91bed31b) .ei_l_91bed31b:not(.b_l_91bed31b){font-weight:300}.fb_l_91bed31b .ei_l_91bed31b{margin-bottom:8px}.ff_l_91bed31b{font-size:16px;line-height:22px}.ec_l_91bed31b .ei_l_91bed31b{margin-bottom:2px}.ec_l_91bed31b .ff_l_91bed31b{font-size:14px;line-height:20px}.ec_l_91bed31b.et_l_91bed31b.eb_l_91bed31b .ei_l_91bed31b:not(.b_l_91bed31b){font-weight:600}.ee_l_91bed31b .ei_l_91bed31b{margin-bottom:4px}.ee_l_91bed31b .ei_l_91bed31b:not(.b_l_91bed31b){font-size:17px;font-weight:400}.ee_l_91bed31b .ei_l_91bed31b.b_l_91bed31b{font-size:"[theme:mediumPlusFontSize, default: 16px]";font-weight:"[theme:mediumPlusFontWeight, default: 400]";font-weight:600}.ee_l_91bed31b .fg_l_91bed31b{font-size:14px;line-height:18px}.ee_l_91bed31b .fc_l_91bed31b.b_l_91bed31b{font-size:"[theme:mediumFontSize, default: 14px]";font-weight:"[theme:mediumFontWeight, default: 400]"}.ef_l_91bed31b.et_l_91bed31b:not(.eb_l_91bed31b) .ei_l_91bed31b{margin-bottom:20px;padding-bottom:20px}.ef_l_91bed31b .ff_l_91bed31b{font-size:20px;line-height:26px}.ef_l_91bed31b .fg_l_91bed31b{font-size:16px;line-height:22px}.ef_l_91bed31b .ei_l_91bed31b,.eu_l_91bed31b .ei_l_91bed31b,.ev_l_91bed31b .ei_l_91bed31b{margin-bottom:8px}.eu_l_91bed31b.et_l_91bed31b:not(.eb_l_91bed31b) .ei_l_91bed31b,.ev_l_91bed31b.et_l_91bed31b:not(.eb_l_91bed31b) .ei_l_91bed31b{margin-bottom:24px;padding-bottom:24px}.eu_l_91bed31b.et_l_91bed31b:not(.eb_l_91bed31b) .ei_l_91bed31b:not(.b_l_91bed31b),.ev_l_91bed31b.et_l_91bed31b:not(.eb_l_91bed31b) .ei_l_91bed31b:not(.b_l_91bed31b){font-weight:300}.eu_l_91bed31b.et_l_91bed31b.eb_l_91bed31b .ch_l_91bed31b{justify-content:flex-start}.eu_l_91bed31b.et_l_91bed31b:not(.eb_l_91bed31b) .ei_l_91bed31b:not(.b_l_91bed31b){font-size:21px}.eu_l_91bed31b.et_l_91bed31b:not(.eb_l_91bed31b) .ei_l_91bed31b.b_l_91bed31b{font-size:"[theme:xLargeFontSize, default: 20px]";font-weight:"[theme:xLargeFontWeight, default: 600]"}.ev_l_91bed31b.et_l_91bed31b:not(.eb_l_91bed31b) .ei_l_91bed31b{font-size:24px}.ec_l_91bed31b .eg_l_91bed31b{height:96px;width:128px}.ee_l_91bed31b .eg_l_91bed31b{height:112px}.ee_l_91bed31b:not(.et_l_91bed31b) .eg_l_91bed31b{width:196px}.ef_l_91bed31b .eg_l_91bed31b{height:156px}.ef_l_91bed31b:not(.et_l_91bed31b) .eg_l_91bed31b{width:276px}.eu_l_91bed31b .eg_l_91bed31b{height:214px}.eu_l_91bed31b:not(.et_l_91bed31b) .eg_l_91bed31b{width:378px}.ev_l_91bed31b .eg_l_91bed31b{height:264px}.ev_l_91bed31b:not(.et_l_91bed31b) .eg_l_91bed31b{width:482px}.ef_l_91bed31b.et_l_91bed31b:not(.eb_l_91bed31b) .ei_l_91bed31b,.eu_l_91bed31b.et_l_91bed31b:not(.eb_l_91bed31b) .ei_l_91bed31b,.ev_l_91bed31b.et_l_91bed31b:not(.eb_l_91bed31b) .ei_l_91bed31b{position:relative}.ef_l_91bed31b.et_l_91bed31b:not(.eb_l_91bed31b) .ei_l_91bed31b:after,.eu_l_91bed31b.et_l_91bed31b:not(.eb_l_91bed31b) .ei_l_91bed31b:after,.ev_l_91bed31b.et_l_91bed31b:not(.eb_l_91bed31b) .ei_l_91bed31b:after{bottom:0;content:"";height:2px;position:absolute;width:48px}[dir=ltr] .ef_l_91bed31b.et_l_91bed31b:not(.eb_l_91bed31b) .ei_l_91bed31b:after,[dir=ltr] .eu_l_91bed31b.et_l_91bed31b:not(.eb_l_91bed31b) .ei_l_91bed31b:after,[dir=ltr] .ev_l_91bed31b.et_l_91bed31b:not(.eb_l_91bed31b) .ei_l_91bed31b:after{left:0}[dir=rtl] .ef_l_91bed31b.et_l_91bed31b:not(.eb_l_91bed31b) .ei_l_91bed31b:after,[dir=rtl] .eu_l_91bed31b.et_l_91bed31b:not(.eb_l_91bed31b) .ei_l_91bed31b:after,[dir=rtl] .ev_l_91bed31b.et_l_91bed31b:not(.eb_l_91bed31b) .ei_l_91bed31b:after{right:0}.fc_l_91bed31b{width:100%;line-height:1.4;word-break:break-word}.fc_l_91bed31b:not(.b_l_91bed31b){font-size:15px}.fc_l_91bed31b.b_l_91bed31b{font-size:"[theme:mediumPlusFontSize, default: 16px]";font-weight:"[theme:mediumPlusFontWeight, default: 400]"}.ec_l_91bed31b .fc_l_91bed31b{font-size:14px}.ee_l_91bed31b.et_l_91bed31b:not(.eb_l_91bed31b) .fc_l_91bed31b,.ec_l_91bed31b.et_l_91bed31b:not(.eb_l_91bed31b) .fc_l_91bed31b{margin-bottom:16px}.ef_l_91bed31b.et_l_91bed31b:not(.eb_l_91bed31b) .fc_l_91bed31b{padding-bottom:20px}.eu_l_91bed31b.et_l_91bed31b:not(.eb_l_91bed31b) .fc_l_91bed31b,.ev_l_91bed31b.et_l_91bed31b:not(.eb_l_91bed31b) .fc_l_91bed31b{padding-bottom:24px}.ef_l_91bed31b.et_l_91bed31b:not(.eb_l_91bed31b) .fc_l_91bed31b{font-size:14px}.ev_l_91bed31b.et_l_91bed31b:not(.eb_l_91bed31b) .fc_l_91bed31b{line-height:1.5}.ev_l_91bed31b.et_l_91bed31b:not(.eb_l_91bed31b) .fc_l_91bed31b:not(.b_l_91bed31b){font-size:17px}.ev_l_91bed31b.et_l_91bed31b:not(.eb_l_91bed31b) .fc_l_91bed31b.b_l_91bed31b{font-size:"[theme:largeFontSize, default: 18px]";font-weight:"[theme:largeFontWeight, default: 400]"}.ev_l_91bed31b.et_l_91bed31b.eb_l_91bed31b .fc_l_91bed31b.b_l_91bed31b{font-size:"[theme:mediumPlusFontSize, default: 16px]";font-weight:"[theme:mediumPlusFontWeight, default: 400]"}.fh_l_91bed31b{display:none}.fi_l_91bed31b{align-items:flex-start;display:flex;flex-grow:1;padding-top:10px;padding-bottom:6px}.eg_l_91bed31b{-webkit-print-color-adjust:exact;align-self:flex-start;border-style:solid;border-width:1px;box-sizing:border-box;flex-shrink:0}[dir=ltr] .eg_l_91bed31b{margin-right:20px}[dir=rtl] .eg_l_91bed31b{margin-left:20px}.ee_l_91bed31b.et_l_91bed31b .eg_l_91bed31b,.ef_l_91bed31b.et_l_91bed31b .eg_l_91bed31b,.eu_l_91bed31b.et_l_91bed31b .eg_l_91bed31b,.ev_l_91bed31b.et_l_91bed31b .eg_l_91bed31b{margin-bottom:16px;width:100%}[dir=ltr] .ee_l_91bed31b.et_l_91bed31b .eg_l_91bed31b,[dir=ltr] .ef_l_91bed31b.et_l_91bed31b .eg_l_91bed31b,[dir=ltr] .eu_l_91bed31b.et_l_91bed31b .eg_l_91bed31b,[dir=ltr] .ev_l_91bed31b.et_l_91bed31b .eg_l_91bed31b{margin-right:0}[dir=rtl] .ee_l_91bed31b.et_l_91bed31b .eg_l_91bed31b,[dir=rtl] .ef_l_91bed31b.et_l_91bed31b .eg_l_91bed31b,[dir=rtl] .eu_l_91bed31b.et_l_91bed31b .eg_l_91bed31b,[dir=rtl] .ev_l_91bed31b.et_l_91bed31b .eg_l_91bed31b{margin-left:0}[dir=ltr] .ef_l_91bed31b .eg_l_91bed31b,[dir=ltr] .eu_l_91bed31b .eg_l_91bed31b,[dir=ltr] .ev_l_91bed31b .eg_l_91bed31b{margin-right:28px}[dir=rtl] .ef_l_91bed31b .eg_l_91bed31b,[dir=rtl] .eu_l_91bed31b .eg_l_91bed31b,[dir=rtl] .ev_l_91bed31b .eg_l_91bed31b{margin-left:28px}.eb_l_91bed31b .fj_l_91bed31b{text-decoration:none}.eb_l_91bed31b .fj_l_91bed31b:focus{text-decoration:underline overline}.fk_l_91bed31b{height:100%;width:100%}.fl_l_91bed31b{align-items:center;background:"[theme:themePrimary, default: #0078d4]";color:"[theme:white, default: #ffffff]";display:flex;flex-direction:column;height:100%;justify-content:center}.fm_l_91bed31b{font-size:28px;margin-bottom:12px}.fn_l_91bed31b{align-items:center;display:flex}[dir=ltr] .fo_l_91bed31b{margin-right:8px}[dir=rtl] .fo_l_91bed31b{margin-left:8px}.eh_l_91bed31b{width:100%;display:inline-block;line-height:1.4;text-decoration:none;word-break:break-word;font-size:12px;margin-bottom:2px;font-weight:600;border-radius:2px}[dir=ltr] .eh_l_91bed31b{padding-left:8px}[dir=ltr] .eh_l_91bed31b,[dir=rtl] .eh_l_91bed31b{padding-right:8px}[dir=rtl] .eh_l_91bed31b{padding-left:8px}[dir=ltr] .fp_l_91bed31b{margin-left:-8px}[dir=rtl] .fp_l_91bed31b{margin-right:-8px}.fq_l_91bed31b{background:"[theme:neutralLighter, default: #f3f2f1]";color:"[theme:neutralPrimary, default: #323130]"}.fr_l_91bed31b .eg_l_91bed31b{min-height:340px;height:340px;width:100%;background-color:"[theme:themePrimary, default: #0078d4]"}.fr_l_91bed31b .ch_l_91bed31b{position:absolute;bottom:0;padding-bottom:28px;z-index:1}[dir=ltr] .fr_l_91bed31b .ch_l_91bed31b{left:0}[dir=rtl] .fr_l_91bed31b .ch_l_91bed31b{right:0}[dir=ltr] .fr_l_91bed31b .ch_l_91bed31b{padding-left:24px}[dir=rtl] .fr_l_91bed31b .ch_l_91bed31b{padding-right:24px}.fr_l_91bed31b .ch_l_91bed31b .ei_l_91bed31b{color:#fff;width:100%;text-decoration:none;word-break:break-word}.fr_l_91bed31b .ch_l_91bed31b .ei_l_91bed31b.b_l_91bed31b{font-size:"[theme:xLargePlusFontSize, default: 24px]";font-weight:"[theme:xLargePlusFontWeight, default: 600]"}.fr_l_91bed31b .ch_l_91bed31b .ei_l_91bed31b.b_l_91bed31b.fs_l_91bed31b{font-size:"[theme:xxLargePlusFontSize, default: 32px]";font-weight:"[theme:xxLargePlusFontWeight, default: 600]"}.fr_l_91bed31b .ch_l_91bed31b .ei_l_91bed31b:not(.b_l_91bed31b){font-size:28px!important}.fr_l_91bed31b .ft_l_91bed31b{background-color:transparent;background-image:linear-gradient(180deg,transparent 15%,rgba(0,0,0,.7));position:absolute;top:0;bottom:0;padding:28px;pointer-events:none}[dir=ltr] .fr_l_91bed31b .ft_l_91bed31b{left:0}[dir=ltr] .fr_l_91bed31b .ft_l_91bed31b,[dir=rtl] .fr_l_91bed31b .ft_l_91bed31b{right:0}[dir=rtl] .fr_l_91bed31b .ft_l_91bed31b{left:0}.fu_l_91bed31b .eg_l_91bed31b,.fv_l_91bed31b .eg_l_91bed31b,.fw_l_91bed31b .eg_l_91bed31b,.fx_l_91bed31b .eg_l_91bed31b{border:0;background-color:"[theme:themePrimary, default: #0078d4]";flex:1 1 auto;margin:0}.fu_l_91bed31b .ch_l_91bed31b,.fv_l_91bed31b .ch_l_91bed31b,.fw_l_91bed31b .ch_l_91bed31b,.fx_l_91bed31b .ch_l_91bed31b{position:absolute;bottom:0;z-index:1;box-sizing:border-box}[dir=ltr] .fu_l_91bed31b .ch_l_91bed31b,[dir=ltr] .fv_l_91bed31b .ch_l_91bed31b,[dir=ltr] .fw_l_91bed31b .ch_l_91bed31b,[dir=ltr] .fx_l_91bed31b .ch_l_91bed31b{left:0}[dir=rtl] .fu_l_91bed31b .ch_l_91bed31b,[dir=rtl] .fv_l_91bed31b .ch_l_91bed31b,[dir=rtl] .fw_l_91bed31b .ch_l_91bed31b,[dir=rtl] .fx_l_91bed31b .ch_l_91bed31b{right:0}.fu_l_91bed31b .ch_l_91bed31b.b_l_91bed31b,.fv_l_91bed31b .ch_l_91bed31b.b_l_91bed31b,.fw_l_91bed31b .ch_l_91bed31b.b_l_91bed31b,.fx_l_91bed31b .ch_l_91bed31b.b_l_91bed31b{padding-bottom:20px}.fu_l_91bed31b .ch_l_91bed31b .ei_l_91bed31b,.fv_l_91bed31b .ch_l_91bed31b .ei_l_91bed31b,.fw_l_91bed31b .ch_l_91bed31b .ei_l_91bed31b,.fx_l_91bed31b .ch_l_91bed31b .ei_l_91bed31b{color:#fff;width:100%;text-decoration:none;word-break:break-word;text-overflow:ellipsis}.fu_l_91bed31b .ch_l_91bed31b .ei_l_91bed31b:not(.b_l_91bed31b),.fv_l_91bed31b .ch_l_91bed31b .ei_l_91bed31b:not(.b_l_91bed31b),.fw_l_91bed31b .ch_l_91bed31b .ei_l_91bed31b:not(.b_l_91bed31b),.fx_l_91bed31b .ch_l_91bed31b .ei_l_91bed31b:not(.b_l_91bed31b){font-weight:600}.fu_l_91bed31b .ft_l_91bed31b,.fv_l_91bed31b .ft_l_91bed31b,.fw_l_91bed31b .ft_l_91bed31b,.fx_l_91bed31b .ft_l_91bed31b{background-color:transparent;background-image:linear-gradient(180deg,transparent 15%,rgba(0,0,0,.7));position:absolute;top:0;bottom:0;pointer-events:none}[dir=ltr] .fu_l_91bed31b .ft_l_91bed31b,[dir=ltr] .fv_l_91bed31b .ft_l_91bed31b,[dir=ltr] .fw_l_91bed31b .ft_l_91bed31b,[dir=ltr] .fx_l_91bed31b .ft_l_91bed31b{left:0}[dir=ltr] .fu_l_91bed31b .ft_l_91bed31b,[dir=ltr] .fv_l_91bed31b .ft_l_91bed31b,[dir=ltr] .fw_l_91bed31b .ft_l_91bed31b,[dir=ltr] .fx_l_91bed31b .ft_l_91bed31b,[dir=rtl] .fu_l_91bed31b .ft_l_91bed31b,[dir=rtl] .fv_l_91bed31b .ft_l_91bed31b,[dir=rtl] .fw_l_91bed31b .ft_l_91bed31b,[dir=rtl] .fx_l_91bed31b .ft_l_91bed31b{right:0}[dir=rtl] .fu_l_91bed31b .ft_l_91bed31b,[dir=rtl] .fv_l_91bed31b .ft_l_91bed31b,[dir=rtl] .fw_l_91bed31b .ft_l_91bed31b,[dir=rtl] .fx_l_91bed31b .ft_l_91bed31b{left:0}.fu_l_91bed31b:not(.eb_l_91bed31b) .ch_l_91bed31b:not(.b_l_91bed31b),.fv_l_91bed31b:not(.eb_l_91bed31b) .ch_l_91bed31b:not(.b_l_91bed31b),.fw_l_91bed31b:not(.eb_l_91bed31b) .ch_l_91bed31b:not(.b_l_91bed31b),.fx_l_91bed31b:not(.eb_l_91bed31b) .ch_l_91bed31b:not(.b_l_91bed31b){top:45%}[dir=ltr] .fv_l_91bed31b .ch_l_91bed31b{padding-left:32px}[dir=ltr] .fv_l_91bed31b .ch_l_91bed31b,[dir=rtl] .fv_l_91bed31b .ch_l_91bed31b{padding-right:32px}[dir=rtl] .fv_l_91bed31b .ch_l_91bed31b{padding-left:32px}.fv_l_91bed31b .ch_l_91bed31b:not(.b_l_91bed31b){padding-bottom:36px}.fv_l_91bed31b .ch_l_91bed31b .ei_l_91bed31b{font-size:32px}[dir=ltr] .fw_l_91bed31b .ch_l_91bed31b{padding-left:32px}[dir=ltr] .fw_l_91bed31b .ch_l_91bed31b,[dir=rtl] .fw_l_91bed31b .ch_l_91bed31b{padding-right:32px}[dir=rtl] .fw_l_91bed31b .ch_l_91bed31b{padding-left:32px}.fw_l_91bed31b .ch_l_91bed31b:not(.b_l_91bed31b){padding-bottom:36px}.fw_l_91bed31b .ch_l_91bed31b .ei_l_91bed31b{font-size:28px}[dir=ltr] .fu_l_91bed31b .ch_l_91bed31b{padding-left:24px}[dir=ltr] .fu_l_91bed31b .ch_l_91bed31b,[dir=rtl] .fu_l_91bed31b .ch_l_91bed31b{padding-right:24px}[dir=rtl] .fu_l_91bed31b .ch_l_91bed31b{padding-left:24px}.fu_l_91bed31b .ch_l_91bed31b:not(.b_l_91bed31b){padding-bottom:32px}.fu_l_91bed31b .ch_l_91bed31b .ei_l_91bed31b:not(.b_l_91bed31b){font-size:20px}.fu_l_91bed31b .ch_l_91bed31b .ei_l_91bed31b.b_l_91bed31b{font-size:"[theme:xLargeFontSize, default: 20px]";font-weight:"[theme:xLargeFontWeight, default: 600]"}[dir=ltr] .fx_l_91bed31b .ch_l_91bed31b{padding-left:24px}[dir=ltr] .fx_l_91bed31b .ch_l_91bed31b,[dir=rtl] .fx_l_91bed31b .ch_l_91bed31b{padding-right:24px}[dir=rtl] .fx_l_91bed31b .ch_l_91bed31b{padding-left:24px}.fx_l_91bed31b .ch_l_91bed31b:not(.b_l_91bed31b){padding-bottom:32px}.fx_l_91bed31b .ch_l_91bed31b .ei_l_91bed31b:not(.b_l_91bed31b){font-size:18px}.fx_l_91bed31b .ch_l_91bed31b .ei_l_91bed31b.b_l_91bed31b{font-size:"[theme:largeFontSize, default: 18px]";font-weight:"[theme:largeFontWeight, default: 400]";font-weight:600}.fy_l_91bed31b .ei_l_91bed31b:not(.b_l_91bed31b){font-size:15px!important;font-weight:400}.fy_l_91bed31b .ei_l_91bed31b.b_l_91bed31b{font-size:16px!important}.fz_l_91bed31b{overflow:hidden}.ga_l_91bed31b{-webkit-line-clamp:2}.gb_l_91bed31b,.ga_l_91bed31b{display:-webkit-box;-webkit-box-orient:vertical;overflow:hidden}.gb_l_91bed31b{margin-bottom:6px;-webkit-line-clamp:1}.gc_l_91bed31b{margin-bottom:16px}',!0),t.e={newsHubItem:"cy_l_91bed31b",newsItem:"cz_l_91bed31b",newsItem__listLayout:"ea_l_91bed31b",newsItem__hasImage:"eb_l_91bed31b",newsItem__medium:"ec_l_91bed31b",newsItem__large:"ee_l_91bed31b",newsItem__xLarge:"ef_l_91bed31b",imageArea:"eg_l_91bed31b",text_siteLink:"eh_l_91bed31b",text_title:"ei_l_91bed31b",fluent:"b_l_91bed31b",text_siteLinkAlign:"ej_l_91bed31b",newsHubItem__featured:"ek_l_91bed31b",hubItemImagePlaceholderContainer:"el_l_91bed31b",imageAreaContainer:"em_l_91bed31b",hubItemImagePlaceholder:"en_l_91bed31b",newsHubItem__oneItemFeatured:"eo_l_91bed31b",newsHubItem__twoItemFeatured:"ep_l_91bed31b",newsHubItem__ThreeItemFeatured:"eq_l_91bed31b",hubPlaceholderIcon:"er_l_91bed31b",hubNewsItemInfo:"es_l_91bed31b",newsItem__featured:"et_l_91bed31b",newsItem__xXLarge:"eu_l_91bed31b",newsItem__xXXLarge:"ev_l_91bed31b",text:"ch_l_91bed31b",callToAction:"ew_l_91bed31b",callToActionMdTile:"ex_l_91bed31b",callToActionIcon:"ey_l_91bed31b",textIEStyle:"ez_l_91bed31b",textListLayoutTitle:"fa_l_91bed31b",newsItem__small:"fb_l_91bed31b",text_description:"fc_l_91bed31b",newsItem__singleItem:"fe_l_91bed31b",compact_text_title:"ff_l_91bed31b",compact_text_description:"fg_l_91bed31b",text_description__hidden:"fh_l_91bed31b",text_addNewsWrapper:"fi_l_91bed31b",imageArea_link:"fj_l_91bed31b",imageArea_image:"fk_l_91bed31b",contributorActionCard:"fl_l_91bed31b",contributorActionCard_icon:"fm_l_91bed31b",contributorActionCard_text:"fn_l_91bed31b",contributorActionCard_text_icon:"fo_l_91bed31b",text_siteTitle:"fp_l_91bed31b",contributorActionCard__disabled:"fq_l_91bed31b",newsItem__carousel:"fr_l_91bed31b",xxLargePlusFont:"fs_l_91bed31b",content:"ft_l_91bed31b",newsItem__heroDoubleTile:"fu_l_91bed31b",newsItem__heroFullScreen:"fv_l_91bed31b",newsItem__heroHalfScreen:"fw_l_91bed31b",newsItem__heroTile:"fx_l_91bed31b",newsItem__compactFeatured:"fy_l_91bed31b",objectFitCoverIE11:"fz_l_91bed31b",truncateTitleText:"ga_l_91bed31b",truncateDescription:"gb_l_91bed31b",featuredNewsDescription:"gc_l_91bed31b"}},I6O9:function(e,t){e.exports=i},IGle:function(e,t,n){"use strict";var a=n("KL1q"),i=Object(a.classNamesFunction)(),r=function(){function e(){}return e.getClassNames=function(t){return function(e,t){return i(e,t)}(e._getStyles,t)},e._getStyles=function(e){var t=e.theme,n=Object(a.getTheme)(),i=!!(!n.isInverted&&t.isInverted||n.isInverted&&!t.isInverted),r=i?t:n,o=i?t.semanticColors.bodyStandoutBackground:n.semanticColors.bodyStandoutBackground,s=i?n.semanticColors.primaryButtonBackgroundHovered:n.semanticColors.primaryButtonBackground,c=i?n.semanticColors.primaryButtonTextHovered:n.semanticColors.primaryButtonText;return{nonFeatured:["nonFeatured",{backgroundColor:o,borderColor:t.semanticColors.variantBorder,selectors:{"& a":{color:r.semanticColors.actionLink}}}],nonFeaturedBorder:["nonFeaturedBorder",{borderColor:r.semanticColors.bodyDivider}],newsItem__featured:["newsItem__featured",{selectors:{"&:not(.hasImage)":{backgroundColor:o,border:"1px solid "+t.semanticColors.variantBorder}}}],hubItemImagePlaceholderContainer:[{backgroundColor:s,color:c}],hubNewsLayout__small:[{selectors:{"& .nonFeatured":{backgroundColor:"transparent"},"& .nonFeaturedBorder":{borderColor:t.semanticColors.bodyDivider}}}],itemArea:[{borderBottom:"1px solid"+t.semanticColors.bodyDivider}],item:[{borderBottom:"1px solid"+t.semanticColors.bodyDivider,selectors:{"& .hasImage .ms-NewsPinningItemImage":{backgroundColor:t.semanticColors.bodyStandoutBackground,borderColor:t.semanticColors.variantBorder},".nonFeatured &":{borderBottom:"0 none"},".listNewsLayout &":{borderBottom:"0 none"},".hubNewsLayout_featured & ":{backgroundColor:n.semanticColors.bodyBackground,border:"1px solid"+t.semanticColors.variantBorder,boxShadow:n.effects.elevation4,borderRadius:n.effects.roundedCorner2},".hubNewsLayout_featured &:hover ":{boxShadow:n.effects.elevation8}}}],orgNews:["orgNews",{textTransform:"uppercase",padding:"2px 8px",verticalAlign:"middle",backgroundColor:t.semanticColors.primaryButtonBackground,selectors:{".text_siteLink&":{display:"inline",color:t.semanticColors.primaryButtonText},"&:hover":{backgroundColor:t.semanticColors.primaryButtonBackgroundHovered,color:t.semanticColors.primaryButtonText}}}],socialActionItem:[{color:t.semanticColors.bodySubtext,selectors:{span:{color:t.semanticColors.bodySubtext},".newsItem__featured:not(.hasImage) & span":{color:r.semanticColors.bodySubtext},".hubNewsLayout_featured & span":{color:n.semanticColors.bodySubtext}}}],text_siteLink:["text_siteLink",{color:t.semanticColors.link,selectors:{".nonFeatured &:not(.orgNews)":{color:r.semanticColors.link},".featuredNewsLayout &:not(.orgNews)":{color:t.semanticColors.link},".hubNewsLayout_featured &:not(.orgNews)":{color:n.semanticColors.link}}}],aTag_siteLink:[{selectors:{":hover":{color:void 0}}}],text_title:[{color:t.semanticColors.actionLink,selectors:{".newsItem__featured:not(.hasImage) &":{color:r.semanticColors.actionLink},".newsItem__featured:not(.hasImage) &:after":{backgroundColor:r.semanticColors.link},".hubNewsLayout_featured &":{color:n.semanticColors.actionLink}}}],text_description:[{color:t.semanticColors.bodySubtext,selectors:{".newsItem__featured:not(.hasImage) &":{color:r.semanticColors.bodySubtext}}}],author:[{color:t.semanticColors.bodyText,selectors:{".newsItem__featured:not(.hasImage) &":{color:r.semanticColors.bodyText},".hubNewsLayout_featured &":{color:n.semanticColors.bodyText}}}],date:[{color:t.semanticColors.bodySubtext,selectors:{".newsItem__featured:not(.hasImage) &":{color:r.semanticColors.bodySubtext},".hubNewsLayout_featured &":{color:n.semanticColors.bodySubtext}}}],views:[{color:t.semanticColors.bodySubtext,selectors:{span:{color:t.semanticColors.bodySubtext},".newsItem__featured:not(.hasImage) & span":{color:r.semanticColors.bodySubtext},".hubNewsLayout_featured & span":{color:n.semanticColors.bodySubtext}}}],carousel:[{selectors:{"& .ms-NewsPinningItemImage":{borderColor:t.semanticColors.variantBorder}}}],imageArea:[{backgroundColor:o,borderColor:t.semanticColors.variantBorder}],pinnedItem:[{selectors:{span:{div:{selectors:{span:{color:t.semanticColors.bodyText}}}},div:{button:{color:r.palette.themePrimary}}}}],pinnedNewsItemBuffer:[{selectors:{span:{div:{selectors:{span:{color:r.palette.neutralSecondary}}}},div:{button:{color:r.palette.themePrimary}}}}],calloutMain:[{div:{selectors:{p:{color:r.semanticColors.bodyText}}}}],iconContainer:[{selectors:{i:{color:t.palette.accent}}}]}},e}();t.e=r},K9kD:function(e,t){e.exports=r},KEk8:function(e){e.exports=JSON.parse('{"K":"News","t":"Add","e":"Add news","_":"Learn more","h":"\\u0022Learn more about News webpart","b":"Show news on your page by choosing a news source, layout, and content options.","z":"See all","V":"See all news","H":"Layout","T":"Automatically cycle news","U":"Seconds between each change of news posts","g":"News Source","v":"Select a news source","i":"This site","l":"All sites in the hub","n":"Select sites","B":"Recommended for current user","S":"View all news posts and create a news digest","y":"Choose posts to include in your news digest","D":"Number of news posts to show","a":"Show compact view","c":"Show compact view in narrow widths","G":"Show title and commands","W":"Show author","q":"Show first published date","Q":"Show number of views","w":"News post","I":"News link","C":"Organize","r":"Remove news post from ordered list","k":"Select and order news","L":"News order","A":"Select news to organize","R":"Recent news from your selected news sources","N":"Recent news from across your organization","j":"Search all news","M":"Move or drag a news post to the position you want in the News order column.","P":"We couldn\\u0027t find what you\\u0027re looking for here.","u":"Use ctrl + right arrow to move items to the News order column. Use left and right arrows for additional actions on the item.","f":"Use ctrl + up arrow or ctrl + down arrow to reorder items. Use left and right arrows for additional actions on the item.","o":"Use ctrl + right arrow to move items to the News order column.","s":"Use ctrl + up arrow or ctrl + down arrow to reorder items.","E":"Items below item {0} will not be shown. Adjust layout type or number of items to show in your current layout to show more.","p":"Item moved.","m":"Item removed.","x":"Reorder your news by dragging the posts into the position you want. Positions not used will automatically be filled with posts based on how recent they are.","d":"Hide this web part if there\\u0027s nothing to show","F":"Show call to action","O":"Close"}')},KL1q:function(e,t){e.exports=o},NTtI:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=function(){function e(){}return e.filterOutContributorActionCard=function(e){return e&&e.filter(function(e){return!e.isContributorActionCard})},e.initializeImages=function(e,t,n){t(e.slice(0,n).filter(function(e){return Boolean(e.image)}).map(function(e){return e.image}))},e}()},OZbH:function(e,t){e.exports=s},PdVp:function(e,t,n){"use strict";n.d(t,"n",function(){return R}),n.d(t,"e",function(){return B}),n.d(t,"t",function(){return N.e}),n.d(t,"a",function(){return S.e});var a=n("17wl"),i=n("cDcd"),r=n("KL1q"),o=n("UWqr"),s=n("hiL/"),c=n("OZbH"),d=n("lgTv"),l=n("ox9S"),u=n("6X2r"),f=n("jOlS");f.loadStyles('.bv_j_91bed31b,.bw_j_91bed31b,.bx_j_91bed31b{content:""}.e_j_91bed31b{border-bottom-width:1px;border-bottom-style:solid;box-sizing:border-box;color:"[theme:neutralLight, default: #edebe9]";margin-bottom:20px;padding-bottom:20px}.bj_j_91bed31b:not(.bk_j_91bed31b) .e_j_91bed31b{padding-bottom:0;border-bottom:0}.bl_j_91bed31b .e_j_91bed31b:last-of-type{margin-bottom:0;padding-bottom:0;border-bottom:none}.by_j_91bed31b .au_j_91bed31b,.bz_j_91bed31b .au_j_91bed31b{display:flex;flex-direction:row;justify-content:space-between}.by_j_91bed31b .bj_j_91bed31b .e_j_91bed31b,.bz_j_91bed31b .bj_j_91bed31b .e_j_91bed31b{margin-bottom:0;height:100%;padding-bottom:0;border-bottom:0}.by_j_91bed31b .bl_j_91bed31b,.bz_j_91bed31b .bl_j_91bed31b{flex-basis:50%;flex-grow:1;display:flex;flex-direction:column}.by_j_91bed31b .bj_j_91bed31b{min-height:365px;flex-basis:50%;min-width:0}[dir=ltr] .by_j_91bed31b .bj_j_91bed31b{margin-right:20px}[dir=rtl] .by_j_91bed31b .bj_j_91bed31b{margin-left:20px}.bz_j_91bed31b .bj_j_91bed31b{flex-basis:50%;min-width:0}[dir=ltr] .bz_j_91bed31b .bj_j_91bed31b{margin-right:20px}[dir=rtl] .bz_j_91bed31b .bj_j_91bed31b{margin-left:20px}.ca_j_91bed31b .e_j_91bed31b,.cb_j_91bed31b:not(.bx_j_91bed31b) .e_j_91bed31b{border-bottom:none;margin-bottom:0;padding-bottom:0}.bx_j_91bed31b.cb_j_91bed31b .e_j_91bed31b:first-of-type{margin-bottom:16px}.bx_j_91bed31b.cb_j_91bed31b .e_j_91bed31b:last-of-type{border-bottom:none;margin-bottom:0;padding-bottom:0}.bx_j_91bed31b .bj_j_91bed31b.bk_j_91bed31b .e_j_91bed31b{border-bottom-width:1px;border-bottom-style:solid;padding-bottom:20px}.bx_j_91bed31b .aa_j_91bed31b{padding-bottom:16px;margin-bottom:16px}.by_j_91bed31b.cb_j_91bed31b .au_j_91bed31b,.bw_j_91bed31b.cb_j_91bed31b .au_j_91bed31b,.bz_j_91bed31b.cb_j_91bed31b .au_j_91bed31b{display:flex;flex-direction:row}.by_j_91bed31b.cb_j_91bed31b .e_j_91bed31b,.bw_j_91bed31b.cb_j_91bed31b .e_j_91bed31b,.bz_j_91bed31b.cb_j_91bed31b .e_j_91bed31b{flex:1 1 50%}[dir=ltr] .by_j_91bed31b.cb_j_91bed31b .e_j_91bed31b:first-of-type,[dir=ltr] .bw_j_91bed31b.cb_j_91bed31b .e_j_91bed31b:first-of-type,[dir=ltr] .bz_j_91bed31b.cb_j_91bed31b .e_j_91bed31b:first-of-type{margin-right:20px}[dir=rtl] .by_j_91bed31b.cb_j_91bed31b .e_j_91bed31b:first-of-type,[dir=rtl] .bw_j_91bed31b.cb_j_91bed31b .e_j_91bed31b:first-of-type,[dir=rtl] .bz_j_91bed31b.cb_j_91bed31b .e_j_91bed31b:first-of-type{margin-left:20px}.bq_j_91bed31b{align-items:center;background-color:"[theme:neutralLighter, default: #f3f2f1]";border:1px solid;box-sizing:border-box;color:"[theme:neutralLight, default: #edebe9]";display:flex;flex-direction:column;height:100%;justify-content:center;padding:20px}.br_j_91bed31b{align-items:flex-end;display:flex;margin-bottom:12px}.bs_j_91bed31b{color:"[theme:themePrimary, default: #0078d4]";font-size:32px}[dir=ltr] .bs_j_91bed31b{margin-right:16px}[dir=rtl] .bs_j_91bed31b{margin-left:16px}.bt_j_91bed31b{color:"[theme:neutralPrimary, default: #323130]";font-size:28px;font-weight:100}.bu_j_91bed31b{color:"[theme:neutralSecondary, default: #605e5c]";font-size:15px;margin-bottom:28px;max-width:260px;text-align:center}',!0);var p="au_j_91bed31b",m="ca_j_91bed31b",_=n("IGle"),h=n("eUG4"),b=n("i5pg"),g=n("h4zy"),v=function(e){function t(t){var n,a,i=e.call(this,t)||this;i._breakpointValues=((n={})[s.BREAKPOINT_SIZE.SM]={maxWidth:559,className:"bx_j_91bed31b",oneItemSize:3,twoItemsFirstItemSize:3,twoItemsSecondItemSize:0,threePlusPrimaryItemSize:3,threePlusSecondaryItemSize:0},n[s.BREAKPOINT_SIZE.MD]={maxWidth:699,className:"bw_j_91bed31b",oneItemSize:3,twoItemsFirstItemSize:3,twoItemsSecondItemSize:3,threePlusPrimaryItemSize:3,threePlusSecondaryItemSize:1},n[s.BREAKPOINT_SIZE.LG]={maxWidth:1069,className:"by_j_91bed31b",oneItemSize:4,twoItemsFirstItemSize:4,twoItemsSecondItemSize:4,threePlusPrimaryItemSize:4,threePlusSecondaryItemSize:1},n[s.BREAKPOINT_SIZE.XL]={maxWidth:999999,className:"bz_j_91bed31b",oneItemSize:5,twoItemsFirstItemSize:5,twoItemsSecondItemSize:5,threePlusPrimaryItemSize:5,threePlusSecondaryItemSize:2},n),i._onAddButtonClicked=function(){u.e.logNewsEngagement({component:"NewsAdd",layoutId:N.e.getLayoutId(0),logTag:h.e,workload:i.props.workload})},i._layout=N.e.getLayoutId(0),i._responsiveUI=new s.ResponsiveUI,i._responsiveUI.screenBreakpoints=((a={})[i._breakpointValues[s.BREAKPOINT_SIZE.SM].maxWidth]=s.BREAKPOINT_SIZE.SM,a[i._breakpointValues[s.BREAKPOINT_SIZE.MD].maxWidth]=s.BREAKPOINT_SIZE.MD,a[i._breakpointValues[s.BREAKPOINT_SIZE.LG].maxWidth]=s.BREAKPOINT_SIZE.LG,a[i._breakpointValues[s.BREAKPOINT_SIZE.XL].maxWidth]=s.BREAKPOINT_SIZE.XL,a);var r=N.e.getCurrentElementBreakpoint(i._responsiveUI,t.width);return i.state={currentBreakpoint:r},i}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"_classNames",{get:function(){var e=this.props.emphasisTheme;return _.e.getClassNames({root:"FeaturedNewsLayout",theme:e})},enumerable:!1,configurable:!0}),t.prototype.UNSAFE_componentWillMount=function(){this._updateRealNewsItems(this.props.items)},t.prototype.componentDidMount=function(){this._isMounted=!0,this._resizeComponent(this.props.width)},t.prototype.componentWillUnmount=function(){this._isMounted=!1},t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.props.width!==e.width&&this._resizeComponent(e.width)},t.prototype.UNSAFE_componentWillUpdate=function(e){e.items!==this.props.items&&this._updateRealNewsItems(e.items)},t.prototype.getCurrentBreakpoint=function(){return this.state.currentBreakpoint?this.state.currentBreakpoint:s.BREAKPOINT_SIZE.SM},t.prototype.render=function(){return void 0===this.state.currentBreakpoint?null:i.createElement("div",{className:Object(r.css)("featuredNewsLayout","bv_j_91bed31b",this._getLayoutModifierClasses(),this._breakpointValues[this.getCurrentBreakpoint()].className),"data-automation-id":"featuredNewsLayout"},this._renderNewsContent())},t.prototype._renderNewsContent=function(){var e,t=this.props.items;switch(this._realNewsItems.length){case 0:e=t&&1===t.length?this._renderOneItemLayout(t[0]):this._renderThreePlusItemLayout(t,!0);break;case 1:e=this._renderOneItemLayout(this._realNewsItems[0]);break;case 2:e=this._renderTwoItemLayout(this._realNewsItems);break;default:e=this._renderThreePlusItemLayout(this._realNewsItems,!1)}return i.createElement(r.FocusZone,{direction:r.FocusZoneDirection.vertical},e)},t.prototype._initializeImages=function(e){g.e.isNewsCommonCustomerPromiseEnabled()&&S.e.initializeImages(this.props.items,this.props.initializeImages,e)},t.prototype._renderOneItemLayout=function(e){var t=this._breakpointValues[this.getCurrentBreakpoint()].oneItemSize,n=this.getCurrentBreakpoint()<s.BREAKPOINT_SIZE.MD||!e.image;return this._initializeImages(1),i.createElement("div",{role:"list","aria-label":this.props.title},this._renderNewsItem(e,t,n,0,!0))},t.prototype._renderTwoItemLayout=function(e){var t=this._breakpointValues[this.getCurrentBreakpoint()].twoItemsFirstItemSize,n=this._breakpointValues[this.getCurrentBreakpoint()].twoItemsSecondItemSize;return this._initializeImages(2),i.createElement("div",{className:p,role:"list","aria-label":this.props.title},this._renderNewsItem(e[0],t,!0,0),this._renderNewsItem(e[1],n,!this._shouldRenderCompactMode,1))},t.prototype._renderThreePlusItemLayout=function(e,t){var n,a=this,o=t?e:e.slice(1,4);this._initializeImages(o.length);var c=this._breakpointValues[this.getCurrentBreakpoint()].threePlusPrimaryItemSize,d=this._breakpointValues[this.getCurrentBreakpoint()].threePlusSecondaryItemSize,l=Object(r.css)(((n={}).bj_j_91bed31b=!this._shouldRenderCompactMode,n.bk_j_91bed31b=!!e[0].image,n)),u=this.state.currentBreakpoint!==s.BREAKPOINT_SIZE.MD||this.state.currentBreakpoint===s.BREAKPOINT_SIZE.MD&&!e[0].image;return i.createElement("div",{className:p,role:"list","aria-label":this.props.title},i.createElement("div",{className:l},t?this._renderPlaceholderNewsItem():this._renderNewsItem(e[0],c,u,0)),i.createElement("div",{className:"bl_j_91bed31b"},o.map(function(e,t){return e&&a._renderNewsItem(e,d,!1,t+1)})))},t.prototype._renderNewsItem=function(e,t,n,a,o){var s;void 0===o&&(o=!1);var l=this.props,u=l.addNewsArticleUrl,f=l.displayMode,p=l.emphasisTheme,m=l.isEligibleForCssTextTruncate,_=l.isLoading,h=l.locale,g=l.onImageRender,v=l.logClickEvent,y=l.pageContext,S=l.serviceScope,D=l.showNewsMetadata,I=l.width,x=l.workload,C={addNewsUrl:u,displayMode:f,isEligibleForCssTextTruncate:m,isFeatured:n,isLoading:_,isSingleItem:o,index:a,layout:this._layout,locale:h,onImageRender:g,logClickEvent:v,newsItem:e,pageContext:y,serviceScope:S,shouldHideDescription:this._shouldRenderCompactMode||!Object(b.n)()&&t<=2,showNewsMetadata:D,size:t,theme:p,webpartWidth:I,workload:x},O=i.createElement(this._shouldRenderCompactMode?d.e:d.a,C);return i.createElement("div",{key:c.NewsUtilities.getNewsItemKey(e,a.toString()),className:Object(r.css)("e_j_91bed31b",this._classNames.item,(s={},s.aa_j_91bed31b=this._shouldRenderCompactMode,s))},O)},t.prototype._renderPlaceholderNewsItem=function(){return this.getCurrentBreakpoint()===s.BREAKPOINT_SIZE.SM||this.getCurrentBreakpoint()===s.BREAKPOINT_SIZE.MD?null:i.createElement("div",{className:"bq_j_91bed31b"},i.createElement("div",{className:"br_j_91bed31b"},i.createElement(r.Icon,{className:"bs_j_91bed31b",iconName:"News"}),i.createElement("span",{className:"bt_j_91bed31b"},l.d)),i.createElement("div",{className:"bu_j_91bed31b"},l.c),this.props.displayMode===o.DisplayMode.Read&&this._renderPlaceholderAddButton())},t.prototype._renderPlaceholderAddButton=function(){var e=this.props,t=e.addNewsArticleUrl;if(e.showAddButton)return i.createElement(r.PrimaryButton,{"data-interception":"propagate",href:t,title:l.o,description:l.o,onClick:this._onAddButtonClicked,text:l.o})},t.prototype._getLayoutModifierClasses=function(){var e=this.props.items;switch(this._realNewsItems.length){case 0:return e&&1===e.length?m:"";case 1:return m;case 2:return"cb_j_91bed31b";default:return""}},t.prototype._resizeComponent=function(e){var t=this._responsiveUI.getCurrentElementBreakpoint(e);this.state.currentBreakpoint!==t&&this._isMounted&&this.setState({currentBreakpoint:t})},t.prototype._updateRealNewsItems=function(e){this._realNewsItems=e.filter(function(e){return!e.isHelpArticle})},Object.defineProperty(t.prototype,"_shouldRenderCompactMode",{get:function(){return this.props.compactMode&&this.getCurrentBreakpoint()===s.BREAKPOINT_SIZE.SM},enumerable:!1,configurable:!0}),t}(i.Component),y=n("84oY"),S=n("NTtI");f.loadStyles(".c_b_91bed31b{display:flex;flex-direction:column}.e_b_91bed31b{padding:20px 0}.f_b_91bed31b .c_b_91bed31b,.g_b_91bed31b .c_b_91bed31b{flex-flow:row wrap;justify-content:space-between}.f_b_91bed31b .e_b_91bed31b{width:calc(50% - 12px)}.g_b_91bed31b .e_b_91bed31b{width:calc(50% - 16px);padding:24px 0}.f_b_91bed31b .e_b_91bed31b:first-child,.f_b_91bed31b .e_b_91bed31b:nth-child(2),.h_b_91bed31b .e_b_91bed31b:first-child,.i_b_91bed31b .e_b_91bed31b:first-child,.g_b_91bed31b .e_b_91bed31b:first-child,.g_b_91bed31b .e_b_91bed31b:nth-child(2){padding-top:0}.j_b_91bed31b{content:none}",!0);var D=function(e){function t(t){var n,a,i=e.call(this,t)||this;i._breakpointValues=((n={})[s.BREAKPOINT_SIZE.SM]={maxWidth:575,className:"i_b_91bed31b",newsItemSize:1},n[s.BREAKPOINT_SIZE.MD]={maxWidth:959,className:"h_b_91bed31b",newsItemSize:2},n[s.BREAKPOINT_SIZE.LG]={maxWidth:1203,className:"f_b_91bed31b",newsItemSize:2},n[s.BREAKPOINT_SIZE.XL]={maxWidth:999999,className:"g_b_91bed31b",newsItemSize:2},n),i._layout=N.e.getLayoutId(2),i._responsiveUI=new s.ResponsiveUI,i._responsiveUI.screenBreakpoints=((a={})[i._breakpointValues[s.BREAKPOINT_SIZE.SM].maxWidth]=s.BREAKPOINT_SIZE.SM,a[i._breakpointValues[s.BREAKPOINT_SIZE.MD].maxWidth]=s.BREAKPOINT_SIZE.MD,a[i._breakpointValues[s.BREAKPOINT_SIZE.LG].maxWidth]=s.BREAKPOINT_SIZE.LG,a[i._breakpointValues[s.BREAKPOINT_SIZE.XL].maxWidth]=s.BREAKPOINT_SIZE.XL,a);var r=N.e.getCurrentElementBreakpoint(i._responsiveUI,t.width);return i.state={currentBreakpoint:r},i}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"_classNames",{get:function(){var e=this.props.emphasisTheme;return _.e.getClassNames({root:"GridNewsLayout",theme:e})},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){this._isMounted=!0,this._resizeComponent(this.props.width)},t.prototype.componentWillUnmount=function(){this._isMounted=!1},t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.props.width!==e.width&&this._resizeComponent(e.width)},t.prototype.getCurrentBreakpoint=function(){return this.state.currentBreakpoint?this.state.currentBreakpoint:s.BREAKPOINT_SIZE.SM},t.prototype.render=function(){return void 0===this.state.currentBreakpoint?null:i.createElement("div",{role:"list",className:Object(r.css)("j_b_91bed31b",this._breakpointValues[this.getCurrentBreakpoint()].className),"data-automation-id":"gridNewsLayout"},this.renderNewsContent())},t.prototype.renderNewsContent=function(){return i.createElement("div",{className:"c_b_91bed31b"},this.renderNewsItems())},t.prototype.renderNewsItems=function(){var e=[],t=this.props.showAddButton?this.props.items:S.e.filterOutContributorActionCard(this.props.items),n=this.props,a=n.displayMode,s=n.emphasisTheme,l=n.isEligibleForCssTextTruncate,u=n.locale,f=n.onImageRender,p=n.logClickEvent,m=n.pageContext,_=n.serviceScope,h=n.showNewsMetadata,b=n.totalItemsToRender,g=n.width,v=n.workload,y=t.length>b?b:t.length;this._initializeImages(y);for(var D=0;D<y;D++)e.push(i.createElement("div",{key:c.NewsUtilities.getNewsItemKey(t[D],D.toString()),className:Object(r.css)("e_b_91bed31b",this._classNames.item)},i.createElement(d.a,{isDisabled:(t[D].isContributorActionCard||t[D].isHelpArticle)&&a===o.DisplayMode.Edit,displayMode:a,isEligibleForCssTextTruncate:l,isFeatured:!1,isLoading:!1,index:D,locale:u,layout:this._layout,logClickEvent:p,onImageRender:f,newsItem:t[D],pageContext:m,serviceScope:_,showNewsMetadata:h,size:this._breakpointValues[this.getCurrentBreakpoint()].newsItemSize,theme:s,workload:v,webpartWidth:g})));return e},t.prototype._initializeImages=function(e){g.e.isNewsCommonCustomerPromiseEnabled()&&S.e.initializeImages(this.props.items,this.props.initializeImages,e)},t.prototype._resizeComponent=function(e){var t=this._responsiveUI.getCurrentElementBreakpoint(e);this.state.currentBreakpoint!==t&&this._isMounted&&this.setState({currentBreakpoint:t})},t}(i.Component),I=n("faye"),x=n("Pk8u"),C=n("ut3N"),O=n("y88i"),w=n("4h6m"),E=function(e){function t(t){var n=e.call(this,t)||this;return n._listKey=0,n._draggableHandle="draggableElement",n._listItems=[],n._sortableIsInvalid=!1,n._renderNewsContent=function(){var e=Object(b.v)()?n.props.items:Object(x.cloneDeep)(n.props.items),t=i.createElement(r.List,{ref:n._resolveRef("_containerDiv"),key:n._listKey,items:e,getItemCountForPage:n._getItemCountForPage,renderCount:e.length,onRenderCell:n._renderListItem});return i.createElement("div",{role:"list","data-is-focusable":!1},i.createElement(r.FocusZone,{direction:r.FocusZoneDirection.vertical,isCircularNavigation:!0,isInnerZoneKeystroke:n._isInnerZoneKeyStroke},t))},n._getItemCountForPage=function(e,t){return n.props.totalItemsToRender},n._renderListItem=function(e,t){var a=n._getDigestListItemAriaLabel(e,t),s=n.props,c=s.displayMode,l=s.emphasisTheme,u=s.isEligibleForCssTextTruncate,f=s.locale,p=s.serviceScope,m=s.showNewsMetadata,_=s.pageContext,h=s.width,b=s.workload,g=i.createElement(d.a,{displayMode:c,isDisabled:c===o.DisplayMode.Edit,isEligibleForCssTextTruncate:u,isFeatured:!1,isLoading:!1,index:t,layout:n._layout,locale:f,newsItem:e,pageContext:_,serviceScope:p,size:n._breakpointValues[n.getCurrentBreakpoint()].newsItemSize,showNewsMetadata:m,theme:l,webpartWidth:h,workload:b});return i.createElement("div",{className:Object(r.css)(w.e.itemArea),"data-is-focusable":!0,tabIndex:0,"aria-label":a,role:"presentation",ref:function(e){return n._listItems[t]=e},onFocus:n._onFocusItem(t),onBlur:n._onBlurItem,onKeyDown:n._handleKeyDownOnListItem(e,t)},i.createElement("div",{className:w.e.item},i.createElement(r.FocusZone,{direction:r.FocusZoneDirection.horizontal,isCircularNavigation:!0},g)),n._renderIcons(t))},n._getDigestListItemAriaLabel=function(e,t){var a=n.props,i=a.items,r=a.locale;return O.StringHelper.format(l.a,t+1,i.length,e.title,O.StringHelper.format(l.b,e.author,d.i._getFormattedDate(e.publishedOnRelativeTime,e.publishedOn,r)),e.description?l._:O.StringHelper.format(l.t,e.description))},n._onFocusItem=function(e){return function(t){n._focusedIndex=e}},n._onBlurItem=function(e){n._focusedIndex=-1},n._handleKeyDownOnListItem=function(e,t){var a=n.props,i=a.items,o=a.reorderItemCallback;return function(e){if(n._focusedIndex===t&&n.props.canReorder&&e.ctrlKey)switch(e.which){case r.KeyCodes.down:if(t>=i.length-1)return;n._swapNewsItems(i,t,t+1),n._focusedIndex=t+1,n._sortableIsInvalid=!0,e.stopPropagation(),e.preventDefault(),o&&o(i);break;case r.KeyCodes.up:if(t<1)return;n._swapNewsItems(i,t,t-1),n._focusedIndex=t-1,n._sortableIsInvalid=!0,e.stopPropagation(),e.preventDefault(),o&&o(i);break;case r.KeyCodes.del:n._handleRemoveItem(t),e.stopPropagation()}}},n._handleRemoveItem=function(e){var t=n.props,a=t.items,i=t.reorderItemCallback;e>-1&&(a.splice(e,1),n._sortableIsInvalid=!0,i(a))},n._onReorderEnd=function(e){if(e.oldIndex!==e.newIndex){n._listKey++;var t=n.props,a=t.items,i=t.reorderItemCallback;n._swapNewsItems(a,e.oldIndex,e.newIndex),i&&i(a)}},n._swapNewsItems=function(e,t,n){var a=e[t];e.splice(t,1),e.splice(n,0,a)},n}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){this._isMounted=!0,this._addEventListeners(),this._resizeComponent(this.props.width),this._createSortableList()},t.prototype.componentWillUnmount=function(){this._isMounted=!1,this._removeEventListeners()},t.prototype.componentDidUpdate=function(){if(this._resizeComponent(this.props.width),this._sortableIsInvalid=!1,this._createSortableList(),this._focusedIndex>-1){var e=this._listItems[this._focusedIndex];e&&e.focus()}},t.prototype.shouldComponentUpdate=function(e,t){return!Object(x.isEqual)(e.items,this.props.items)||this._sortableIsInvalid},Object.defineProperty(t.prototype,"_layoutType",{get:function(){return 3},enumerable:!1,configurable:!0}),t.prototype._addEventListeners=function(){},t.prototype._removeEventListeners=function(){},t.prototype._renderIcons=function(e){var t=this,n=this.props,a=n.displayMode,s=n.items;return a===o.DisplayMode.Edit&&s.length>1?i.createElement("div",{className:w.e.iconArea,"data-is-focusable":!1},i.createElement(r.IconButton,{"data-is-focusable":!1,iconProps:{iconName:"Cancel"},onClick:function(){t._handleRemoveItem(e)},title:l.g}),i.createElement(r.IconButton,{"data-is-focusable":!1,className:this._draggableHandle,iconProps:{iconName:"Move"},title:l.m})):void 0},Object.defineProperty(t.prototype,"_sortableContainer",{get:function(){return I.findDOMNode(this._containerDiv)},enumerable:!1,configurable:!0}),t.prototype._createSortableList=function(){var e=this;this.props.canReorder&&this._sortableContainer&&this._async.setTimeout(function(){if(e._sortableContainer&&e._sortableContainer instanceof Element){for(var t=e._sortableContainer.getElementsByClassName("ms-List-page"),n=new C._QosMonitor("NewsDigestLayout.createSortableList"),a=function(a){s.SortableLoader.GetSortable().then(function(n){n.create(t[a],{handle:".".concat(e._draggableHandle),group:"newsDigest".concat(e._listKey),forceFallback:o._BrowserDetection.getBrowserInformation().browser!==o._Browser.Chrome,onEnd:e._onReorderEnd,animation:200,draggable:".ms-List-cell"})}).catch(function(e){throw n.writeUnexpectedFailure(void 0,e),e})},i=0;i<t.length;i++)a(i);n.writeSuccess()}},0)},t}(y.e),A=E,L=n("xc3d"),k=n("ZfdM");f.loadStyles(".as_h_91bed31b,.at_h_91bed31b,.au_h_91bed31b,.av_h_91bed31b{display:flex}.as_h_91bed31b,.av_h_91bed31b{flex-direction:column}.as_h_91bed31b{align-content:space-between}[dir=ltr] .aw_h_91bed31b .e_h_91bed31b:last-of-type{margin-right:0}[dir=rtl] .aw_h_91bed31b .e_h_91bed31b:last-of-type{margin-left:0}.at_h_91bed31b:nth-of-type(2){margin-top:8px}.at_h_91bed31b .e_h_91bed31b{flex:1 1 auto;width:0}[dir=ltr] .at_h_91bed31b .e_h_91bed31b{margin-right:8px}[dir=rtl] .at_h_91bed31b .e_h_91bed31b{margin-left:8px}.ax_h_91bed31b{height:1px;border-bottom-width:1px;border-bottom-style:solid}.av_h_91bed31b{box-sizing:border-box}.av_h_91bed31b.ay_h_91bed31b .e_h_91bed31b:nth-of-type(3){border-bottom:0;padding-bottom:0}.av_h_91bed31b.az_h_91bed31b{justify-content:space-between}.av_h_91bed31b.ba_h_91bed31b{justify-content:flex-start}.av_h_91bed31b.ba_h_91bed31b .e_h_91bed31b{padding:15px 2px}.av_h_91bed31b .e_h_91bed31b{padding:0 2px}.av_h_91bed31b .e_h_91bed31b:first-of-type{padding-top:0}.av_h_91bed31b .e_h_91bed31b:nth-of-type(6){border-bottom:0;padding-bottom:0}.bb_h_91bed31b .as_h_91bed31b,.bb_h_91bed31b .av_h_91bed31b,.bc_h_91bed31b .as_h_91bed31b,.bc_h_91bed31b .av_h_91bed31b,.be_h_91bed31b .as_h_91bed31b,.be_h_91bed31b .av_h_91bed31b{width:0}.bb_h_91bed31b .av_h_91bed31b,.bc_h_91bed31b .av_h_91bed31b,.be_h_91bed31b .av_h_91bed31b{border-width:1px;border-style:solid;padding:20px 18px}.bf_h_91bed31b .au_h_91bed31b{flex-direction:column}.bf_h_91bed31b .as_h_91bed31b{margin-bottom:16px}.bf_h_91bed31b .at_h_91bed31b .e_h_91bed31b{flex:1 1 auto}[dir=ltr] .bf_h_91bed31b .at_h_91bed31b .e_h_91bed31b{margin-right:0}[dir=rtl] .bf_h_91bed31b .at_h_91bed31b .e_h_91bed31b{margin-left:0}.bc_h_91bed31b .as_h_91bed31b{flex:1 1 272px}.bc_h_91bed31b .av_h_91bed31b{flex:0 0 333px;max-width:333px}.bb_h_91bed31b .as_h_91bed31b{flex:1 1 544px}.bb_h_91bed31b .av_h_91bed31b{flex:0 0 333px;max-width:333px}.be_h_91bed31b .as_h_91bed31b{flex:1 1 816px}.be_h_91bed31b .av_h_91bed31b{flex:0 0 332px;max-width:332px}",!0);var M="bb_h_91bed31b",P="bc_h_91bed31b",T="be_h_91bed31b",U="bf_h_91bed31b",F=function(e){function t(t){var n,a,i,o=e.call(this,t)||this;o._breakpointValuesSingleFeatured=((n={})[s.BREAKPOINT_SIZE.SM]={maxWidth:559,className:Object(r.css)(U,o._classNames.hubNewsLayout__small),itemSize:3},n[s.BREAKPOINT_SIZE.MD]={maxWidth:699,className:P,itemSize:3},n[s.BREAKPOINT_SIZE.LG]={maxWidth:1069,className:M,itemSize:4},n[s.BREAKPOINT_SIZE.XL]={maxWidth:999999,className:T,itemSize:5},n),o._breakpointValues=((a={})[s.BREAKPOINT_SIZE.SM]={maxWidth:480,className:Object(r.css)(U,o._classNames.hubNewsLayout__small)},a[s.BREAKPOINT_SIZE.MD]={maxWidth:728,className:P},a[s.BREAKPOINT_SIZE.LG]={maxWidth:944,className:M},a[s.BREAKPOINT_SIZE.XL]={maxWidth:999999,className:T},a),o._layoutValues=((i={})[s.BREAKPOINT_SIZE.SM]={numberOfFeatured:1,maxNumberOfNonFeatured:4,maxFeaturedPerRow:1},i[s.BREAKPOINT_SIZE.MD]={maxNumberOfNonFeatured:6,maxFeaturedPerRow:1},i[s.BREAKPOINT_SIZE.LG]={maxNumberOfNonFeatured:6,maxFeaturedPerRow:2},i[s.BREAKPOINT_SIZE.XL]={maxNumberOfNonFeatured:6,maxFeaturedPerRow:3},i),o._layout=N.e.getLayoutId(4),o._setResponsiveUI();var c=N.e.getCurrentElementBreakpoint(o._responsiveUI,t.width);return o.state={currentBreakpoint:c,maxItems:Math.min(k.MAX_L1_ITEMS,o.props.items.length)},o._updateRealNewsItems(o.props.items),o}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"_classNames",{get:function(){var e=this.props.emphasisTheme;return _.e.getClassNames({root:"HubNewsLayout",theme:e})},enumerable:!1,configurable:!0}),t.prototype.UNSAFE_componentWillMount=function(){this._setResponsiveUI()},t.prototype.componentDidMount=function(){this._isMounted=!0,this._resizeComponent(this.props.width)},t.prototype.componentWillUnmount=function(){this._isMounted=!1},t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.props.width!==e.width&&this._resizeComponent(e.width);var t=Math.min(k.MAX_L1_ITEMS,e.items.length);this.state.maxItems!==t&&this.setState({maxItems:t})},t.prototype.UNSAFE_componentWillUpdate=function(e){var t=this.props.items;c.NewsUtilities.hasSameOrderOfPosts(e.items,t)&&c.NewsUtilities.hasSameSetOfPosts(e.items,t)||this._updateRealNewsItems(e.items)},t.prototype.getCurrentBreakpoint=function(){return this.state.currentBreakpoint||s.BREAKPOINT_SIZE.SM},t.prototype.render=function(){var e=this.getCurrentBreakpoint(),t=this._breakpointValues[e];return i.createElement("div",{className:t.className,"data-automation-id":"hubNewsLayout"},this._renderNewsContent(e))},t.prototype._setResponsiveUI=function(){var e,t;this._responsiveUI=this._responsiveUI||new s.ResponsiveUI,1===this.props.items.length?this._responsiveUI.screenBreakpoints=((e={})[this._breakpointValuesSingleFeatured[s.BREAKPOINT_SIZE.SM].maxWidth]=s.BREAKPOINT_SIZE.SM,e[this._breakpointValuesSingleFeatured[s.BREAKPOINT_SIZE.MD].maxWidth]=s.BREAKPOINT_SIZE.MD,e[this._breakpointValuesSingleFeatured[s.BREAKPOINT_SIZE.LG].maxWidth]=s.BREAKPOINT_SIZE.LG,e[this._breakpointValuesSingleFeatured[s.BREAKPOINT_SIZE.XL].maxWidth]=s.BREAKPOINT_SIZE.XL,e):this._responsiveUI.screenBreakpoints=((t={})[this._breakpointValues[s.BREAKPOINT_SIZE.SM].maxWidth]=s.BREAKPOINT_SIZE.SM,t[this._breakpointValues[s.BREAKPOINT_SIZE.MD].maxWidth]=s.BREAKPOINT_SIZE.MD,t[this._breakpointValues[s.BREAKPOINT_SIZE.LG].maxWidth]=s.BREAKPOINT_SIZE.LG,t[this._breakpointValues[s.BREAKPOINT_SIZE.XL].maxWidth]=s.BREAKPOINT_SIZE.XL,t)},t.prototype._getNumberOfFeatured=function(e){var t=this.state.maxItems;return e===s.BREAKPOINT_SIZE.MD?t<=4?1:2:e===s.BREAKPOINT_SIZE.LG?t<=5?2:4:e===s.BREAKPOINT_SIZE.XL?t<=6?3:6:1},t.prototype._renderNewsContent=function(e){var t=this._layoutValues[e],n=Object(a.__assign)(Object(a.__assign)({},t),{numberOfFeatured:void 0===t.numberOfFeatured?this._getNumberOfFeatured(e):t.numberOfFeatured}),o=this._renderNewsLayout(n,e);return i.createElement(r.FocusZone,{direction:r.FocusZoneDirection.vertical},o)},t.prototype._getFeaturedItemSize=function(e,t,n){if(n===s.BREAKPOINT_SIZE.SM)return this._initializeImages(1),6;if(this._initializeImages(e.length),t.length>1)return 9;switch(e.length){case 1:return this._breakpointValuesSingleFeatured[n].itemSize||3;case 2:return 7;case 3:return 8;default:return 9}},t.prototype._renderNewsLayout=function(e,t){var n,a,o=this,d=this._realNewsItems.slice(0,this.state.maxItems),l=d.slice(0,e.numberOfFeatured),u=d.slice(e.numberOfFeatured,e.numberOfFeatured+e.maxNumberOfNonFeatured);this._initializeImages(u.length),1!==u.length||t!==s.BREAKPOINT_SIZE.MD&&t!==s.BREAKPOINT_SIZE.LG||(l.push(u.pop()),e.maxFeaturedPerRow++);var f=this._getFeaturedItemSize(l,u,t),p=[];u.forEach(function(e,t){p.push(e),t!==u.length-1&&p.push(void 0)});var m=[],_=[];l.forEach(function(t,n){n<e.maxFeaturedPerRow?m.push(t):_.push(t)});var h=i.createElement("div",{className:Object(r.css)("hubNewsLayout_featured","as_h_91bed31b",(n={},n.aw_h_91bed31b=0===u.length,n))},[m,_].map(function(e,n){var a=1!==l.length||t===s.BREAKPOINT_SIZE.SM||t===s.BREAKPOINT_SIZE.MD||1===l.length&&!l[0].image;return Boolean(e.length)&&i.createElement("div",{className:"at_h_91bed31b",key:n},e.map(function(e,n){return o._renderNewsHubItem(e,f,a,c.NewsUtilities.getNewsItemKey(e,"featured_".concat(n)),t,n)}))})),b=_.length||t===s.BREAKPOINT_SIZE.SM?e.maxNumberOfNonFeatured:e.maxNumberOfNonFeatured/2,g=Boolean(p.length)?i.createElement("div",{className:Object(r.css)("hubNewsLayout_nonFeatured","av_h_91bed31b",this._classNames.nonFeatured,(a={},a.ay_h_91bed31b=!_.length&&t!==s.BREAKPOINT_SIZE.SM,a.az_h_91bed31b=u.length===b&&t!==s.BREAKPOINT_SIZE.SM,a.ba_h_91bed31b=u.length!==b||t===s.BREAKPOINT_SIZE.SM,a))},p.map(function(e,n){return Boolean(e)?o._renderNewsHubItem(e,9,!1,c.NewsUtilities.getNewsItemKey(e,"nonFeatured_".concat(n)),t,n):o._renderNonFeaturedSpacingElement(n+1)})):void 0;return i.createElement("div",{className:"au_h_91bed31b",role:"list","aria-label":this.props.title},h,g)},t.prototype._initializeImages=function(e){g.e.isNewsCommonCustomerPromiseEnabled()&&S.e.initializeImages(this.props.items,this.props.initializeImages,e)},t.prototype._renderNonFeaturedSpacingElement=function(e){return i.createElement("div",{className:Object(r.css)("ax_h_91bed31b",this._classNames.nonFeaturedBorder),key:e})},t.prototype._renderNewsHubItem=function(e,t,n,a,o,s){var c=this.props,d=c.displayMode,l=c.emphasisTheme,u=c.isEligibleForCssTextTruncate,f=c.isLoading,p=c.locale,m=c.onImageRender,_=c.logClickEvent,h=c.pageContext,b=c.serviceScope,g=c.showNewsMetadata,v=c.width,y=c.workload;return i.createElement("div",{key:a,className:Object(r.css)("e_h_91bed31b",this._classNames.item)},i.createElement(L.e,{displayMode:d,isEligibleForCssTextTruncate:u,isFeatured:n,isLoading:f,index:s,layout:this._layout,locale:p,logClickEvent:_,newsItem:e,onImageRender:m,pageContext:h,serviceScope:b,showNewsMetadata:g,size:t,theme:l,webpartWidth:v,workload:y}))},t.prototype._resizeComponent=function(e){var t=this._responsiveUI.getCurrentElementBreakpoint(e);this.state.currentBreakpoint!==t&&this._isMounted&&this.setState({currentBreakpoint:t})},t.prototype._updateRealNewsItems=function(e){var t=this;this._realNewsItems=e.filter(function(e){return!e.isHelpArticle}),0===this._realNewsItems.length&&e.forEach(function(e){t._realNewsItems.push(e)})},t}(i.Component),H=n("I6O9"),R=function(){function e(){}return e.loadFeaturedNewsLayout=function(){return Promise.resolve(v)},e.loadListNewsLayout=function(){return Promise.resolve(y.e)},e.loadGridNewsLayout=function(){return Promise.resolve(D)},e.loadNewsDigestLayout=function(){if(!Object(b.g)()){var e,t=new C._QosMonitor("NewsDigestLayout.LoadLayoutOnDemand");return n.e(4).then(n.bind(null,"M1fG")).then(function(n){return e=n.default,t.writeSuccess(),e}).catch(function(e){throw t.writeUnexpectedFailure("FailedToLoadDigestLayoutChunk"),e})}return Promise.resolve(A)},e.loadNewsHubLayout=function(){return Promise.resolve(F)},e.loadCarouselNewsLayout=function(){var e=k.CAROUSEL_HERO_WRAPPER_ID;return H.SPComponentLoader.loadComponentById(e).then(function(e){return Promise.resolve(e.CarouselNewsLayout)}).catch(function(e){return Promise.resolve(void 0)})},e.loadHeroNewsLayout=function(){var e=k.CAROUSEL_HERO_WRAPPER_ID;return H.SPComponentLoader.loadComponentById(e).then(function(e){return Promise.resolve(e.HeroNewsLayout)}).catch(function(e){return Promise.resolve(void 0)})},e}(),N=n("ZQz3"),B=function(){function e(){}return e.loadFeaturedNewsLayoutOptions=function(e){return{isSelected:e===N.e.getLayoutId(0),key:N.e.getLayoutId(0),title:l.i,imageSrc:"newsfeatured.svg"}},e.loadListNewsLayoutOptions=function(e){return{isSelected:e===N.e.getLayoutId(1),key:N.e.getLayoutId(1),title:l.f,imageSrc:"newslist.svg"}},e.loadNewsDigestLayoutOptions=function(e){return{isSelected:e===N.e.getLayoutId(3),key:N.e.getLayoutId(3),title:l.n,imageSrc:"newslist.svg"}},e.loadGridNewsLayoutOptions=function(e){return{isSelected:e===N.e.getLayoutId(2),key:N.e.getLayoutId(2),title:l.r,imageSrc:"newsgrid.svg"}},e.loadNewsHubLayoutOptions=function(e){return{isSelected:e===N.e.getLayoutId(4),key:N.e.getLayoutId(4),title:l.u,imageSrc:"newshub.svg"}},e.loadCarouselNewsLayoutOptions=function(e){return{isSelected:e===N.e.getLayoutId(5),key:N.e.getLayoutId(5),title:l.e,imageSrc:"carousel.svg"}},e.loadHeroNewsLayoutOptions=function(e){return{isSelected:e===N.e.getLayoutId(6),key:N.e.getLayoutId(6),title:l.l,imageSrc:"hero.svg"}},e}()},Pk8u:function(e,t){e.exports=c},QZHX:function(e,t){e.exports=d},U4ag:function(e,t){e.exports=l},UWqr:function(e,t){e.exports=u},Vm5Y:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n("17wl"),i=n("cDcd"),r=i.lazy(function(){return Promise.all([n.e(11),n.e(7)]).then(n.bind(null,"c5Pp")).then(function(e){return{default:e.ListNewsCheckbox}})}),o=i.forwardRef(function(e,t){return i.createElement(i.Suspense,{fallback:!1},i.createElement(r,Object(a.__assign)({ref:t},e)))})},"X+PM":function(e,t){e.exports=f},Ycni:function(e,t){e.exports=p},ZQz3:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n("UWqr"),i=n("ZfdM"),r=function(){function e(){}return Object.defineProperty(e,"_dictionary",{get:function(){var t;return e._layoutsMap||(e._layoutsMap=((t={})[0]={layoutIndex:0,layoutId:"FeaturedNews",maxCount:4},t[101]={layoutIndex:101,layoutId:"NewsCommSite",maxCount:4},t[999]={layoutIndex:999,layoutId:"templateId"},t[1]={layoutIndex:1,layoutId:"ListNews",maxCount:8},t[2]={layoutIndex:2,layoutId:"GridNews",maxCount:i.MAX_L1_ITEMS},t[3]={layoutIndex:3,layoutId:"NewsDigest"},t[99]={layoutIndex:99,layoutId:"Newsreel",maxCount:4},t[100]={layoutIndex:100,layoutId:"Newsfeed"},t[4]={layoutIndex:4,layoutId:"NewsHub",maxCount:12},t[5]={layoutIndex:5,layoutId:"Carousel",maxCount:8},t[6]={layoutIndex:6,layoutId:"Hero",maxCount:5},t)),e._layoutsMap},enumerable:!1,configurable:!0}),e.getIndex=function(t){return e._dictionary[t].layoutIndex},e.getLayoutId=function(t){return e._dictionary[t].layoutId},e.getNewsLayout=function(t){for(var n in e._dictionary)if(e._dictionary.hasOwnProperty(n)&&e._dictionary[n].layoutId===t)return e._dictionary[n].layoutIndex},e.getMaxDisplayCount=function(t){if(t){var n=e.getNewsLayout(t);if(n)return e._dictionary[n].maxCount}},e.getCurrentElementBreakpoint=function(e,t){return e?e.getCurrentElementBreakpoint(t):void 0},e.determineCssTextTruncateEligibility=function(){return a._BrowserDetection.getBrowserInformation().browser!==a._Browser.IE},e.GRID_MIN_COUNT=2,e}()},ZfdM:function(e,t,n){"use strict";n.r(t),n.d(t,"MAX_L1_ITEMS",function(){return T}),n.d(t,"CAROUSEL_HERO_WRAPPER_ID",function(){return U});var a=n("17wl"),i=n("cDcd"),r=n("KL1q"),o=n("Pk8u"),s=n("ut3N"),c=n("UWqr"),d=n("X+PM"),l=n("Ycni"),u=n("y88i"),f=n("hiL/"),p=n("U4ag"),m=n("2q6Q"),_=n("QZHX"),h=n("OZbH"),b=n("vnpV"),g=n("PdVp"),v=n("KEk8"),y=function(){function e(){}return e.getNewsPrefetchData=function(){return window._spNewsWebPartData},e.invalidatePrefetchData=function(){window._spNewsWebPartData=void 0},e}(),S=n("I6O9"),D=function(){function e(){}return e.loadModule=function(){return e._loadedModulePromise||(e._loadedModulePromise=S.SPComponentLoader.loadComponentById("471d4a2d-f3fa-4244-9981-3386a871c1cf")),e._loadedModulePromise},Object(a.__decorate)([Object(f.monitor)("News.loadDeferredLinkPanel")],e,"loadModule",null),e}(),I=function(){function e(){}return e.loadModule=function(){return e._loadedModulePromise||(e._loadedModulePromise=S.SPComponentLoader.loadComponentById(e.carouselComponentId)),e._loadedModulePromise},e.loadCarousel=function(){return e.loadModule().then(function(e){return e.CarouselLayoutLoader.loadCarousel()})},e.carouselComponentId="8ac0c53c-e8d0-4e3e-87d0-7449eb0d4027",Object(a.__decorate)([Object(f.monitor)("News.loadCarousel")],e,"loadCarousel",null),e}(),x=n("7yaZ"),C=n("6X2r"),O=n("h4zy"),w=n("i5pg"),E=n("szL1"),A=n("lgTv"),L=n("siGj"),k=n("IGle"),M=n("F2ap"),P=n("K9kD"),T=12,U="67f38b9a-1ca4-427d-961d-732f70c1bdfe",F="audienceTargetingEnabled",H="",R="PrefetchDataNotUsable",N="PrefetchDataNotAvailable",B="NewsWebPartRender",j=function(e){function t(){var r=e.call(this)||this;return r.enablingViewCounts=!1,r.staleViewCountsRendered=!1,r.requestItemsPerInfiniteScroll=!1,r._customerPromiseStatus={totalTimesDataRendered:0,totalTimesViewcountsRendered:0,didRenderFromCache:!1,didRenderFromServer:!1,didRenderFromPrefetch:!1,pinnedItemMetadataRefreshed:!1,pinnedItemViewCountsReRendered:!1},r._didRequestCustomerPromiseLogging=!1,r._hasEnrolledToPrefetchUpdates=!1,r._inDigestMode=!1,r._isPrefetchedDataAvailable=!1,r._isRenderAsync=!1,r._loggedPinnedItems=!1,r._showTeachingBubble=!1,r._totalItemsWithImages=0,r._viewCountsRequestsInProgress=0,r._latestRender="STATIC",r.setDataProviderById=function(t){r._loadDataProviderById(t),e.prototype.setDataProviderById.call(r,t)},r.renderNews=function(){r.render()},r.handleEmptyResults=function(){var e;r._newsItems&&!(null===(e=r._newsItems[0])||void 0===e?void 0:e.isHelpArticle)||r.setResponseAndRender(r.getEmptyStateRows(r.activeLayoutInfo.id,""))},r.refreshNewsData=function(e,t,n){return void 0===t&&(t=p.RefreshType.Replace),void 0===n&&(n=!0),r.refreshData(e,t,n)},r.onPrefetchDataUpdated=function(e){var t=e;if(!Object(w.D)()&&t.instanceId===r.instanceId){var n=h.NewsUtilities.extractNewsItems(t.sitePageMetadataList,r.context.pageContext);r._onNewPrefetchDataResolved(n),r.setResponseAndRender(n)}},r._loadNewsEditModeOnDemand=function(){if(r._editorPromise)return r._editorPromise;if(r.displayMode===c.DisplayMode.Read&&!r._isOnSeeAll)return Promise.resolve();var e=new s._QosMonitor("NewsWebpart.DisplayModeChangedToEdit");return r._editorPromise=n.e(6).then(n.bind(null,"Z1sb")).then(function(t){r._editor=new t.NewsWebPartEdit(r),e.writeSuccess()}).catch(function(t){e.writeUnexpectedFailure("FailedToLoadEditChunk")})},r._loadSeeAllOnDemand=function(){if(r._seeAllPromise)return r._seeAllPromise;if(!r._isOnSeeAll)return Promise.resolve();var e=new s._QosMonitor("NewsWebpart.LoadSeeAllChunk");return r._seeAllPromise=Promise.all([n.e(11),n.e(7)]).then(n.bind(null,"qHvl")).then(function(t){r._seeAllChunk=new t.NewsWabPartSeeAll,e.writeSuccess()}).catch(function(t){e.writeUnexpectedFailure("FailedToLoadSeeAllChunk")})},r._createNewsItem=function(e){return i.createElement(A.a,e)},r._onL2InfiniteScroll=function(){var e;return null===(e=r._editor)||void 0===e?void 0:e.requestPerInfiniteScroll().then(function(e){return r.render(),e})},r._renderNewsItemImageArea=function(e,t,n,a){return new A.r(e).renderImageArea(t,n,a)},r._renderNewsItemTitle=function(e,t){return new A.r(e).renderTitle(t)},r._logOrgNewsCount=function(e){var t=e.filter(function(e){return e.isAuthoritative});if(t.length){var n=new Set(t.map(function(e){return e.siteId}));C.e.logNewsEngagement({component:"NewsRollup",extraData:{itemCount:t.length,sitesCount:n.size},isIntentional:!1,layoutId:r.activeLayoutInfo.id,logTag:"OrgNews",usageType:"Render",workload:r._workload})}},r._logPinnedNewsCount=function(e){!r._loggedPinnedItems&&e>0&&(r._loggedPinnedItems=!0,C.e.logNewsEngagement({component:"NewsRollup",extraData:{itemCount:e},isIntentional:!1,layoutId:r.activeLayoutInfo.id,logTag:"PinnedNews",usageType:"Render",workload:r._workload}))},r.setResponseAndRender=function(t){e.prototype.setResponseAndRender.call(r,t),r._shouldSkipViewCount(r.activeDataProviderInfo.id)||r.requestViewCounts(t)},r.onServerResponseResolved=function(e){O.e.isNewsCommonCustomerPromiseEnabled()?(r._latestRender="FRESH",r.updateCustomerPromiseFreshDataRenderStatus({dataProvider:r._getDataSource(),isServerResultEmpty:e})):(r._customerPromiseStatus.didRenderFromServer=!0,r._customerPromiseDataProviderStatus={dataSource:r.properties.dataProviderId,apiSuccess:!0,emptyData:e})},r.onServerResponseFailed=function(e){if(O.e.isNewsCommonCustomerPromiseEnabled()){var t=r.parseFreshRenderFailure(e);r.updateCustomerPromiseFreshDataRenderStatus({dataProvider:r._getDataSource(),error:t})}else r._customerPromiseStatus.didRenderFromServer=!1,r._customerPromiseDataProviderStatus={dataSource:r.properties.dataProviderId,apiSuccess:!1,apiFailedReason:e&&e.message}},r.renderedFromCacheData=function(e){O.e.isNewsCommonCustomerPromiseEnabled()?(r._latestRender="CACHE",r.updateCustomerPromiseCachedDataRenderStatus({isCacheDataEmpty:e})):(r._customerPromiseStatus.didRenderFromCache=!0,r._customerPromiseLKGStatus={hit:!0,emptyData:e})},r.onCacheResponseFailed=function(e){if(O.e.isNewsCommonCustomerPromiseEnabled()){var t=r.parseCacheRenderFailure(e);r.updateCustomerPromiseCachedDataRenderStatus({error:t})}else r._customerPromiseLKGStatus={hit:!1,failedReason:e&&e.message}},r.onCacheThenNetworkServerDataNotReturned=function(e,t){O.e.isNewsCommonCustomerPromiseEnabled()&&e&&r.logNoFreshRenderAfterCacheRender()},r.initializeImages=function(e){r.initializeCustomerPromiseImages(r._latestRender,e)},r.onImageRender=function(e,t){r.updateCustomerPromiseImageRenderStatus({image:e,renderType:r._latestRender,status:t})},r.parseCacheRenderFailure=function(e){if("errorCode"in e){var t=e;if(100001===t.errorCode)return"CacheMiss";if(100002===t.errorCode)return"DataSizeExceeded";if(100003===t.errorCode)return"MySiteCacheUnexpectedError";if(100004===t.errorCode)return"MySiteCacheLateFlushHasNotCompleted"}return"CacheUnavailable"},r.parseFreshRenderFailure=function(e){switch(e.errorCode){case p.FreshDataRenderFailure.BadRequest:return p.FreshDataRenderFailure.BadRequest;case p.FreshDataRenderFailure.Forbidden:return p.FreshDataRenderFailure.Forbidden;case p.FreshDataRenderFailure.NotFound:return p.FreshDataRenderFailure.NotFound;case p.FreshDataRenderFailure.NotAcceptable:return p.FreshDataRenderFailure.NotAcceptable;case p.FreshDataRenderFailure.RequestTimeout:return p.FreshDataRenderFailure.RequestTimeout;case p.FreshDataRenderFailure.Conflict:return p.FreshDataRenderFailure.Conflict;case p.FreshDataRenderFailure.RequestEntityTooLarge:return p.FreshDataRenderFailure.RequestEntityTooLarge;case p.FreshDataRenderFailure.TooManyRequest:return p.FreshDataRenderFailure.TooManyRequest;case p.FreshDataRenderFailure.ServerError:return p.FreshDataRenderFailure.ServerError;case p.FreshDataRenderFailure.NotImplemented:return p.FreshDataRenderFailure.NotImplemented}return p.FreshDataRenderFailure.MiscellaneousError},r._handleAppMessage=function(e){e&&e.origin===location.origin&&e.data&&"string"==typeof e.data&&"8c88f208-6c77-4bdb-86a0-0c47b4316588"===e.data&&r._refreshDataAfterNewsLinkPost()},r._handleNewsPostClick=function(e,t){if(r._logClickAddButton(),Object(w.S)())if(r._isOnSeeAll&&r.properties.prevPageUrl&&r.properties.prevPageSiteID&&r.properties.prevPageSiteID.equals(r.context.pageContext.site.id)){var n=u.Uri.concatenate("router://",r.pageContext.site.absoluteUrl,r.properties.prevPageUrl,"?createNewsPost=1");postMessage(n,location.origin)}else postMessage("router://".concat(r._addNewsArticleUrl),location.origin);else postMessage("router://".concat(r._addNewsArticleUrl),location.origin)},r._handleNewsLinkClick=function(e,n){D.loadModule().then(function(e){r._newsLinkPanel=e.NewsLinkPanel,r.panelElementType=2,r._showNewsLinkPanel=!0,r.render()}).catch(function(e){return s._TraceLogger.logError(t._logSource,e,"LoadNewsLinkPanelModule")})},r._handleNewsLinkPanelClose=function(e){r._showNewsLinkPanel=!1,e?r._refreshDataAfterNewsLinkPost():r.render()},r._refreshDataAfterNewsLinkPost=function(){r.setDataProviderById(r.newsDataProviderId),r._initScrollCounters(),r.refreshData().catch(function(e){return s._TraceLogger.logError(t._logSource,e,"RefreshAfterPost")})},r._checkNewsDigestFirstRun=function(){r._loadNewsDigestFirstRunUtilities().showFirstRun().then(function(e){r._showTeachingBubble!==e&&(r._showTeachingBubble=e,r.render())}).catch(function(e){return s._TraceLogger.logError(t._logSource,e,"CheckDigestFirstRun")})},r._onDismissTeachingBubble=function(){r._showTeachingBubble&&(r._showTeachingBubble=!1,r._loadNewsDigestFirstRunUtilities().setFirstRunSeen(!0).catch(function(e){return s._TraceLogger.logError(t._logSource,e,"DismissDigestFirstRun")}))},r._reorderNewsItems=function(e){r.properties.newsItems=e,r._newsDigestDataProviderInfo.options.newsItems=e;var n=r.activeDataProviderInfo.id;r.setDataProviderById(h.newsDigest),r.refreshData(void 0,void 0,!0).then(function(){r.setDataProviderById(n)}).catch(function(e){return s._TraceLogger.logError(t._logSource,e,"ReorderItemsRefresh")})},r._switchToDigestMode=function(){r._inDigestMode=!0,r.properties.title=v.y,r.render()},r._switchToViewMode=function(){r._inDigestMode=!1,r.properties.title=v.K,r.render()},r._logNewsWebpartRender=function(e){for(var t=0,n=0,a=0,i=0,o=r.properties.filters&&r._isDefaultFilter,s=Math.min(e.length,r.totalItemsToRender),c=0;c<s;c++)e[c].hasOwnProperty("isAuthoritative")&&e[c].isAuthoritative&&t++,e[c].hasOwnProperty("originalSourceUrl")&&e[c].originalSourceUrl&&a++,e[c].hasOwnProperty("isBoostedNews")&&e[c].isBoostedNews&&i++,r.properties.pinnedItems&&r.properties.pinnedItems[c]&&!r.properties.pinnedItems[c].isHelpArticle&&n++;C.e.logNewsEngagement({component:"NewsWebPart",layoutId:r.activeLayoutInfo.id,logTag:"NewsWebPart",usageType:"Render",workload:r._workload,extraData:{newsDataSourceProvider:r.properties.newsDataSourceProp,totalNewsItemsRendered:r.totalItemsToRender,newsFilterProperties:r.properties.filters&&r.properties.filters.map(function(e){return e.filterType}),orgNewsCount:t,pinnedNewsCount:n,newsLinkCount:a,isDefaultFilter:o,boostedNewsCount:i,isSeeAll:r._isOnSeeAll}})},r._logNewsItemClickEvent=function(e,t,n){var i,o=!!(null===(i=r.properties.pinnedItems)||void 0===i?void 0:i.length)&&0!==r.properties.pinnedItems.filter(function(t){return!!t&&h.NewsUtilities.getNewsItemKey(t,"")===h.NewsUtilities.getNewsItemKey(e.item,"")}).length,s=!!e.item.hasOwnProperty("isAuthoritative")&&e.item.isAuthoritative,d=!!e.item.hasOwnProperty("originalSourceUrl")&&!!e.item.originalSourceUrl,l=r.properties.filters&&r._isDefaultFilter,u=!!e.item.hasOwnProperty("isBoostedNews")&&e.item.isBoostedNews;c.DisplayMode.Read===r.displayMode&&C.e.logNewsEngagement(Object(a.__assign)(Object(a.__assign)({},e),{extraData:{clickedNewsPosition:t,totalNewsItemsRendered:r.totalItemsToRender,newsDataProvider:r.properties.newsDataSourceProp,newsFilterProperties:r.properties.filters&&r.properties.filters.map(function(e){return e.filterType}),isNewsPinned:o,isOrgNews:s,isNewsFeatured:n,isNewsLink:d,isDefaultFilter:l,isBoostedNews:u,isSeeAll:r._isOnSeeAll}}))},r}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"newsActiveLayoutInfo",{get:function(){return this.activeLayoutInfo},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newsItems",{get:function(){return this._newsItems},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"viewCountsRequestsInProgress",{get:function(){return this._viewCountsRequestsInProgress},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newsWebPartProps",{get:function(){return this.properties},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newsLayouts",{get:function(){return this.layouts},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"backgroundTheme",{get:function(){return this.sectionBackgroundTheme},enumerable:!1,configurable:!0}),t.prototype.basePropertyPaneFieldChanged=function(t,n,a){e.prototype.onPropertyPaneFieldChanged.call(this,t,n,a)},t.prototype.setLayoutById=function(t){e.prototype.setLayoutById.call(this,t)},Object.defineProperty(t.prototype,"options",{get:function(){return{qosPrefix:"NewsWebPart",requirePageContextVariables:!0,showTitle:!this._isNewsDigestLayout,displayPlaceholderTitleInReadMode:!this._isNewsDigestLayout,deprecated_canCacheResults:this.shouldUseMySiteCache,isRenderAsync:this._isRenderAsync,temporary_isTieredCacheImplementedInDataProvider:!0,isCustomerPromiseInitialized:O.e.isNewsCommonCustomerPromiseEnabled()}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shouldUseMySiteCache",{get:function(){var e=this.properties.audienceTargetingEnabled;return!this._isOnSeeAll&&!this._isNewsDigestLayout&&(this.isHubNews||this._isMultiSiteNews||this._isMyNews||!!e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"layouts",{get:function(){var e=this.context.pageContext,t=this.properties,n=t.showNewsMetadata,i=t.showCallToAction,r={createNewsItem:this._createNewsItem,getLayoutId:g.t.getLayoutId,initializeImages:this.initializeImages,isEligibleForCssTextTruncate:g.t.determineCssTextTruncateEligibility(),isLoading:!1,items:this._newsItems,itemSizeStyle:A.c,locale:e.cultureInfo.currentCultureName,newsStyleGetClassName:k.e.getClassNames,onImageRender:this.onImageRender,pageContext:e,renderCompleted:this.renderCompleted,renderImageArea:this._renderNewsItemImageArea,renderTitle:this._renderNewsItemTitle,serviceScope:this.context.serviceScope,showNewsMetadata:n,newsItemStyles:Object(a.__assign)({},M.e),totalItemsWithImages:this._totalItemsWithImages,showCallToAction:i};return[{id:g.t.getLayoutId(0),componentId:H,loadLayout:g.n.loadFeaturedNewsLayout,option:g.e.loadFeaturedNewsLayoutOptions(this.properties.layoutId),properties:Object(a.__assign)({},r)},{id:g.t.getLayoutId(1),componentId:H,loadLayout:g.n.loadListNewsLayout,option:g.e.loadListNewsLayoutOptions(this.properties.layoutId),properties:Object(a.__assign)(Object(a.__assign)({},r),{infiniteScrollCallback:this._onL2InfiniteScroll.bind(this),itemCountOnInfiniteScroll:50,digestModeCallback:this._switchToDigestMode,switchOutOfDigestModeCallback:this._switchToViewMode})},{id:g.t.getLayoutId(2),componentId:H,loadLayout:g.n.loadGridNewsLayout,option:g.e.loadGridNewsLayoutOptions(this.properties.layoutId),properties:Object(a.__assign)({},r)},{id:g.t.getLayoutId(3),componentId:H,loadLayout:g.n.loadNewsDigestLayout,option:g.e.loadNewsDigestLayoutOptions(this.properties.layoutId),properties:Object(a.__assign)(Object(a.__assign)({},r),{reorderItemCallback:this._reorderNewsItems,canReorder:this.displayMode===c.DisplayMode.Edit})},{id:g.t.getLayoutId(4),componentId:H,loadLayout:g.n.loadNewsHubLayout,option:g.e.loadNewsHubLayoutOptions(this.properties.layoutId),properties:Object(a.__assign)({},r)},{id:g.t.getLayoutId(5),componentId:"8ac0c53c-e8d0-4e3e-87d0-7449eb0d4027",loadLayout:g.n.loadCarouselNewsLayout,option:g.e.loadCarouselNewsLayoutOptions(this.properties.layoutId),properties:Object(a.__assign)({},r)},{id:g.t.getLayoutId(6),componentId:"9586b262-54de-4b27-9eb9-34c671400c33",loadLayout:g.n.loadHeroNewsLayout,option:g.e.loadHeroNewsLayoutOptions(this.properties.layoutId),properties:Object(a.__assign)({},r)}]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"propertiesMetadata",{get:function(){return{title:{isSearchablePlainText:!0},baseUrl:{isLink:!0},layoutComponentId:{isComponentDependency:!0},carouselHeroWrapperComponentId:{isComponentDependency:!0}}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataProviders",{get:function(){return[this._newsDataProviderInfo,this._viewCountsDataProviderInfo,this._staleViewCountsDataProviderInfo,this._hubNewsDataProviderInfo,this._newsDigestDataProviderInfo,this._multiSiteNewsDataProviderInfo,this._myNewsDataProviderInfo]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"viewCountsDataProviderInfo",{get:function(){return this._viewCountsDataProviderInfo},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"propertyPaneRenderedByWebPart",{get:function(){return this.properties.layoutId!==g.t.getLayoutId(3)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isOneBox",{get:function(){var e;return"onebox"===(null===(e=this.context.pageContext.legacyPageContext)||void 0===e?void 0:e.env2)},enumerable:!1,configurable:!0}),t.prototype.updateViewCountsDataProviderInfo=function(e){this._viewCountsDataProviderInfo={id:h.viewCounts,loadDataProvider:function(e){return Promise.resolve(new h.ExchangeViewCountsDataProvider(e))},options:{serviceScope:this.context.serviceScope,newsItems:e}}},t.prototype.updateStaleViewCountsDataProviderInfo=function(e){this._staleViewCountsDataProviderInfo={id:h.staleViewCounts,loadDataProvider:function(e){return Promise.resolve(new h.ExchangeViewCountsDataProvider(e))},options:{serviceScope:this.context.serviceScope,newsItems:e}}},Object.defineProperty(t.prototype,"dataVersion",{get:function(){return c.Version.parse("1.12")},enumerable:!1,configurable:!0}),t.prototype.onAfterDeserialize=function(e,t){return t.lessThan(c.Version.parse("1.2"))&&void 0===e.showChrome&&(e.showChrome=!0),t.lessThan(c.Version.parse("1.4"))&&void 0!==e.pinnedItems&&(e.pinnedItems=void 0),t.lessThan(c.Version.parse("1.6"))&&(e.carouselSettings||(e.carouselSettings={autoplay:!1,autoplaySpeed:5,dots:!0,lazyLoad:!0})),t.lessThan(c.Version.parse("1.11"))&&(e.showNewsMetadata={showSocialActions:!1,showAuthor:!0,showDate:!0}),e},t.prototype.onInit=function(){var t=this;this.properties.layoutId||(this.properties.layoutId=this.getDefaultLayout());var n=this._loadNewsEditModeOnDemand(),a=this._loadSeeAllOnDemand();return Object(w.I)()||(this._onNewPrefetchDataResolved=function(){}),this.isMicroserviceSupported=!Object(w.b)()&&this._isMicroserviceSupported(),Object(w.h)()||this._verifyHubNewsSettings(),Promise.all([n,a]).then(function(){return t.initializeDynamicComponents(),t._initScrollCounters(),t._updateRenderCounters(),t.setWebPartTitle(),t._setAudienceTargetingMode(),Object(w.i)()&&t._loadDataProviderById(t.properties.dataProviderId),t.updateViewCountsDataProviderInfo(void 0),t.updateStaleViewCountsDataProviderInfo(void 0),window.addEventListener("message",t._handleAppMessage),t.properties.filters=t.properties.filters||[Object(o.cloneDeep)(b.e)],(Object(w.b)()||t.isMicroserviceSupported&&!t._isFilterForCurrentSiteOnly)&&t.ensureMicroServiceIsAvailable().catch(function(){}),t._setInitialPropertyValues().then(function(){if(O.e.isNewsCommonCustomerPromiseEnabled())t.initializeCustomerPromise(B,3e3,{hasCacheDataRender:!0,hasFlushedDataRender:!0,hasFreshDataRender:!0,hasImages:!0,pageType:t._isOnSeeAll?"L2":"L1"});else{var n={scenario:B};t._customerPromise=new P.CustomerPromise(n)}return Object(w.p)()||!t.isHubNews&&!t._isMultiSiteNews||(m._PerformanceLogger.trackWebpartFlight(t.context.webPartTag,m._PerformanceFlight.NewsHaukAPIFlight),m._PerformanceLogger.trackWebpartExperiment(t.context.webPartTag,m._PerformanceExperiment.NewsHaukAPIExperiment)),Object(w.u)()||!t.isHubNews&&!t._isMultiSiteNews||(m._PerformanceLogger.trackWebpartFlight(t.context.webPartTag,m._PerformanceFlight.AsyncDataPrefetchClientNewsFlight),m._PerformanceLogger.trackWebpartExperiment(t.context.webPartTag,m._PerformanceExperiment.AsyncDataFlushExperiment)),!Object(w.m)()&&t._isMyNews&&(m._PerformanceLogger.trackWebpartFlight(t.context.webPartTag,m._PerformanceFlight.MyNewsHaukAPIFlight),m._PerformanceLogger.trackWebpartExperiment(t.context.webPartTag,m._PerformanceExperiment.MyNewsHaukAPIExperiment)),Object(w._)()||t.properties.newsDataSourceProp!==h.NewsDataSource.CurrentSite||(m._PerformanceLogger.trackWebpartFlight(t.context.webPartTag,m._PerformanceFlight.NewsUseGetMultiSiteForThisSite),m._PerformanceLogger.trackWebpartExperiment(t.context.webPartTag,m._PerformanceExperiment.NewsUseGetMultiSiteForThisSiteExp)),Object(w.f)()||(m._PerformanceLogger.trackWebpartExperiment(t.context.webPartTag,m._PerformanceExperiment.NewsCustomerPromiseExperiment),m._PerformanceLogger.trackWebpartFlight(t.context.webPartTag,m._PerformanceFlight.NewsCustomerPromiseFlight)),e.prototype.onInit.call(t)})})},Object.defineProperty(t.prototype,"defaultTitle",{get:function(){return v.K},enumerable:!1,configurable:!0}),t.prototype.getDefaultLayout=function(){var e=this.layoutId;return Boolean(e)?e:this.isOnHubSite?g.t.getLayoutId(4):this._isOnCommSite?g.t.getLayoutId(2):void 0},t.prototype.getDisplayFieldMap=function(e,t){},t.prototype.transposeRow=function(e,t,n){var i=n.publishedOn,r=n.publishedOnRelativeTime,o=i?i instanceof Date?i:new Date(i):new Date;return Object(a.__assign)(Object(a.__assign)({},n),{publishedOnRelativeTime:r||l.LocaleFormat.formatRelativeTimeApproximate(o,{oneWeekCutoff:!0})})},t.prototype.transposeItems=function(e,n,a){var i=this,r=this._mergePinnedAndNewsItems(a),o=this.properties.showNewsMetadata;if(o&&!o.showSocialActions||!this._isPinnedItemsDefined())return this._logOrgNewsCount(r),r;if(this._isPinnedItemsDefined()&&!this.staleViewCountsRendered){var c=this.properties.pinnedItems.filter(function(e){return e&&!e.isHelpArticle}),d=this._dataProviderIdForReset;this.requestViewCountsForPinnedItems(c).then(function(){i.staleViewCountsRendered=!0,i.render(),O.e.isNewsCommonCustomerPromiseEnabled()||(i._customerPromiseStatus.pinnedItemViewCountsReRendered=!0),d&&i.setDataProviderById(d)}).catch(function(e){return s._TraceLogger.logError(t._logSource,e,"TransposePinnedViewCount")})}return this._logOrgNewsCount(r),r},t.prototype.getPrefetchedData=function(e,t){var n;n=new s._QosMonitor("GetPrefetchedData");var a=!Object(w.D)()&&this.properties.filters&&this._isDefaultFilter;if(this._isPrefetchedDataNeeded(t)||a){this._customerPromisePrefetchStatus={hit:!1};var i,r=y.getNewsPrefetchData();if(Object(w.I)()||this._hasEnrolledToPrefetchUpdates||(h.NewsUtilities.trackPrefetchDataUpdated(this.context.serviceScope,{onDataUpdated:this.onPrefetchDataUpdated}),this._hasEnrolledToPrefetchUpdates=!0),!Boolean(r))return n.writeUnexpectedFailure(N),void(O.e.isNewsCommonCustomerPromiseEnabled()?this.updateCustomerPromiseFlushedDataRenderStatus({error:"PrefetchDataNotAvailable"}):this._customerPromisePrefetchStatus.failedReason=N);if(r){var o=r.instanceId;if(o&&this.instanceId!==o||!r.sitePageMetadataList){var c="".concat(R,"InstanceIDMismatch");return n.writeExpectedFailure(c),void(O.e.isNewsCommonCustomerPromiseEnabled()?this.updateCustomerPromiseFlushedDataRenderStatus({error:"PrefetchDataNotUsableInstanceIDMismatch"}):this._customerPromisePrefetchStatus.failedReason=c)}i=r.sitePageMetadataList,Object(w.I)()||y.invalidatePrefetchData()}var d=h.NewsUtilities.extractNewsItems(i,this.context.pageContext);if(5!==d.length||void 0!==this.properties.prefetchCount||this.properties.layoutId!==g.t.getLayoutId(4))return this._isPrefetchedDataAvailable=0!==d.length,n.writeSuccess({service:d.length}),O.e.isNewsCommonCustomerPromiseEnabled()?(this._latestRender="FLUSH",this.updateCustomerPromiseFlushedDataRenderStatus({isFlushedDataEmpty:!this._isPrefetchedDataAvailable,isFlushOnTime:!0})):(this._customerPromisePrefetchStatus.emptyData=!this._isPrefetchedDataAvailable,this._customerPromisePrefetchStatus.hit=!0,this._customerPromiseStatus.didRenderFromPrefetch=!0),this._isPrefetchedDataAvailable?d:this.getEmptyStateRows(t,e);this._shouldMonitorPrefetch&&(c="".concat(R,"HubNewsLayout"),n.writeExpectedFailure(c),O.e.isNewsCommonCustomerPromiseEnabled()?this.updateCustomerPromiseFlushedDataRenderStatus({error:"PrefetchDataNotUsable"}):this._customerPromisePrefetchStatus.failedReason=c)}else n.writeExpectedFailure("PrefetchDataNotNeeded")},t.prototype.getPrefetchedDataAsync=function(e,t){var n=this;if(!Object(w.I)()){var a=new s._QosMonitor("getPrefetchedDataAsync");return new Promise(function(e,t){n._onNewPrefetchDataResolved=e}).then(function(e){if(n._customerPromisePrefetchStatus.flushOnTime=!1,e&&e.length>0)return a.writeSuccess(),e;if(n._isPrefetchedDataNeeded(t)){var i="PrefetchDataNotAvailable";a.writeUnexpectedFailure(i),n.updateCustomerPromiseFlushedDataRenderStatus({error:i})}})}return new Promise(function(a,i){var r=window._spNewsWebPartDataLoaded;window._spNewsWebPartDataLoaded=function(){var i=new s._QosMonitor("getPrefetchedDataAsync");"function"==typeof r&&r(),n._customerPromisePrefetchStatus.flushOnTime=!1;var o=n.getPrefetchedData(e,t);if(o&&o.length>0)i.writeSuccess(),a(o);else if(n._isPrefetchedDataNeeded(t)){var c="NoPrefetchedData";i.writeUnexpectedFailure(c),O.e.isNewsCommonCustomerPromiseEnabled()?n.updateCustomerPromiseFlushedDataRenderStatus({error:"PrefetchDataNotAvailable"}):n._customerPromisePrefetchStatus.failedReason=c}}})},t.prototype.onDisplayModeChanged=function(t){e.prototype.onDisplayModeChanged.call(this,t),this._loadNewsEditModeOnDemand().catch(function(e){})},t.prototype._isPrefetchedDataNeeded=function(e){return!(this._isOnSeeAll||this._isNewsDigestLayout||h.NewsUtilities.isPrefetchStale(this.context.pageContext.site.absoluteUrl)||this.isHubNews||this._isMultiSiteNews||this._isMyNews||this.properties.audienceTargetingEnabled)},t.prototype._fallbackToCurrentSiteWhenNoMicroService=function(e){var t=this;if(void 0===e&&this.isHubNews&&!this.isMicroserviceAvailable){var n=this.properties.newsDataSourceProp;return this.properties.newsDataSourceProp=h.NewsDataSource.CurrentSite,setTimeout(function(){return t.onPropertyPaneFieldChanged(h.newsDataSourceProp,n,t.properties.newsDataSourceProp)},1e3),!0}return!1},t.prototype.onPreRender=function(e,n,a){var i=this;if(this._shouldSkipViewCount(n)?(O.e.isNewsCommonCustomerPromiseEnabled()||(this._customerPromiseStatus.totalTimesViewcountsRendered++,this._customerPromiseStatus.totalTimesDataRendered++),this._newsItems=a):n===h.viewCounts||n===h.staleViewCounts?(O.e.isNewsCommonCustomerPromiseEnabled()||this._customerPromiseStatus.totalTimesViewcountsRendered++,this._newsItems=a):(O.e.isNewsCommonCustomerPromiseEnabled()||this._customerPromiseStatus.totalTimesDataRendered++,this.requestViewCounts(a)),this._fallbackToCurrentSiteWhenNoMicroService(a))return Promise.resolve(this._getLayoutState(this.properties.showChrome,!1,!1,!1));void 0===a&&(a=[]),this.getNewsRedirectUrls(!1);var r=this.isContributor&&!c._BrowserUtilities.isMobileBrowser()&&(O.e.isCreateNewPagesInTeamsEnabled()&&!c._BrowserUtilities.isEmbeddedInSite()||!c._BrowserUtilities.isEmbedded())&&(O.e.isCreateNewPagesInTeamsEnabled()||!c._BrowserUtilities.isTeamsHosted())&&!this._isNewsDigestLayout&&!this._inDigestMode&&this.properties.newsDataSourceProp!==h.NewsDataSource.MyNews&&(!(!a||!a.length)||!this.properties.hideWebPartWhenEmpty),o=a.filter(function(e){return!e.isHelpArticle}),d=!this._isOnSeeAll&&!this._isNewsDigestLayout&&o.length>this.totalItemsToRender,l=d&&this.isContributor&&this.displayMode!==c.DisplayMode.Edit&&this._showTeachingBubble;return this.updateActiveLayoutProp("allowInfiniteScrolling",this._isOnSeeAll),this.updateActiveLayoutProp("totalItemsToRender",this.totalItemsToRender),this.updateActiveLayoutProp("showAddButton",r),this.updateActiveLayoutProp("workload",this._workload),this.updateActiveLayoutProp("showCheckboxes",this._inDigestMode),this.updateActiveLayoutProp("compactMode",this.properties.compactMode),this.updateActiveLayoutProp("showNewsMetadata.showSocialActions",this.properties.showNewsMetadata.showSocialActions),this.updateActiveLayoutProp("showNewsMetadata.showAuthor",this.properties.showNewsMetadata.showAuthor),this.updateActiveLayoutProp("showNewsMetadata.showDate",this.properties.showNewsMetadata.showDate),O.e.isCallToActionEnabled()&&this.updateActiveLayoutProp("showCallToAction",this.properties.showCallToAction),this.updateActiveLayoutProp("logClickEvent",this._logNewsItemClickEvent),o&&o.length&&this._ensureObserver(this.domElement,o),Promise.resolve().then(function(){if(i._isCarousel())return I.loadCarousel().then(function(e){i.updateActiveLayoutProp("carouselComponentClass",e)}).catch(function(e){throw s._TraceLogger.logError(t._logSource,e,"CarouselLoader"),e});if(i._isHero()){var e=i.width>639;return(e?x.t.loadHeroLayout():I.loadCarousel()).then(function(t){var n;e?(i.updateActiveLayoutProp("heroPatternComponentClass",t),n=I.loadCarousel()):(i.updateActiveLayoutProp("carouselComponentClass",t),n=x.t.loadHeroLayout()),setTimeout(function(){return i.loadSecondaryLayout(e,n)},100)}).catch(function(e){throw s._TraceLogger.logError(t._logSource,e,"PrimaryLayoutLoad"),e})}}).then(function(){return i._getLayoutState(i.properties.showChrome,r,d,l)})},t.prototype.onPostRender=function(e,t,n){var a=this;return this._isOnSeeAll||this._teachingBubbleTimeout||(this._teachingBubbleTimeout=setTimeout(function(){a._checkNewsDigestFirstRun()},4e3)),O.e.isNewsCommonCustomerPromiseEnabled()?this.logPostRenderCustomerPromise():this._didRequestCustomerPromiseLogging||(this._didRequestCustomerPromiseLogging=!0,setTimeout(function(){a.logCustomerPromise()},3500)),Promise.resolve(void 0)},t.prototype.logCustomerPromise=function(){if(this.isReadyToResolveCustomerPromise()){var e=this.getCustomerPromiseBaseEndSchema();e.extraData=Object(a.__assign)(Object(a.__assign)({},e.extraData),{isL2Page:this._isOnSeeAll,dataProvider:!!this._customerPromiseDataProviderStatus&&this._customerPromiseDataProviderStatus.dataSource,renderedFromPrefetch:this._customerPromiseStatus.didRenderFromPrefetch,renderedFromCache:this._customerPromiseStatus.didRenderFromCache,renderedServerAPIData:this._customerPromiseStatus.didRenderFromServer,totalTimesRendered:this.rendersCompleted,totalTimesNewsDataRendered:this._customerPromiseStatus.totalTimesDataRendered,totalTimesViewcountsRendered:this._customerPromiseStatus.totalTimesViewcountsRendered,pinnedItemMetadataRefreshed:this._customerPromiseStatus.pinnedItemMetadataRefreshed,pinnedItemViewCountsReRendered:this._customerPromiseStatus.pinnedItemViewCountsReRendered,shouldViewCountsBeRendered:this.properties.showNewsMetadata&&this.properties.showNewsMetadata.showSocialActions}),this._customerPromise.end(e)}},t.prototype.getCustomerPromiseBaseEndSchema=function(){var e=!!this._customerPromisePrefetchStatus&&!this._customerPromisePrefetchStatus.hit,t=!!this._customerPromiseLKGStatus&&!this._customerPromiseLKGStatus.hit,n=!!this._customerPromiseDataProviderStatus&&!this._customerPromiseDataProviderStatus.apiSuccess,i={resultType:(t||e)&&n?u.ResultTypeEnum.Failure:u.ResultTypeEnum.Success,extraData:{}};return(e||t||n)&&(i.errorCode=""),e&&(i.errorCode+="PREFETCH_FAILED--",i.extraData=Object(a.__assign)(Object(a.__assign)({},i.extraData),{prefetchError:"Prefetch Error: ".concat(this._customerPromisePrefetchStatus.failedReason)})),t&&(i.errorCode+="LKG_FAILED--",i.extraData=Object(a.__assign)(Object(a.__assign)({},i.extraData),{lkgError:"LKG Error: ".concat(this._customerPromiseLKGStatus.failedReason)})),n&&(i.errorCode+="API-FAILED",i.extraData=Object(a.__assign)(Object(a.__assign)({},i.extraData),{apiError:"API Error: ".concat(this._customerPromiseDataProviderStatus.apiFailedReason)})),i},t.prototype.isReadyToResolveCustomerPromise=function(){var e=this.rendersRequested===this.rendersCompleted+this.failedRendersCompleted;return(this.properties.showNewsMetadata&&!this.properties.showNewsMetadata.showSocialActions||this.rendersRequested>1)&&e},t.prototype.initializeDynamicComponents=function(){this.properties.carouselHeroWrapperComponentId=this._isCarousel()||this._isHero()?U:H},t.prototype.onDispose=function(){this._teachingBubbleTimeout&&clearTimeout(this._teachingBubbleTimeout),window.removeEventListener("message",this._handleAppMessage,!1),e.prototype.onDispose.call(this),this._webPartObserver&&this._webPartObserver.unobserve(this.domElement),e.prototype.onDispose.call(this)},t.prototype.onBeforeSerialize=function(){this._updateRenderCounters()},t.prototype.onAfterResize=function(e){this.component&&this.activeLayoutInfo&&this.render()},Object.defineProperty(t.prototype,"disableReactivePropertyChanges",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.loadPropertyPaneResources=function(){var e;return null===(e=this._editor)||void 0===e?void 0:e.loadPropertyPaneResources()},t.prototype.getPropertyPaneConfiguration=function(){var e;return null===(e=this._editor)||void 0===e?void 0:e.getPropertyPaneConfiguration()},t.prototype.onPropertyPaneConfigurationStart=function(){var e;null===(e=this._editor)||void 0===e||e.onPropertyPaneConfigurationStart()},t.prototype.onPropertyPaneFieldChanged=function(e,t,n){var a;null===(a=this._editor)||void 0===a||a.onPropertyPaneFieldChanged(e,t,n)},t.prototype.onAfterPropertyPaneChangesApplied=function(){var e;null===(e=this._editor)||void 0===e||e.onAfterPropertyPaneChangesApplied()},Object.defineProperty(t.prototype,"dataCacheConfiguration",{get:function(){var e=h.NewsUtilities.isOnSeeAllPage,t={audienceTargetingEnabled:this.properties.audienceTargetingEnabled,hubId:this.hubId,serializedFilterQuery:this.properties.serializedFilterQuery,siteList:this.properties.newsSiteList};return e?Object(a.__assign)(Object(a.__assign)({},t),{canCacheRequest:!0,count:50,skip:this._totalItemsRequested+=50,isPaginationRequest:!Object(w.c)()}):Object(a.__assign)(Object(a.__assign)({},t),{canCacheRequest:!!Object(w.r)()||this.shouldUseMySiteCache,count:this.requestItemsPerInfiniteScroll?50:this._totalItemsToRequest+1,skip:this.requestItemsPerInfiniteScroll&&this._newsItems?this._newsItems.length:0})},enumerable:!1,configurable:!0}),t.prototype.postProcessTieredCachedData=function(e){return h.NewsUtilities.extractNewsItems(e,this.pageContext)},t.prototype.getRequest=function(e,t){var n,i;if(e===h.news||e===h.hubNews||e===h.multiSiteNews||e===h.myNews||e===h.newsDigest){var r=this.dataCacheConfiguration,o=this._getEmptyNewsArticleType(),s=this._emptyStateHelpItemsCount();return Object(a.__assign)(Object(a.__assign)({},r),{callerHeader:"PagesWeb",isCallToActionEnabled:O.e.isGetMultiSiteForThisSiteEnabled(this.isOneBox)?null===(n=this.properties)||void 0===n?void 0:n.showCallToAction:void 0,isOneBox:this.isOneBox,emptyItemType:o,emptyItemsCount:s,onServerResponseResolvedWithCache:this.setResponseAndRender,onServerResponseResolved:this.onServerResponseResolved,onServerResponseFailed:this.onServerResponseFailed,onCacheResponseResolved:this.renderedFromCacheData,onCacheResponseFailed:this.onCacheResponseFailed,onCacheThenNetworkServerDataNotReturned:this.onCacheThenNetworkServerDataNotReturned,prefetchUpdateOptions:{onDataUpdated:this.setResponseAndRender},fieldDictionary:null===(i=this._editor)||void 0===i?void 0:i.queryableListFields(),filterKQLQuery:this.properties.filterKQLQuery,filters:this.properties.filters,languageOverride:this._pageLanguage,webpartWidth:this.width,webpartId:this.context.instanceId})}return e===h.viewCounts?this._newsItems&&this._newsItems.filter(function(e){return!e.isHelpArticle}):e===h.staleViewCounts?this._isPinnedItemsDefined()&&this.properties.pinnedItems.filter(function(e){return!e.isHelpArticle}):void 0},t.prototype.requestViewCountsBase=function(e){var t=this;return this._isNewsDigestLayout?Promise.resolve([]):(this._viewCountsRequestsInProgress++,this.refreshData(void 0,e,!1).then(function(e){return t._viewCountsRequestsInProgress--,Promise.resolve(e)}))},t.prototype.requestViewCounts=function(e){var n,a=this,i=this.properties.showNewsMetadata;if((this.enablingViewCounts||this._newsItems!==e)&&(this._newsItems=e,!i||i.showSocialActions||this._isPinnedItemsDefined()||(null===(n=this._editor)||void 0===n?void 0:n.isPinningPanelOpen))){var r=this._dataProviderIdForReset;this.updateViewCountsDataProviderInfo(e),this.setDataProviderById(h.viewCounts),this.requestViewCountsBase().then(function(){a._newsItems===e&&(a._hasRenderedWithFreshData=!0,a.render()),r&&a.setDataProviderById(r)}).catch(function(e){return s._TraceLogger.logError(t._logSource,e,"RequestViewCounts")})}},t.prototype.requestViewCountsForPinnedItems=function(e){var t=this,n=this.properties.showNewsMetadata;return n&&!n.showSocialActions?Promise.resolve():(this.updateStaleViewCountsDataProviderInfo(e),this.setDataProviderById(h.staleViewCounts),this.requestViewCountsBase(p.RefreshType.Compare).then(function(e){return t.properties.pinnedItems.forEach(function(n,a){if(!n.isHelpArticle)for(var i=0;i<e.length;i++){var r=e[i];if(h.NewsUtilities.getNewsItemKey(n,"")===h.NewsUtilities.getNewsItemKey(r,"")){t.properties.pinnedItems[a]=r;break}}}),t.setDataProviderById(h.viewCounts),Promise.resolve()}))},t.prototype.getEmptyStateRows=function(e,t){if(this._isOnSeeAll&&this._newsItems&&this._newsItems.length>0||this._isNewsDigestLayout||this.properties.hideWebPartWhenEmpty)return[];var n=this._emptyStateHelpItemsCount(),a=h.NewsEmptyStateType.None;a=this._shouldUseStockCarouselItems?h.NewsEmptyStateType.Carousel:this._isOnCommSite?h.NewsEmptyStateType.CommSite:h.NewsEmptyStateType.TeamSite;var i=h.NewsUtilities.getEmptyStateItems(a,this.context.serviceScope,n,this.width);return(this._isFeaturedNews(e)||this._shouldUseStockCarouselItems?[]:[h.NewsUtilities.getTipActionNewsItem(this.isContributor,this.pageContext.web.absoluteUrl)]).concat(i)},t.prototype.isOnL2Page=function(e){return e===g.t.getLayoutId(1)&&h.NewsUtilities.isOnSeeAllPage},t.prototype.setWebPartTitle=function(){if(this._isOnSeeAll){var e=h.NewsUtilities.extractParamFromUrl("title",window.location.href);e&&(this.properties.title=e)}},t.prototype._getDataSource=function(){switch(this.properties.newsDataSourceProp){case h.NewsDataSource.CurrentSite:return"CurrentSite";case h.NewsDataSource.ChooseSites:return"MultiSite";case h.NewsDataSource.Hub:return"Hub";case h.NewsDataSource.MyNews:return"Recommended"}},t.prototype._setAudienceTargetingMode=function(){if(this._isOnSeeAll){var e=h.NewsUtilities.extractParamFromUrl(F,window.location.href);e&&(this.properties.audienceTargetingEnabled=Boolean(e))}},t.prototype._getLayoutState=function(e,n,a,i){var o,s,d,l=this,u=c._BrowserUtilities.isWebViewHosted()?void 0:{show:i,text:v.S,onDismiss:this._onDismissTeachingBubble,primaryButtonProps:{text:v._,href:t._teachingBubbleLearnMoreUrl,target:"_blank"}},p={showTitle:e,addButton:{show:e&&n,label:v.t,ariaLabel:v.e,disabled:this.displayMode===c.DisplayMode.Edit,automationId:"newsAddButton"},seeAllLink:{show:e&&a,href:this._seeAllNewsUrl,label:v.z,ariaLabel:v.V,disabled:this.displayMode===c.DisplayMode.Edit,onClick:function(){l._logClickSeeAllButton()},action:JSON.stringify({properties:this.properties}),automationId:"newsSeeAllLink",teachingBubble:u}};if(1===this.panelElementType&&(p.panelElement=null===(s=this._editor)||void 0===s?void 0:s.loadPinningPanelElement()),this.pageContext.site.sitePagesFeatureVersion>=8){p.addButton.split=!0;var m=Object(r.getTheme)(),_="menuPropsClass";if(p.addButton.menuProps={styles:{root:{selectors:(o={},o[".menuPropsClass button:hover"]=[{backgroundColor:m.semanticColors.menuItemBackgroundHovered}],o[".menuPropsClass button"]=[{color:m.semanticColors.bodyText,backgroundColor:m.semanticColors.bodyBackground}],o)}},items:[{key:"newspost",name:v.w,onClick:this._handleNewsPostClick,"data-automation-id":"newsPostOption",className:_},{key:"newslink",name:v.I,onClick:this._handleNewsLinkClick,"data-automation-id":"newsLinkOption",className:_}]},2===this.panelElementType)return void 0!==this._isModerationEnabled?(this._setNewsLinkPanelElement(p),Promise.resolve(p)):(d=this.context.serviceScope,new Promise(function(e,t){d.whenFinished(function(){var t=d.consume(f.PageService.serviceKey);try{return t.getPagePublishInfo().then(function(t){return e(t.enableModeration)}).catch(function(t){return e(!1)})}catch(t){e(!1)}})})).then(function(e){return l._isModerationEnabled=e,l._setNewsLinkPanelElement(p),Promise.resolve(p)})}else p.addButton.href=this._addNewsArticleUrl,p.addButton.onClick=function(){l._logClickAddButton()};return Promise.resolve(p)},t.prototype._setNewsLinkPanelElement=function(e){e.panelElement=i.createElement(this._newsLinkPanel,{createMode:!0,isModerationEnabled:this._isModerationEnabled,onClosePanelClick:this._handleNewsLinkPanelClose,serviceScope:this.context.serviceScope,showPanel:this._showNewsLinkPanel})},t.prototype._requestNewsItemsByUniqueId=function(e){if(0===e.length)return Promise.resolve([]);var t=new s._QosMonitor("NewsWebpart.SearchNewsItemsToRefreshData");return h.NewsSearchDataProvider._requestNewsData({contentLocation:_.ContentLocation.AllSites,rowLimit:L.e,serviceScope:this.context.serviceScope,startRow:0,uniqueIdGuids:e}).then(function(e){return t.writeSuccess(),Promise.resolve(e)}).catch(function(e){return t.writeUnexpectedFailure("FailToSearchNewsItemsToRefreshData",e),Promise.resolve([])})},t.prototype._updateCDNImageUrl=function(e){this._isPinnedItemsDefined()&&e.forEach(function(e){e&&!e.isHelpArticle&&(e.image=h.NewsUtilities.getResourceFromPrivateCDNUrl(e.image))})},t.prototype._isMicroserviceSupported=function(){var e,t;return Boolean(Number(null===(t=null===(e=this.context.pageContext.legacyPageContext)||void 0===e?void 0:e.farmSettings)||void 0===t?void 0:t.ExternalService_issphomemicroservicesupported))},t.prototype._setInitialPropertyValues=function(){var e=this;Object(w.h)()&&this._verifyHubNewsSettings(),this._initializePinnedItems();var t=this.properties.showNewsMetadata;return(this._isOnSeeAll||void 0===t)&&(this.properties.showNewsMetadata={showSocialActions:this._isOnSeeAll,showAuthor:!0,showDate:!0}),f.Multilingual.getPageLanguage(this.context.serviceScope).then(function(t){return e._pageLanguage=t&&t.LanguageCode,e._setNewsDataSource().then(function(){e.properties.dataProviderId&&e.properties.dataProviderId!==h.viewCounts&&e.properties.dataProviderId!==h.staleViewCounts||(e.properties.dataProviderId=e.newsDataProviderId),e._refreshPinnedItemMetadata(),e.setDataProviderById(e.properties.dataProviderId),e.properties.newsSiteList=e.properties.newsSiteList||[],e.properties.renderItemsSliderValue=e.properties.renderItemsSliderValue||4})})},t.prototype._isCarousel=function(){return this.properties.layoutId===g.t.getLayoutId(5)},t.prototype._isHero=function(){return this.properties.layoutId===g.t.getLayoutId(6)},t.prototype._refreshPinnedItemMetadata=function(){var e=this;if(this._isPinnedItemsDefined()){var t=!1,n=this.properties.pinnedItems.filter(function(e){return e&&!e.isHelpArticle}).map(function(e){return c.Guid.tryParse(e.uniqueId)});this._requestNewsItemsByUniqueId(n).then(function(n){e.properties.pinnedItems.forEach(function(a,i){if(!a.isHelpArticle){var r=n.filter(function(e){return e&&a&&h.NewsUtilities.getNewsItemKey(e,"")===h.NewsUtilities.getNewsItemKey(a,"")})[0];if(h.NewsUtilities.didRenderedPropertiesChange(r,a)&&(e.properties.pinnedItems[i].description=r.description,e.properties.pinnedItems[i].image=r.image,e.properties.pinnedItems[i].title=r.title,t=!0),void 0!==r&&A.i._getFormattedDate(r.publishedOnRelativeTime,r.publishedOn,e.activeLayoutInfo.properties.locale)!==A.i._getFormattedDate(a.publishedOnRelativeTime,a.publishedOn,e.activeLayoutInfo.properties.locale)){var o=e.properties.pinnedItems[i];o.publishedOnRelativeTime=r.publishedOnRelativeTime,o.publishedOn=r.publishedOn,t=!0}}}),e._hasRenderedWithFreshData&&t&&(e.render(),O.e.isNewsCommonCustomerPromiseEnabled()||(e._customerPromiseStatus.pinnedItemMetadataRefreshed=!0))})}},t.prototype._verifyHubNewsSettings=function(){Object(w.h)()||h.NewsUtilities.isValidNewsSource(this.properties.newsDataSourceProp)||(this.properties.newsDataSourceProp=this.isOnHubSite?h.NewsDataSource.Hub:h.NewsDataSource.CurrentSite),this.isOnHubSite||this.properties.newsDataSourceProp!==h.NewsDataSource.Hub||(this.properties.newsDataSourceProp=h.NewsDataSource.CurrentSite),Object(w.h)()||this.isHubNews&&!this.isMicroserviceSupported&&(this.properties.newsDataSourceProp=h.NewsDataSource.CurrentSite,this.setDataProviderById(h.news))},t.prototype._initializePinnedItems=function(){var e=this;this._isPinnedItemsDefined()&&this.properties.pinnedItems.forEach(function(t,n){t&&!t.isHelpArticle&&void 0!==t.viewCounts&&(e.properties.pinnedItems[n].viewCounts=void 0,e.properties.pinnedItems[n].publishedOnRelativeTime=void 0,e.properties.pinnedItems[n]=e.transposeRow(e.properties.layoutId,e.properties.dataProviderId,e.properties.pinnedItems[n]))})},t.prototype._setNewsDataSource=function(){var e,t=this;if(this._isOnSeeAll){var n={dataVersion:this.dataVersion.toString(),delayedGetDataAndRender:this.delayedGetDataAndRender,editor:this._editor,isPrefetchedDataAvailable:this._isPrefetchedDataAvailable,properties:this.properties,serviceScope:this.context.serviceScope};return null===(e=this._seeAllChunk)||void 0===e?void 0:e.setNewsDataSourceSeeAll(n).catch(function(){var e;if(t._isFilterForCurrentSiteOnly)return null===(e=t._seeAllChunk)||void 0===e?void 0:e.filterSchemaSetupSeeAll(n)})}return h.NewsUtilities.isValidNewsSource(this.properties.newsDataSourceProp)||(this.properties.newsDataSourceProp=this.isOnHubSite?h.NewsDataSource.Hub:h.NewsDataSource.CurrentSite),Promise.resolve()},t.prototype.getNewsRedirectUrls=function(e){if(void 0===e&&(e=!1),!this._addNewsArticleUrl||e){var t=new u.Uri(u.Uri.concatenate(this.pageContext.web.absoluteUrl,Object(w.S)()?"/_layouts/15/CreateSitePage.aspx":"/_layouts/15/CreatePageFromTemplate.aspx"));t.setQueryParameter("source",window.location.pathname+window.location.search),t.setQueryParameter("promotedState","1"),this.activeLayoutInfo.properties.addNewsArticleUrl=this._addNewsArticleUrl=t.toString();var n=new u.Uri(u.Uri.concatenate(this.pageContext.web.absoluteUrl,"/_layouts/15/news.aspx"));this.properties.title&&n.setQueryParameter("title",this.properties.title),n.setQueryParameter("newsSource",this.properties.newsDataSourceProp.toString()),n.setQueryParameter("instanceId",this.context.instanceId),n.setQueryParameter("webPartId",this.componentId),n.setQueryParameter("serverRelativeUrl",window.location.pathname),this._isOnSeeAll||this._isNewsDigestLayout||!this.pageContext.list||n.setQueryParameter("pagesListId",this.pageContext.list.id.toString()),this.properties.audienceTargetingEnabled&&n.setQueryParameter(F,"true"),this._seeAllNewsUrl=n.toString()}},t.prototype._logClickSeeAllButton=function(){this.logClick("SeeAll","NewsSeeAll")},t.prototype._logClickAddButton=function(){this.logClick("Add","NewsAdd")},t.prototype.logClick=function(e,t){C.e.logNewsEngagement({component:t,layoutId:this.activeLayoutInfo.id,logTag:e,workload:this._workload})},Object.defineProperty(t.prototype,"_workload",{get:function(){var e=this._isOnTeamSite?"TeamSite":this._isOnGroupSite?"GroupSite":this._isOnCommSite?"CommSite":"Other";return"".concat("News",".").concat(e)+(this._isOnSeeAll?"L2":"")},enumerable:!1,configurable:!0}),t.prototype._isFeaturedNews=function(e){return e===g.t.getLayoutId(0)},t.prototype._getEmptyNewsArticleType=function(e){var t=e||this.properties.layoutId,n=Object(w.s)()||!this.properties.hideWebPartWhenEmpty;if(this._shouldUseStockCarouselItems)return h.NewsEmptyStateType.Carousel;if(this._isFeaturedNews(t)&&n){if(this._isOnTeamOrGroupSite)return h.NewsEmptyStateType.TeamSite;if(this._isOnCommSite)return h.NewsEmptyStateType.CommSite}return h.NewsEmptyStateType.None},Object.defineProperty(t.prototype,"_shouldUseStockCarouselItems",{get:function(){return this.properties.layoutId===g.t.getLayoutId(5)&&this.properties.carouselSettings.useStockItems},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_isOnGroupSite",{get:function(){return"64"===this.context.pageContext.legacyPageContext.webTemplate},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_isOnTeamSite",{get:function(){return"1"===this.context.pageContext.legacyPageContext.webTemplate},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_isOnCommSite",{get:function(){return"68"===this.context.pageContext.legacyPageContext.webTemplate},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_isOnTeamOrGroupSite",{get:function(){return this._isOnTeamSite||this._isOnGroupSite},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newsDataProviderId",{get:function(){return this.isHubNews?h.hubNews:this._isMultiSiteNews?h.multiSiteNews:this._isMyNews?h.myNews:this._isNewsDigestLayout?h.newsDigest:h.news},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hubId",{get:function(){return this.context.pageContext.legacyPageContext.hubSiteId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isHubNews",{get:function(){return this.properties.newsDataSourceProp===h.NewsDataSource.Hub&&this.isOnHubSite},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_isMultiSiteNews",{get:function(){return this.properties.newsDataSourceProp===h.NewsDataSource.ChooseSites},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_isMyNews",{get:function(){return this.properties.newsDataSourceProp===h.NewsDataSource.MyNews},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isOnHubSite",{get:function(){return this.context.pageContext.legacyPageContext.isHubSite},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_dataProviderIdForReset",{get:function(){return!this._isOnSeeAll&&this.activeDataProviderInfo.id},enumerable:!1,configurable:!0}),t.prototype._emptyStateHelpItemsCount=function(){var e=this.isContributor?3:0;return this._shouldUseStockCarouselItems&&(e=3),this._isOnTeamOrGroupSite&&this.properties.emptyStateHelpItemsCount&&(e=this.properties.emptyStateHelpItemsCount),e},t.prototype._loadNewsDigestFirstRunUtilities=function(){return new h.NewsDigestUtilities(this.context.pageContext,this.context.spHttpClient,"sharePointNewsDigestTeachingBubbleHomePage")},t.prototype._initScrollCounters=function(){this.isOnL2Page?this._totalItemsRequested=-50:this._isNewsDigestLayout&&this.properties.newsItems&&(this._totalItemsRequested=this.properties.newsItems.length)},t.prototype._updateRenderCounters=function(){this._isNewsDigestLayout&&this.properties.newsItems?this.totalItemsToRender=this.properties.newsItems.length:this._isOnSeeAll?this.totalItemsToRender=Number.MAX_VALUE:this.properties.layoutId===g.t.getLayoutId(4)?this.totalItemsToRender=T:E.e.isRenderItemsSliderEnabled(this.properties.layoutId)?this.totalItemsToRender=this.properties.renderItemsSliderValue:this.totalItemsToRender=4,this.properties.prefetchCount=this.totalItemsToRender,this._totalItemsToRequest=this._isOnSeeAll?50:T},Object.defineProperty(t.prototype,"_isNewsDigestLayout",{get:function(){return this.properties.layoutId===g.t.getLayoutId(3)},enumerable:!1,configurable:!0}),t.prototype.loadHubNewsDataProvider=function(e){return Promise.resolve(new h.HubNewsDataProvider(e))},t.prototype.loadNewsDataProvider=function(e){return Promise.resolve(new h.NewsDataProvider(e))},t.prototype.loadNewsDigestDataProvider=function(e){return Promise.resolve(new h.NewsDigestDataProvider(e))},t.prototype.loadMultiSiteNewsDataProvider=function(e){return Promise.resolve(new h.MultiSiteNewsDataProvider(e))},t.prototype.loadMyNewsDataProvider=function(e){return Promise.resolve(new h.MyNewsDataProvider(e))},t.prototype._isPinnedItemsDefined=function(){var e=this.properties.pinnedItems;return e&&e.some(function(e){return Boolean(e)&&!e.isHelpArticle})},t.prototype._mergePinnedAndNewsItems=function(e){var t,n=this;if(!this._isPinnedItemsDefined())return e;t=e.filter(function(e){return n.properties.pinnedItems.forEach(function(t,a){t.isHelpArticle||e.isHelpArticle||h.NewsUtilities.getNewsItemKey(t,"")!==h.NewsUtilities.getNewsItemKey(e,"")||(n.properties.pinnedItems[a]=e)}),!h.NewsUtilities.isNewsItemInList(n.properties.pinnedItems,e)});var a=this.properties.pinnedItems.filter(function(e){return e&&!e.isHelpArticle});this._updateCDNImageUrl(a),this._logPinnedNewsCount(a.length);var i=0,r=Object(o.cloneDeep)(this.properties.pinnedItems);return r.forEach(function(e,a){e.isHelpArticle&&t[i]&&(r[a]=t[i++]);var o=Object(h.tryGetAuthoritativeSiteDetails)(e.siteId,e.webId,n.pageContext);e.isAuthoritative=!!o}),r.filter(function(e){return e&&!e.isHelpArticle})},t.prototype.ensureMicroServiceIsAvailable=function(){var e=this;return void 0===this.isMicroserviceAvailable?this.context.serviceScope.consume(_.SPHomeHttpClient.serviceKey).isServiceAvailable.then(function(t){e.isMicroserviceAvailable=t}):Promise.resolve()},Object.defineProperty(t.prototype,"_isFilterForCurrentSiteOnly",{get:function(){return this.properties.newsDataSourceProp===h.NewsDataSource.CurrentSite},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_isOnSeeAll",{get:function(){return this.isOnL2Page(this.properties.layoutId)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_isDefaultFilter",{get:function(){return JSON.stringify(this.properties.filters)===JSON.stringify([Object(o.cloneDeep)(b.e)])},enumerable:!1,configurable:!0}),t.prototype._ensureObserver=function(e,t){var n=this;!this._webPartObserver&&e&&(window.IntersectionObserver?(this._webPartObserver=new IntersectionObserver(function(e,a){e.forEach(function(e){e.intersectionRatio>0&&(c.DisplayMode.Read===n.displayMode&&n._logNewsWebpartRender(t),a.disconnect())})},{rootMargin:"0px",threshold:.1}),this._webPartObserver.observe(e)):null!==this._webPartObserver&&(this._webPartObserver=null,c.DisplayMode.Read===this.displayMode&&this._logNewsWebpartRender(t)))},t.prototype._shouldSkipViewCount=function(e){var t=O.e.isNewsHaukAPIModelEnabled()&&(e===h.multiSiteNews||e===h.hubNews),n=O.e.isMyNewsHaukAPIModelEnabled()&&e===h.myNews;return!Object(w.O)()&&(Object(w.A)()||this._isDefaultFilter)&&(t||n)},t.prototype.loadSecondaryLayout=function(e,n){var a=this;n.then(function(t){e?a.updateActiveLayoutProp("carouselComponentClass",t):a.updateActiveLayoutProp("heroPatternComponentClass",t)}).catch(function(e){return s._TraceLogger.logError(t._logSource,e,"SecondaryLayoutLoad")})},t.prototype.shouldUseMicroservice=function(){var e=this.context.serviceScope.consume(d.PageContext.serviceKey).user,t=!1;if(e){var n=e.isAnonymousGuestUser,a=e.isExternalGuestUser;t=n||a}var i=!Object(w.C)()&&this.properties.filters&&JSON.stringify(this.properties.filters)!==JSON.stringify([Object(o.cloneDeep)(b.e)]);return t||i||!!Object(w.c)()&&this._isOnSeeAll},t.prototype._loadDataProviderById=function(e){(void 0===e||e===h.hubNews&&!this._hubNewsDataProviderInfo)&&(this._hubNewsDataProviderInfo={id:h.hubNews,loadDataProvider:this.loadHubNewsDataProvider,options:O.e.isNewsHaukAPIModelEnabled()?{serviceScope:this.context.serviceScope,shouldUseMicroservice:this.shouldUseMicroservice()}:void 0}),(void 0===e||e===h.news&&!this._newsDataProviderInfo)&&(this._newsDataProviderInfo={id:h.news,loadDataProvider:this.loadNewsDataProvider}),(void 0===e||e===h.newsDigest&&!this._newsDigestDataProviderInfo)&&(this._newsDigestDataProviderInfo={id:h.newsDigest,loadDataProvider:this.loadNewsDigestDataProvider,options:{serviceScope:this.context.serviceScope,newsItems:this.properties.newsItems}}),(void 0===e||e===h.multiSiteNews&&!this._multiSiteNewsDataProviderInfo)&&(this._multiSiteNewsDataProviderInfo={id:h.multiSiteNews,loadDataProvider:this.loadMultiSiteNewsDataProvider,options:O.e.isNewsHaukAPIModelEnabled()?{serviceScope:this.context.serviceScope,shouldUseMicroservice:this.shouldUseMicroservice()}:void 0}),(void 0===e||e===h.myNews&&!this._myNewsDataProviderInfo)&&(this._myNewsDataProviderInfo={id:h.myNews,loadDataProvider:this.loadMyNewsDataProvider,options:O.e.isMyNewsHaukAPIModelEnabled()?{serviceScope:this.context.serviceScope,shouldUseMicroservice:this.shouldUseMicroservice()}:void 0})},t._teachingBubbleLearnMoreUrl="https://support.office.com/article/create-and-send-a-news-digest-42efc3c6-605f-4a9a-85d5-1f9ff46019bf",t._logSource=s._LogSource.create("NewsWebPart"),t}(p.BaseCollectionWebPart);t.default=j},cDcd:function(e,t){e.exports=m},eUG4:function(e,t,n){"use strict";n.d(t,"e",function(){return u}),n.d(t,"t",function(){return f});var a=n("17wl"),i=n("cDcd"),r=n("KL1q"),o=n("UWqr"),s=n("y88i"),c=n("lgTv"),d=n("F2ap"),l=n("i5pg"),u="CallToActionAdd",f=function(e){function t(t){var n=e.call(this,t)||this;return n._onNewsImageClicked=function(){var e,t=n.props,a=t.isFeatured,i=t.index,r=t.layout,o=t.newsItem,s={component:"NewsImageArea",item:o,layoutId:r,logTag:"Thumbnail",workload:t.workload};(null===(e=n.props)||void 0===e?void 0:e.logClickEvent)&&n.props.logClickEvent(s,i,a),n._sendViewSignalForExternalLink(o)},n._onNewsSiteTitleClicked=function(){var e,t=n.props,a=t.isFeatured,i=t.index,r=t.layout,o={component:"NewsSiteTitle",item:t.newsItem,layoutId:r,logTag:"SiteLink",workload:t.workload};(null===(e=n.props)||void 0===e?void 0:e.logClickEvent)&&n.props.logClickEvent(o,i,a)},n._onNewsTitleClicked=function(e){var t,a=n.props,i=a.isFeatured,r=a.index,o=a.layout,s=a.newsItem,c={component:"NewsArticleTitle",item:s,layoutId:o,logTag:"Title",workload:a.workload};(null===(t=n.props)||void 0===t?void 0:t.logClickEvent)&&n.props.logClickEvent(c,r,i),n._sendViewSignalForExternalLink(s)},n}return Object(a.__extends)(t,e),t.prototype.renderImageArea=function(e,t,n){var a={};if(t)switch(this.props.size){case 10:a={width:"".concat(t,"px"),height:"".concat(9*t/21,"px")};break;case 14:case 13:a={height:"".concat(n,"px")};break;case 12:case 11:a={height:"".concat(n/2-1,"px")};break;default:a={}}var r=this.props,o=r.displayMode,s=r.isDisabled,d=r.newsItem,l=r.onImageRenderCompleted,u=r.onImageRender,f=r.pageContext,p=r.serviceScope,m=r.size,_=r.theme,h={image:d.image,isContributorActionCard:d.isContributorActionCard,isHelpArticle:d.isHelpArticle,listId:d.listId,siteId:d.siteId,title:d.title,uniqueId:d.uniqueId,url:d.url,webId:d.webId};return i.createElement(c.n,{allowLinkInterception:this._allowLinkInterception(o),additionalStyling:a,isNewsItemDisabled:this._isLinkDisabled(o,s),linkTarget:"_blank",newsItem:h,onClickCallback:this._onNewsImageClicked,onImageRenderCompleted:l,onImageRender:u,pageContext:f,serviceScope:p,refCallback:e,size:m,theme:_})},t.prototype.renderSiteTitleLink=function(e){var t=this.props,n=t.displayMode,a=t.theme,r=this.props.newsItem,o=r.isAuthoritative,s=r.siteTitle,d=r.siteUrl;return Boolean(s)&&i.createElement(c.o,{allowLinkInterception:this._allowLinkInterception(n),isAuthoritative:o,isDisabled:this._isLinkDisabled(n),linkTarget:"_blank",onClickCallback:this._onNewsSiteTitleClicked,refCallback:e,siteTitle:s,siteUrl:d,theme:a})},t.prototype.renderTitle=function(e,t){var n=t?d.e.compact_text_title:void 0,a=this.props,o=a.displayMode,s=a.isDisabled,l=a.locale,u=a.newsItem,f=a.size,p=a.theme,m=a.webpartWidth,_={author:u.author,description:u.description,publishedOn:u.publishedOn,publishedOnRelativeTime:u.publishedOnRelativeTime,title:u.title,url:u.url},h=10===f&&m>=622&&d.e.xxLargePlusFont;return n=Object(r.mergeStyles)(h,n),i.createElement(c.s,{allowLinkInterception:this._allowLinkInterception(o),additionalCssClass:n,linkTarget:"_blank",locale:l,newsItem:_,onClickCallback:this._onNewsTitleClicked,refCallback:e,shouldLinkToArticle:this._isLinkDisabled(o,s),theme:p})},t.prototype.renderDescription=function(e){var t=this.props,n=t.newsItem,a=t.theme,r=t.isEligibleForCssTextTruncate&&!Object(l.l)();return i.createElement(c.t,{additionalCssClass:r?d.e.truncateDescription:void 0,descriptionText:n.description,refCallback:e,theme:a})},t.prototype._isLinkDisabled=function(e,t){return void 0===t&&(t=!1),e===o.DisplayMode.Edit||t},t.prototype._allowLinkInterception=function(e){return!e||e===o.DisplayMode.Read},t.prototype._sendViewSignalForExternalLink=function(e){var t=e.listId,n=e.originalSourceUrl,a=e.originalSourceItemId,i=e.path,r=e.siteUrl,c=e.uniqueId,d=e.url;if(n){var l=a&&o.Guid.tryParse(a);(!a||o.Guid.empty.equals(l))&&window.postMessage({command:"viewSignalAction",listId:t,uniqueId:c,url:r&&i?s.Uri.concatenate(r,i):d},location.origin)}},t}(i.Component)},faye:function(e,t){e.exports=_},h4zy:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a,i=n("UWqr"),r=n("2q6Q"),o=n("i5pg");!function(e){function t(){return i._SPFlight.isEnabled(60465)}function n(){return 1===r._SPPerfExperiment.getVariantAndTrackExperiment(r._PerformanceExperiment.NewsHaukAPIExperiment)||t()}function a(){return i._SPFlight.isEnabled(60229)}function s(){return i._SPFlight.isEnabled(60705)}e.isSitePickerWithHubEnabled=function(){return i._SPFlight.isEnabled(1530)},e.isCreateNewPagesInTeamsEnabled=function(){return i._SPFlight.isEnabled(60494)},e.isWEXWithinNewsWebpartDragAndDropFlight=function(){return i._SPFlight.isEnabled(1982)&&!Object(o.w)()&&i._BrowserDetection.getBrowserInformation().browser!==i._Browser.IE},e.isNewsHaukAPIFlightEnabled=t,e.isNewsHaukAPIModelEnabled=n,e.isNewsHaukOnAllEnvironmentsEnabled=function(){return n()&&i._SPFlight.isEnabled(60511)},e.isCallToActionEnabled=function(){return i._SPFlight.isEnabled(60497)},e.isMyNewsHaukAPIFlightEnabled=a,e.isMyNewsHaukAPIModelEnabled=function(){return 1===r._SPPerfExperiment.getVariantAndTrackExperiment(r._PerformanceExperiment.MyNewsHaukAPIExperiment)||a()},e.useGetMultiSiteForThisSite=s,e.isGetMultiSiteForThisSiteEnabled=function(e){return(1===r._SPPerfExperiment.getVariantAndTrackExperiment(r._PerformanceExperiment.NewsUseGetMultiSiteForThisSiteExp)||s())&&!e},e.isWebPartAudienceTargetingEnabled=function(){return i._SPFlight.isEnabled(60668)},e.isNewsCommonCustomerPromiseEnabled=function(){return i._SPFlight.isEnabled(60878)&&(1===r._SPPerfExperiment.getVariantAndTrackExperiment(r._PerformanceExperiment.NewsCustomerPromiseExperiment)||i._SPFlight.isEnabled(60872))}}(a||(a={}))},"hiL/":function(e,t){e.exports=h},i5pg:function(e,t,n){"use strict";n.d(t,"r",function(){return i}),n.d(t,"w",function(){return r}),n.d(t,"b",function(){return o}),n.d(t,"h",function(){return s}),n.d(t,"v",function(){return c}),n.d(t,"p",function(){return d}),n.d(t,"u",function(){return l}),n.d(t,"g",function(){return u}),n.d(t,"s",function(){return f}),n.d(t,"o",function(){return p}),n.d(t,"d",function(){return m}),n.d(t,"c",function(){return _}),n.d(t,"O",function(){return h}),n.d(t,"C",function(){return b}),n.d(t,"S",function(){return g}),n.d(t,"y",function(){return v}),n.d(t,"n",function(){return y}),n.d(t,"_",function(){return S}),n.d(t,"m",function(){return D}),n.d(t,"l",function(){return I}),n.d(t,"a",function(){return x}),n.d(t,"E",function(){return C}),n.d(t,"i",function(){return O}),n.d(t,"f",function(){return w}),n.d(t,"t",function(){return E}),n.d(t,"e",function(){return A}),n.d(t,"A",function(){return L}),n.d(t,"x",function(){return k}),n.d(t,"I",function(){return M}),n.d(t,"D",function(){return P});var a=n("UWqr");function i(){return a._SPKillSwitch.isActivated("282de873-acca-4975-a430-c3672a4d4c69")}function r(){return a._SPKillSwitch.isActivated("f0847ee4-de76-46f4-ab20-e99907c86a82")}function o(){return a._SPKillSwitch.isActivated("42fabd84-2489-45d4-8814-3b649a8ebf96")}function s(){return a._SPKillSwitch.isActivated("e42ef46c-bc16-46d6-93b4-18eb9cd2d110")}function c(){return a._SPKillSwitch.isActivated("5790df7c-a9bf-46b2-a9b3-6aaefbbd7a92")}function d(){return a._SPKillSwitch.isActivated("1f257e85-ec1b-4c7b-8f91-f8485813254d")}function l(){return a._SPKillSwitch.isActivated("cc0b6778-0ec2-4567-990c-68fc4872e2f8")}function u(){return a._SPKillSwitch.isActivated("772e07c1-5a5a-48b9-8cd0-58feee85f7cc")}function f(){return a._SPKillSwitch.isActivated("a872199b-131a-4c1c-a1de-fc82fb7e6954")}function p(){return a._SPKillSwitch.isActivated("3804ae1f-35ce-494b-bb7d-b864397c357c")}function m(){return a._SPKillSwitch.isActivated("22ce9b62-ec48-4da4-854c-679f15eed688")}function _(){return a._SPKillSwitch.isActivated("741ba3c3-f4ac-41d0-827a-a656abb2db07")}function h(){return a._SPKillSwitch.isActivated("11987693-ca44-431f-bb9e-88bc5f6b29e7")}function b(){return a._SPKillSwitch.isActivated("f017c43c-19b5-4568-80ae-3a6dda880f1d")}function g(){return a._SPKillSwitch.isActivated("0ffe418d-2c76-4fe1-ab7a-56b03e336b28")}function v(){return a._SPKillSwitch.isActivated("9490d5c8-c2a2-4789-b2bb-2936c313b22e")}function y(){return a._SPKillSwitch.isActivated("b2f25346-7a66-4141-90d2-90b81c3bc435")}function S(){return a._SPKillSwitch.isActivated("552f94a5-154c-4992-8579-690a2fec84f9")}function D(){return a._SPKillSwitch.isActivated("f5a9e1ab-6c61-4295-b0f7-d517c3b934c5")}function I(){return a._SPKillSwitch.isActivated("b18a1005-e9b3-4f84-b505-5d15c270ad33")}function x(){return a._SPKillSwitch.isActivated("6533307e-d00e-4f89-8e5a-c178ef1123e5")}function C(){return a._SPKillSwitch.isActivated("bab69ca2-7437-46ee-875c-968c79c31397")}function O(){return a._SPKillSwitch.isActivated("ce28b0a6-1773-40f6-9511-687db55226f6")}function w(){return a._SPKillSwitch.isActivated("268cd1c5-d1e4-4b0b-8f09-f89904cfa98b")}function E(){return a._SPKillSwitch.isActivated("e5597b8d-3da3-46fe-b266-cc0b52669f62")}function A(){return a._SPKillSwitch.isActivated("70953142-2191-4e09-865e-1e7217fc340c")}function L(){return a._SPKillSwitch.isActivated("a4abf1c6-3c6b-41eb-b95a-7e19d7e3f738")}function k(){return a._SPKillSwitch.isActivated("85da70a7-8ef1-4504-96fa-3837a846b825")}function M(){return a._SPKillSwitch.isActivated("90258c51-970d-4c43-bb14-4fd635bde388")}function P(){return a._SPKillSwitch.isActivated("54c18948-6cc1-429b-ba62-872c013d9537")}},jOlS:function(e,t){e.exports=b},lgTv:function(e,t,n){"use strict";n.d(t,"e",function(){return u}),n.d(t,"t",function(){return m}),n.d(t,"n",function(){return I}),n.d(t,"a",function(){return k}),n.d(t,"c",function(){return w}),n.d(t,"i",function(){return R}),n.d(t,"r",function(){return L.t}),n.d(t,"o",function(){return B}),n.d(t,"s",function(){return V});var a,i=n("17wl"),r=n("cDcd"),o=n("KL1q"),s=n("U4ag"),c=n("i5pg"),d=n("F2ap"),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._refItems={},t._renderCompactItem=function(){var e,n=t.props,a=n.isFeatured,i=n.isLoading,s=n.newsItem,c=n.shouldHideDescription,l=n.size;if(void 0!==s){var u=Object(o.css)(d.e.newsItem,w[l]&&w[l].className,((e={})[d.e.newsItem__hasImage]=t.isImageVisible,e[d.e.newsItem__featured]=t.isImageVisible,e[d.e.newsItem__compactFeatured]=a,e[d.e.fluent]=!0,e)),f=t.isImageVisible&&!i,p=new L.t(t.props);return r.createElement("div",{className:u,"data-automation-id":s.isHelpArticle?"newsHelpItem":"newsItem"},f&&p.renderImageArea(),r.createElement("div",{className:d.e.text},r.createElement("div",null,p.renderSiteTitleLink(t._siteLinkRefCallback),p.renderTitle(t._titleRefCallback),!c&&p.renderDescription(t._descriptionRefCallback))))}},t._siteLinkRefCallback=function(e){t._refItems.siteLinkElement=e},t._titleRefCallback=function(e){t._refItems.titleElement=e},t._descriptionRefCallback=function(e){t._refItems.descriptionElement=e},t._truncateTitleAndDescription=function(){var e=t.props,n=e.isEligibleForCssTextTruncate,a=e.newsItem;if(t._refItems.titleElement){t._refItems.siteLinkElement&&(n?(t._refItems.siteLinkElement.classList.add(d.e.truncateTitleText),t._refItems.siteLinkElement.style.webkitLineClamp="".concat(1)):t._refItems.siteLinkElement.classList.add(d.e.textIEStyle));var i=2;if(n?(t._refItems.titleElement.classList.add(d.e.truncateTitleText),t._refItems.titleElement.style.webkitLineClamp="".concat(i)):i=Object(s.clampElement)(t._refItems.titleElement,3,a.title).lines,t._refItems.descriptionElement){var r=3-i;0===r?t._refItems.descriptionElement.classList.add(d.e.text_description__hidden):t._refItems.descriptionElement.classList.remove(d.e.text_description__hidden),n&&Object(c.l)()?(t._refItems.descriptionElement.classList.add(d.e.truncateTitleText),t._refItems.descriptionElement.style.webkitLineClamp="".concat(r),t._refItems.descriptionElement.style.marginBottom="6px"):t._refItems.descriptionElement.classList.add(d.e.textIEStyle)}}},t}return Object(i.__extends)(t,e),t.prototype.render=function(){return r.createElement(k,Object(i.__assign)({},this.props,{functionOverrides:{render:this._renderCompactItem,truncateText:this._truncateTitleAndDescription}}))},Object.defineProperty(t.prototype,"isImageVisible",{get:function(){var e=this.props,t=e.isFeatured,n=e.newsItem;return t&&(void 0!==n.isContributorActionCard||Boolean(n.image))},enumerable:!1,configurable:!0}),t}(r.Component),u=l,f=(n("xc3d"),n("IGle")),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),Object.defineProperty(t.prototype,"_classNames",{get:function(){var e=this.props.theme;return f.e.getClassNames({root:"NewsDescription",theme:e})},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e=this.props,t=e.additionalCssClass,n=e.descriptionText,a=e.refCallback;return r.createElement("div",{"aria-hidden":!1,className:Object(o.css)(d.e.text_description,this._classNames.text_description,t||"",d.e.fluent),ref:a,"data-automation-id":"newsItemDescription"},n)},t}(r.PureComponent),m=p,_=n("UWqr"),h=n("Pk8u"),b=n("hiL/"),g=n("tGpx"),v=n("OZbH"),y=n("ox9S"),S=n("h4zy"),D=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onLazyTimeOut=function(){if(S.e.isNewsCommonCustomerPromiseEnabled()){var e=t.props;(0,e.onImageRender)(e.newsItem.image,"Delayed")}},t._onImageRender=function(){var e=t.props;(0,e.onImageRender)(e.newsItem.image,"Success"),t._handleImageLoadOrError()},t._onImageFailure=function(){var e=t.props;(0,e.onImageRender)(e.newsItem.image,"Failure"),t._handleImageLoadOrError()},t._handleImageLoaded=function(e){var n=t.props.onImageRenderCompleted,a=e===o.ImageLoadState.loaded||e===o.ImageLoadState.error;n&&a&&n()},t._handleImageLoadOrError=function(){var e=t.props.onImageRenderCompleted;e&&e()},t}return Object(i.__extends)(t,e),Object.defineProperty(t.prototype,"_classNames",{get:function(){var e=this.props.theme;return f.e.getClassNames({root:"NewsImage",theme:e})},enumerable:!1,configurable:!0}),t.prototype.shouldComponentUpdate=function(e){var t,n;return!Object(c.y)()&&(null===(t=e.additionalStyling)||void 0===t?void 0:t.height)!==(null===(n=this.props.additionalStyling)||void 0===n?void 0:n.height)||!Object(h.isEqual)(e.newsItem,this.props.newsItem)},t.prototype.render=function(){var e,n=this.props,a=n.additionalStyling,s=n.allowLinkInterception,c=n.isNewsItemDisabled,l=n.linkTarget,u=n.onClickCallback,f=n.newsItem,p=n.refCallback,m=f.isContributorActionCard?this._renderContributorActionCard():this._renderNewsItemImage(),_=r.createElement(r.Fragment,null,m,r.createElement("div",{className:d.e.content})),h={className:d.e.imageArea_link,href:f.url,onClick:u,role:f.isContributorActionCard?"link":"presentation",target:l,"data-interception":s?"propagate":"off"};return f.isContributorActionCard?h["aria-label"]=y.s:(h["aria-hidden"]=!0,h["data-is-focusable"]=!1,h.tabIndex=-1),r.createElement("div",{className:Object(o.css)(d.e.imageArea,(e={},e[d.e.objectFitCoverIE11]=t._isIE,e),"ms-NewsPinningItemImage",this._classNames.imageArea),ref:p,style:a||{}},c?_:r.createElement("a",Object(i.__assign)({},h),m,r.createElement("div",{className:d.e.content})))},t.prototype._renderNewsItemImage=function(){var e=this.props,t=e.additionalStyling,n=e.newsItem,a=e.pageContext,i=e.serviceScope,s=e.size,c=n.image,l=n.siteId,u=n.siteUrl,f=n.title,p=n.uniqueId,m=n.webId,_=n.isHelpArticle,h=c,y=b.PreviewUtility.smallestBreakPointWidth,D=w[s];return t&&t.width?y=Math.round(parseInt(t.width.toString(),10)):D&&(y=D.imageWidth),_||(h=v.NewsUtilities.processBannerImageUrlPart(c,p,a,y,l,m,u)),h?r.createElement(g.SPImg,{imageData:{imageUrl:h,siteId:l,webId:m,uniqueId:p},serviceScope:i||a._serviceScope,callerId:19,width:"100%",height:"100%",thumbnailWidth:y,imageFit:"cover",onLazyTimeout:this._onLazyTimeOut,onImageLoad:S.e.isNewsCommonCustomerPromiseEnabled()?this._onImageRender:this._handleImageLoadOrError,onImageLoadFailure:S.e.isNewsCommonCustomerPromiseEnabled()?this._onImageFailure:this._handleImageLoadOrError,getDefaultImage:b.DefaultImageHelper.getDefaultImage}):r.createElement(o.Image,{className:d.e.imageArea_image,"aria-hidden":!0,role:"presentation",imageFit:o.ImageFit.cover,title:f,src:h,onLoadingStateChange:this._handleImageLoaded})},t.prototype._renderContributorActionCard=function(){return r.createElement("div",{className:Object(o.css)(d.e.contributorActionCard,this.props.isNewsItemDisabled&&d.e.contributorActionCard__disabled)},r.createElement(o.Icon,{className:d.e.contributorActionCard_icon,iconName:"News"}),r.createElement("span",{className:d.e.contributorActionCard_text},r.createElement(o.Icon,{className:d.e.contributorActionCard_text_icon,iconName:"Add"}),y.o))},t._isIE=_._BrowserDetection.getBrowserInformation().browser===_._Browser.IE,t}(r.Component),I=D,x=200,C=300,O=750,w=((a={})[0]={className:d.e.newsItem__small,imageWidth:x},a[1]={className:d.e.newsItem__medium,imageWidth:x},a[2]={className:d.e.newsItem__large,imageWidth:x},a[3]={className:d.e.newsItem__xLarge,imageWidth:C},a[4]={className:d.e.newsItem__xXLarge,imageWidth:O},a[5]={className:d.e.newsItem__xXXLarge,imageWidth:O},a[6]={className:d.e.newsHubItem__oneItemFeatured,imageWidth:C},a[7]={className:d.e.newsHubItem__twoItemFeatured,imageWidth:C},a[8]={className:d.e.newsHubItem__ThreeItemFeatured,imageWidth:x},a[10]={className:d.e.newsItem__carousel,imageWidth:1200},a[11]={className:d.e.newsItem__heroTile,imageWidth:C},a[12]={className:d.e.newsItem__heroDoubleTile,imageWidth:O},a[13]={className:d.e.newsItem__heroHalfScreen,imageWidth:O},a[14]={className:d.e.newsItem__heroFullScreen,imageWidth:1200},a[9]={className:d.e.newsHubItem__oneItemFeatured,imageWidth:C},a),E=n("6X2r"),A=n("ZQz3"),L=n("eUG4"),k=function(e){function t(t){var n=e.call(this,t)||this;return n._refItems={},n._siteLinkRefCallback=function(e){n._refItems.siteLinkElement=e},n._titleRefCallback=function(e){n._refItems.titleElement=e},n._descriptionRefCallback=function(e){n._refItems.descriptionElement=e},n._logEvent=function(){var e=n.props,t=e.layout,a=e.newsItem,i=e.workload;E.e.logNewsEngagement({component:"NewsAdd",item:a,layoutId:t,logTag:L.e,workload:i})},n._truncateTitleAndDescription=function(){var e=n.props,t=e.functionOverrides,a=e.size,i=A.e.getNewsLayout(n.props.layout);if(t&&t.truncateText)t.truncateText();else{if(0===a)return null;if(n._refItems.titleElement){var r=n._getMaxTotalLines,o=n.props.isEligibleForCssTextTruncate;if(n._refItems.siteLinkElement&&(o?(n._refItems.siteLinkElement.classList.add(d.e.truncateTitleText),n._refItems.siteLinkElement.style.webkitLineClamp="".concat(1)):n._refItems.siteLinkElement.classList.add(d.e.textIEStyle)),o?(n._refItems.titleElement.classList.add(d.e.truncateTitleText),n._refItems.titleElement.style.webkitLineClamp="".concat(2)):n._refItems.titleElement.classList.add(d.e.textIEStyle),n._refItems.descriptionElement){var s=n._getMaxDescriptionLines(r-2),l=n.props.showNewsMetadata;s<=2&&l&&!l.showAuthor&&!l.showDate&&(s+=2),!Object(c.n)()&&0===i&&n.props.isFeatured&&n._refItems.descriptionElement.classList.add(d.e.featuredNewsDescription),0===s?n._refItems.descriptionElement.classList.add(d.e.text_description__hidden):n._refItems.descriptionElement.classList.remove(d.e.text_description__hidden),o&&Object(c.l)()?(n._refItems.descriptionElement.classList.add(d.e.truncateTitleText),n._refItems.descriptionElement.style.webkitLineClamp="".concat(s)):n._refItems.descriptionElement.classList.add(d.e.textIEStyle)}}}},n._async=new o.Async(n),n}return Object(i.__extends)(t,e),Object.defineProperty(t.prototype,"_classNames",{get:function(){var e=this.props.theme;return f.e.getClassNames({root:"NewsItem",theme:e})},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){this.props.isLoading||this._async.setTimeout(this._truncateTitleAndDescription,100)},t.prototype.componentDidUpdate=function(){this._truncateTitleAndDescription()},t.prototype.render=function(){return this._renderNewsItem()},t.prototype._renderNewsItem=function(){var e,t=this.props,n=t.functionOverrides,a=t.isFeatured,i=t.isSingleItem,s=t.newsItem,l=t.layout,u=t.size;if(n&&n.render)return n.render();if(void 0!==s){var f=u>=3,p=l===A.e.getLayoutId(1)||l===A.e.getLayoutId(3),m=Object(o.css)(d.e.newsItem,"ms-NewsItem",w[u]&&w[u].className,((e={})[d.e.newsItem__hasImage]=this._isImageVisible(),e.hasImage=this._isImageVisible(),e[d.e.newsItem__featured]=a&&0!==u,e[d.e.newsItem__listLayout]=p,e[d.e.newsItem__singleItem]=i,e[this._classNames.text_description]=a,e[d.e.fluent]=!0,e)),_=this.props,h=_.addNewsUrl,b=_.index,g=_.isLoading,v=_.locale,y=_.serviceScope,S=_.shouldHideDescription,D=_.showNewsMetadata,I=_.theme,x=r.createElement(R,{item:s,index:b,layout:Object(c.n)()?void 0:this.props.layout,locale:v,serviceScope:y,showNewsMetadata:D,showPersona:f,theme:I,viewCounts:s.viewCounts}),C=i&&s.isHelpArticle&&void 0!==h,O=this._isImageVisible()&&!g,E=new L.t(this.props);return r.createElement("div",{className:m,"data-automation-id":s.isHelpArticle?"newsHelpItem":"newsItem",role:"listitem"},O&&E.renderImageArea(),r.createElement("div",{className:d.e.text},r.createElement("div",null,E.renderSiteTitleLink(this._siteLinkRefCallback),E.renderTitle(this._titleRefCallback),0!==u&&!S&&E.renderDescription(this._descriptionRefCallback)),C?this._renderAddNewsButton():x))}},t.prototype._isImageVisible=function(){var e=this.props,t=e.newsItem,n=e.size;return(void 0!==t.isContributorActionCard||!!t.image)&&0!==n},t.prototype._renderAddNewsButton=function(){var e=this.props,t=e.addNewsUrl,n=e.displayMode,a=r.createElement(o.PrimaryButton,{"data-interception":"propagate",href:t,title:y.o,description:y.o,onClick:this._logEvent,text:y.o});return r.createElement("div",{className:d.e.text_addNewsWrapper},n===_.DisplayMode.Read&&a)},Object.defineProperty(t.prototype,"_getMaxTotalLines",{get:function(){var e=this.props,t=e.isFeatured,n=e.isSingleItem,a=e.size;return a>4&&t&&!this._isImageVisible()?6:a>=4&&!t&&this._isImageVisible()?4:a>3&&t&&!this._isImageVisible()?Boolean(n)?3:6:a>2&&t&&!this._isImageVisible()?4:3},enumerable:!1,configurable:!0}),t.prototype._getMaxDescriptionLines=function(e){return this.props.size>4&&!this._isImageVisible()?4:e},t}(r.Component),M=n("jOlS");M.loadStyles('.a_a_91bed31b{color:"[theme:neutralSecondary, default: #605e5c]"}.a_a_91bed31b:not(.b_a_91bed31b){font-size:12px}.a_a_91bed31b.b_a_91bed31b{font-size:"[theme:smallFontSize, default: 12px]";font-weight:"[theme:smallFontWeight, default: 400]"}',!0);var P=n("8zjT"),T=n("y88i"),U=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t.prototype.render=function(){var e="",t=this.props.count;return void 0!==t&&t>0&&(e=T.StringHelper.formatWithLocalizedCountValue(P.t,P.e,t)),r.createElement("span",{className:"a_a_91bed31b",title:e,"aria-hidden":!0,role:"presentation"},e)},t}(r.Component),F=U;M.loadStyles('.ah_g_91bed31b:not(.b_g_91bed31b){font-size:12px}.ah_g_91bed31b.b_g_91bed31b{font-size:"[theme:smallFontSize, default: 12px]";font-weight:"[theme:smallFontWeight, default: 400]"}.ai_g_91bed31b{position:relative}[dir=ltr] .ai_g_91bed31b{margin-right:8px}[dir=rtl] .ai_g_91bed31b{margin-left:8px}.ai_g_91bed31b.aj_g_91bed31b .ms-Persona-initials{background-color:"[theme:neutralLighter, default: #f3f2f1]";color:"[theme:neutralPrimary, default: #323130]"}.ai_g_91bed31b .ms-Persona{justify-content:center}.ak_g_91bed31b{display:inline-block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;vertical-align:top}[dir=ltr] .ak_g_91bed31b{padding-right:5px}[dir=rtl] .ak_g_91bed31b{padding-left:5px}.ak_g_91bed31b.b_g_91bed31b,.ak_g_91bed31b:not(.b_g_91bed31b){font-weight:600}.al_g_91bed31b{display:inline-block;vertical-align:top;flex:0 0 auto;white-space:nowrap}.al_g_91bed31b.b_g_91bed31b{font-weight:600}.am_g_91bed31b{min-height:19px}.an_g_91bed31b{display:flex;margin-bottom:6px}.ao_g_91bed31b{display:flex;flex-direction:column;justify-content:space-around;overflow:hidden}.ap_g_91bed31b{display:flex}.aq_g_91bed31b{margin-bottom:6px}.aq_g_91bed31b,.ar_g_91bed31b{display:flex;justify-content:space-between;overflow:hidden}.ar_g_91bed31b{margin-bottom:1px}',!0);var H="b_g_91bed31b",R=function(e){function t(t){var n=e.call(this,t)||this;return n._refItems={},n}return Object(i.__extends)(t,e),Object.defineProperty(t.prototype,"_classNames",{get:function(){var e=this.props.theme;return f.e.getClassNames({root:"NewsMetadata",theme:e})},enumerable:!1,configurable:!0}),t._getFormattedDate=function(e,t,n){return e||(t&&t instanceof Date?t.toLocaleDateString(n,{year:"numeric",month:"short",day:"numeric"}):"")},t.prototype.componentDidMount=function(){this._refItems.authorDateElement=r.createRef(),this._refItems.authorElement=r.createRef(),this._refItems.dateElement=r.createRef(),this._refItems.socialActionElement=r.createRef()},t.prototype.render=function(){var e=this.props,t=e.item,n=e.showPersona,a=e.showNewsMetadata,i=e.viewCounts,r=!a||a.showAuthor,o=!a||a.showDate,s=!a||a.showSocialActions,c=this._getAuthorElement(r,t),d=this._getDateElement(o),l=this._getViewCountElement(s,i),u=this._getPersonaAuthorDateElement(r,o,n,s,t,this._getAuthorDateElement(r,t,c,d),l,c,d);return this._getNewsMetadataElement(t,r,n,s,u,l)},t.prototype._getNewsMetadataElement=function(e,t,n,a,i,s){var d;s=n&&t||!a?void 0:s;var l=A.e.getNewsLayout(null===(d=this.props)||void 0===d?void 0:d.layout);return r.createElement("div",{className:Object(o.css)("ah_g_91bed31b",Object(c.n)()||0!==l&&1!==l&&2!==l?"aq_g_91bed31b":"ar_g_91bed31b",H)},r.createElement("div",{title:e.author+" "+this._getFormattedDateForItem()},i,s))},t.prototype._getPersonaAuthorDateElement=function(e,t,n,a,i,o,s,c,d){var l="an_g_91bed31b",u=void 0;if(e||t)if(e&&n)u=r.createElement("div",{className:l,"data-automation-id":"newsAuthorDate"},this._renderPersona(i),r.createElement("div",{className:"ao_g_91bed31b"},o,a&&s));else{var f=a?"ap_g_91bed31b":l;u=r.createElement("div",{className:f,ref:this._refItems.authorDateElement},e&&this._getAuthorWrappedInLpc(i,c)," ",t&&d)}return u},t.prototype._getViewCountElement=function(e,t){return e?r.createElement("div",{className:Object(o.css)("am_g_91bed31b",this._classNames.views)},r.createElement(F,{count:t})):void 0},t.prototype._getAuthorElement=function(e,t){var n=this._getAuthorEmail(t),a={className:Object(o.css)("ak_g_91bed31b",this._classNames.author,H),ref:this._refItems.authorElement};return n||(a.role="presentation",a["aria-hidden"]=!0),e&&r.createElement("span",Object(i.__assign)({},a),t.author)},t.prototype._getDateElement=function(e){return e&&r.createElement("span",{className:Object(o.css)("al_g_91bed31b",this._classNames.date,H),"aria-hidden":!0,role:"presentation",ref:this._refItems.dateElement},this._getFormattedDateForItem())},t.prototype._getAuthorDateElement=function(e,t,n,a){return r.createElement("div",{className:"ap_g_91bed31b",ref:this._refItems.authorElement},this._getAuthorWrappedInLpc(t,n),e&&" ",a)},t.prototype._getAuthorEmail=function(e){if(!Object(c.o)()&&e.email)return e.email;var t,n=e.authorAccountName;if(n){var a=n.split("|");t=a[a.length-1]}return t},t.prototype._getAuthorWrappedInLpc=function(e,t){var n=this.props,a=n.item,i=n.serviceScope,o=this._getAuthorEmail(e);return o?r.createElement(s.LivePersonaCard,{clientScenario:"NewsWebPart",hostAppPersonaInfo:{PersonaType:"User"},displayName:a.author,serviceScope:i,legacyUpn:o},t):t},t.prototype._renderPersona=function(e){var t,n=this._getAuthorEmail(e),a=n&&b.SPUtility.getUserPhotoUrl(n);return e.isHelpArticle&&void 0!==e.isContributorActionCard?t=void 0:(t=r.createElement(o.Persona,{text:e.author,imageInitials:e.authorInitial,hidePersonaDetails:!0,imageUrl:a,imageAlt:e.title,size:o.PersonaSize.size32}),t=this._getAuthorWrappedInLpc(e,t)),r.createElement("div",{className:Object(o.css)("ai_g_91bed31b",e.isHelpArticle?"aj_g_91bed31b":void 0),role:"presentation"},t)},t.prototype._getFormattedDateForItem=function(){var e=this.props,n=e.item,a=e.locale;return t._getFormattedDate(n.publishedOnRelativeTime,n.publishedOn,a)},t}(r.Component),N=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),Object.defineProperty(t.prototype,"_classNames",{get:function(){var e=this.props.theme;return f.e.getClassNames({root:"NewsSiteTitle",theme:e})},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e,t=this.props,n=t.allowLinkInterception,a=t.isAuthoritative,s=t.isDisabled,c=t.linkTarget,l=t.onClickCallback,u=t.refCallback,f=t.siteTitle,p=t.siteUrl,m={className:Object(o.css)(d.e.text_siteLink,"ms-NewsSiteTitle",this._classNames.text_siteLink,(e={},e[this._classNames.orgNews]=a,e[this._classNames.aTag_siteLink]=!s,e[d.e.text_siteTitle]=!a,e)),ref:u},h={"aria-label":_.Text.format(a?y.h:y.S,f),href:p,onClick:l,target:c,"data-interception":n?"propagate":"off"};return f&&(s?r.createElement("span",Object(i.__assign)({},m),f):r.createElement("div",{className:d.e.text_siteLinkAlign},r.createElement("a",Object(i.__assign)({},m,h),f)))},t}(r.Component),B=N,j=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),Object.defineProperty(t.prototype,"_classNames",{get:function(){var e=this.props.theme;return f.e.getClassNames({root:"NewsTitle",theme:e})},enumerable:!1,configurable:!0}),t.prototype.shouldComponentUpdate=function(e){return!Object(h.isEqual)(e.newsItem,this.props.newsItem)||!Object(h.isEqual)(e.theme,this.props.theme)},t.prototype.render=function(){var e,t=this.props,n=t.additionalCssClass,a=t.allowLinkInterception,s=t.linkTarget,l=t.newsItem,u=t.onClickCallback,f=t.refCallback,p=t.shouldLinkToArticle,m=l.title,_=Object(o.css)(d.e.text_title,this._classNames.text_title,d.e.textListLayoutTitle,((e={})[d.e.fluent]=!0,e[n]=!0,e)),h=Object(i.__assign)({"aria-label":m,ref:f,"data-automation-id":"newsItemTitle"},!Object(c.t)()&&{title:l.title}),b={href:l.url,onClick:u,target:s,"data-interception":a?"propagate":"off"};return p||!l.url&&!Object(c.E)()?r.createElement("span",Object(i.__assign)({},h,{className:_}),l.title):r.createElement("a",Object(i.__assign)({},h,b,{className:_+""}),l.title)},t}(r.Component),V=j},ox9S:function(e){e.exports=JSON.parse('{"d":"News","c":"Keep your team engaged by sharing content and updates","o":"Add News","s":"Add a news post","b":"Published by {0} on {1}.","t":"Description: {0}","_":"No description available.","y":"Selectable news post. {0} {1} {2}. Use Enter to add this news post to the digest.","a":"News Digest Item. Number {0} out of {1}. {2} {3} {4}. Press control plus up or down to re-order this item. Press control plus delete to remove this item from the digest.","p":"Focus on news posts list. Use Enter to focus on individual items. Use up and down arrow keys to navigate between items.","v":"Focus on news posts list. Use Enter to focus on and select individual items. Use up and down arrow keys to navigate between items.","i":"Top story","f":"List","n":"Digest","r":"Side-by-side","u":"Hub News","e":"Carousel","l":"Tiles","S":"Site {0}","h":"Organizational news site {0}","g":"Remove","m":"Move"}')},siGj:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=100},szL1:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n("ZQz3"),i=function(){function e(){}return Object.defineProperty(e,"_layoutsSliderEnabled",{get:function(){return new Set([1,5,6,2])},enumerable:!1,configurable:!0}),e.isAnyCurrentLayout=function(e,t){return t.some(function(t){return e===a.e.getLayoutId(t)})},e.isLayoutEnabledAndMatching=function(t,n){var i=a.e.getNewsLayout(t)===n;return e.isLayoutEnabled(t)&&i},e.isLayoutEnabled=function(e){return 3!==a.e.getNewsLayout(e)},e.isRenderItemsSliderEnabled=function(t){var n=a.e.getNewsLayout(t);return!!n&&e._layoutsSliderEnabled.has(n)},e}()},tGpx:function(e,t){e.exports=g},ut3N:function(e,t){e.exports=v},vnpV:function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o});var a=n("QZHX"),i=n("Pk8u"),r={filterType:a.FilterType.TitleContaining,value:"",values:[]};function o(e){return!e||1===e.length&&Object(i.isEqual)(e[0],r)}},xc3d:function(e,t,n){"use strict";var a=n("17wl"),i=n("cDcd"),r=n("KL1q"),o=n("lgTv"),s=n("F2ap"),c=n("IGle"),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._refItems={},t._renderHubNewsItem=function(){var e,n=t.props,a=n.isFeatured,c=n.isLoading,d=n.index,l=n.locale,u=n.newsItem,f=n.serviceScope,p=n.showNewsMetadata,m=n.size,_=n.theme;if(void 0!==u){var h=o.c[m],b=Object(r.css)(s.e.newsItem,s.e.newsHubItem,Boolean(h)&&h.className,((e={})[s.e.newsHubItem__featured]=a,e)),g=t._isImageVisible()&&!c,v=new o.r(t.props),y=i.createElement("div",{className:b},v.renderSiteTitleLink(t._siteLinkRefCallback),v.renderTitle(t._titleRefCallback));return a?i.createElement("div",{className:b},i.createElement("div",null,Boolean(u.image)?g&&t._renderImageArea(v):t._renderHubImagePlaceholder()),i.createElement("div",{className:s.e.hubNewsItemInfo},v.renderSiteTitleLink(t._siteLinkRefCallback),v.renderTitle(t._titleRefCallback),i.createElement(o.i,{item:u,index:d,locale:l,serviceScope:f,showNewsMetadata:p,theme:_,viewCounts:u.viewCounts}))):y}},t._siteLinkRefCallback=function(e){t._refItems.siteLinkElement=e},t._titleRefCallback=function(e){t._refItems.titleElement=e},t._truncateTitle=function(){var e=t.props,n=e.isEligibleForCssTextTruncate,a=e.isFeatured;t._refItems.titleElement&&(n?a&&t._refItems.titleElement.classList.add(s.e.truncateTitleText):t._refItems.titleElement.classList.add(s.e.textIEStyle))},t}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"_classNames",{get:function(){var e=this.props.theme;return c.e.getClassNames({root:"HubNewsItem",theme:e})},enumerable:!1,configurable:!0}),t.prototype.render=function(){return i.createElement(o.a,Object(a.__assign)({},this.props,{functionOverrides:{render:this._useHubNewsRender()?this._renderHubNewsItem:void 0,truncateText:this._truncateTitle}}))},t.prototype._renderImageArea=function(e){return i.createElement("div",{className:s.e.imageAreaContainer},e.renderImageArea())},t.prototype._renderHubImagePlaceholder=function(){return i.createElement("div",{className:Object(r.css)(s.e.hubItemImagePlaceholderContainer)},i.createElement("div",{className:Object(r.css)(s.e.hubItemImagePlaceholder,this._classNames.hubItemImagePlaceholderContainer)},i.createElement(r.Icon,{className:s.e.hubPlaceholderIcon,iconName:"News"})))},t.prototype._isImageVisible=function(){var e=this.props.newsItem,t=e.image;return void 0!==e.isContributorActionCard||Boolean(t)},t.prototype._useHubNewsRender=function(){var e=this.props.size;return 9===e||6===e||8===e||7===e},t}(i.Component);t.e=d},y88i:function(e,t){e.exports=y}})});