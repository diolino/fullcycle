(window.webpackJsonp_764afdc3_183e_47f5_8d20_a62aff2b0881_0_1_0=window.webpackJsonp_764afdc3_183e_47f5_8d20_a62aff2b0881_0_1_0||[]).push([[5],{"1tKF":function(e,t,n){"use strict";n.d(t,"e",function(){return d});var a=n("17wl"),i=n("dq6a"),r=n("aABS"),o=n("K9kD"),s=n("w0LS"),c=function(){function e(e,t){var n=e.id,a=e.cacheType,i=void 0===a?o.DataStoreCachingType.session:a,r=t.cacheIdPrefix,c=void 0===r?s.t:r,d=t.pageContext;this._id=n,this._version=d?d.siteClientTag+"_"+d.userDisplayName:"",this._store=new o.DataStore(c,i),this._storeDefaultCacheType=i,this._initCache()}return e.prototype.getDataUtilizingCache=function(e){var t=this,n=e,a=n.cacheRequestKey,i=n.useStale,r=void 0!==i&&i,c=n.bypassCache,d=void 0!==c&&c,l=n.onlyCache,u=void 0!==l&&l,f=n.checkForInvalidation,p=n.setInvalidated,m=n.getData,_=n.cacheTimeoutTime,h=void 0===_?s.n:_,b=n.returnStatistics,g=void 0!==b&&b,v=this._cache,y=v[a],S=function(){return g?{data:y._value,cacheStats:{lastModified:NaN,lastRead:y._fetched,reads:NaN}}:y._value};if(u)return y?o.Promise.resolve(S()):o.Promise.resolve(void 0);f=f&&!d&&this._storeDefaultCacheType!==o.DataStoreCachingType.local;var D=y&&this._isCacheExpired(y,a,f,h);return d||!y||D&&!r?m().then(function(e){var n=(new Date).valueOf();return v[a]={_fetched:n,_value:e},p&&t._store.setValue(a,n-1,o.DataStoreCachingType.local),t._updateCache(),g?{data:e,cacheStats:{lastModified:NaN,lastRead:n,reads:NaN}}:e}):o.Promise.resolve(S())},e.prototype.getRequestKey=function(e,t,n){var a=[];return a.push(e),a.push(t),n&&a.push(n.toString()),a.join(",")},e.prototype.isCachedDataInvalidated=function(e){var t=this._cache[e];return this._isCachedDataInvalidated(t,e)},Object.defineProperty(e.prototype,"cacheId",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cacheVersionId",{get:function(){return this._id+"-version"},enumerable:!1,configurable:!0}),e.prototype.flushCache=function(e){e?(delete this._cache[e],this._updateCache()):this._clearCache()},e.prototype._initCache=function(){this._version!==this._store.getValue(this.cacheVersionId,void 0,!1)?(this._clearCache(),this._store.setValue(this.cacheVersionId,this._version,void 0,!1)):this._cache=this._store.getValue(this.cacheId,void 0,!1)||{}},e.prototype._updateCache=function(){this._store.setValue(this.cacheId,this._cache,void 0,!1)},e.prototype._clearCache=function(){this._cache={},this._updateCache()},e.prototype._isCacheExpired=function(e,t,n,a){if(n&&this._isCachedDataInvalidated(e,t))return!0;var i=(new Date).valueOf()-a;return e._fetched<=i},e.prototype._isCachedDataInvalidated=function(e,t){var n=Number(this._store.getValue(t,o.DataStoreCachingType.local));return!!(e&&n&&e._fetched<n)},e}(),d=function(e){function t(t,n){var i=e.call(this,t,n)||this,o=n.pageContext;i._legacyRequestCache=new c(t,{pageContext:o}),t.cacheType;var s=Object(a.__rest)(t,["cacheType"]);return i._persistentRequestCache=new r.e(s,{pageContext:o}),i}return Object(a.__extends)(t,e),t.prototype.getDataUtilizingLegacyCache=function(e){var t=this,n=e,i=n.getUrl,r=n.getAdditionalPostData,o=n.cacheRequestKey,s=n.cacheTimeoutTime,c=Object(a.__rest)(n,["getUrl","getAdditionalPostData","cacheRequestKey","cacheTimeoutTime"]);(c=Object(a.__assign)({url:i&&i(),additionalPostData:r&&r(),method:"POST"},c)).url=c.url||i&&i(),"needsRequestDigest"in c||(c.needsRequestDigest=this.needsRequestDigest(c.url)),c.additionalPostData=c.additionalPostData||r&&r(),o=o||this.getRequestKey(c.url,c.method,c.additionalPostData);var d=e.useStale,l=void 0!==d&&d,u=e.bypassCache,f=void 0!==u&&u,p=e.onlyCache,m=void 0!==p&&p,_=e.checkForInvalidation,h=void 0!==_&&_,b=e.setInvalidated,g=void 0!==b&&b;return this._legacyRequestCache.getDataUtilizingCache({cacheRequestKey:o,useStale:l,bypassCache:f,onlyCache:m,checkForInvalidation:h,setInvalidated:g,cacheTimeoutTime:s,getData:function(){return t.dataRequestor.getData(c)}})},t.prototype.getDataUtilizingPersistentCache=function(e){var t=this,n=e,i=n.getUrl,r=n.getAdditionalPostData,o=n.cacheRequestKey,s=n.cacheTimeoutTime,c=n.returnStatistics,d=Object(a.__rest)(n,["getUrl","getAdditionalPostData","cacheRequestKey","cacheTimeoutTime","returnStatistics"]);(d=Object(a.__assign)({url:i&&i(),additionalPostData:r&&r(),method:"POST"},d)).url=d.url||i&&i(),"needsRequestDigest"in d||(d.needsRequestDigest=this.needsRequestDigest(d.url)),d.additionalPostData=d.additionalPostData||r&&r(),o=o||this.getRequestKey(d.url,d.method,d.additionalPostData);var l=e.cachingStrategy;return this._persistentRequestCache.getDataUtilizingCache({cachingStrategy:l,cacheRequestKey:o,cacheTimeoutTime:s,getData:function(){return t.dataRequestor.getData(d)},returnStatistics:c})},t.prototype.isCachedDataInvalidated=function(e){return this._legacyRequestCache.isCachedDataInvalidated&&this._legacyRequestCache.isCachedDataInvalidated(e)},t.prototype.getRequestKey=function(e,t,n){return this._legacyRequestCache.getRequestKey(e,t,n)},Object.defineProperty(t.prototype,"cacheId",{get:function(){return this._legacyRequestCache.cacheId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cacheVersionId",{get:function(){return this._legacyRequestCache.cacheVersionId},enumerable:!1,configurable:!0}),t.prototype.flushCache=function(e){this._legacyRequestCache.flushCache(e),this._persistentRequestCache.flushCache(e)},t}(i.e);t.t=d},"7qB6":function(e,t,n){"use strict";function a(e){for(var t="";t.length<e;){var n=16*Math.random();t+=(n|=0).toString(16)}return t}function i(){var e=[];e.push(a(8)),e.push(a(4));var t="4"+a(3);e.push(t);var n=a(4),i=parseInt(n[0],16);return i&=3,n=(i|=8).toString(16)+n.substr(1),e.push(n),e.push(a(12)),e.join("-")}function r(e,t){return void 0===t&&(t=!1),e?function(e,t){var n=e.match(/^\{(.*)\}$/);return n?t?n[0]:n[1]:t?"{"+e+"}":e}(e.toUpperCase(),t):""}n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r})},aABS:function(e,t,n){"use strict";n.d(t,"e",function(){return H});var a={};n.r(a),n.d(a,"localStorage",function(){return s}),n.d(a,"indexedDB",function(){return c}),n.d(a,"none",function(){return d});var i,r=n("17wl"),o=n("K9kD"),s=0,c=1,d=2,l=a,u=n("7qB6"),f="undefined"==typeof window?self:window;!function(e){e.success="success",e.error="error"}(i||(i={}));var p="app",m="app_lastRead",_="ODSP_DB",h="ODSP_DB_TABLE",b="lastModified",g="lastRead",v="ODSP_DB_METADATA_TABLE",y="database_metadata",S="parentKey",D="reads",I=(new function(e){var t="undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0;e||(e=t&&t.navigator&&navigator.userAgent||"");var n,a=e,i=e.toLowerCase(),o=function(e){var t;function n(n){return t=RegExp("".concat(n,"(\\d+)([\\d.]*)")).exec(e)}e=e.toLowerCase();var a=n("msie ")||n("trident.*rv:"),i=t&&"9"===t[1],r=!t&&n("edge/"),o=!t&&n("edg/"),s=!t&&n("fxios|firefox/"),c=!t&&n("(?:chrome|crios)/"),d=!t&&/safari\/(\d+)/.test(e);return d&&n("version/"),{browserName:a?"IE":r?"Edge":o?"EdgeChromium":s?"Firefox":c?"Chrome":d?"Safari":"NA",isChrome:!!c,isEdge:!!r,isEdgeChromium:!!o,isFirefox:!!s,isIE:!!a,isIE9:!!i,isSafari:!!d,matchedBrowser:t}}(i),s={browserMajor:(n=o.matchedBrowser)&&parseInt(n[1],10)||0,browserMinor:n&&n[2]&&n[2].slice(1)||"0"},c=function(e){e=e.toLowerCase();var t=/windows phone|wpdesktop/.test(e),n=t||/ipad|iphone|ipod|android/.exec(e),a=n&&n[0],i="android"===a,r="ipad"===a,o=!!a&&!i,s=!n&&e.indexOf("macintosh")>-1,c=!n&&e.indexOf("windows nt")>-1;return{isAndroid:i,isIOS:o,isIPad:r,isMac:s,isWindows:c,isWinPhone:!!t,isMobile:!!n,osName:c?"Windows":t?"Windows Phone":s?"OSX":o?"IOS":i?"Android":"NA"}}(i),d=c.isMobile,l=/electron\/\\d+[\\d.]*/.test(i),u=i.indexOf("winappwipenabled")>-1,f=!("undefined"==typeof window||!window.matchMedia)&&(window.matchMedia("(display-mode: standalone)").matches||window.matchMedia("(display-mode: minimal-ui)").matches),p=/[\s\(](os|os x|windows (?:phone|nt)|android) ([\d._]+)/.exec(i),m=!1,_=!1,h=!1,b=!1;if(t&&t.document){var g=document.createElement("style");g.type="text/css",m=!g.styleSheet,_="addBehavior"in HTMLDivElement.prototype;var v=document.createElement("input");v.type="file";var y=t.File,S=y&&y.prototype;b=!(!S||!(S.slice||S.mozSlice||S.webkitSlice)),h="webkitdirectory"in v&&!l}return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},o),s),c),{isElectron:l,osVersion:p?p[2]:"NA",isWindows81:!d&&/windows (?:8\.1|nt 6\.3)/.test(i),isWindows10:!d&&i.indexOf("windows nt 10")>-1,isWindows7:!d&&i.indexOf("windows nt 6.1")>-1,isWinAppWipEnabled:u,isPWA:f,areCSS3TransitionsSupported:!o.isIE||s.browserMajor>9,areTouchEventsSupported:!!t&&"ontouchstart"in t,isFolderUploadSupported:h,isHtml5FileUploadSupported:b,isRetinaSupported:!!t&&t.devicePixelRatio>1,isUnlimitedStyleSheetsSupported:m,isWebDavSupported:_,userAgent:a})}).isFirefox,x="indexedDB is not supported",C=function(){function e(t){if(!("indexedDB"in f)||!f.indexedDB)throw new Error(x);this._logger=t,e._openDBPromise||(e._openDBPromise=this._openIndexedDB().then(function(t){return e._db=t,t}))}return e.prototype.freeSpace=function(t,n){return Object(r.__awaiter)(this,void 0,void 0,function(){var a,i,o,s=this;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return i=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=r.sent(),r.label=2;case 2:return a=i._db=o,[2,new Promise(function(e,i){var r=a.transaction([h],"readwrite").objectStore(h).index(m).openCursor();r.onsuccess=function(a){var i=r.result;i?(i.value.app===t&&n>0&&(n-=i.value.size,i.delete()),n>0?i.continue():e()):e()},r.onerror=function(e){s._errorHandling(e,i)}})]}})})},e.prototype.read=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){return[2,this._readInternal(h,function(t){return t.get(e)})]})})},e.prototype.rangeQuery=function(t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,a,i,o,s,c,d,l,u,f,p,m,_,b=this;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return n={},i=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=r.sent(),r.label=2;case 2:return a=i._db=o,s=a.transaction([h],"readonly"),c=s.objectStore(h),d=[],l=t.index,u=t.range,f=t.direction,p=t.count,m=c.index(l),(_=m.openKeyCursor(u,f)).onerror=function(e){b._errorHandling(e,n.reject)},_.onsuccess=function(e){var t=e.target.result;t?(d.push(t.primaryKey),d.length>=p?n.resolve(d):t.continue()):n.resolve(d)},[2,new Promise(function(e,t){n.resolve=e,n.reject=t})]}})})},e.prototype.write=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){return t=e.key,void 0!==e.data?[2,this._writeInternal({tableName:h,key:t,row:Object(r.__assign)(Object(r.__assign)({},e),{lastModified:Date.now()})})]:void 0!==e.parentKey?[2,this._deleteDataRows(e.parentKey)]:[2,this._writeInternal({tableName:h,key:t,row:void 0})]})})},e.prototype.statistics=function(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e,t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return this._dbMetaData?[3,2]:[4,this._readAndSetMetadataDB()];case 1:e=n.sent(),this._dbMetaData=e,n.label=2;case 2:return[4,this._iterate(h,function(e){return e.size})];case 3:return t=n.sent(),[2,{metaData:this._dbMetaData,count:t.length,totalBytes:t.reduce(function(e,t){return e+t},0)}]}})})},e.prototype._openIndexedDB=function(){var t=this;return new Promise(function(n,a){if(e._db)n(e._db);else{var i=I?indexedDB.open(_,{version:4,storage:"temporary"}):indexedDB.open(_,4);i.onerror=function(e){t._errorHandling(e,a)},i.onsuccess=function(t){var a=e._db=i.result;n(a)},i.onupgradeneeded=function(e){var n=e.target.result;n.onerror=function(e){t._errorHandling(e,a)};var r=e.oldVersion;t._handleDBUpgrade(i,n,r)}}})},e.prototype._handleDBUpgrade=function(e,t,n){var a;n<1&&((a=t.createObjectStore(h,{keyPath:"key"})).createIndex(b,b,{unique:!1}),a.createIndex(D,D,{unique:!1}),t.createObjectStore(v,{keyPath:"key"})),n<2&&((a=a||e.transaction.objectStore(h)).createIndex(p,p,{unique:!1}),a.createIndex(g,g,{unique:!1}),a.createIndex(m,[p,g],{unique:!1})),n<3&&((a=a||e.transaction.objectStore(h)).createIndex("app_lastModified",[p,b],{unique:!1}),a.createIndex("app_reads",[p,D],{unique:!1})),n<4&&((a=a||e.transaction.objectStore(h)).createIndex(S,S,{unique:!1}),a.createIndex("parentKey_app",[S,p],{unique:!1}),a.createIndex("parentKey_app_lastModified",[S,p,b],{unique:!1}),a.createIndex("parentKey_app_lastRead",[S,p,g],{unique:!1}),a.createIndex("parentKey_app_reads",[S,p,D],{unique:!1}))},e.prototype._readAndSetMetadataDB=function(){var e=this;return this._readInternal(v,function(e){return e.get(y)}).then(function(t){if(t)return t.data;var n={id:u.e(),created:Date.now(),cacheType:l.indexedDB};return e._writeInternal({tableName:v,key:y,row:{key:y,data:n}}).then(function(){return n})})},e.prototype._readInternal=function(t,n){return Object(r.__awaiter)(this,void 0,void 0,function(){var a,i,s,c=this;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return i=e,(s=e._db)?[3,2]:[4,e._openDBPromise];case 1:s=r.sent(),r.label=2;case 2:return a=i._db=s,[2,new Promise(function(e,i){var r=c._logger({name:"PersistentCacheIDB.readInternal"}),s=Date.now(),d=a.transaction([t],"readonly").objectStore(t),l=n(d);l.onsuccess=function(t){r({resultType:o.ResultTypeEnum.Success,extraData:{io:Math.round(Date.now()-s)}}),e(l.result)},l.onerror=function(e){r({resultType:o.ResultTypeEnum.Failure,extraData:{io:Math.round(Date.now()-s)}}),c._errorHandling(e,i)}})]}})})},e.prototype._iterate=function(t,n){return Object(r.__awaiter)(this,void 0,void 0,function(){var a,i,o,s,c=this;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return i=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=r.sent(),r.label=2;case 2:return a=i._db=o,s=[],[2,new Promise(function(e,i){var r=a.transaction([t],"readonly").objectStore(t).openCursor();r.onsuccess=function(t){var a=r.result;a?(s.push(n(a.value)),a.continue()):e(s)},r.onerror=function(e){c._errorHandling(e,i)}})]}})})},e.prototype._writeInternal=function(t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,a,i,o,s,c,d=this;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return n=t.tableName,a=t.key,i=t.row,s=e,(c=e._db)?[3,2]:[4,e._openDBPromise];case 1:c=r.sent(),r.label=2;case 2:return o=s._db=c,[2,new Promise(function(e,t){try{var r=o.transaction([n],"readwrite"),s=r.objectStore(n);r.oncomplete=function(){},r.onerror=function(e){d._errorHandling(e,t)};var c=i?s.put(i):s.delete(a);c.onsuccess=function(t){e()},c.onerror=function(e){d._errorHandling(e,t)}}catch(e){throw e}})]}})})},e.prototype._deleteDataRows=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n=this;return Object(r.__generator)(this,function(a){return t=e.slice(0,e.length-1)+String.fromCharCode(e.charCodeAt(e.length-1)+1),[2,this.rangeQuery({index:S,range:IDBKeyRange.bound(e,t,!1,!0),direction:"next"}).then(function(e){return Promise.all(e.map(function(e){return n._writeInternal({tableName:h,key:e,row:void 0})}))}).then(function(){})]})})},e.prototype._errorHandling=function(e,t){if(e.type===i.error){var n=e.target.error;t({name:n.name,message:n.message,code:n.code})}},e}(),O="PersistentCache",w="PersistentCache_metadata",E=function(){function e(){try{if("localStorage"in f&&f.localStorage&&(this._localStorage=f.localStorage,!this._localStorage.getItem(w))){var e={id:u.e(),created:Date.now(),cacheType:l.localStorage};this._localStorage.setItem(w,JSON.stringify(e))}}catch(e){}if(!this._localStorage)throw new Error("localStorage is not supported")}return e.prototype.freeSpace=function(e,t){throw new Error("Method not implemented.")},e.prototype.read=function(e){return JSON.parse(this._localStorage.getItem(this._cacheKey(e)))},e.prototype.write=function(e){var t=e.key;if(void 0!==e.data){var n=Object(r.__assign)(Object(r.__assign)({},e),{lastModified:Date.now()});this._localStorage.setItem(this._cacheKey(t),JSON.stringify(n))}else this._localStorage.removeItem(this._cacheKey(t))},e.prototype.statistics=function(){var e=[];for(var t in this._localStorage)if(0===t.indexOf(O)){var n=this._localStorage.getItem(t);e.push(n?n.length:0)}return{metaData:JSON.parse(this._localStorage.getItem(w)),count:e.length,totalBytes:e.reduce(function(e,t){return e+t},0)}},e.prototype.rangeQuery=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2,void 0]})})},e.prototype._cacheKey=function(e){return"".concat(O,"_").concat(e)},e}(),A=0,L=function(){function e(){this._queue={}}return e.prototype.enqueue=function(e,t){var n=this._queue[e]=this._queue[e]||[],a=!0,i=[];n.length>0&&(n[0].schedule?(i=n.slice(1),this._queue[e]=[n[0]],a=!1):(i=this._queue[e],this._queue[e]=[]));var r=this._createUpateTask(e,t);return i.length>0&&(r.signal=i[0].signal),this._queue[e].push(r),a&&this._scheduleTask(e),r},e.prototype._createUpateTask=function(e,t){var n=this,a={};a.promise=new Promise(function(e,t){a.resolve=e,a.reject=t});var i={execute:function(){return Object(r.__awaiter)(n,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,3,4]),[4,t()];case 1:return n.sent(),[3,4];case 2:return e=n.sent(),i.error=e,[3,4];case 3:return this._completeTask(i),[7];case 4:return[2]}})})},schedule:0,id:A++,key:e,signal:a};return i},e.prototype._scheduleTask=function(e){var t=this._queue[e];if(t&&t.length>0){var n=t[0];n.schedule=f.setTimeout(n.execute,5)}},e.prototype._completeTask=function(e){var t=e.id,n=e.key,a=this._queue[n],i=a[0],r=a.slice(1);if(i.id!==t)throw new Error("this should not happen, currently running task must be the top of the queue");this._queue[n]=r,this._scheduleTask(n),e.error?e.signal.reject(e.error):e.signal.resolve()},e}();function k(){return f.performance&&performance.now?Math.round(performance.now()):Date.now()}var M="_odspcache_",P="_____",T={cacheType:l.indexedDB},U=function(){function e(e){var t=e.cacheType,n=void 0===t?T.cacheType:t,a=Object(r.__rest)(e,["cacheType"]);if(this._config=Object(r.__assign)(Object(r.__assign)({},a),{cacheType:n}),this._cacheSecret=this._config.secret,this._dataIsEncrypted=!!this._cacheSecret,this._crypto=this._config.crypto,this._dataIsEncrypted&&!this._crypto)throw new Error("When data needs encryption, crypto implementing ICrypto has to be provided when initiating PersistentCache.");this._cacheType=this._config.cacheType,this._app=e.app,this._cacheUpdateTaskManager=new L,this._qos=this._config.telemetry&&this._config.telemetry.qos,this._initLocalStorage(this._cacheType)}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this._config},enumerable:!1,configurable:!0}),e.prototype.read=function(t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,a,i,s,c,d,l,u,f,p,m,_,h,b,g,v,y,S,D,I;return Object(r.__generator)(this,function(r){switch(r.label){case 0:n=this._logQos({name:"PersistentCache.read"}),c=k(),d=Date.now(),r.label=1;case 1:return r.trys.push([1,12,,13]),u=this._getCacheKey(t),f=!1,p={lastModified:NaN,lastRead:d,reads:1},m=void 0,u?(_=k(),[4,this._storage.read(u)]):[3,11];case 2:return l=r.sent(),s=Math.round(k()-_),l?(h=l.data,p={lastModified:l.lastModified,lastRead:d,reads:l.reads+1},(a=e._buffer[u])&&a.cacheStats.lastModified===l.lastModified?(a.app=l.app||this._app,a.key={original:t,encoded:l.key||u},a.cacheStats.lastRead=d,a.cacheStats.reads++,a.performance={total:Math.round(k()-c)},[3,11]):[3,3]):[3,11];case 3:if(a=void 0,void 0===h)return[3,11];if(!this._dataIsEncrypted)return[3,10];b=h,g=this._cacheSecret,v=g.CurrentKey.Key,y=g.PreviousKey.Key,S=k(),r.label=4;case 4:return r.trys.push([4,6,,9]),[4,this._crypto.decrypt({encryptedData:b,encryptionSecret:v})];case 5:return m=r.sent(),[3,9];case 6:return(D=r.sent())&&D.message&&D.message.indexOf("wrong secret or signature.")>=0?[4,this._crypto.decrypt({encryptedData:b,encryptionSecret:y})]:[3,8];case 7:m=r.sent(),f=void 0!==m,n({resultType:o.ResultTypeEnum.ExpectedFailure,error:D.message,extraData:{cacheResult:"hit"}}),r.label=8;case 8:return[3,9];case 9:return i=Math.round(k()-S),[3,11];case 10:m=h,r.label=11;case 11:return a=a||{key:{original:t,encoded:l&&l.key||u},app:l&&l.app||this._app,data:m,cacheStats:p,cacheType:this._cacheType,performance:{crypto:i,io:s,total:Math.round(k()-c)}},e._buffer[u]=a,f&&this.update(t,m),[3,13];case 12:throw I=r.sent(),n({resultType:o.ResultTypeEnum.Failure,error:I.message?I.message:I.toString(),extraData:{cacheResult:"miss"}}),I;case 13:return n({resultType:o.ResultTypeEnum.Success,extraData:{cacheResult:"".concat(void 0!==a.data?"hit":"miss")}}),[2,Promise.resolve(a)]}})})},e.prototype.rangeQuery=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,a,i,s,c,d,u=this;return Object(r.__generator)(this,function(r){if(this._cacheType!==l.indexedDB)throw new Error("Only indexedDB supports range query, your storage does not support!");t=this._logQos({name:"PersistentCache.rangeQuery"}),n=0,a=k(),i=Date.now(),c={lastModified:NaN,lastRead:i,reads:1};try{d=k(),s=this._storage.rangeQuery(e).then(function(e){return n=Math.round(k()-d),{key:void 0,app:void 0,data:e.map(function(e){return{original:u._getOriginalKeyFromCacheKey(e),encoded:e}}),cacheStats:c,cacheType:u._cacheType,performance:{io:n,total:Math.round(k()-a)}}})}catch(e){throw t({resultType:o.ResultTypeEnum.Failure,error:e.message?e.message:e.toString()}),e}return t({resultType:o.ResultTypeEnum.Success}),[2,s||Promise.resolve({key:void 0,app:void 0,data:[],cacheStats:c,cacheType:this._cacheType,performance:{io:n,total:Math.round(k()-a)}})]})})},e.prototype.update=function(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,a=this;return Object(r.__generator)(this,function(i){switch(i.label){case 0:return n=this._getCacheKey(e),[4,this._cacheUpdateTaskManager.enqueue(n,function(){return a._doCacheUpdate(e,t)}).signal.promise];case 1:return i.sent(),this._logCacheStats(),[2]}})})},e.prototype.remove=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){return[2,this.update(e,void 0)]})})},e.prototype.freeSpace=function(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(n){return[2,this._storage.freeSpace(e,t)]})})},e.prototype.readAndUpdate=function(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,a,i,s,c,d,u=this;return Object(r.__generator)(this,function(r){switch(r.label){case 0:n=k(),a=Date.now(),i=this._logQos({name:"PersistentCache.readAndUpdate"}),s=t().then(function(t){var i={app:u._app,key:{original:e,encoded:u._getCacheKey(e)},data:t,cacheType:l.none,cacheStats:{lastModified:void 0,lastRead:a,reads:1},performance:{total:Math.round(k()-n)}};return u.update(e,t),i}),r.label=1;case 1:r.trys.push([1,8,,9]),r.label=2;case 2:return r.trys.push([2,4,,5]),[4,Promise.race([this.read(e),s])];case 3:return c=r.sent(),[3,5];case 4:return r.sent(),[3,5];case 5:return!c||c.cacheType!==l.none&&void 0===c.data?[4,s]:[3,7];case 6:c=r.sent(),r.label=7;case 7:return[3,9];case 8:throw d=r.sent(),i({resultType:o.ResultTypeEnum.Failure,error:d.message?d.message:d.toString()}),d;case 9:return i({resultType:o.ResultTypeEnum.Success}),[2,c]}})})},e.prototype._initLocalStorage=function(e){if(e===l.localStorage)this._storage=new E;else try{this._storage=new C(this._logQos.bind(this))}catch(e){e.message===x&&(this._storage=new E,this._cacheType=l.localStorage)}},e.prototype._getCacheKey=function(e){var t=encodeURIComponent("".concat(e.key).concat(e.user?P+e.user:""));return"".concat(M).concat(this._dataIsEncrypted?btoa(t):t)},e.prototype._getOriginalKeyFromCacheKey=function(e){var t=e.replace(M,""),n=this._dataIsEncrypted?atob(t):t,a=decodeURIComponent(n);if(a.indexOf(P)>=0){var i=a.split(P);return{key:i[0],user:i[1]}}return{key:a}},e.prototype._doCacheUpdate=function(t,n){return Object(r.__awaiter)(this,void 0,void 0,function(){var a,i,s,c,d,u,f;return Object(r.__generator)(this,function(p){switch(p.label){case 0:a=this._logQos({name:"PersistentCache.update"}),p.label=1;case 1:return p.trys.push([1,9,,10]),i=this._getCacheKey(t),void 0===n?[3,6]:((s=e._buffer[i]=Object(r.__assign)(Object(r.__assign)({},e._buffer[i]),{data:n,cacheType:this._cacheType})).cacheStats||(s.cacheStats={lastModified:NaN,lastRead:k(),reads:1}),c=n,d=NaN,this._dataIsEncrypted?(u=this._cacheSecret.CurrentKey.Key,[4,this._crypto.encrypt({encryptionSecret:u,data:n,doSerialize:this._cacheType===l.localStorage})]):[3,3]);case 2:return c=p.sent(),d=c.cipherText?c.cipherText.byteLength:0,[3,4];case 3:try{d="string"==typeof n?n.length:JSON.stringify(n).length}catch(e){}p.label=4;case 4:return[4,this._storage.write({app:this._app,key:i,data:c,lastRead:s.cacheStats.lastRead,parentKey:t.parentKey,reads:s.cacheStats.reads,size:d})];case 5:return p.sent(),[3,8];case 6:return delete e._buffer[i],[4,this._storage.write({key:i,app:void 0,data:void 0,lastRead:void 0,parentKey:t.parentKey,reads:void 0,size:void 0})];case 7:p.sent(),p.label=8;case 8:return[3,10];case 9:throw f=p.sent(),a({resultType:o.ResultTypeEnum.Failure,error:f.message?f.message:f.toString()}),f;case 10:return a({resultType:o.ResultTypeEnum.Success}),[2]}})})},e.prototype._logCacheStats=function(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e=this;return Object(r.__generator)(this,function(t){return this._logStatsTimer||(this._logStatsTimer=setTimeout(function(){return Object(r.__awaiter)(e,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,this._storage.statistics()];case 1:return e.sent(),[2]}})})},3e4)),[2]})})},e.prototype._logQos=function(e){if(this._qos){var t=this._app;e.extraData||(e.extraData={}),e.extraData.alias=e.extraData.alias||t;var n=new this._qos(e);return function(e){e.extraData||(e.extraData={}),e.extraData.alias=e.extraData.alias||t,n.end(e)}}return function(e){}},e._buffer={},e}(),F=n("w0LS"),H=function(){function e(e,t){this._getDataPromises={};var n=e.id,a=e.dataSourceName,i=e.cacheType,s=void 0===i?l.indexedDB:i,c=(t.pageContext||{}).aadUserId;this._id=n,this._userId=c;var d=a||n,u=o.Qos.withData(function(e){return e.name&&d&&!e.name.startsWith(d)?Object(r.__assign)(Object(r.__assign)({},e),{name:"".concat(d,".").concat(e.name)}):e});this._cache=new U({cacheType:s,telemetry:{qos:u}})}return e.prototype.getDataUtilizingCache=function(e){var t=this,n=e,a=n.cacheRequestKey,i=n.cachingStrategy,r=void 0===i?F.e.useCacheAndUpdateInTheBackground:i,s=n.cacheTimeoutTime,c=void 0===s?F.a:s,d=n.getData,l=n.returnStatistics,u=void 0!==l&&l,f={key:a,user:this._userId},p=function(){return t._getDataPromises[a]||(t._getDataPromises[a]=d().then(function(e){return delete t._getDataPromises[a],e}).catch(function(e){throw delete t._getDataPromises[a],e})),t._getDataPromises[a].then(function(e){return t._cache.update(f,e),u?{data:e,cacheStats:{lastModified:NaN,lastRead:Date.now(),reads:1}}:e})};return r===F.e.onlyCache?o.Promise.resolve(this._cache.read(f)).then(function(e){var t=e.data,n=e.cacheStats;return null==t?null:u?{data:t,cacheStats:n}:t}).catch(function(){return null}):o.Promise.resolve(this._cache.read(f)).then(function(e){var n=e.data,a=e.cacheStats;if(null==n)return p();var i=u?{data:n,cacheStats:a}:n,o=t._isCacheExpired(a.lastModified,c);switch(r){case F.e.useCacheAndNoUpdate:return i;case F.e.useCacheAndUpdateInTheBackground:return o&&p(),i;case F.e.useCacheIfNotExpired:return o?p():i;case F.e.bypassCache:default:return p()}}).catch(function(){return p()})},e.prototype.getRequestKey=function(e,t,n){var a=[];return a.push(e),a.push(t),n&&a.push(n.toString()),a.join(",")},Object.defineProperty(e.prototype,"cacheId",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cacheVersionId",{get:function(){return this._id+"-version"},enumerable:!1,configurable:!0}),e.prototype.flushCache=function(e){var t={key:e,user:this._userId};delete this._cache[e],this._cache.remove(t)},e.prototype.updateCache=function(e,t){var n={key:e,user:this._userId};this._cache.update(n,t)},e.prototype._isCacheExpired=function(e,t){return e<=(new Date).valueOf()-t},e}()},dq6a:function(e,t,n){"use strict";var a=n("17wl"),i=n("K9kD"),r=function(){function e(e,t){var n=this._pageContext=t.pageContext,r=t.tokenProvider,o=t.dataRequestorType,s=void 0===o?function(e){function t(t){return e.call(this,t,{pageContext:n,tokenProvider:r})||this}return Object(a.__extends)(t,e),t}(i.DataRequestor):o,c=e.dataSourceName,d=void 0===c?"DataSource":c;this.dataRequestor=new s({qosName:d})}return e.prototype.getDataSourceName=function(){return this.dataSourceName},e.prototype.needsRequestDigest=function(e){return!0},e.prototype.getData=function(e,t,n,a,i,r,o,s,c,d,l,u,f,p){void 0===i&&(i="POST");var m=e(),_=a&&a(),h=this.needsRequestDigest(m);return this.dataRequestor.getData({url:m,parseResponse:t,qosName:n,additionalPostData:_,method:i,additionalHeaders:r,contentType:o,maxRetries:s,noRedirect:c,crossSiteCollectionCall:d,telemetryHandler:l,qosExtraData:u,needsRequestDigest:h,authToken:f,webAbsoluteUrl:p})},e}();t.e=r},jidH:function(e,t,n){"use strict";n.d(t,"e",function(){return f});var a,i=n("17wl"),r=n("K9kD"),o=n("1tKF"),s=n("UoEp"),c=n("ysJJ"),d=n("w0LS"),l={ODB:1447},u={links:void 0,name:"",startingNodeKey:"",isAudienceEnabled:!1,isAudienceTargeted:!1,isAudienceAffected:!1};!function(e){e[e.None=0]="None",e[e.TopOrHub=1]="TopOrHub",e[e.QuickLaunch=2]="QuickLaunch"}(a||(a={}));var f=function(e){function t(t,n){var a=e.call(this,{id:"ViewNavDataSource"},{pageContext:t})||this;return a._mapProviderName=n,a._audiencesDataSource=c.e.getInstance(t),a._viewNavCacheKey="viewNavDataSource"+"_".concat(t.aadUserId),a}return Object(i.__extends)(t,e),t.isRelativeUrl=function(e){return!!e&&!/^[a-z0-9+-.]+:\/\//i.test(e)&&-1===e.indexOf("/_layouts/15/groupstatus.aspx?")},t.shouldLinkOpenInSameWindow=function(e){if(!e)return!1;var t=new r.Uri(e),n=t.getScheme()+"://"+t.getAuthority();return(""===t.getScheme()&&""===t.getAuthority()||n===window.location.origin)&&-1===e.indexOf("/_layouts/15/groupstatus.aspx?")},t.transformNodesToLinks=function(e,n,a){var i=function(e,o){a&&(e=e.filter(function(e){return a(e,o)}));var s=r.Killswitch.isActivated("21145038-e027-44da-8f7e-f5dc5e49f368","07/06/2022","Open all same-origin urls in the current tab and all external urls in a new tab unless OpenInNewWindow is set");return e.map(function(e){var a;return{name:e.Title,key:e.Id.toString(),url:e.Url,onClick:n,isDocLib:e.IsDocLib,links:e.Children&&e.Children.length?i(e.Children,o+1):void 0,audiences:e.AudienceIds||void 0,currentLCID:e.CurrentLCID,openInNewWindow:e.OpenInNewWindow,target:r.Features.isFeatureEnabled({ODB:60322})?(null!==(a=e.OpenInNewWindow)&&void 0!==a?a:!t.shouldLinkOpenInSameWindow(e.Url))?"_blank":"_self":s?"":t.shouldLinkOpenInSameWindow(e.Url)?"_self":"_blank"}})};return i(e=e||[],0)},t.getAreaNavigationSettingsUrl=function(e){return"".concat(e.webAbsoluteUrl,"/_layouts/15/AreaNavigationSettings.aspx")},t.prototype.setGlobalNavEnabled=function(e){var t="".concat(this._pageContext.webAbsoluteUrl,"/_api/navigation/SetGlobalNavEnabled?isEnabled=").concat(e);return this.dataRequestor.getData({url:t,qosName:"SetGlobalNavEnabled",method:"POST",noRedirect:!0})},t.prototype.getGlobalNavEnabled=function(){var e=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return"".concat(e._pageContext.webAbsoluteUrl,"/_api/navigation/GlobalNavEnabled")},parseResponse:function(e){var t=JSON.parse(e);return!(!t||!t.d)&&t.d.GlobalNavEnabled},qosName:"getGlobalNavEnabled",method:"GET",noRedirect:!0,cacheRequestKey:"".concat(this._viewNavCacheKey,"_getGlobalNavEnabled")})},t.prototype.setHomeSiteNavEnabled=function(e){var t="".concat(this._pageContext.webAbsoluteUrl,"/_api/navigation/homesitesettings"),n={__metadata:{type:"Microsoft.SharePoint.Navigation.REST.HomeSiteNavigationSettings"},IsEnabled:e};return this.dataRequestor.getData({url:t,qosName:"setHomeSiteNavEnabled",method:"PATCH",additionalPostData:JSON.stringify(n),noRedirect:!0})},t.prototype.getHomeSiteNavEnabled=function(){var e=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return"".concat(e._pageContext.webAbsoluteUrl,"/_api/navigation/homesitesettings/isenabled")},parseResponse:function(e){var t=JSON.parse(e);return!(!t||!t.d)&&t.d.IsEnabled},qosName:"getHomeSiteNavEnabled",method:"GET",noRedirect:!0,cacheRequestKey:"".concat(this._viewNavCacheKey,"_getHomeSiteNavEnabled")})},t.prototype.getGlobalNav=function(e,t,n){var a=this,i=new r.Qos({name:"GlobalNavigation"}),o="".concat(this._pageContext.webAbsoluteUrl,"/_api/navigation/GlobalNav");t&&(o+="?source='".concat(t,"'"));var s={url:o,qosName:"GetGlobalNavigation",parseResponse:function(e){var t=JSON.parse(e);return a._transformToNavLinkGroup(t,!1,i,!0)},method:"GET",additionalHeaders:{"ODATA-VERSION":"4.0",Accept:"*/*, application/json; odata.metadata=minimal"},contentType:"application/json; odata.metadata=minimal",maxRetries:1,crossSiteCollectionCall:!0,cachingStrategy:e?d.e.bypassCache:d.e.useCacheIfNotExpired,noRedirect:!0,cacheRequestKey:"".concat(this._viewNavCacheKey,"_getGlobalNav")};return this.getDataUtilizingPersistentCache(s).then(function(e){return a._processGlobalNavNodes(e,n)})},t.prototype.processGlobalNavLKG=function(e,t){var n=new r.Qos({name:"GlobalNavigationFromLKG"});return this._processGlobalNavNodes(this._transformToNavLinkGroup(e,!1,n,!0),t)},t.prototype.getHomeSiteNav=function(e,n){var a=this,i=new r.Qos({name:"GetHomeSiteNav"}),o="".concat(this._pageContext.webAbsoluteUrl,"/_api/navigation/HomeSiteNavigation");e&&(o+="?source='".concat(e,"'"));var s={url:o,qosName:"GetHomeSiteNav",parseResponse:function(e){var t=JSON.parse(e);return a._transformToNavLinkGroup(t,!1,i,!0)},method:"GET",additionalHeaders:{"ODATA-VERSION":"4.0",Accept:"*/*, application/json; odata.metadata=minimal"},contentType:"application/json; odata.metadata=minimal",maxRetries:1,noRedirect:!0};return this.dataRequestor.getData(s).then(function(e){return n||m()&&!e||!e.isAudienceEnabled||!e.isAudienceTargeted?e:a._audiencesDataSource.filter("HomeSiteNav",e.links,"links").then(function(n){var a=t.checkIfLinksAffected(e.links,n);return e.links=n||[],e.isAudienceAffected=a,e})})},t.prototype.isNavAudienceTargetedEnabled=function(){var e;return Boolean(0===this._pageContext.webPropertyFlags2||this._pageContext.webPropertyFlags2?this._pageContext.webPropertyFlags2&t.NAV_AUDIENCE_TARGET_FLAG:null===(e=this._pageContext.navigationInfo)||void 0===e?void 0:e.isAudienceTargeted)},t.prototype.getMenuState=function(e){var n=this;void 0===e&&(e={});var a=new r.Qos({name:"TransformMenuStateToLinkGroup"}),i=e.providerName,o=void 0===i?this._mapProviderName:i,c=e.isGlobalNav,f=e.useCache,p=e.forceRefresh,_=e.menuNodeKey,h=e.maxRetries,b=void 0===h?1:h,g=e.depth,v=void 0===g?3:g,y=e.skipAudienceFiltering,S=e.audienceFilterNodeKey,D=f?"getMenuStateUsingCache":"NavigationGetMenuState",I="";o=o||this._mapProviderName,_?(I+="?menuNodeKey='".concat(_,"'"),o&&(I+="&mapProviderName='".concat(o,"'"))):(c||o)&&(I+="?menuNodeKey=".concat(c?s.t.globalNavParent:""),o&&(I+="&mapProviderName='".concat(o,"'"))),r.Features.isFeatureEnabled(l)&&I&&I.length>0&&(I+="&depth='".concat(v,"'"));var x,C={url:"".concat(this._pageContext.webAbsoluteUrl,"/_api/navigation/MenuState").concat(I),qosName:D,qosExtraData:{NavProviderName:o},parseResponse:function(e){var t=JSON.parse(e);return n._transformToNavLinkGroup(t,Boolean(y),a)},method:"GET",additionalHeaders:{"ODATA-VERSION":"4.0",Accept:"*/*, application/json; odata.metadata=minimal"},contentType:"application/json; odata.metadata=minimal",maxRetries:b,crossSiteCollectionCall:!0,cachingStrategy:p?d.e.bypassCache:d.e.useCacheAndUpdateInTheBackground,noRedirect:!0};return x=f?this.getDataUtilizingPersistentCache(C).then(function(e){return m()?e:e||u}):this.dataRequestor.getData(C),m()?!y&&this.isNavAudienceTargetedEnabled()?x.then(function(e){return e&&n._isGroupAudienceTargeted(e)?(e.name===s.t.footerNavParent&&e.links&&S&&n._audiencesDataSource.containsAudiences(e.links.filter(function(e){return e.name===S}),"links")&&r.Engagement.logData({name:"FooterNav.AudienceTargeting"}),n._audiencesDataSource.filter("SiteNav",e.links,"links").then(function(t){return e.links=t||[],e})):e}):x:x.then(function(e){return e.isAudienceEnabled&&e.isAudienceTargeted?n._audiencesDataSource.filter("SiteNav",e.links,"links").then(function(n){var a=t.checkIfLinksAffected(e.links,n);return e.links=n||[],e.isAudienceAffected=a,e}):e})},t.checkIfLinksAffected=function(e,t){return p(e)!==p(t)},t.prototype.clearCache=function(){this.flushCache()},t.prototype._transformToNavLinkGroup=function(e,t,n,a){if(!e||!e.Nodes||0===e.Nodes.length)return n.end({resultType:r.ResultTypeEnum.ExpectedFailure,error:"getMenuState empty MenuState"}),m()?void 0:u;try{var i=this._getLinksFromNodes(e.Nodes,e.FriendlyUrlPrefix),o={isAudienceEnabled:!m()&&!t&&(a?e.IsAudienceTargetEnabledForGlobalNav:this.isNavAudienceTargetedEnabled()),isAudienceTargeted:(m()||!t)&&this._audiencesDataSource.containsAudiences(i,"links"),isAudienceAffected:!1,name:e.StartingNodeTitle||"",links:i,startingNodeKey:e.StartingNodeKey};return n.end({resultType:r.ResultTypeEnum.Success}),o}catch(e){return n.end({resultType:r.ResultTypeEnum.Failure,error:e?e.toString():"getMenuState failed"}),m()?void 0:u}},t.prototype._processGlobalNavNodes=function(e,n){return n||m()&&!e||!e.isAudienceEnabled||!e.isAudienceTargeted?r.Promise.resolve(e):this._audiencesDataSource.filter("GlobalNav",e.links,"links").then(function(n){var a=t.checkIfLinksAffected(e.links,n);return e.links=n||[],e.isAudienceAffected=a,e})},t.prototype._getLinksFromNodes=function(e,n){var a=this,i=function(e,o,c){e=e.filter(function(e){return e.Key!==s.t.quickLaunchRecent&&-1===e.Key.indexOf("SPNavigationNodeId=".concat(s.t.quickLaunchRecent))&&!e.IsDeleted&&!e.IsHidden});var d=c?c+"/":"";return e.map(function(e){var s,c,l=o&&d+o.FriendlyUrlSegment,u=a._getUrl(e,!!o,n,l),f=e.CustomProperties?a._getCustomPropertyValue(e.CustomProperties,"Target"):void 0,p="_blank"===f||null!==f&&void 0,m=r.Features.isFeatureEnabled({ODB:60322})?(null!==(c=null!==(s=e.OpenInNewWindow)&&void 0!==s?s:p)&&void 0!==c?c:!t.shouldLinkOpenInSameWindow(u))?"_blank":"_self":(null!=p?p:!t.shouldLinkOpenInSameWindow(u))?"_blank":"_self";return{name:e.Title,url:u,key:e.Key,ariaLabel:e.Title,isExpanded:!1,hasChildLinks:e.CustomProperties?"True"===a._getCustomPropertyValue(e.CustomProperties,"HasChildNodes"):void 0,target:m,links:e.Nodes&&e.Nodes.length?i(e.Nodes,e,l):void 0,audiences:e.AudienceIds&&e.AudienceIds.length>0?e.AudienceIds:void 0,currentLCID:e.CurrentLCID}})};return i(e||[])},t.prototype._getCustomPropertyValue=function(e,t){for(var n=e.length-1;n>0;n--)if(e[n].Key===t)return e[n].Value;return""},t.prototype._getUrl=function(e,t,n,a){return e.SimpleUrl?e.SimpleUrl:(e.NodeType===s.e.FriendlyUrl&&e.FriendlyUrlSegment&&(i=(i=t?n+((a?"/".concat(a):"")+"/".concat(e.FriendlyUrlSegment)):n+e.FriendlyUrlSegment).replace("//","/")),i);var i},t.prototype._isGroupAudienceTargeted=function(e){return!!e.isAudienceTargeted||!(e.name!==s.t.footerNavParent||!e.links)&&this._audiencesDataSource.containsAudiences(e.links,"links")},t.NAV_AUDIENCE_TARGET_FLAG=8388608,t}(o.e);function p(e){if(!e)return 0;for(var t=e.length,n=0,a=e;n<a.length;n++)t+=p(a[n].links);return t}function m(){return r.Killswitch.isActivated("1cd2d1c9-fdc8-4110-a71e-e8125063dd90","2020-09-01","Refine the audience targeting logging")}},w0LS:function(e,t,n){"use strict";n.d(t,"n",function(){return a}),n.d(t,"a",function(){return i}),n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o});var a=3e5,i=864e5,r="odsp-ds-",o={useCacheAndUpdateInTheBackground:0,useCacheIfNotExpired:1,onlyCache:2,bypassCache:3,useCacheAndNoUpdate:4}},ysJJ:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a,i=n("17wl"),r="MembershipsCache";function o(){if(!window||!window.localStorage)throw new Error("localStorage is not supported")}function s(e){return"".concat(r,"_").concat(e)}!function(e){e[e.Success=0]="Success",e[e.Failure=1]="Failure",e[e.ExpectedFailure=2]="ExpectedFailure"}(a||(a={}));var c=function(){function e(e,t){var n=this;this._log=function(e,t,a){n._logCacheQoS&&n._logCacheQoS("".concat(r,".").concat(e),t,a)},this._getData=e,this._logCacheQoS=t}return e.doesItemContainAudiences=function(e){var t;return((null===(t=null==e?void 0:e.audiences)||void 0===t?void 0:t.length)||0)>0},e.containsAudiences=function(t,n){if(!t)return!1;if(t.some(e.doesItemContainAudiences))return!0;if(n)for(var a=0,i=t;a<i.length;a++){var r=i[a];if(e.containsAudiences(r[n],n))return!0}return!1},e.getInstance=function(t,n){return e._instance||(e._instance=new e(t,n)),e._instance},e.prototype.filter=function(e,t,n,a,i,r){var o=this;return a?this.getCurrentUserMemberships(e,t,n,r).then(function(e){return o.filterWithMembership(e,a,i)}).catch(function(){return o.filterWithMembership([],a,i)}):Promise.resolve(void 0)},e.prototype.filterWithMembership=function(e,t,n){var a=this;if(!t)return t;var r=t.filter(function(t){return!function(e){return Boolean(e.audiences&&e.audiences.length>0&&"00000000-0000-0000-0000-000000000000"!==e.audiences[0])}(t)||function(e,t){var n=e.audiences;if(!n)return!1;for(var a=0;a<n.length;a++)if(-1!==t.indexOf(n[a]))return!0;return!1}(t,e)});return n&&(r=r.map(function(t){var r;return Object(i.__assign)(Object(i.__assign)({},t),((r={})[n]=a.filterWithMembership(e,t[n],n),r))})),r},e.prototype.getCurrentUserMemberships=function(e,t,n,i){var r,c=this,d=new URLSearchParams(window.location.search),l=!1;if("Preview"===d.get("env")&&d.has("audiences")){var u=d.get("audiences");r=u?u.split(","):[],l=!0}else try{r=function(e,t){o();var n=window.localStorage.getItem(s(e));if(n){var a=JSON.parse(n),i=Boolean(a&&a.lastModified&&Date.now()-a.lastModified<=72e5);if(t?navigator.onLine?i:Boolean(a):i)return a.data}}(e,i)}catch(e){this._log(n,a.Failure,{error:e.message||e,scenario:n})}if(r)return l||this._log(n,a.Success),Promise.resolve(r);if(!this._getMembershipsPromise){var f=t+"/_api/SP.Publishing.SitePageService.GetCurrentUserMemberships"+(n?"?scenario='".concat(n,"'"):"");this._getMembershipsPromise=this._getData(f,n).then(function(t){return c._getMembershipsPromise=void 0,t&&function(e,t){if(o(),t){var n={data:t,lastModified:Date.now()};window.localStorage.setItem(s(e),JSON.stringify(n))}else window.localStorage.removeItem(s(e))}(e,t),c._log(n,a.ExpectedFailure),t})}return this._getMembershipsPromise},e}(),d=n("K9kD"),l=function(){function e(e){var t=this;this._getDataFromAPI=function(e,n){var a={url:e,qosName:n?"getUserMembershipsForAudienceTargeting.".concat(n):"getUserMembershipsForAudienceTargeting",cacheRequestKey:t._cacheRequestKey,parseResponse:function(e){return e&&JSON.parse(e).value||[]},method:"GET",additionalHeaders:{"ODATA-VERSION":"4.0",Accept:"*/*, application/json; odata.metadata=minimal"},contentType:"application/json; odata.metadata=minimal",maxRetries:1};return t._dataRequestor.getData(a)},this._logCacheQoS=function(e,t,n){return new d.Qos({name:e}).end({name:e,resultType:t,extraData:n})},this._pageContext=e,this._dataRequestor=new d.DataRequestor({qosName:"AudiencesDataSource"},{pageContext:e}),this._cacheRequestKey=e.aadUserId||e.userLoginName,this._audienceTargetComponent=c.getInstance(this._getDataFromAPI,this._logCacheQoS)}return e.getInstance=function(t){var n=t.aadUserId||t.userLoginName;return e._instances[n]||(e._instances[n]=new e(t)),e._instances[n]},e.prototype.containsAudiences=function(e,t){if(!e)return!1;if(e.filter(u).length>0)return!0;if(t)for(var n=0,a=e;n<a.length;n++){var i=a[n];if(this.containsAudiences(i[t],t))return!0}return!1},e.containsAudienceTargetedNode=function(e){var t=this;return!!e&&(e.filter(u).length>0||e.filter(function(e){return t.containsAudienceTargetedNode(e.links)}).length>0)},e.prototype.filter=function(e,t,n){var a=d.Killswitch.isActivated("845880ed-07f0-4103-bef6-d3d7779183b5");return d.Promise.resolve(this._audienceTargetComponent.filter(this._cacheRequestKey,this._pageContext.webAbsoluteUrl,e,t,n,!a))},e.prototype.filterWithMembership=function(e,t,n){return this._audienceTargetComponent.filterWithMembership(e,t,n)},e.filterLinksWithMemberships=function(t,n){return e._filterRecursively(new Set(n),t,function(e){return e.links},function(e,t){return Object(i.__assign)(Object(i.__assign)({},e),{links:t})})},e.getGroupObjectId=function(e){return e.userId&&e.userId.length>=36?e.userId.substr(e.userId.length-36):void 0},e.prototype.getCurrentUserMemberships=function(e){var t=this._pageContext.webAbsoluteUrl;return window&&window.location&&window.location.origin&&-1===t.indexOf(window.location.origin)&&(t=window.location.origin),d.Promise.resolve(this._audienceTargetComponent.getCurrentUserMemberships(this._cacheRequestKey,t,e))},e._filterRecursively=function(t,n,a,i){if(!n)return n;var r=n.filter(function(e){var n;return!u(e)||(null===(n=e.audiences)||void 0===n?void 0:n.some(function(e){return t.has(e)}))});return a&&i&&(r=r.map(function(n){var r=a(n),o=e._filterRecursively(t,r,a,i);return i(n,o)})),r},e._instances={},e}();function u(e){return!!(e.audiences&&e.audiences.length>0&&e.audiences[0]!==d.Guid.Empty)}}}]);