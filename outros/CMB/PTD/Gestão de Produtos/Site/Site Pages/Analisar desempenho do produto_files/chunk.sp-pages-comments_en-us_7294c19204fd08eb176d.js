(window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0=window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0||[]).push([[73],{"/OYS":function(e,t,n){"use strict";var a=n("17wl"),i=n("cDcd"),r=n("KL1q"),o=n("Yo/j"),s=i.lazy(function(){return Promise.all([n.e(7),n.e(72)]).then(n.bind(null,"Bx+e")).then(function(e){return{default:e.default}})});function c(e){return i.createElement(i.Suspense,{fallback:!1},i.createElement(s,Object(a.__assign)({},e)))}var d=n("Rrln"),l=n("m9Fc"),u=n("y88i"),f=n("jwQD"),p=n("xs0R"),m=n("q+wp"),_=n("F5rs"),h=n("fPVX"),b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onChange=function(e){m.e.logUserEngagementForPage(p.t.fields,!0,e?"CommentsEnable":"CommentsDisable"),o.e.setDisabled(!e).then(function(){o.e.clearComments(),e&&o.e.getComments()})},t}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=m.e.isNewPage(),t=i.createElement(f.e,{checked:!this.props.disabled,disabled:e,onAriaLabel:_.R,onText:_.j,offAriaLabel:_.N,offText:_.B,onChanged:this._onChange,"data-automation-id":this.props.disabled?"sp-comment-toggle-disabled":"sp-comment-toggle-enabled"});return e&&(t=i.createElement(r.TooltipHost,{content:_.X,calloutProps:{gapSpace:0}},t)),i.createElement("div",{className:h.e.spToggleWrapper},t)},t}(i.Component),g=b,v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=Object(r.mergeStyles)(h.e.spHeader,h.e.fluent);return i.createElement("div",null,i.createElement("h2",{className:e,id:"sp-comments"},u.StringHelper.format(u.StringHelper.getLocalizedCountValue(_.O,_.w,this.props.count),this.props.count)),this.props.isToggleVisible&&i.createElement(g,{disabled:this.props.disabled}))},t}(i.Component),y=v,S=n("HUje"),D=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n._assignCommentReplyRef=function(e){t.topLevelReply=e},n._onLoadMore=function(){m.e.logUserEngagementForPage(p.t.fields,!0,"LoadMoreComments"),o.e.getNextComments(n.props.nextLink)},n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e,t;return this.props.disabledAtSiteOrTenant||this.props.disabled&&!this.props.isToggleVisible?i.createElement(i.Fragment,null):i.createElement("aside",{className:Object(r.css)(h.e.spCommentSection,(e={},e[h.e.zoom400]=!Object(S.e)(),e)),role:"complementary","aria-label":_.a},i.createElement(y,{count:this.props.count,isToggleVisible:this.props.isToggleVisible,disabled:this.props.disabled}),this.props.isPublished?i.createElement("div",{className:h.e.spComments},i.createElement(l.e,{disabled:d.e.instance.disableEditing||this.props.disabled,ref:this._assignCommentReplyRef}),!this.props.disabled&&(null===(t=this.props.comments)||void 0===t?void 0:t.map(function(e){return i.createElement(c,{data:e,key:e.optimisticId||e.id})})),!this.props.disabled&&this.props.nextLink&&i.createElement(r.Link,{className:h.e.spMore,onClick:this._onLoadMore},_.G)):i.createElement("div",{className:h.e.spComments},i.createElement(r.Label,null,_.n)))},t}(i.Component);t.e=D},"2G27":function(e,t,n){"use strict";var a=n("DGFG");t.e=function(e){this.name="LikeLimitExceeded",this.message=a.n,e&&(this.message=e)}},"D/Gr":function(e,t,n){"use strict";var a=n("Rrln"),i=n("i8gT"),r=function(){function e(e,t,n,a,i,r,o,s,c,d,l,u,f){this._isDeleted=!1,this._date=t,this._id=n,this._nextLink=a,this._parentId=i,this._text=r,this._replies=e,this._author=o,this._likeCount=s,this._userLiked=c,this._likedBy=d,this._nextLikesLink=l,this._serverObject=u,this._mentions=f,u||(this._optimisticId=n),this.sortReplies()}return Object.defineProperty(e.prototype,"date",{get:function(){return this._date},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"optimisticId",{get:function(){return this._optimisticId},set:function(e){this._optimisticId=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isFromServer",{get:function(){return!!this._serverObject},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextLink",{get:function(){return this._nextLink},set:function(e){this._nextLink=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentId",{get:function(){return this._parentId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"replies",{get:function(){return this._replies},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"author",{get:function(){return this._author},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"likeCount",{get:function(){return this._likeCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"likedBy",{get:function(){return this.userLiked?[a.e.instance.user].concat(this._likedBy||[]):this._likedBy},set:function(e){this._likedBy=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextLikesLink",{get:function(){return this._nextLikesLink},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mentions",{get:function(){return this._mentions},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userLiked",{get:function(){return this._userLiked},enumerable:!1,configurable:!0}),e.prototype.addReply=function(e){this._replies.push(e),this._latestDate=void 0},e.prototype.equals=function(e){return this.id===e.id},e.prototype.hasMoreLikes=function(){return Boolean(this._nextLikesLink)},e.prototype.isDeleted=function(){return this._isDeleted},e.prototype.isReply=function(){return"0"!==this._parentId},e.prototype.latestDate=function(){return this._latestDate||(this._latestDate=this._replies&&this._replies.length?this._replies[this._replies.length-1].date:this._date)},e.prototype.markDeleted=function(){this._isDeleted=!0},e.prototype.moreReplies=function(){return!!this._nextLink},e.prototype.processLikeChunk=function(e){var t=this;this._nextLikesLink=e["@odata.nextLink"],i.e.allLikesFetched(this._nextLikesLink)&&(this._nextLikesLink=void 0);var n=e.likes||[];this.userLiked&&(n=n.filter(function(e){return!a.e.isCurrentUser(e)})),n=n.filter(function(e){return!t._alreadyLiked(e)}),this._likedBy=(this._likedBy||[]).concat(n)},e.prototype.removeReply=function(e){this._replies=this._replies.filter(function(t){return!e.equals(t)}),this._latestDate=void 0},e.prototype.replaceReply=function(e,t){var n=this._replies.indexOf(e);n>-1?this._replies[n]=t:this.addReply(t)},e.prototype.sortReplies=function(){this._replies=this._replies.sort(function(e,t){return+e.latestDate()-+t.latestDate()}),this._replies=this._replies.filter(function(e,t,n){return 0===t||e.id!==n[t-1].id})},e.prototype.like=function(e){this.userLiked||(this._userLiked=!0,this._likeCount++)},e.prototype.unlike=function(e){this.userLiked&&(this._userLiked=!1,this._likeCount--)},e.prototype.unmarkDelted=function(){this._isDeleted=!1},e.prototype._alreadyLiked=function(e){return this._likedBy.some(function(t){return t.email===e.email})},e}();t.e=r},DrmC:function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return i}),n.d(t,"findCommentById",function(){return r});var a=n("17wl");function i(e,t){switch(void 0===e&&(e={comments:[],commentCount:0,disabled:!1,disabledAtSiteOrTenant:!0,loaded:!1}),t.type){case"COMMENTS_DISABLED":return d(e,t.actionData);case"COMMENT_CLEAR":return s(e);case"COMMENT_CHUNK":return function(e){return Object(a.__assign)(Object(a.__assign)({},e),{loaded:!0})}(function(e){return Object(a.__assign)(Object(a.__assign)({},e),{comments:e.comments.sort(function(e,t){return+t.date-+e.date}).filter(function(e,t,n){return 0===t||e.id!==n[t-1].id})})}(function(e,t){var n=e.commentCount||t.count||t.comments.length||0,i=e;return t.comments.forEach(function(e){return i=o(i,e,!1)}),i=d(i,t.disabledState),Object(a.__assign)(Object(a.__assign)({},i),{commentCount:n,nextLink:t.nextLink})}(e,t.actionData)));case"COMMENT_CREATED":return o(e,t.actionData,!0);case"COMMENT_DELETED":return function(e,t){if(t.isReply()){var n=c(e,t.parentId);n&&n.removeReply(t)}return Object(a.__assign)(Object(a.__assign)({},e),{comments:t.isReply()?e.comments:e.comments.filter(function(e){return!t.equals(e)}),commentCount:e.commentCount-1-t.replies.length})}(e,t.actionData);case"COMMENT_LIKE":return function(e,t,n){return t.like(n),Object(a.__assign)({},e)}(e,t.actionData.comment,t.actionData.user);case"COMMENT_LIKE_CHUNK":return function(e,t,n){return n.processLikeChunk(t),Object(a.__assign)({},e)}(e,t.actionData.likeChunk,t.actionData.comment);case"COMMENT_FOCUS_REPLY":return function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{focusedCommentId:t})}(e,t.actionData);case"COMMENT_MARK_DELETED":return function(e,t){return t.markDeleted(),Object(a.__assign)({},e)}(e,t.actionData);case"COMMENT_REPLACED":return function(e,t,n){var i=t&&c(e,t.parentId);if(i)return i.replaceReply(t,n),Object(a.__assign)({},e);var r=e.comments.indexOf(t);return r>-1?Object(a.__assign)(Object(a.__assign)({},e),{comments:e.comments.map(function(e,t){return t===r?n:e})}):o(e,n,!0)}(e,t.actionData.oldComment,t.actionData.newComment);case"COMMENT_REPLY_CHUNK":return function(e,t){var n=c(e,t.parentId);if(!n)throw new Error("CommentReducer: Attempted to add reply chunk but no parent was found");var a=e;return t.comments.forEach(function(e){return a=o(a,e,!1)}),n.nextLink=t.nextLink,a}(e,t.actionData);case"COMMENT_RESET":case"PAGE_CREATE_STUB":return function(e){return Object(a.__assign)(Object(a.__assign)({},s(e)),{disabled:!0})}(e);case"COMMENT_UNLIKE":return function(e,t,n){return t.unlike(n),Object(a.__assign)({},e)}(e,t.actionData.comment,t.actionData.user);case"COMMENT_UNMARK_DELETED":return function(e,t){return r(e,t.id)?(t.unmarkDelted(),Object(a.__assign)({},e)):o(e,t,!0)}(e,t.actionData);default:return e}}function r(e,t){return c(e,t)||function(e,t){return e.comments.reduce(function(e,n){return e||n.replies.reduce(function(e,n){return e||n.id===t?n:void 0})})}(e,t)}function o(e,t,n){var i=c(e,t.parentId);return i&&(i.addReply(t),i.sortReplies()),Object(a.__assign)(Object(a.__assign)({},e),{comments:i?e.comments:Object(a.__spreadArray)([t],Object(a.__read)(e.comments),!1),commentCount:n?e.commentCount+1:e.commentCount})}function s(e){return Object(a.__assign)(Object(a.__assign)({},e),{comments:[],commentCount:0,nextLink:void 0,loaded:!1})}function c(e,t){return e.comments.filter(function(e){return e.id===t})[0]}function d(e,t){var n=0!==t,i=2===t||3===t;return Object(a.__assign)(Object(a.__assign)({},e),{disabled:n,disabledAtSiteOrTenant:i})}},ECV1:function(e,t,n){"use strict";var a=n("17wl"),i=n("cDcd"),r=n("faye"),o=n("KL1q"),s=n("UWqr"),c=n("CIL5"),d=n.n(c),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.render=function(){return this.parseCounter=0,i.createElement("span",{className:this.props.className},this._parse(this.props.children))},t.prototype._cloneElement=function(e){return i.cloneElement(e,{key:"parse".concat(++this.parseCounter)},this._parse(e.props.children))},t.prototype._convertMatchesToReact=function(e,t){var n=this,a=0,i=[];return t.forEach(function(t,r){i.push(e.substring(a,t.index)),i.push(n._newLink(t)),a=t.lastIndex}),i.push(e.substring(a)),i.filter(function(e){return!!e})},t.prototype._getMatches=function(e){return t._linkifyIt.match(e)},t.prototype._newLink=function(e){return i.createElement("a",this._propsFor(e.url,"parse".concat(this.parseCounter,"match").concat(e.url)),e.text)},t.prototype._parseString=function(e){if(""===e)return[];var t=this._getMatches(e);return t?this._convertMatchesToReact(e,t):e},t.prototype._parse=function(e){var t=this;return"string"==typeof e?this._parseString(e):i.isValidElement(e)&&"a"!==e.type?this._cloneElement(e):e instanceof Array?e.map(function(e){return t._parse(e)}):e},t.prototype._propsFor=function(e,t){var n={href:e,key:t};for(var a in this.props.properties)this.props.properties.hasOwnProperty(a)&&(n[a]=this.props.properties[a]);return n},t._linkifyIt=new d.a,t}(i.Component),u=l,f=n("F5rs"),p=n("fPVX"),m=n("xs0R"),_=n("q+wp"),h=n("Y7TA"),b=function(e){function t(t){var n=e.call(this,t)||this;n._mentionMap=new Map,n._assignInputRef=function(e){n._root=e},n._showMore=function(){_.e.logUserEngagementForPage(m.t.fields,!0,"CommentShowMoreButton"),n.setState({expanded:!0,text:n.props.text})};var a=n._shrinkText(t.text);return n.state={expanded:a===t.text,text:a},n.props.mentions&&n.props.mentions.forEach(function(e){if(n._mentionMap.set(e.email,e.name),e.loginName){var t=e.loginName.substr(e.loginName.lastIndexOf("|")+1);n._mentionMap.set(t,e.name)}}),n}return Object(a.__extends)(t,e),t.htmlDecode=function(e){var t=e;if(DOMParser){var n=(new DOMParser).parseFromString(t||"","text/html");t=n&&n.body&&n.body.innerText?n.body.innerText:""}return t},t.prototype.render=function(){return i.createElement(u,{properties:{target:"_blank",rel:"noopener"},ref:this._assignInputRef},this.state.text&&this.state.text.split("\n").map(function(e,t,n){return i.createElement("span",{key:e+t,className:p.e.commentRichText,dangerouslySetInnerHTML:{__html:e}})}),!this.state.expanded&&i.createElement(o.Link,{className:p.e.spMore,onClick:this._showMore},f.H))},t.prototype.componentDidMount=function(){this._attachLivePersonaCard()},t.prototype.componentDidUpdate=function(e,t){t.expanded===!this.state.expanded&&(this._disposeLivePersonaCards(),this._attachLivePersonaCard())},t.prototype.componentWillUnmount=function(){this._disposeLivePersonaCards()},t.prototype._disposeLivePersonaCards=function(){this._lpcAdapters&&(this._lpcAdapters.forEach(function(e){r.unmountComponentAtNode(e)}),this._lpcAdapters=void 0)},t.prototype._attachLivePersonaCard=function(){var e=r.findDOMNode(this._root),t="data-sp-mention-user-id",n="access-type";if(e instanceof Element){var a=e.querySelectorAll("a[".concat(t,"]"));this._lpcAdapters=[];for(var i=0;i<a.length;i++){var o=a[i].getAttribute(t),c=a[i].innerText.replace("@","");if(a[i].setAttribute("href","mailto:"+o),this.props.mentions){var d=this._mentionMap.get(o);d?(-1===d.indexOf(c)&&(c=d),a[i].setAttribute(n,"1")):a[i].setAttribute(n,"0")}var l=this._linkWithLPC(o,s.Text.format(f.Y,c));r.render(l,a[i]),this._lpcAdapters.push(a[i])}}},t.prototype._shrinkText=function(e){return t.htmlDecode(e).length>400?s.Text.format(f.q,e.slice(0,this._truncationPoint(e))):e},t.prototype._truncationPoint=function(e){var t=e.slice(0,350).lastIndexOf(" ");return-1===t?350:t},t.prototype._linkWithLPC=function(e,t){return i.createElement(h.e,{personaType:"User",identifier:e,lpcHoverTargetProps:{upn:e},pageContext:this.props.pageContext.legacyPageContext,moduleLoader:void 0,lpcCardBehavior:{disableHover:!0,onCardClose:void 0,onCardOpen:void 0}},i.createElement("span",null,t))},t}(i.Component);t.e=b},F5rs:function(e){e.exports=JSON.parse('{"a":"Comments","p":"Comment removed with no replies||Comment removed with {0} reply||Comment removed with {0} replies ","f":"0||1||2- ","s":"No more comments to show||Showing {0} older comment||Showing {0} older comments","c":"0||1||2-","d":"No more replies to show||Showing {0} more reply||Showing {0} more replies","o":"0||1||2-","r":"No more likes to show.||Showing {0} more like.||Showing {0} more likes.","l":"0||1||2-","u":"Comment posted","i":"Comment liked.","m":"Comment unliked.","g":"Reply","v":"Reply to {0}","_":"Delete","h":"Like the comment.","S":"Unlike the comment.","y":"Show more.","b":"More options","x":"Delete confirmation","I":"Are you sure you want to delete this comment?","C":"Couldn\\u0027t delete comment. Try again.","O":"Comments||{0} Comment||{0} Comments","w":"0||1||2-","J":"Add a comment. Type @ to mention someone","Q":"Add a comment.","k":"Post","M":"Couldn\\u0027t post comment. Try again.","E":"Couldn\\u0027t like the comment. Try again.","V":"Couldn\\u0027t unlike the comment. Try again.","A":" Could not like the comment.  The comment has reached the maximum number of likes. ","L":"Likes","D":"Close","H":"Show more","P":"You have exceeded the limit by {0} character||You have exceeded the limit by {0} characters","T":"1||2-","U":"{0} character left||{0} characters left","F":"1||0,2-","R":"Comments on","N":"Comments off","B":"Off","j":"On","z":"Photo of {0}","G":"Show more comments","W":"Show more replies","K":"Show more likes","Y":"@{0}","q":"{0}…","X":"Save this page before enabling or disabling comments.","t":"Click this link to go to the top of the page.","e":"{0} Commented {1}.","n":"The comments section will be displayed after the page is published."}')},GW7U:function(e,t,n){"use strict";n.r(t);var a=n("17wl"),i=n("cDcd"),r=n("ut3N"),o=n("Yo/j"),s=n("Rrln"),c=n("DrmC"),d=n("xs0R"),l=function(){function e(e){var t=this;this._findAndScroll=function(){t._commentIsPresent()?t._scrollToComment():t._getNext().then(t._findAndScroll).catch(t._handleError)},this._hash=e,this._determineValidity(),this._valid&&this._extractParts()}return e.prototype.scroll=function(){this._valid&&this._findAndScroll()},Object.defineProperty(e.prototype,"_commentSlice",{get:function(){return d.t.pageReduxStore.getState().comments},enumerable:!1,configurable:!0}),e.prototype._commentIsPresent=function(){return void 0!==Object(c.findCommentById)(this._commentSlice,String(this._commentId))},e.prototype._determineValidity=function(){this._valid=e._commentIdRegex.test(this._hash)},e.prototype._extractNumber=function(e,t){var n=e.exec(t);return n?Number(n[1]):void 0},e.prototype._extractParts=function(){this._commentId=this._extractNumber(e._commentIdRegex,this._hash),this._parentCommentId=this._extractNumber(e._parentIdRegex,this._hash)},e.prototype._getNext=function(){if(this._parentCommentId){var e=Object(c.findCommentById)(this._commentSlice,String(this._parentCommentId));if(e)return e.nextLink?o.e.getNextReplies(e.nextLink,e.id):Promise.reject(new Error("Unable to find comment reply"))}return this._commentSlice.nextLink?o.e.getNextComments(this._commentSlice.nextLink):Promise.reject(new Error("Unable to find top level comment"))},e.prototype._handleError=function(t){r._TraceLogger.logError(e._logSource,t)},e.prototype._scrollToComment=function(){var t=this;setTimeout(function(){var n=document.getElementById("sp-comment-".concat(t._commentId));n?n.scrollIntoView():r._TraceLogger.logError(e._logSource,new Error("Comment present but could not be found in view"))},0)},e._commentIdRegex=new RegExp(/[#&]comment=(\d+)/),e._logSource=r._LogSource.create("CommentDirectScroller"),e._parentIdRegex=new RegExp(/[#&]parentComment=(\d+)/),e}(),u=n("/OYS"),f=n("PJr9"),p=n("q+wp"),m=function(e){function t(n){var a=e.call(this,n)||this;return a._updateStateFromStore=function(){-1!==d.t.sliceUpdated.indexOf(f.e.CommentStore)?(a.props.onDisabledChange&&a.props.onDisabledChange(a._commentSlice.disabled),a.setState({comments:a._commentSlice.comments,count:a._commentSlice.commentCount,disabled:a._commentSlice.disabled,disabledAtSiteOrTenant:a._commentSlice.disabledAtSiteOrTenant,nextLink:a._commentSlice.nextLink})):t._commentsHasRendered&&t._onPageStoreUpdated()},a._qosMonitor=new r._QosMonitor("CommentLoadedAndRendered"),d.t.addReducer("comments",c.default),a.state={comments:a._commentSlice.comments,count:a._commentSlice.commentCount,disabled:a._commentSlice.disabled,disabledAtSiteOrTenant:a._commentSlice.disabledAtSiteOrTenant,nextLink:a._commentSlice.nextLink},a._updateCommentContext(n),a}return Object(a.__extends)(t,e),t._onPageStoreUpdated=function(){p.e.isNewPage()&&(t._refreshOnNextStoreUpdate=!0),(p.e.navigatedToNewPage(this._pageKey)||t._refreshOnNextStoreUpdate&&!p.e.isNewPage())&&(t._pageKey=p.e.getPageKey(),o.e.clearComments(),o.e.getComments(),t._refreshOnNextStoreUpdate=!1)},t.prototype.componentDidMount=function(){this._checkQoSFinished(),this._unsubscribe=d.t.addListener(this._updateStateFromStore),this._onFirstRender(),this._updateTimer=window.setInterval(this.forceUpdate.bind(this),6e4)},t.prototype.componentDidUpdate=function(){this._checkQoSFinished()},t.prototype.UNSAFE_componentWillReceiveProps=function(e){this._updateCommentContext(e)},t.prototype.componentWillUnmount=function(){this._unsubscribe(),clearInterval(this._updateTimer),t._lastTimeout&&clearTimeout(t._lastTimeout),t._commentsHasRendered=!1},t.prototype.render=function(){try{return i.createElement(u.e,{comments:this.state.comments,count:this.state.count,disabled:this.state.disabled,disabledAtSiteOrTenant:this.state.disabledAtSiteOrTenant,isToggleVisible:this.props.isToggleVisible,nextLink:this.state.nextLink,isPublished:p.e.hasPageBeenPublished()})}catch(n){var e=new Error(n);this._qosMonitor.writeUnexpectedFailure("FailedRenderTag",e),r._TraceLogger.logError(t._logSource,e)}},t.prototype._onFirstRender=function(){var e=this;t._pageKey=p.e.getPageKey(),o.e.clearComments(),o.e.getComments().then(function(){t._commentsHasRendered=!0,e._scrollToCommentsIfNeeded()})},t.prototype._checkQoSFinished=function(){!this._qosMonitor.hasEnded&&this._commentSlice.loaded&&this._qosMonitor.writeSuccess()},Object.defineProperty(t.prototype,"_commentSlice",{get:function(){return d.t.pageReduxStore.getState().comments},enumerable:!1,configurable:!0}),t.prototype._scrollToCommentsIfNeeded=function(){"#comments"===window.location.hash?this._scrollToCommentsSection():new l(window.location.hash).scroll()},t.prototype._scrollToCommentsSection=function(){var e=document.getElementById("sp-comments");e&&e.scrollIntoView()},t.prototype._updateCommentContext=function(e){s.e.instance.deleteAllPermission=e.deleteAllPermission,s.e.instance.disableEditing=e.disableEditing,s.e.instance.serviceScope=e.serviceScope,s.e.instance.user=e.user},t._commentsHasRendered=!1,t._refreshOnNextStoreUpdate=!1,t._logSource=r._LogSource.create("CommentContainer"),t}(i.Component);t.default=m},HUje:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r});var a=n("UWqr"),i=function(){return a._SPKillSwitch.isActivated("82a8f061-50d8-4c2d-a047-cdd0debb3749")};function r(){return a._SPKillSwitch.isActivated("f77cd7ea-a060-4c3e-9f05-ebb4df562947")}},"J4/A":function(e,t,n){"use strict";n.r(t);var a=n("ut3N"),i=n("2q6Q"),r=n("vlQI"),o=n("y88i"),s=n("Yo/j"),c=n("i8gT"),d=n("2G27"),l=n("xs0R"),u=n("onFi"),f=n("q+wp"),p=function(){function e(e,t){this._loggedLoadSource=!1,this._pageContext=e,this._spHttpClient=t}return e.prototype.createComment=function(e,t){var n=this,a=new i._QosMonitor("CreateCommentAPI");return new Promise(function(i,r){n._createCommentRequest(e,t).then(function(e){n._checkForErrors("CreateCommentAPI",a,e),e.json().then(function(e){i(c.e.toCommentItem(e)),a.writeSuccess()})}).catch(function(e){a.writeUnexpectedFailure("CreateCommentAPI",e),r(e)})})},e.prototype.deleteComment=function(e){var t=this,n=new i._QosMonitor("DeleteCommentAPI");return new Promise(function(a,i){t._deleteCommentRequest(e).then(function(i){t._checkForErrors("DeleteCommentAPI",n,i),a(e),n.writeSuccess()}).catch(function(e){n.writeUnexpectedFailure("DeleteCommentAPI",e),i(e)})})},e.prototype.getComments=function(){return 0!==i._SPPerfExperiment.getVariantAndTrackExperiment(i._PerformanceExperiment.WEXPrefetchCommentsDisabled)?this._getCommentsDataFromAPI():window._spCommentsData?(this._deferClearPageData(),this._logLoadSource("Prefetch"),Promise.resolve(this._convertDataToItemChunk(window._spCommentsData,this._getPageDisabledState()))):Promise.race([this._getCommentsDataFromAPI(),this._getCommentsFromPage()])},e.prototype.getDisabled=function(e){var t=this,n=new i._QosMonitor("GetCommentsDisabledScopeAPI");return new Promise(function(a,i){t._getCommentsDisabledScopeRequest(e).then(function(e){t._checkForErrors("GetCommentsDisabledScopeAPI",n,e),e.json().then(function(e){a(e.value),n.writeSuccess()})}).catch(function(e){n.writeUnexpectedFailure("GetCommentsDisabledScopeAPI",e),i(e)})})},e.prototype.getNext=function(e,t){var n=this;void 0===t&&(t=!1);var a=new i._QosMonitor("LoadMoreCommentsAPI");return new Promise(function(i,r){n._nextCommentsRequest(e,t).then(function(e){n._checkForErrors("LoadMoreCommentsAPI",a,e),e.json().then(function(e){i(n._convertDataToItemChunk(e)),a.writeSuccess()})}).catch(function(e){a.writeUnexpectedFailure("LoadMoreCommentsAPI",e),r(e)})})},e.prototype.getNextLikes=function(e){var t=this,n=new i._QosMonitor("GetCommentLikesAPI");return this._nextLikesRequest(e).then(function(e){return t._checkForErrors("GetPageUrlAPI",n,e),e.json()}).then(function(e){return n.writeSuccess(),Promise.resolve(t._convertServerLikesResponse(e))}).catch(function(e){return n.writeUnexpectedFailure("GetCommentLikesAPI",e),Promise.reject(e)})},e.prototype.likeComment=function(e){var t=this,n=new i._QosMonitor("LikeCommentAPI");return this._likeCommentRequest(e).then(function(e){t._checkLikeResponse("LikeCommentAPI",n,e),n.writeSuccess()}).catch(function(e){return n.writeUnexpectedFailure("LikeCommentAPI",e),Promise.reject(e)})},e.prototype.setDisabled=function(e){var t=this,n=new i._QosMonitor("DisableCommentsAPI");return new Promise(function(a,i){t._disabledRequest(e).then(function(e){t._checkForErrors("DisableCommentsAPI",n,e),a(),n.writeSuccess()}).catch(function(e){n.writeUnexpectedFailure("DisableCommentsAPI",e),i(e)})})},e.prototype.unlikeComment=function(e){var t=this,n=new i._QosMonitor("UnlikeCommentAPI");return this._unlikeCommentRequest(e).then(function(e){t._checkForErrors("UnlikeCommentAPI",n,e),n.writeSuccess()}).catch(function(e){return n.writeUnexpectedFailure("UnlikeCommentAPI",e),Promise.reject(e)})},e.prototype._checkForErrors=function(e,t,n){n||this._throwEmptyResponseError(e,t),f.e.isResponseSuccessful(n.status)||this._throwHttpError(t,n)},e.prototype._checkLikeResponse=function(e,t,n){return n?f.e.isResponseSuccessful(n.status)?void 0:this._throwLikeError(t,n):this._throwEmptyResponseError(e,t)},e.prototype._createCommentRequest=function(e,t){return this._spHttpClient.post(o.Uri.concatenate(this._getCommentsUrl(t),t?"/replies":""),r.SPHttpClient.configurations.v1,{body:JSON.stringify({text:e})})},e.prototype._convertDataToItemChunk=function(e,t){return void 0===t&&(t=0),{comments:e.value.map(function(e){return c.e.toCommentItem(e)}),disabledState:t,count:e["@odata.count"],nextLink:e["@odata.nextLink"]}},e.prototype._deferClearPageData=function(){setTimeout(function(){window._spCommentsData=void 0},0)},e.prototype._convertServerLikesResponse=function(e){return e.value?{likes:e.value,"@odata.nextLink":e["@odata.nextLink"]}:void 0},e.prototype._deleteCommentRequest=function(e){return this._spHttpClient.fetch(o.Uri.concatenate(this._getCommentsUrl(e.id)),r.SPHttpClient.configurations.v1,{method:"delete"})},e.prototype._disabledRequest=function(e){return this._spHttpClient.post(o.Uri.concatenate(this._getPageUrl(),"/SetCommentsDisabled"),r.SPHttpClient.configurations.v1,{body:JSON.stringify({value:e})})},e.prototype._failedResponseFromStatus=function(e){var t,n=((t={})[403]="FailedResponseForbidden",t[404]="FailedResponseNotFound",t[406]="FailedResponseNotAcceptable",t);return n[e]?n[e]:"FailedResponseStatus"},e.prototype._getCommentsDataFromAPI=function(){var t=this;if(0!==i._SPPerfExperiment.getVariantAndTrackExperiment(i._PerformanceExperiment.WEXPrefetchCommentsDisabled))return this._getCommentsFromAPI(void 0).then(function(e){return t._logLoadSource("API"),t._convertDataToItemChunk(e)}).catch(function(t){return a._TraceLogger.logError(e._logSource,t),t});var n=this._spHttpClient.beginBatch(),r=[this._getCommentsFromAPI(n),this.getDisabled(n)];return this._resolveBatch(n,r).then(function(e){return t._logLoadSource("API"),t._convertDataToItemChunk(e[0],e[1])}).catch(function(t){return a._TraceLogger.logError(e._logSource,t),t})},e.prototype._getCommentsFromAPI=function(e){var t=this,n=new i._QosMonitor("LoadCommentsFromAPI");return new Promise(function(a,i){t._getCommentsRequest(e).then(function(e){t._checkForErrors("LoadCommentsFromAPI",n,e),e.json().then(function(e){a(e),n.writeSuccess()})}).catch(function(e){n.writeUnexpectedFailure("LoadCommentsFromAPI",e),i(e)})})},e.prototype._getCommentsFromPage=function(){var e=this;return new Promise(function(t,n){window._spCommentsDataLoaded=function(){t(e._convertDataToItemChunk(window._spCommentsData,e._getPageDisabledState())),e._deferClearPageData(),e._logLoadSource("PrefetchCallback")}})},e.prototype._fields=function(){return l.t.fields},e.prototype._getCommentsDisabledScopeRequest=function(e){return e?e.get(o.Uri.concatenate(this._getPageUrl(),"/CommentsDisabledScope"),r.SPHttpClientBatch.configurations.v1):this._spHttpClient.get(o.Uri.concatenate(this._getPageUrl(),"/CommentsDisabledScope"),r.SPHttpClient.configurations.v1)},e.prototype._getCommentsRequest=function(e){return e?e.get("".concat(this._getCommentsUrl(),"?$expand=replies,likedBy,replies/likedBy&$top=10&$inlineCount=AllPages"),r.SPHttpClientBatch.configurations.v1):this._spHttpClient.get("".concat(this._getCommentsUrl(),"?$expand=replies,likedBy,replies/likedBy&$top=10&$inlineCount=AllPages"),r.SPHttpClient.configurations.v1)},e.prototype._getCommentsUrl=function(e){var t=e?"/Comments".concat(e?"(".concat(e,")"):""):"/GetComments";return o.Uri.concatenate(this._getPageUrl(),t)},e.prototype._getPageDisabledState=function(){if(window._spCommentsDisabledScope)return window._spCommentsDisabledScope.value;var e=3;return window._spCommentsData.value&&window._spCommentsData.value.length&&(e=0),s.e.getDisabledScope(),e},e.prototype._getPageUrl=function(){return o.Uri.concatenate(this._pageContext.legacyPageContext.webServerRelativeUrl||"","/_api/web/lists('".concat(f.e.listId(),"')"),"/GetItemById(".concat(this._itemId(),")"))},e.prototype._itemId=function(){return this._fields().Id||f.e.spPageContextInfo.pageItemId},e.prototype._likeCommentRequest=function(e){return this._toggleLikeCommentRequest(e,!0)},e.prototype._logLoadSource=function(e){this._loggedLoadSource||(this._loggedLoadSource=!0,i._EngagementLogger.logEvent("CommentsLoad.".concat(e)))},e.prototype._nextCommentsRequest=function(e,t){return this._spHttpClient.get("".concat(e)+(t?"&$expand=likedBy":""),r.SPHttpClient.configurations.v1)},e.prototype._nextLikesRequest=function(e){return this._spHttpClient.get(e,r.SPHttpClient.configurations.v1)},e.prototype._resolveBatch=function(e,t){return e.execute().then(function(){return Promise.all(t)})},e.prototype._throwEmptyResponseError=function(e,t){var n=new Error("Response is null, undefined or empty");throw t.writeUnexpectedFailure("FailedResponseStatus",n),n},e.prototype._throwHttpError=function(e,t){var n=new u.e(f.e.getStatusMessage(t),t.status);throw e.writeUnexpectedFailure(this._failedResponseFromStatus(t.status),n),n},e.prototype._throwLikeError=function(e,t){507===t.status?this._throwLikeLimitExceededError(e):this._throwHttpError(e,t)},e.prototype._throwLikeLimitExceededError=function(t){throw t.writeExpectedFailure("LikeCommentAPI",e.likeLimitExceededError),e.likeLimitExceededError},e.prototype._toggleLikeCommentRequest=function(e,t){return this._spHttpClient.fetch(o.Uri.concatenate(this._getCommentsUrl(e),t?"/like":"/unlike"),r.SPHttpClient.configurations.v1,{method:"post",body:JSON.stringify({})})},e.prototype._unlikeCommentRequest=function(e){return this._toggleLikeCommentRequest(e,!1)},e.likeLimitExceededError=new d.e,e._logSource=a._LogSource.create("CommentsDataProvider"),e}();t.default=p},RPce:function(e,t,n){"use strict";var a=n("17wl"),i=n("cDcd"),r=n("ut3N"),o=n("Y7TA"),s=n("y88i"),c=n("X+PM"),d=n("fiok"),l=n.n(d),u=n("hiL/"),f=n("Rrln"),p=n("F5rs"),m=n("fPVX"),_=function(e){function t(t){var n=e.call(this,t)||this;return n._avatarErrorLogged=!1,n._lpcAdapterRefresh=n._lpcAdapterRefresh.bind(n),n.state={},n}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){this._mounted=!0},t.prototype.componentWillUnmount=function(){this._mounted=!1},t.prototype.render=function(){var e,t=f.e.instance.serviceScope.consume(c.PageContext.serviceKey);if(this._isValidUser())try{e=i.createElement(o.e,{personaType:"User",identifier:this.props.user.email,lpcHoverTargetProps:{upn:this._getUserUpn(this.props.user)},pageContext:t.legacyPageContext,moduleLoader:void 0,lpcCardBehavior:{disableHover:!0,onCardClose:void 0,onCardOpen:void 0}},i.createElement("div",null,this._imageComponent()))}catch(e){this._logAvatarError("UnknownError",e)}else this._logAvatarError("InvalidUser");return i.createElement("div",{className:m.e.spAvatar},e)},t.prototype._lpcAdapterRefresh=function(e){var t=this;!this._lpcAdapterPromise&&e&&(this._lpcAdapterPromise=this.state.lpcAdapter.ensureInitializeLPC(e.makeAdapterConfig()).then(function(){return t._mounted&&t.setState(t.state)}))},t.prototype._imageComponent=function(){return i.createElement(l.a,{key:this.props.user.email,dimensions:{width:32,height:32},displayName:this.props.user.name},i.createElement("img",{alt:s.StringHelper.format(p.z,this.props.user.name),className:m.e.spAvatarImage,src:u.SPUtility.getUserPhotoUrl(this.props.user.email)}),this.props.disabled&&i.createElement("div",{className:m.e.spDisabledAvatarOverlay}))},t.prototype._getUserUpn=function(e){return e.loginName?e.loginName.slice(e.loginName.lastIndexOf("|")+1):e.email},t.prototype._isValidUser=function(){return this.props.user&&!!this.props.user.id&&-1!==this.props.user.id},t.prototype._logAvatarError=function(e,t){this._avatarErrorLogged||(new r._QosMonitor("CommentAvatarError").writeUnexpectedFailure(e,t,t?{stack:t.stack}:void 0),this._avatarErrorLogged=!0)},t}(i.Component);t.e=_},Rrln:function(e,t,n){"use strict";var a=function(){function e(){}return Object.defineProperty(e,"instance",{get:function(){return this._instance||this._createInstance()},enumerable:!1,configurable:!0}),e.isCurrentUser=function(t){var n=e.instance.user;return n&&t&&n.id===t.id},e._createInstance=function(){return this._instance=new e},e.DEFAULT_LIKE_COUNT=0,e}();t.e=a},Y7TA:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var a=n("17wl"),i=n("cDcd"),r=n("jOlS");Object(r.loadStyles)([{rawString:".deferredLivePersonaCardRoot_b42bfbac{display:inline-block}.deferredLivePersonaCardRoot_b42bfbac .lpc-hoverTarget:focus-visible[data-is-focusable='true']{position:initial;outline:-webkit-focus-ring-color auto 1px}\n"}]);var o=n("KL1q"),s=n("kwLa"),c=function(e){function t(t){var n=e.call(this,t)||this;return n._deferLoadComponent=function(){!n.state.ComponentModule&&n.props.moduleLoader&&n.props.modulePath&&n.props.moduleLoader.load(n.props.modulePath,n.props.getModule).then(function(e){if(n.props.moduleLoader.parse&&(e=n.props.moduleLoader.parse(e)),!e){var t="ReactDeferredComponent: component not found when loading ".concat(n.props.modulePath," ")+"- check your load and parse functions";console.error(t)}n._mounted?n.setState({ComponentModule:e}):n.state={ComponentModule:e}})},n._mounted=!1,n.state={ComponentModule:void 0},n._setupDeferLoadCallback(t),n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.state.ComponentModule;return t?i.createElement(t,Object(a.__assign)({ref:function(t){t&&Object(s.hoistMethods)(e,t)}},this.props.props),this.props.children):this.props.placeHolder||null},t.prototype.componentDidMount=function(){this._mounted||(this._mounted=!0)},t.prototype.UNSAFE_componentWillReceiveProps=function(e){this._setupDeferLoadCallback(e)},t.prototype._setupDeferLoadCallback=function(e){var t=e.customWaiter;t?t.then(this._deferLoadComponent):this._deferLoadComponent()},t}(i.Component),d=n("K9kD"),l=Object(o.css)("deferredLivePersonaCardRoot","deferredLivePersonaCardRoot_b42bfbac"),u=function(e){function t(t,a){var r=e.call(this,t,a)||this;return r._onActivate=function(e){r.state.hovered||r.setState({hovered:!0,activatedByFocus:"focus"===e.type})},r.modulePath="./SpLivePersonaCard",r.moduleLoader={load:function(){return Promise.all([n.e(15),n.e(57)]).then(n.bind(null,"Wv/s")).then(function(e){return e.SpLivePersonaCard})}},r.state={hovered:t.forceLoad,activatedByFocus:!1},r.containerRef=i.createRef(),r}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.state.hovered;return this.onFocusRender=function(){if(e.state.activatedByFocus){var t=e.containerRef.current.firstChild;e.props.shouldOnFocusMoveFocusToTarget&&t&&t.className.indexOf("lpc-hoverTarget")>-1&&t.focus()}},this._deferredComponentProps={modulePath:this.modulePath,moduleLoader:this.moduleLoader,props:Object(a.__assign)(Object(a.__assign)({},this.props),{onPersonaCardReady:this.onFocusRender}),customWaiter:this.props.customWaiter,placeHolder:this.props.placeHolder},i.createElement("div",{onMouseOver:this._onActivate,onClick:this._onActivate,onFocus:this._onActivate,onMouseDown:this._onActivate,onKeyDown:this._onActivate,className:l,tabIndex:d.Killswitch.isActivated("f52064a4-9bfc-4a31-9a77-daf2c1d3a5a1")?-1:this.props.containerTabIndex,ref:this.containerRef,"data-is-focusable":!(!(this.props.containerTabIndex>-1)||t)},t?i.createElement(c,Object(a.__assign)({},this._deferredComponentProps),this.props.children):this.props.children)},t.defaultProps={containerTabIndex:-1},t}(o.BaseComponent)},"Yo/j":function(e,t,n){"use strict";var a=n("ut3N"),i=n("Cgdb"),r=n("jyrw"),o=n("D/Gr"),s=n("J4/A"),c=n("7plR"),d=n("n1SJ"),l=n("F5rs"),u=n("q+wp"),f=function(){function e(){}return e.clearComments=function(){e._dispatch("clear")},e.createComment=function(t,n,a,i){var r=this._createOptimisticComment(t,n,a);c.e.instance.commentsDataProvider().then(function(e){return e.createComment(n,a)}).then(function(t){t.optimisticId=r.optimisticId,e._dispatch("replace",{newComment:t,oldComment:r})}).catch(function(t){null==i||i(),e._dispatch("delete",r),d.e.showError(l.M,void 0,t),e._logError(t)})},e.deleteComment=function(t){e._dispatch("markDelete",t);var n=window.setTimeout(function(){e._dispatch("delete",t)},200);c.e.instance.commentsDataProvider().then(function(e){return e.deleteComment(t)}).catch(function(a){clearTimeout(n),e._dispatch("unmarkDelete",t),d.e.showError(l.C,void 0,a),e._logError(a)})},e.getComments=function(){return c.e.instance.commentsDataProvider().then(function(e){return e.getComments()}).then(function(t){e._dispatch("loaded",t)}).catch(e._logError)},e.getDisabledScope=function(){c.e.instance.commentsDataProvider().then(function(e){return e.getDisabled()}).then(function(t){e._dispatch("getDisabled",t)}).catch(e._logError)},e.getNextComments=function(t){return c.e.instance.commentsDataProvider().then(function(e){return e.getNext(t)}).then(function(t){e._dispatch("moreComments",t),u.e.alertScreenreader(l.s,l.c,t.comments.length)}).catch(e._logError)},e.getNextLikes=function(t){c.e.instance.commentsDataProvider().then(function(e){return e.getNextLikes(t.nextLikesLink)}).then(function(n){e._dispatch("moreLikes",{comment:t,likeChunk:n}),u.e.alertScreenreader(l.r,l.o,n.likes.length)}).catch(e._logError)},e.getNextReplies=function(t,n){return c.e.instance.commentsDataProvider().then(function(e){return e.getNext(t,!0)}).then(function(t){t.parentId=n,e._dispatch("moreReplies",t),u.e.alertScreenreader(l.d,l.l,t.comments.length)}).catch(e._logError)},e.focusReply=function(t){e._dispatch("focus",t)},e.likeComment=function(e,t){var n=this;this._dispatch("likeComment",{comment:e,user:t}),c.e.instance.commentsDataProvider().then(function(t){return t.likeComment(e.id)}).then(function(){c.e.instance.a11yManager.alert(l.i)}).catch(function(a){n._dispatch("unlikeComment",{comment:e,user:t}),n._processLikeError(a)})},e.reset=function(){e._dispatch("reset")},e.setDisabled=function(t){return e._dispatch("setDisabled",t?1:0),c.e.instance.commentsDataProvider().then(function(e){return e.setDisabled(t)}).catch(function(n){e._dispatch("setDisabled",t?0:1),e._logError(n)})},e.unlikeComment=function(t,n){this._dispatch("unlikeComment",{comment:t,user:n}),c.e.instance.commentsDataProvider().then(function(e){return e.unlikeComment(t.id)}).then(function(){c.e.instance.a11yManager.alert(l.m)}).catch(function(a){e._dispatch("likeComment",{comment:t,user:n}),d.e.showError(l.V,void 0,a),e._logError(a)})},e._createOptimisticComment=function(t,n,a){var i=new o.e([],new Date,"optimistic_".concat(Math.random()),void 0,a||"0",n,t,0,!1);return e._dispatch("create",i),i},e._dispatch=function(t,n){r.e.dispatch(new i.e(e._actionTypes[t],e._logEntryFor(t),n))},e._logEntryFor=function(t){return new a._LogEntry(e._moduleName,e._logFeatures[t],a._LogType.Event)},e._logError=function(t){a._TraceLogger.logError(e._logSource,t)},e._processLikeError=function(t){var n=t.name===s.default.likeLimitExceededError.name?l.A:l.E;d.e.showError(n,void 0,t),e._logError(t)},e._logSource=a._LogSource.create("CommentActionCreator"),e._moduleName="[CommentActionCreator]",e._logFeatures={clear:"SPPageCommentsCleared",create:"SPPageCommentCreated",delete:"SPPageCommentDeleted",focus:"SPPageCommentReplyFocused",getDisabled:"SPPageCommentsGetDisabled",likeComment:"SPPageCommentLiked",loaded:"SPPageCommentsLoaded",markDelete:"SPPageCommentMarkDeleted",moreComments:"SPPageCommentsMoreCommentsLoaded",moreLikes:"SPPageCommentMoreLikesLoaded",moreReplies:"SPPageCommentsMoreRepliesLoaded",replace:"SPPageCommentReplaced",reset:"SPPageCommentsReset",setDisabled:"SPPageCommentsSetDisabled",unlikeComment:"SPPageCommentUnliked",unmarkDelete:"SPPageCommentMarkUndeleted"},e._actionTypes={clear:"COMMENT_CLEAR",create:"COMMENT_CREATED",delete:"COMMENT_DELETED",focus:"COMMENT_FOCUS_REPLY",getDisabled:"COMMENTS_DISABLED",likeComment:"COMMENT_LIKE",loaded:"COMMENT_CHUNK",markDelete:"COMMENT_MARK_DELETED",moreComments:"COMMENT_CHUNK",moreLikes:"COMMENT_LIKE_CHUNK",moreReplies:"COMMENT_REPLY_CHUNK",replace:"COMMENT_REPLACED",reset:"COMMENT_RESET",setDisabled:"COMMENTS_DISABLED",unlikeComment:"COMMENT_UNLIKE",unmarkDelete:"COMMENT_UNMARK_DELETED"},e}();t.e=f},fPVX:function(e,t,n){"use strict";n("jOlS").loadStyles('.ek_p_ada2ac09{color:"[theme:neutralSecondaryAlt, default: #8a8886]"}[dir=ltr] .ek_p_ada2ac09{margin-right:11px}[dir=rtl] .ek_p_ada2ac09{margin-left:11px}.ek_p_ada2ac09:hover{color:"[theme:themePrimary, default: #0078d4]"}[dir=ltr] .ek_p_ada2ac09:last-child{margin-right:0}[dir=rtl] .ek_p_ada2ac09:last-child{margin-left:0}.el_p_ada2ac09{color:"[theme:neutralSecondaryAlt, default: #8a8886]"}[dir=ltr] .el_p_ada2ac09{margin-right:0}[dir=rtl] .el_p_ada2ac09{margin-left:0}.el_p_ada2ac09:hover{color:"[theme:themePrimary, default: #0078d4]"}.em_p_ada2ac09{font-size:14px;font-weight:400;display:flex;min-height:40px;justify-content:space-between}.en_p_ada2ac09{visibility:hidden}.eo_p_ada2ac09{font-size:14px;font-weight:400;color:"[theme:neutralDark, default: #201f1e]";font-weight:700}.ep_p_ada2ac09{height:32px;min-width:32px;position:relative;width:32px}.eq_p_ada2ac09{border-radius:17px;height:100%;width:100%}.er_p_ada2ac09{min-height:32px}.es_p_ada2ac09{margin:20px;width:100%}.et_p_ada2ac09{margin:14px 0}[dir=ltr] .et_p_ada2ac09 .eu_p_ada2ac09{margin-left:41px}[dir=rtl] .et_p_ada2ac09 .eu_p_ada2ac09{margin-right:41px}.et_p_ada2ac09 .eu_p_ada2ac09:first-child,.eu_p_ada2ac09{margin-top:14px}.eu_p_ada2ac09 .ev_p_ada2ac09 .ew_p_ada2ac09{max-height:75px;min-height:32px;overflow-y:auto;white-space:pre-wrap}.mobile .eu_p_ada2ac09 .ev_p_ada2ac09 .ew_p_ada2ac09{max-height:none}@media print{.eu_p_ada2ac09 .ev_p_ada2ac09 .ew_p_ada2ac09{max-height:none}}.ex_p_ada2ac09{flex:1;line-height:1}[dir=ltr] .ex_p_ada2ac09{margin-left:11px}[dir=rtl] .ex_p_ada2ac09{margin-right:11px}.ey_p_ada2ac09{display:flex}.ez_p_ada2ac09{background-color:"[theme:white, default: #ffffff]";border-radius:17px;height:33px;opacity:.6;position:absolute;top:0;width:33px}.fa_p_ada2ac09{margin:0 7px 30px;flex-grow:1}.fb_p_ada2ac09{display:inline-block;margin-bottom:10px;margin-top:0}.fb_p_ada2ac09.fc_p_ada2ac09{font-size:"[theme:xLargeFontSize, default: 20px]";font-weight:"[theme:xLargeFontWeight, default: 600]"}.fb_p_ada2ac09:not(.fc_p_ada2ac09){font-size:28px;font-weight:100}.ew_p_ada2ac09{border-style:solid;border-width:1px;box-sizing:border-box;cursor:text;line-height:normal;outline:0;padding:5px 14px;word-break:break-word;word-wrap:break-word;-webkit-font-smoothing:antialiased}.ew_p_ada2ac09.fe_p_ada2ac09{background-color:"[theme:bodyBackground, default: #ffffff]";color:"[theme:neutralPrimary, default: #323130]";border-color:"[theme:neutralSecondary, default: #605e5c]"}.ew_p_ada2ac09.fe_p_ada2ac09:focus{border-color:"[theme:themePrimary, default: #0078d4]"}.ew_p_ada2ac09.fe_p_ada2ac09[disabled]{background-color:"[theme:infoBackground, default: #f4f4f4]";border-color:"[theme:infoBackground, default: #f4f4f4]";pointer-events:none;cursor:default}.ew_p_ada2ac09.fe_p_ada2ac09:hover{border-color:"[theme:neutralSecondaryAlt, default: #8a8886]"}.ew_p_ada2ac09:not(.fe_p_ada2ac09){background-color:"[theme:bodyBackground, default: #ffffff]";border-color:"[theme:neutralTertiaryAlt, default: #c8c6c4]";color:"[theme:neutralPrimary, default: #323130]"}.ew_p_ada2ac09:not(.fe_p_ada2ac09):hover{border-color:"[theme:neutralSecondaryAlt, default: #8a8886]"}.ew_p_ada2ac09:not(.fe_p_ada2ac09):focus{border-color:"[theme:themePrimary, default: #0078d4]"}.ew_p_ada2ac09:not(.fe_p_ada2ac09)[disabled]{background-color:"[theme:infoBackground, default: #f4f4f4]";border-color:"[theme:infoBackground, default: #f4f4f4]";pointer-events:none;cursor:default}.ew_p_ada2ac09:empty:after{color:"[theme:neutralSecondary, default: #605e5c]";content:attr(placeholder);display:block}.ew_p_ada2ac09[disabled]:empty:not(:focus):before{content:""}.ff_p_ada2ac09{font-size:11px;font-weight:400;color:"[theme:neutralSecondaryAlt, default: #8a8886]";padding-top:5px}.fg_p_ada2ac09{color:"[theme:error, default: #a80000]"}.fh_p_ada2ac09{color:"[theme:themePrimary, default: #0078d4]"}.fh_p_ada2ac09:hover{cursor:pointer;color:"[theme:themeDark, default: #005a9e]"}.fi_p_ada2ac09{margin-top:6px}.fi_p_ada2ac09>a,.fi_p_ada2ac09>label{font-size:12px;font-weight:400;color:"[theme:neutralSecondary, default: #605e5c]"}.fi_p_ada2ac09>a.fj_p_ada2ac09,.fi_p_ada2ac09>label.fj_p_ada2ac09{color:"[theme:neutralSecondaryAlt, default: #8a8886]"}.fk_p_ada2ac09{margin-bottom:14px}.ev_p_ada2ac09{font-size:14px;font-weight:400;display:flex}@media print{.ev_p_ada2ac09{display:none}}.fl_p_ada2ac09{flex-shrink:0}.fm_p_ada2ac09{font-size:17px;font-weight:300;color:"[theme:neutralPrimary, default: #323130]";font-weight:400;line-height:normal;margin-top:8px;word-break:break-word;word-wrap:break-word}.fm_p_ada2ac09 .fn_p_ada2ac09{display:block}.fm_p_ada2ac09 .fn_p_ada2ac09 a[data-sp-mention-user-id]{color:"[theme:themePrimary, default: #0078d4]";font-weight:lighter;text-decoration:none}.fm_p_ada2ac09 .fn_p_ada2ac09 a[data-sp-mention-user-id][access-type="1"]{font-weight:700}.fm_p_ada2ac09 .fn_p_ada2ac09 div{display:inline}.fo_p_ada2ac09{display:inline-block;margin:0 15px;vertical-align:middle}.fp_p_ada2ac09{width:288px}.fq_p_ada2ac09{top:50px}.fr_p_ada2ac09{padding:0 25px;overflow-x:hidden;overflow-y:auto}.fs_p_ada2ac09{flex-shrink:0;padding:0 25px}.fs_p_ada2ac09 .ft_p_ada2ac09{font-size:21px;font-weight:300;line-height:48px;margin:0}@media screen and (min-width:640px){.es_p_ada2ac09{margin:20px 36px}}@media screen and (max-width:639px){.es_p_ada2ac09.fu_p_ada2ac09{margin:0}.ev_p_ada2ac09.fu_p_ada2ac09{flex-wrap:wrap}.fv_p_ada2ac09{width:100%}}',!0),t.e={spAction:"ek_p_ada2ac09",spActionLike:"el_p_ada2ac09",spActions:"em_p_ada2ac09",spActionsHidden:"en_p_ada2ac09",spAuthor:"eo_p_ada2ac09",spAvatar:"ep_p_ada2ac09",spAvatarImage:"eq_p_ada2ac09",spButton:"er_p_ada2ac09",spCommentSection:"es_p_ada2ac09",spComment:"et_p_ada2ac09",spComments:"eu_p_ada2ac09",spReply:"ev_p_ada2ac09",spInput:"ew_p_ada2ac09",spContent:"ex_p_ada2ac09",spContentRegion:"ey_p_ada2ac09",spDisabledAvatarOverlay:"ez_p_ada2ac09",spField:"fa_p_ada2ac09",spHeader:"fb_p_ada2ac09",fluent:"fc_p_ada2ac09",spInputContrastRatioOverwrite:"fe_p_ada2ac09",spInputLimit:"ff_p_ada2ac09",spInputLimitExceeded:"fg_p_ada2ac09",spMore:"fh_p_ada2ac09",spMetadata:"fi_p_ada2ac09",originalColor:"fj_p_ada2ac09",spMoreBlock:"fk_p_ada2ac09",spReplyButtonBlock:"fl_p_ada2ac09",spText:"fm_p_ada2ac09",commentRichText:"fn_p_ada2ac09",spToggleWrapper:"fo_p_ada2ac09",spLikesList:"fp_p_ada2ac09",spLikesPanel:"fq_p_ada2ac09",spLikesPanelContent:"fr_p_ada2ac09",spLikesPanelHeader:"fs_p_ada2ac09",spLikesPanelHeaderText:"ft_p_ada2ac09",zoom400:"fu_p_ada2ac09",spBreak:"fv_p_ada2ac09"}},i8gT:function(e,t,n){"use strict";var a=n("D/Gr"),i=n("Rrln"),r=function(){function e(){}return e.allLikesFetched=function(e){return e&&-1===e.indexOf("skiptoken")},e.toCommentItem=function(t){return e._toCommentItemWithLikes(t)},e._toCommentItemWithLikes=function(t){var n=t.replies?t.replies.map(function(t){return e._toCommentItemWithLikes(t)}):[],r=t.likedBy&&t.likedBy.filter(function(e){return e&&!i.e.isCurrentUser(e)}),o=t["likedBy@odata.nextLink"];return e.allLikesFetched(o)&&(o=void 0),new a.e(n,new Date(t.createdDate),t.id,t["replies@odata.nextLink"],t.parentId,t.text,t.author,t.likeCount,t.isLikedByUser,r,o,t,t.mentions)},e}();t.e=r},m9Fc:function(e,t,n){"use strict";var a=n("17wl"),i=n("cDcd"),r=n("faye"),o=n("2q6Q"),s=n("ut3N"),c=n("I6O9"),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype._internalLoad=function(){return c.SPComponentLoader.loadComponentById("44f2ec7c-d082-4660-956e-5e3cd760e6ad").then(function(e){return e.AtMentionControl})},t}(n("qjmy")._DeferredComponent),l=d,u=n("KL1q"),f=n("y88i"),p=n("UWqr"),m=n("Yo/j"),_=n("RPce"),h=n("Rrln"),b=n("ECV1"),g=n("CIL5"),v=n.n(g),y="".concat(" ").concat(" ","\n\r"),S=function(){function e(){this._addingPreNodes=!0,this._postNodes=[],this._preNodes=[]}return e.prototype.addNode=function(e){(this._addingPreNodes?this._preNodes:this._postNodes).push(e)},e.prototype.addText=function(e,t){t>0&&t<e.length?(this.addNode(document.createTextNode(e.substr(0,t))),this._startAddingPostNodes(),this.addNode(document.createTextNode(e.substr(t)))):this.addNode(document.createTextNode(e))},Object.defineProperty(e.prototype,"postNodes",{get:function(){return this._postNodes.filter(this._nonBlankNode)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"preNodes",{get:function(){return this._preNodes.filter(this._nonBlankNode)},enumerable:!1,configurable:!0}),e.prototype._nonBlankNode=function(e){return"A"===e.nodeName||!!e.nodeValue},e.prototype._startAddingPostNodes=function(){this._addingPreNodes=!1},e}(),D=function(){function e(e,t){this._element=e,this._requireSpace=t}return e.replaceLinks=function(t,n){new e(t,n).replaceLinks()},e.prototype.replaceLinks=function(){var e=this;[].forEach.call(this._element.childNodes,function(t){t.nodeValue?e._findAndReplaceMatches(t,t.nodeValue):e._replaceChildLinks(t)})},e.prototype._findAndReplaceMatches=function(e,t){var n=this._matchesForText(e,t);if(n.length){var a=this._newNodesForMatches(e,n,t);this._pushNodes(a,e)}},e.prototype._getCursorPosition=function(e){var t,n=0,a=e.ownerDocument||e.document,i=a.defaultView||a.parentWindow;if(void 0!==i.getSelection){if((t=i.getSelection()).rangeCount>0){var r=t.getRangeAt(0),o=r.cloneRange();o.selectNodeContents(e),o.setEnd(r.endContainer,r.endOffset),n=o.toString().length}}else if((t=a.selection)&&"Control"!==t.type){var s=t.createRange(),c=a.body.createTextRange();c.moveToElementText(e),c.setEndPoint("EndToEnd",s),n=c.text.length}return n},e.prototype._lastCharacterShouldBreak=function(e,t,n){var a=this._getCursorPosition(e)-1||t.lastIndex;return a>n.length||void 0!==n[a]&&y.indexOf(n[a])>-1},e.prototype._linkNodeFor=function(e){var t=document.createElement("a");return t.appendChild(document.createTextNode(e.text)),t.setAttribute("contentEditable","false"),t.href=e.url,t.rel="noopener",t.target="_blank",t},e.prototype._matchesForText=function(t,n){return this._removeUnfinishedMatches(t,e._linkifyIt.match(n)||[],n)},e.prototype._newNodesForMatches=function(e,t,n){var a=this,i=this._getCursorPosition(e)||n.length,r=new S,o=0;return t.forEach(function(e){r.addText(n.substr(o,e.index-o),i-o),r.addNode(a._linkNodeFor(e)),o=e.lastIndex}),r.addText(n.substr(o),i-o),r},e.prototype._pushNodes=function(e,t){var n=this;e.preNodes.forEach(function(e){n._element.insertBefore(e,t)}),e.postNodes.forEach(function(e){n._element.insertBefore(e,t.nextSibling)}),t.nodeValue=""},e.prototype._readyToReplace=function(e,t,n){return!this._requireSpace||this._lastCharacterShouldBreak(e,t,n)},e.prototype._removeUnfinishedMatches=function(e,t,n){var a=this;return t.filter(function(t){return a._readyToReplace(e,t,n)})},e.prototype._replaceChildLinks=function(t){"DIV"===t.nodeName&&e.replaceLinks(t,this._requireSpace)},e._linkifyIt=new v.a,e}(),I=n("7plR"),x=n("xs0R"),C=n("q+wp"),O=n("HUje"),w=n("F5rs"),E=n("fPVX"),A=2e3,L=function(e){function t(t){var n=e.call(this,t)||this;return n._a11yManager=I.e.instance.a11yManager,n._mentionsWithAccess=0,n._mentionsWithoutAccess=0,n._mentionsTotal=0,n._assignInputElementRef=function(e){n._inputElement=e},n._handleBlur=function(){n._updateText()},n._convertPasteToPlainText=function(e){var t=e;if(!C.e.isIE11()){t.preventDefault();var n="";t.clipboardData||t.originalEvent.clipboardData?n=(t.originalEvent||t).clipboardData.getData("text/plain"):window.clipboardData&&(n=window.clipboardData.getData("Text")),document.queryCommandSupported("insertText")?document.execCommand("insertText",!1,n):document.execCommand("paste",!1,n)}},n._onReply=function(){C.e.logUserEngagementForPage(x.t.fields,!0,"CommentReplyPostButton");var e,t=!p._SPKillSwitch.isActivated("a5464fa5-fce2-43b2-8f99-1c93dc649482"),a=n._textContent();t&&(e=function(){n.setState({commentValue:a}),n._inputElement&&(n._inputElement.innerHTML=a)}),m.e.createComment(h.e.instance.user,a,n.props.commentId,t?e:void 0),n.setState({commentValue:""}),n._logMentionTotal(),n._a11yManager.alert(w.u),n._inputElement&&n._a11yManager.focusTo(n._inputElement)},n._updateText=function(e){e&&e.ctrlKey&&13===e.keyCode?n._onReply():(n._inputElement&&(D.replaceLinks(n._inputElement,e&&13!==e.keyCode),n.setState({commentValue:n._inputElement.innerHTML})),n._handleAtMention())},n._handleAtMention=function(){if(n._inputElement&&!n._atMention){var e=document.createElement("div"),t=i.createElement(l,{deferredProps:{editorElement:n._inputElement,serviceScope:I.e.instance.serviceScope}});n._atMention=r.render(t,e)}},p.Validate.isNotNullOrUndefined(n._a11yManager,"A11yManager"),n._allowTags(["a"]),n.state={commentValue:""},n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e,t=w.J,n=!Object(O.e)();return i.createElement("form",{className:Object(u.css)(E.e.spReply,(e={},e[E.e.zoom400]=n,e))},i.createElement(_.e,{disabled:this.props.disabled,user:h.e.instance.user}),i.createElement("div",{className:E.e.spField},i.createElement("div",Object(a.__assign)({"aria-label":w.Q,className:Object(u.css)(E.e.spInput,E.e.spInputContrastRatioOverwrite),contentEditable:!this.props.disabled},{disabled:this.props.disabled,placeholder:t},{id:this._isRootReply()?"sp-comment-input":"sp-comment-input-reply-".concat(this.props.commentId),onBlur:this._handleBlur,onKeyUp:this._updateText,onPaste:this._convertPasteToPlainText,ref:this._assignInputElementRef,role:"textbox"})),this._textLength()>1800&&i.createElement("div",{"aria-atomic":"true","aria-live":"polite",className:Object(u.css)(E.e.spInputLimit,this._inputExceededStyle())},this._charactersRemainingText())),n&&i.createElement("div",{className:E.e.spBreak}),i.createElement("div",{className:E.e.spReplyButtonBlock},i.createElement(u.PrimaryButton,{ariaLabel:w.k,className:E.e.spButton,"data-automation-id":this._isRootReply()?"sp-comment-post":"sp-comment-reply-post-".concat(this.props.commentId),disabled:!this.commentInputValid()||this.props.disabled,onClick:this._onReply,text:w.k})))},t.prototype.commentInputValid=function(){return this._textLength()>0&&this._textLength()<=2e3},t.prototype.componentDidMount=function(){this.props.autoFocus&&this._inputElement&&this._a11yManager.focusTo(this._inputElement)},t.prototype.componentWillUnmount=function(){this._inputElement&&(r.unmountComponentAtNode(this._inputElement),this._inputElement=void 0)},t.prototype.componentDidUpdate=function(){""===this.state.commentValue&&this._inputElement&&(this._inputElement.innerHTML="")},t.prototype.focus=function(){this._inputElement&&this._a11yManager.focusTo(this._inputElement)},t.prototype._charactersRemainingText=function(){return this._textLength()<=A?p.Text.format(f.StringHelper.getLocalizedCountValue(w.U,w.F,A-this._textLength()),A-this._textLength()):p.Text.format(f.StringHelper.getLocalizedCountValue(w.P,w.T,-2e3+this._textLength()),-2e3+this._textLength())},t.prototype._inputExceededStyle=function(){return this._textLength()>A?E.e.spInputLimitExceeded:""},t.prototype._isRootReply=function(){return!this.props.commentId},t.prototype._limitConsecutiveNewlines=function(e){return e.replace(/\n{3,}/gm,"\n\n")},t.prototype._removeAllTags=function(e){return this._regexWithException?e.replace(this._regexWithException,""):e.replace(/<(?:.|\n)*?>/gm,"")},t.prototype._allowTags=function(e){for(var t=e[0],n=1;n<e.length;n++)t+="|"+e[n];this._regexWithException=new RegExp("<(?!/?("+t+")(?=>|\\s.*>))/?.*?>","gm")},t.prototype._replaceDivsWithNewLines=function(e){return e.replace(/<div>/gi,"\n").replace(/<\/div>/gi,"")},t.prototype._textLength=function(){return this._inputElement&&0!==this.state.commentValue.length?this._textLengthCache&&this._lastHTML===this._inputElement.innerHTML?this._textLengthCache:(this._lastHTML=this._inputElement.innerHTML,this._textLengthCache=this._textContent().length):0},t.prototype._textContent=function(){var e=this._inputElement?this._inputElement.innerHTML:"";return e=this._replaceDivsWithNewLines(e),e=this._limitConsecutiveNewlines(e),e=this._trimSurroundingWhitespace(e),e=this._removeAllTags(e),this._regexWithException||(e=b.e.htmlDecode(e)),e},t.prototype._trimSurroundingWhitespace=function(e){return e.replace(/^\s+|\s+$/g,"")},t.prototype._updateMentionTotal=function(){if(this._inputElement){var e=this._inputElement.querySelectorAll("a[".concat("data-sp-mention-user-id","]"));this._mentionsTotal=e.length,this._mentionsWithAccess=0,this._mentionsWithoutAccess=0;for(var t=0;t<e.length;t++){var n=e[t].getAttribute("access-type");"1"===n?this._mentionsWithAccess+=1:"0"===n&&(this._mentionsWithoutAccess+=1)}}},t.prototype._logMentionTotal=function(){this._updateMentionTotal();var e=new s._LogEntry("CommentsAtMention","CommentsPost",s._LogType.Event,{mentionTotal:this._mentionsTotal.toString(),mentionWithPermission:this._mentionsWithAccess.toString(),mentionWithoutPermission:this._mentionsWithoutAccess.toString()});o._EngagementLogger.logEventWithLogEntry(e)},t}(i.Component);t.e=L}}]);