(window.webpackJsonp_764afdc3_183e_47f5_8d20_a62aff2b0881_0_1_0=window.webpackJsonp_764afdc3_183e_47f5_8d20_a62aff2b0881_0_1_0||[]).push([[14],{"7lLr":function(e,t,n){"use strict";n.r(t),n.d(t,"PreventSPAppBarCalloutDismissContext",function(){return ie});var a=n("17wl"),i=n("cDcd"),r=n("Q+Pn"),o=n("FEK+"),s=function(e){function t(t){var n=e.call(this,t)||this;return n.state={hasError:!1},n}return Object(a.__extends)(t,e),t.getDerivedStateFromError=function(){return{hasError:!0}},t.prototype.componentDidCatch=function(e,t){this.props.onError(e,JSON.stringify(t))},t.prototype.render=function(){return this.state.hasError?i.createElement(i.Fragment,null):i.createElement(i.Fragment,null,this.props.children)},t}(i.Component),c=n("p5NW"),d=n("f6ry"),l=n("w0LS"),u=n("jidH"),f=n("X15L"),p=n("K9kD"),m=function(){function e(e,t){this._dataRequestor=t.vroomDataRequestor}return e.prototype.request=function(e){var t=e.webAbsoluteUrl,n=e.requestBody,i=e.qosName;return Object(a.__awaiter)(this,void 0,p.Promise,function(){var e;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return e="".concat(t,"/_api/v2.1/graphql"),[4,this._dataRequestor.send({apiName:null!=i?i:"vroomGetGraphQL",path:e,requestType:"POST",postData:n,headers:{"Content-Type":"application/graphql"},allowCookies:!0,apiVersion:"v2.1",endpoint:t})];case 1:return[2,a.sent()]}})})},e}(),_=n("aABS"),h=n("y88i"),b=n("O/6m"),g=function(e){function t(t,n){var i=this,r=n.response,o=(void 0===r?{}:r).error,s=(void 0===o?{}:o).innerError,c=(void 0===s?{}:s).stackTrace,d=void 0===c?"":c,l=n.response,u=n.request,f=n.status,p=n.code,m=void 0===p?y(l,f,function(e){return"".concat(e)})||"unhandled":p,_=Object(a.__assign)({innerError:t,code:m},n);return(i=e.call(this,_)||this).name="GraphError",i.response=l,i.status=f,i.serverStack=d,i.request=u,i.error=t,i}return Object(a.__extends)(t,e),t}(b.e);function v(e){var t={};if(t.errorMessage=e.message,function(e){return e instanceof g}(e)){t.vroomStatus=e.status;var n=e.response;if(n&&n.error){var a=n.error;t.vroomErrorCode=a.code,t.vroomErrorMessage=a.message;var i=a.innerError||a.innererror;i&&(t.vroomErrorInnerCode=i.code,t.vroomErrorInnerMessage=i.message,t.vroomErrorInnerDebugMessage=i.debugMessage,t.vroomErrorInnerStack=i.stackTrace)}}return t}function y(e,t,n){if(e){for(var a=[],i=e.error;i;)a.push(i),i=i.innerError||i.innererror;for(;i=a.pop();)if(void 0!==i.code){var r=n(i.code);if(void 0!==r)return r}}return n(t)}var S=window&&window.performance,D={activityLimitReached:!0,malwareDetected:!0,nameAlreadyExists:!0,resourceModified:!0,resyncRequired:!0,quotaLimitReached:!0,accessRestricted:!0,childItemCountExceeded:!0,entityTagDoesNotMatch:!0,fragmentOutOfOrder:!0,fragmentOverlap:!0,hipCheckRequired:!0,insufficientVaultQuota:!0,lockMismatch:!0,lockNotFoundOrAlreadyExpired:!0,lockOwnerMismatch:!0,maxDocumentCountExceeded:!0,maxFileSizeExceeded:!0,maxFolderCountExceeded:!0,maxItemCountExceeded:!0,nameContainsInvalidCharacters:!0,pathIsTooLong:!0,pathTooDeep:!0,pathIsTooDeep:!0,propertyNotUpdateable:!0,resyncApplyDifferences:!0,resyncUploadDifferences:!0,serviceReadOnly:!0,throttledRequest:!0,unlockRequired:!0,versionNumberDoesNotMatch:!0,virusSuspicious:!0,authFailure:!1},I="Bearer",x=function(){function e(e,t){var n=e.alwaysSendContentType,a=void 0!==n&&n,i=t.sessionManagementProvider,r=t.urlDataSource,o=t.apiEvent,s=void 0===o?h.Api:o,c=t.cookieOrigin,d=t.isOffline,l=t.dataSyncClient;this._sessionManagementProvider=i,this._alwaysSendContentType=a,this._apiEvent=s,this._apiName=r&&"function"==typeof r.getApiName?r.getApiName():"Vroom",this._urlDataSource=r,this._cookieOrigin=c,this._isOffline=d,this._dataSyncClient=l,this._encodingFixEnabled=!p.Killswitch.isActivated("179f8622-1596-43df-a186-a4b42e1d7917","08/04/2020","Decode unicode characters in graph errors")&&!p.FeatureOverrides.isFeatureEnabled({ODC:"GraphEncodingFixKillswitch"}),this._isPassAuthTokenInHeaderFeatureEnabled=p.FeatureOverrides.isFeatureEnabled({ODB:60762,ODC:"PassAuthTokenInHeader"}),this._passEndpointToGetSessionTokenKS=p.Killswitch.isActivated("9D67A1AA-395D-42A3-9D85-C9FC5FFB73D4","05/11/2022","pass endpoint to getSessionToken"),this._driveIdUrlCheckEnabled=!p.Killswitch.isActivated("16BE6F20-C2C6-46AF-8EA5-6D43B30F7112","06/09/2022","Validate driveUrl against driveId")}return e.prototype.send=function(e){var t=this,n=function(){var n=e.headers,i=void 0===n?{}:n,r=e.path,o=e.endpoint,s=e.driveUrl,c=e.driveId,d=e.apiName,l=e.disableLogging,u=void 0!==l&&l,f=e.timeout,m=e.onProgress,_=e.onUploadProgress,x=e.qosExtraData,O=e.apiVersion,w=void 0===O?"v2.0":O,E=e.needsAuthorization,A=void 0===E||E,L=e.accessToken,k=e.postProcessQos,M=e.breakCache,P=e.allowCookies,T=e.hasContentType,U=void 0===T||T,F=e.useMultiPart,H=void 0!==F&&F,R=e.getErrorAsMessage,N=void 0!==R&&R,B=e.expectedErrors,j=e.useExactAuthToken,V=void 0!==j&&j;if(o||(o=t._urlDataSource?"function"==typeof t._urlDataSource.getApiBaseUrl?t._urlDataSource.getApiBaseUrl({driveId:c}):t._urlDataSource.getVroomApiBaseUrl():void 0),t._driveIdUrlCheckEnabled&&s&&c&&("me"!==c?"".concat(o,"/drives/").concat(c):s)!==s)throw new b.e({code:"DriveIdAndDriveUrlMismatch"});var z=e.useAuthorizationHeaders,G=void 0!==z&&z;t._isPassAuthTokenInHeaderFeatureEnabled&&(G=!0);var K=Object(a.__assign)(Object(a.__assign)({},D),e.expectedErrorCodes||{}),W=e.requestType,q=void 0===W?"GET":W,Q=t._cookieOrigin,Y=new h.SimpleUri(r).authority?r:"".concat(o).concat(r),J=function(n){var s,c,l="",b={};H?(l=p.Guid.generate(),b={"Content-Type":"multipart/form-data;boundary=".concat(l)}):b=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({Accept:"application/json"},(e.postData||t._alwaysSendContentType)&&U?{"Content-Type":"application/json"}:{}),n.useCookies&&n.digestValue?{"x-requestdigest":n.digestValue}:{}),N?{prefer:"rich-error-as-message"}:{}),i),n.sessionToken&&n.sessionToken.tokenUrl&&0===r.indexOf("/drive/")?c=new p.Uri("".concat(n.sessionToken.tokenUrl,"/").concat(r.substring(7))):(c=new p.Uri(r),o&&!c.getScheme()&&(c=new p.Uri(o+r))),H&&(c.setQueryParameter("ump","1"),"POST"!==q&&(i["X-HTTP-Method-Override"]=q),q="POST");var D,I=c.toString();if(!H&&n.sessionToken){var C=n.sessionToken,O=C.accessToken,w=C.proofToken,E=C.wlidToken,A=C.isBadger;if(E)b=Object(a.__assign)(Object(a.__assign)({},b),{Authorization:"wlid1.1 ".concat(E)});else if(G){if(O){var L=A?"badger":"bearer",P=V?O:"".concat(L," ").concat(O);b=Object(a.__assign)(Object(a.__assign)({},b),{Authorization:P})}w&&(b=Object(a.__assign)(Object(a.__assign)({},b),{"X-PROOF_TOKEN":w}))}else O&&c.setQueryParameter("access_token",O),w&&c.setQueryParameter("prooftoken",w)}if(H){var T="";if(T+="--".concat(l,"\r\n"),T+="Content-Disposition: form-data;name=data\r\n",i)for(var F=0,R=Object.keys(i);F<R.length;F++){var j=R[F];T+="".concat(j,": ").concat(i[j],"\r\n")}T+="Content-Type: application/json\r\n";var z=n.sessionToken;O=z.accessToken,A=z.isBadger,O&&(T+="Authorization: ".concat(L=A?"badger":"bearer"," ").concat(O,"\r\n")),N&&(T+="prefer: rich-error-as-message\r\n"),T+="\r\n",T+="".concat(void 0!==e.postData?e.postData:"","\r\n"),T+="--".concat(l,"--")}if(M&&c.setQueryParameter("r",Math.random().toFixed(8)),(null===(s=n.sessionToken)||void 0===s?void 0:s.authKey)&&c.setQueryParameter("authKey",n.sessionToken.authKey),!u){var W=new h.SimpleUri(I),Q={url:"".concat(W.authority,"/{ length: ").concat(W.path.length,", segments: ").concat(W.segments.length," }"),name:"".concat(t._apiName,"DataRequest.").concat(d),extraData:x};D=new t._apiEvent(Q)}var Y=c.toString(),J=S&&S.now();return h.XHRPromise.start({url:Y,headers:b,method:q,json:T||e.postData||"",requestTimeoutInMS:f,withCredentials:n.useCookies,onProgress:m,onUploadProgress:_}).then(function(t){var n,a,i=Object(h.getRequestEntryDurationMetrics)(Y,J);if(D){var r=null!==(a=null===(n=t.getAllResponseHeaders())||void 0===n?void 0:n.toLowerCase())&&void 0!==a?a:"",o={resultType:h.ResultTypeEnum.Success,extraData:{rawRequestDuration:i.duration,performanceEntry:JSON.stringify(i),requestId:r.indexOf("sprequestguid:")>=0?t.getResponseHeader("sprequestguid"):r.indexOf("request-id:")>=0?t.getResponseHeader("request-id"):null,MSCorrelationVector:r.indexOf("ms-cv:")>=0?t.getResponseHeader("MS-CV"):null}};D.end(o)}return e.parseResponse?e.parseResponse(t):0===t.responseText.length?null:JSON.parse(t.responseText)},function(e){var i,r=function(e,t){return k&&(e=k(e,t)),D&&D.end(e),p.Promise.reject(t)},o=Object(h.getRequestEntryDurationMetrics)(Y,J);if(e instanceof Error){var s=p.Promise.isCanceled(e),d=s?h.ResultTypeEnum.ExpectedFailure:h.ResultTypeEnum.Failure,l={error:e.message,resultCode:s?"Canceled":"",resultType:d,extraData:{rawRequestDuration:o.duration,performanceEntry:JSON.stringify(o)}};return r(l,e)}if(e.responseText)try{i=JSON.parse(e.responseText)}catch(e){}if(N)try{var u=t._encodingFixEnabled?JSON.parse((f=i.error.message,decodeURIComponent(escape(atob(f))))):JSON.parse(atob(i.error.message));i={error:u}}catch(e){}var f,m=e.status,_=e.statusText,b=(i||{}).error,S=void 0===b?{}:b,I=S.message,C=void 0===I?"":I,O=S.innerError,w=void 0===O?{}:O,E=w.stackTrace,A=void 0===E?"":E,L=w.debugMessage,M=void 0===L?"":L;return(m||!t._isOffline?p.Promise.resolve(!1):t._isOffline()).then(function(t){var s,d,l=t?"Offline":"",u=null!==(d=null===(s=e.getAllResponseHeaders())||void 0===s?void 0:s.toLowerCase())&&void 0!==d?d:"",f=u.indexOf("sprequestguid")>=0&&e.getResponseHeader("sprequestguid")||u.indexOf("request-id")>=0&&e.getResponseHeader("request-id"),b=t||!!y(i,m,function(e){return K[e]}),S=new g(new Error(C||l),{response:i,status:m,request:e,correlationId:f,isExpected:b});B&&Object(p.isExpectedError)({code:S.code,message:C},B)&&(b=!0);var D={resultType:b?h.ResultTypeEnum.ExpectedFailure:h.ResultTypeEnum.Failure,error:C,resultCode:S.code,extraData:Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},x||{}),v(S)),{stack:A,httpStatus:m,httpStatusText:_,requestId:f,MSCorrelationVector:u.indexOf("ms-cv:")>=0?e.getResponseHeader("MS-CV"):null,debugMessage:M,accessTokenLength:n.sessionToken&&n.sessionToken.accessToken?n.sessionToken.accessToken.length:-1,urlLength:c.toString().length,useCookies:!!n.useCookies,isOffline:t,rawRequestDuration:o.duration,performanceEntry:JSON.stringify(o)})};return r(D,S)})})},X=t._sessionManagementProvider;if(A){if(L)return J({sessionToken:L});var Z=new h.SimpleUri(Y).authority;if(P&&Z&&Q&&Z===Q)return X&&X.getFormDigest&&"GET"!==q?X.getFormDigest(t._passEndpointToGetSessionTokenKS?void 0:"".concat(o,"/_api/contextInfo")).then(function(e){return J({digestValue:e,useCookies:!0})}):J({useCookies:!0});if(X&&X.getSessionToken){var $={apiVersion:w,endpoint:o,driveUrl:s,path:Y};return p.Promise.resolve(X.getSessionToken($)).then(function(e){return J({sessionToken:e}).catch(function(t){return e&&function(e){if(e instanceof g){var t=e.request,n=t&&t.getResponseHeader("WWW-Authenticate");if(n&&n.slice(0,I.length)===I&&n.indexOf('error="insufficient_claims"')>-1)return!0}return!1}(t)?X.getSessionToken(Object(a.__assign)(Object(a.__assign)({},$),{claimsChallenge:{sessionToken:e,claims:C(t),error:t}})).then(function(n){return n.accessToken!==e.accessToken?J({sessionToken:n}):p.Promise.reject(t)}):p.Promise.reject(t)})})}if(X&&X.getToken)return X.getToken(w,Y).then(function(e){return J({sessionToken:e})})}return J({})};return!p.KillSwitch.isActivated("83F9234E-0E49-4110-943D-2F0394E9F9FF","5/24/2022","Route graph calls to Nucleus")&&this._dataSyncClient?function(e){var t=e.dataSyncClient,n=e.options,a=e.getData,i=function(){return a(n)};return p.Promise.resolve(t).then(function(t){return t?function(t){return t.getData({url:n.path,method:n.requestType},function(t){var n=e.options;return n.path=t.url,n.accessToken={accessToken:t.authToken},n.useExactAuthToken=!0,a(n)},i)}(t):i()})}({dataSyncClient:this._dataSyncClient,options:e,getData:n}):n()},e}();function C(e){var t=e.request&&e.request.getResponseHeader("WWW-Authenticate"),n='claims="';if(t){var a=t.indexOf(n);if(a>-1){var i=t.indexOf('"',a+n.length);if(i>-1){var r=t.slice(a+n.length,i);return p.KillSwitch.isActivated("93E9F77D-7B3B-4760-B58F-1154E9E530ED","06/02/2022","Decode claims from base64")?r:atob(r)}}}}var O=n("m1i4"),w=function(){function e(e,t){var n=t.pageContext;this._apiUrlHelper=new O.e({webAbsoluteUrl:n.webAbsoluteUrl}),this._dataRequestor=new p.DataRequestor({},{pageContext:n})}return e.prototype.getFormDigest=function(e){var t=e||this._getContextInfoUrl();return this._dataRequestor.getData({url:t,qosName:"IdentityDataSource.getFormDigest",method:"POST"}).then(function(e){return e.d.GetContextWebInformation.FormDigestValue})},e.prototype._getContextInfoUrl=function(){return this._apiUrlHelper.build().segment("contextInfo").toString()},e}(),E=function(){function e(e){var t=e.getToken,n=e.pageContext;this._getToken=t,this._identityDataSource=new w({},{pageContext:n})}return e.prototype.getSessionToken=function(e){return this._getToken(e.endpoint)},e.prototype.getFormDigest=function(e){return this._identityDataSource.getFormDigest(e)},e}(),A=function(){function e(e){var t=e.webAbsoluteUrl;this._webAbsoluteUrl=t}return e.prototype.getApiBaseUrl=function(e){var t=e.apiVersion,n=void 0===t?"v2.0":t;return"".concat(this._webAbsoluteUrl,"/_api/").concat(n)},e}(),L=function(e){var t=e.pageContext,n=e.getToken,a=e.cookieOrigin;return new x({},{cookieOrigin:a,sessionManagementProvider:new E({pageContext:t,getToken:n}),urlDataSource:new A({webAbsoluteUrl:t.webAbsoluteUrl})})},k=function(){function e(e,t){var n=t.pageContext,i=t.vroomDataRequestor,r=t.getVroomDataRequestorParams,o=this;this._parseFilesResponse=function(e,t,n){var i,r;if(e){var s,c=!1;o._isCachedResultWithStatistic(e)?(s=e.data,c=!0):s=e;var d=null===(r=null===(i=null==s?void 0:s.data)||void 0===i?void 0:i.me)||void 0===r?void 0:r.recent;if(null!=d){if(!d||0===d.length)return t?{data:[],cacheStats:{lastModified:Date.now(),lastRead:Date.now(),reads:0}}:[];d=o._sortByAccessTime(d.filter(function(e){var t,n=e.remoteItem;return n.name&&(null===(t=n.sharepointIds)||void 0===t?void 0:t.siteUrl)&&n.webDavUrl}));var l=null==d?void 0:d.slice(0,n).map(function(e){var t,n,i,r,o,s,c=e.remoteItem,d=null,l=c.name;if("oneNote"===(null===(t=c.package)||void 0===t?void 0:t.type))o="one",s=l;else{var u=l.lastIndexOf(".");o=l.substr(u+1),s=l.substr(0,u)}var f=c.sharepointIds.siteUrl,p=document.createElement("a");if(p.href=c.webDavUrl,"documentLibrary"===c.parentReference.driveType){var m=f.substr(f.lastIndexOf("/")+1);f=null===(n=c.webDavUrl)||void 0===n?void 0:n.substr(0,c.webDavUrl.lastIndexOf("/"));var _=p.pathname,h=_.substr(_.indexOf(m)+m.length+1),b=decodeURI(h).split("/");b.pop(),d=b.length>=3?"".concat(m," > ... > ").concat(b[b.length-1]):Object(a.__spreadArray)([m],b,!0).join(" > ")}else{var g=null===(r=null===(i=c.createdBy)||void 0===i?void 0:i.user)||void 0===r?void 0:r.displayName;d=g&&g.length>0?"OneDrive > ".concat(g):"OneDrive > Documents"}return{name:s,url:"".concat(c.webDavUrl,"?web=1"),path:d,extension:o,siteurl:f}});return c?Object(a.__assign)(Object(a.__assign)({},e),{data:l}):l}}},this._sortByAccessTime=function(e){if(!e||e.length<=1)return e;var t=e.length,n={},a=-1;n[t-1]=new Date(e[t-1].remoteItem.fileSystemInfo.lastAccessedDateTime);for(var i=t-2;i>=0;i--){var r=new Date(e[i].remoteItem.fileSystemInfo.lastAccessedDateTime);n[i]=r,r<n[i+1]&&i+1>a&&(a=i+1)}var o=function(t,n,a){if(t===n)return t;if(new Date(e[t].remoteItem.fileSystemInfo.lastAccessedDateTime)<a)return t;if(new Date(e[n].remoteItem.fileSystemInfo.lastAccessedDateTime)>a)return n+1;if(t===n-1)return n;var i=Math.floor((t+n)/2);return new Date(e[i].remoteItem.fileSystemInfo.lastAccessedDateTime)>a?s(i,n,a):s(t,i,a)},s=function(t,n,a){if(t===n)return t;if(t===n-1)return new Date(e[t].remoteItem.fileSystemInfo.lastAccessedDateTime)<a?t:new Date(e[n].remoteItem.fileSystemInfo.lastAccessedDateTime)>a?n+1:n;var i=Math.floor((t+n)/2);return new Date(e[i].remoteItem.fileSystemInfo.lastAccessedDateTime)>a?s(i,n,a):s(t,i,a)},c=[];for(i=0;i<a;i++)c.push(e.shift());for(i=0;i<c.length;i++){var d=o(0,t-a-1+i,new Date(c[i].remoteItem.fileSystemInfo.lastAccessedDateTime));e.splice(d,0,c[i])}return e},this._isCachedResultWithStatistic=function(e){return!!e.cacheStats},this._persistentRequestCache=new _.e({dataSourceName:"RecentFilesGraphDataSource",id:"RecentFilesGraphDataSource"},{pageContext:n}),this._graphQLService=new m({},{vroomDataRequestor:null!=i?i:L(Object(a.__assign)({pageContext:n},r))})}return e.prototype.getRecentFiles=function(e){var t=this,n=e.webAbsoluteUrl,a=e.maxItems,i=e.cachingStrategy,r=e.returnStatistics,o=e.cacheTimeoutTime,s=e.qosName,c=e.cacheRequestKey;return this._persistentRequestCache.getDataUtilizingCache({cachingStrategy:i,cacheRequestKey:c,cacheTimeoutTime:null!=o?o:864e5,returnStatistics:r,getData:function(){return t._graphQLService.request({qosName:null!=s?s:"RecentFilesGraph",webAbsoluteUrl:n,requestBody:"{ me { recent { remoteItem { name webUrl webDavUrl parentReference { driveType } package { type } sharepointIds { siteUrl } fileSystemInfo { lastAccessedDateTime } createdBy { user { displayName } } } } } }"})}}).then(function(e){return t._parseFilesResponse(e,r,a)})},e}(),M=n("PltX"),P=n("jxDT"),T=n("Tqto"),U=function(){function e(e,t){this._dataRequestor=t.vroomDataRequestor,this._commonHeaders={Caller:e.caller,scenario:e.scenario}}return e.prototype.getNewsFeed=function(e){var t,n=e.webAbsoluteUrl,i=e.expandClause,r=e.language,o=e.section,s=e.qosName;return Object(a.__awaiter)(this,void 0,p.Promise,function(){var e,c,d;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return e="".concat(n,"/_api/v2.1/getNewsFeed?preferredLanguage=").concat(r,"&section=").concat(o).concat(i?"&"+i:""),c=this._commonHeaders,[4,this._dataRequestor.send({apiName:null!=s?s:"vroomGetNewsFeed",path:e,requestType:"GET",headers:c,allowCookies:!0,apiVersion:"v2.1",endpoint:n})];case 1:return d=a.sent(),[2,null!==(t=null==d?void 0:d.value)&&void 0!==t?t:[]]}})})},e}(),F=function(){function e(e,t){var n=e.caller,i=e.scenario,r=t.pageContext,o=t.vroomDataRequestor,s=t.getVroomDataRequestorParams;this._persistentRequestCache=new _.e({dataSourceName:"NewsFeedDataSource",id:"NewsFeed"},{pageContext:r}),this._newsFeedService=new U({caller:n,scenario:i},{vroomDataRequestor:null!=o?o:L(Object(a.__assign)({pageContext:r},s))})}return e.prototype.getNewsFeed=function(e){var t=this,n=e.cacheRequestKey,a=e.cachingStrategy,i=e.cacheTimeoutTime,r=e.returnStatistics,o=e.webAbsoluteUrl,s=e.language,c=e.section,d=e.expandClause,l=e.qosName;return this._persistentRequestCache.getDataUtilizingCache({cachingStrategy:a,cacheRequestKey:n,cacheTimeoutTime:i,returnStatistics:r,getData:function(){return t._newsFeedService.getNewsFeed({webAbsoluteUrl:o,language:s,section:c,expandClause:d,qosName:l})}})},e}(),H=function(){function e(e,t){this._dataRequestor=t.vroomDataRequestor,this._commonHeaders={Caller:e.caller}}return e.prototype.getFrequentSites=function(e){var t,n=e.webAbsoluteUrl,i=e.top,r=e.qosName;return Object(a.__awaiter)(this,void 0,p.Promise,function(){var e,o,s;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return e="".concat(n,"/_api/v2.1/insights/frequentSites?$top=").concat(i),o=this._commonHeaders,[4,this._dataRequestor.send({apiName:null!=r?r:"vroomGetFrequentSites",path:e,requestType:"GET",headers:o,allowCookies:!0,apiVersion:"v2.1",endpoint:n})];case 1:return s=a.sent(),[2,null!==(t=null==s?void 0:s.value)&&void 0!==t?t:[]]}})})},e.prototype.getRecentSites=function(e){var t,n=e.webAbsoluteUrl,i=e.top,r=e.qosName;return Object(a.__awaiter)(this,void 0,p.Promise,function(){var e,o,s;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return e="".concat(n,"/_api/v2.1/insights/recentSites?$top=").concat(i),o=this._commonHeaders,[4,this._dataRequestor.send({apiName:null!=r?r:"vroomGetRecentSites",path:e,requestType:"GET",headers:o,allowCookies:!0,apiVersion:"v2.1",endpoint:n})];case 1:return s=a.sent(),[2,null!==(t=null==s?void 0:s.value)&&void 0!==t?t:[]]}})})},e.prototype.getFollowedSites=function(e){var t,n=e.webAbsoluteUrl,i=e.top,r=e.qosName;return Object(a.__awaiter)(this,void 0,p.Promise,function(){var e,o,s,c;return Object(a.__generator)(this,function(d){switch(d.label){case 0:e="".concat(n,"/_api/v2.1/favorites/followedSites?$top=").concat(i),o=Object(a.__assign)(Object(a.__assign)({},this._commonHeaders),{Prefer:"fillSiteCount=".concat(i)}),d.label=1;case 1:return d.trys.push([1,3,,4]),[4,this._dataRequestor.send({apiName:null!=r?r:"vroomGetFollowedSites",path:e,requestType:"GET",headers:o,allowCookies:!0,apiVersion:"v2.1",endpoint:n,expectedErrors:[{code:"generalException",message:"Social list is not available"}]})];case 2:return s=d.sent(),[2,null!==(t=null==s?void 0:s.value)&&void 0!==t?t:[]];case 3:return"Social list is not available"===(null==(c=d.sent())?void 0:c.message)?[2,[]]:[3,4];case 4:return[2]}})})},e}(),R=function(){function e(e,t){var n=e.caller,i=t.pageContext,r=t.vroomDataRequestor,o=t.getVroomDataRequestorParams;this._persistentRequestCache=new _.e({dataSourceName:"SitesDataSource",id:"Sites"},{pageContext:i}),this._sitesService=new H({caller:n},{vroomDataRequestor:null!=r?r:L(Object(a.__assign)({pageContext:i},o))})}return e.prototype.getFollowedSites=function(e){var t=this,n=e.cacheRequestKey,a=e.cachingStrategy,i=e.cacheTimeoutTime,r=e.returnStatistics,o=e.webAbsoluteUrl,s=e.top,c=e.qosName;return this._persistentRequestCache.getDataUtilizingCache({cachingStrategy:a,cacheRequestKey:n,cacheTimeoutTime:i,returnStatistics:r,getData:function(){return t._sitesService.getFollowedSites({webAbsoluteUrl:o,top:s,qosName:c})}})},e.prototype.getRecentSites=function(e){var t=this,n=e.cacheRequestKey,a=e.cachingStrategy,i=e.cacheTimeoutTime,r=e.returnStatistics,o=e.webAbsoluteUrl,s=e.top;return this._persistentRequestCache.getDataUtilizingCache({cachingStrategy:a,cacheRequestKey:n,cacheTimeoutTime:i,returnStatistics:r,getData:function(){return t._sitesService.getRecentSites({webAbsoluteUrl:o,top:s})}})},e.prototype.getFrequentSites=function(e){var t=this,n=e.cacheRequestKey,a=e.cachingStrategy,i=e.cacheTimeoutTime,r=e.returnStatistics,o=e.webAbsoluteUrl,s=e.top;return this._persistentRequestCache.getDataUtilizingCache({cachingStrategy:a,cacheRequestKey:n,cacheTimeoutTime:i,returnStatistics:r,getData:function(){return t._sitesService.getFrequentSites({webAbsoluteUrl:o,top:s})}})},e}();function N(e){return function(e){return!!e&&"object"==typeof e&&"default"in e}(e)?e.default:e}var B=i.lazy(function(){return Promise.all([n.e(0),n.e(24),n.e(6)]).then(n.bind(null,"cvwl"))}),j=i.lazy(function(){return Promise.all([n.e(0),n.e(3),n.e(8)]).then(n.bind(null,"C8/4"))}),V=i.lazy(function(){return Promise.all([n.e(0),n.e(3)]).then(n.bind(null,"kaTZ"))}),z=i.lazy(function(){return Promise.all([n.e(0),n.e(2),n.e(9)]).then(n.bind(null,"q9Gl"))}),G=i.lazy(function(){return Promise.all([n.e(0),n.e(2),n.e(10)]).then(n.bind(null,"5W9z"))}),K=i.lazy(function(){return Promise.all([n.e(0),n.e(4),n.e(11)]).then(n.bind(null,"59bo"))}),W=i.lazy(function(){return Promise.all([n.e(0),n.e(4)]).then(n.bind(null,"TDhT"))}),q=i.lazy(function(){return Promise.all([n.e(0),n.e(12)]).then(n.bind(null,"ndIK"))}),Q=i.lazy(function(){return Promise.all([n.e(0),n.e(13)]).then(n.bind(null,"E460"))}),Y=i.lazy(function(){return Promise.all([n.e(0),n.e(1),n.e(16)]).then(n.bind(null,"Ib2S"))}),J=i.lazy(function(){return Promise.all([n.e(0),n.e(1),n.e(17)]).then(n.bind(null,"4kUe"))}),X=i.lazy(function(){return Promise.all([n.e(0),n.e(1)]).then(n.bind(null,"ePbC"))}),Z=i.lazy(function(){return n.e(15).then(n.bind(null,"Tn2r"))}),$=i.lazy(function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(18)]).then(n.bind(null,"AcXC"))}),ee=function(e){function t(t){var i,r,s=this;(s=e.call(this,t)||this).componentData={},s._tokenRefreshTimer=0,s._tokenRefreshAsync=new p.Async,s._initializedIcons=!1,s._isMultipleHomeSitesGlobalNavFeatureEnabled=o.t(),s._useNewSitesDataSource=o.r(),s._isSPAppBarIFrameCleanupFeatureEnabled=o.a(),s._initializeFileTypeIcons=function(){n.e(19).then(n.bind(null,"20kd")).then(N).then(function(e){s._initializedIcons=!0,e.initializeFileTypeIcons()})},s._isTokenExpired=function(e){return!(null==e?void 0:e.Token)||s._getExpirationTimeLeft(e.Token)<=0},s._getExpirationTimeLeft=function(e){return s._spHomeDataSource.isMicroserviceToken(e)?1e3*parseInt(e.expires_on,10)-Date.now():1e3*parseInt(e.ExpiresOn,10)-Date.now()},s._clearClientContext=function(){s.state.clientContext||void 0===s.state.clientContext||s.setState({clientContext:void 0})},s._setTimeoutAndGetHomeContext=function(e){e>0&&(s._tokenRefreshTimer=s._tokenRefreshAsync.setTimeout(function(){s._spHomeDataSource.getHomeContext().then(function(e){s._checkAndSetContext(e)}).catch(function(){s._clearClientContext()})},e))},s._checkAndSetContext=function(e,t){if(e.Token){var n=e.Token,a=s._getExpirationTimeLeft(n);a>=3e4&&(t||s.setState({clientContext:e}),s._setTimeoutAndGetHomeContext(a-3e4))}else s._clearClientContext()},s._shouldPrewarm=function(e){return!s._hasGottenFreshData&&("blank"===e.workload&&"blank"!==s.state.workload||"teams"===s.state.workload)},s._handleWorkloadMessages=function(e){if(e.origin===s._windowOrigin&&e.data&&e.data.type)if("spAppBarWorkload"===e.data.type)if(s._isSPAppBarIFrameCleanupFeatureEnabled)s.setState({workload:e.data.payload});else{var t=Object(d.n)("workload",e.data.payload);s.setState({workload:t})}else if("setRTL"===e.data.type){var n=e.data.isRTL?"rtl":"ltr";document.documentElement.setAttribute("dir",n)}else"spAppBarWorkloadBlank"===e.data.type&&s.setState({workload:"blank"})},s._messageParentAppStarted=function(){window.postMessage({type:"spAppBarPanelStarted"},s._windowOrigin)},s._setUpAndPrewarm=function(e){s._useNewSitesDataSource||s._fetchTokenIfExpired(),s._hasGottenFreshData=!0,s._prewarmDataClick(e)},s._fetchTokenIfExpired=function(){s._isTokenExpired(s.state.clientContext)&&s._spHomeDataSource.getHomeContext().then(function(e){s._tokenRefreshTimer&&s._tokenRefreshAsync.clearTimeout(s._tokenRefreshTimer),s._checkAndSetContext(e)}).catch(function(){s._clearClientContext()})},s._prewarmDataClick=function(e){n.e(7).then(n.bind(null,"0eCT")).then(N).then(function(t){var n,a;"files"!==e&&(t.logData({name:"SPAppBar.Files.DataClick"}),s._getFilesNetwork()),s._isMultipleHomeSitesGlobalNavFeatureEnabled?"globalnav"!==e&&s._pageContext.isHomeSiteEnabled&&new P.e(s._pageContext).invokeWithAffinityHomeSite(function(e){e&&Object(T.e)(s._pageContext,e.SiteId)&&(p.Engagement.logData({name:"SPAppBar.GlobalNav.DataClick"}),s._globalnavDataSource.getGlobalNav(!1).catch())}):"globalnav"!==e&&(null===(n=s._pageContext.appBarParams)||void 0===n?void 0:n.isGlobalNavEnabled)&&(null===(a=s._pageContext.companyPortalReference)||void 0===a?void 0:a.SiteId)&&(p.Engagement.logData({name:"SPAppBar.GlobalNav.DataClick"}),s._globalnavDataSource.getGlobalNav(!1).catch()),"news"!==e&&(t.logData({name:"SPAppBar.News.DataClick"}),Object(c.f)(s._newsFeedDataSource,s._pageContext.webAbsoluteUrl).then(function(e){s.receivedNewData(e,"news")}).catch()),"sites"!==e&&(s._useNewSitesDataSource?(t.logData({name:"SPAppBar.Frequent.DataClick"}),Object(c.u)(s._sitesDataSource,s._pageContext.webAbsoluteUrl).then(function(e){s.receivedNewData(e,"frequentSites")}),t.logData({name:"SPAppBar.Recent.DataClick"}),Object(c._)(s._sitesDataSource,s._pageContext.webAbsoluteUrl).then(function(e){s.receivedNewData(e,"recentSites")}),t.logData({name:"SPAppBar.Followed.DataClick"}),Object(c.l)(s._sitesDataSource,s._pageContext.webAbsoluteUrl).then(function(e){s.receivedNewData(e,"followedSites")})):(t.logData({name:"SPAppBar.Frequent.DataClick"}),s._getSPHomeNetwork(s._spHomeDataSource.getFrequentSites.bind(s._spHomeDataSource),c.c,c.a,"frequentSites"),t.logData({name:"SPAppBar.Followed.DataClick"}),s._getSPHomeNetwork(s._spHomeDataSource.getFollowedSites.bind(s._spHomeDataSource),c.c,c.n,"followedSites"),t.logData({name:"SPAppBar.Recent.DataClick"}),s._getSPHomeNetwork(s._spHomeDataSource.getRecentSites.bind(s._spHomeDataSource),c.c,c.s,"recentSites"))),"lists"!==e&&(p.Engagement.logData({name:"SPAppBar.Lists.Recent.DataClick"}),s._getRecentListsNetwork(),p.Engagement.logData({name:"SPAppBar.Lists.Favorite.DataClick"}),s._getFavoriteListsNetwork())})},s._getFilesNetwork=function(){Object(c.m)(s._recentFilesDataSource,s._pageContext.webAbsoluteUrl).then(function(e){s.receivedNewData(e,"files")}).catch()},s._getRecentListsNetwork=function(){s._sharePointDataSource.getRecentLists({cachingStrategy:l.e.useCacheAndUpdateInTheBackground,cacheTimeoutTime:c.i,returnStatistics:!0}).then(function(e){s.receivedNewData(e,"recentLists")}).catch()},s._getFavoriteListsNetwork=function(){s._sharePointDataSource.getFavoriteLists({cachingStrategy:l.e.useCacheAndUpdateInTheBackground,cacheTimeoutTime:c.i,returnStatistics:!0}).then(function(e){s.receivedNewData(e,"favoriteLists")}).catch()},s._getSPHomeNetwork=function(e,t,n,a){var i=s.state.cachedData&&s.state.cachedData.find(function(e){return e.Key===n}),r=null;if(i&&s.state.clientContext?r=e({cachingStrategy:l.e.useCacheIfNotExpired,spHomeCachedItem:i.Value,spHomeClientContext:s.state.clientContext,returnStatistics:!0,cacheTimeoutTime:t}):s.state.clientContext&&s.state.clientContext.Token&&(r=e({cachingStrategy:l.e.useCacheIfNotExpired,spHomeCachedItem:{cacheContext:null,cacheValue:""},spHomeClientContext:s.state.clientContext,returnStatistics:!0,cacheTimeoutTime:t})),r){switch(a){case"frequentSites":s._needsFrequentSitesData=!1;break;case"followedSites":s._needsFollowedSitesData=!1;break;case"recentSites":s._needsRecentSitesData=!1}r.then(function(e){s.receivedNewData(e,a)})}else switch(a){case"frequentSites":s._needsFrequentSitesData=!1;break;case"followedSites":s._needsFollowedSitesData=!1;break;case"recentSites":s._needsRecentSitesData=!1}};var m=s._isSPAppBarIFrameCleanupFeatureEnabled?Object(d.n)("workload",t.query):t.workload;s.state={workload:m,cachedData:void 0,clientContext:void 0},s._pageContext=null!==(i=s.props.spPageContextInfo)&&void 0!==i?i:window._spPageContextInfo,s._windowOrigin=window.location.origin,s._spHomeDataSource=new M.e(s._pageContext),s._globalnavDataSource=new u.e(s._pageContext),s._sharePointDataSource=new f.e(s._pageContext);var _=null!==(r=t.vroomDataRequestor)&&void 0!==r?r:L({pageContext:s._pageContext,getToken:function(e){return Object(a.__awaiter)(s,void 0,void 0,function(){var n,i,r;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,null===(r=null===(i=t.tokenProvider)||void 0===i?void 0:i.getAuthToken)||void 0===r?void 0:r.call(i,{url:e})];case 1:if("string"==typeof(n=a.sent()))return[2,{accessToken:n}];if(n&&n.authToken)return[2,{accessToken:n.authToken,tokenExpiry:n.expiresOn,correlationId:n.correlationId}];throw new Error("Could not create vroom data requestor")}})})},cookieOrigin:window.location.origin});return s._recentFilesDataSource=new k({},{pageContext:s._pageContext,vroomDataRequestor:_}),s._newsFeedDataSource=new F({scenario:"SharePointAppBar",caller:"WebAppBar"},{pageContext:s._pageContext,vroomDataRequestor:_}),s._sitesDataSource=new R({caller:"WebAppBar"},{pageContext:s._pageContext,vroomDataRequestor:_}),s.receivedNewData=c.I.bind(s),s}return Object(a.__extends)(t,e),t.prototype.componentDidUpdate=function(e,t){!t.clientContext&&this.state.clientContext&&(this._needsFrequentSitesData&&this._getSPHomeNetwork(this._spHomeDataSource.getFrequentSites.bind(this._spHomeDataSource),c.c,c.a,"frequentSites"),this._needsFollowedSitesData&&this._getSPHomeNetwork(this._spHomeDataSource.getFollowedSites.bind(this._spHomeDataSource),c.c,c.n,"followedSites"),this._needsRecentSitesData&&this._getSPHomeNetwork(this._spHomeDataSource.getRecentSites.bind(this._spHomeDataSource),c.c,c.s,"recentSites")),this._useNewSitesDataSource||this._fetchTokenIfExpired(),this._shouldPrewarm(t)&&this._setUpAndPrewarm(this.state.workload)},t.prototype.componentDidMount=function(){window.addEventListener("message",this._handleWorkloadMessages),this._messageParentAppStarted(),"blank"!==this.state.workload&&this._setUpAndPrewarm(this.state.workload)},t.prototype.componentWillUnmount=function(){window.removeEventListener("message",this._handleWorkloadMessages)},t.prototype.render=function(){var e=null,t={useRouterNavigation:!1,pageContext:this._pageContext,onDismissAppBarPanel:this.props.onDismissAppBarPanel};switch(this.state.workload){case"globalnav":e=this.componentData.globalnav?i.createElement(G,Object(a.__assign)({rawNavData:this.componentData.globalnav},t)):i.createElement(z,Object(a.__assign)({},t,{sendUpdatedDataToParent:this.receivedNewData,cachedData:this.state.cachedData}));break;case"sites":if(this.componentData.frequentSites&&this.componentData.followedSites&&this.componentData.recentSites)if(this._useNewSitesDataSource){var n=this.componentData.frequentSites,r=this.componentData.followedSites,o=this.componentData.recentSites;if(Object(c.b)(n.cacheStats.lastModified,c.c)&&Object(c.b)(r.cacheStats.lastModified,c.c)&&Object(c.b)(o.cacheStats.lastModified,c.c)){var s=!1;e=i.createElement(X,Object(a.__assign)({},t,{frequentSites:Object(c.S)(n.data||[]),followedSites:Object(c.S)(r.data||[]),recentSites:Object(c.S)(o.data||[]),hideFrequentSites:s,countToRender:Object(d.e)(window.innerHeight,!1)}))}else e=i.createElement(Y,Object(a.__assign)({},t,{sitesDataSource:this._sitesDataSource,sendUpdatedDataToParent:this.receivedNewData,clientContext:this.state.clientContext,cachedData:this.state.cachedData,countToRender:Object(d.e)(window.innerHeight,!1)}))}else n=this.componentData.frequentSites,r=this.componentData.followedSites,o=this.componentData.recentSites,Object(c.b)(n.cacheStats.lastModified,c.c)&&Object(c.b)(r.cacheStats.lastModified,c.c)?(s=!1,e=i.createElement(X,Object(a.__assign)({},t,{frequentSites:Object(c.D)(n.data),followedSites:Object(c.D)(r.data),recentSites:Object(c.D)(o.data),hideFrequentSites:s,countToRender:Object(d.e)(window.innerHeight,!1)}))):e=i.createElement(J,Object(a.__assign)({},t,{sendUpdatedDataToParent:this.receivedNewData,clientContext:this.state.clientContext,cachedData:this.state.cachedData,countToRender:Object(d.e)(window.innerHeight,!1)}));else e=this._useNewSitesDataSource?i.createElement(Y,Object(a.__assign)({},t,{sitesDataSource:this._sitesDataSource,sendUpdatedDataToParent:this.receivedNewData,cachedData:this.state.cachedData,countToRender:Object(d.e)(window.innerHeight,!1)})):i.createElement(J,Object(a.__assign)({},t,{sendUpdatedDataToParent:this.receivedNewData,clientContext:this.state.clientContext,cachedData:this.state.cachedData,countToRender:Object(d.e)(window.innerHeight,!1)}));break;case"news":if(this.componentData.news){var l=this.componentData.news;e=Object(c.b)(l.cacheStats.lastModified,c.o)?i.createElement(Q,Object(a.__assign)({},t,{news:Object(c.y)(l.data),countToRender:Object(d.e)(window.innerHeight,!0)})):i.createElement(q,Object(a.__assign)({},t,{newsFeedDataSource:this._newsFeedDataSource,sendUpdatedDataToParent:this.receivedNewData,clientContext:this.state.clientContext,cachedData:this.state.cachedData,countToRender:Object(d.e)(window.innerHeight,!0)}))}else e=i.createElement(q,Object(a.__assign)({},t,{newsFeedDataSource:this._newsFeedDataSource,sendUpdatedDataToParent:this.receivedNewData,clientContext:this.state.clientContext,cachedData:this.state.cachedData,countToRender:Object(d.e)(window.innerHeight,!0)}));break;case"files":if(this.componentData.files){this._initializedIcons||this._initializeFileTypeIcons();var u=this.componentData.files;e=Object(c.b)(u.cacheStats.lastModified,c.t)?i.createElement(V,Object(a.__assign)({},t,{files:u.data,countToRender:Object(d.e)(window.innerHeight,!0)})):i.createElement(j,Object(a.__assign)({},t,{recentFilesDataSource:this._recentFilesDataSource,clientContext:this.state.clientContext,cachedData:this.state.cachedData,countToRender:Object(d.e)(window.innerHeight,!0)}))}else this._initializedIcons||this._initializeFileTypeIcons(),e=i.createElement(j,Object(a.__assign)({},t,{recentFilesDataSource:this._recentFilesDataSource,clientContext:this.state.clientContext,cachedData:this.state.cachedData,countToRender:Object(d.e)(window.innerHeight,!0)}));break;case"teams":e=i.createElement($,{sitesDataSource:this._sitesDataSource,newsFeedDataSource:this._newsFeedDataSource,useRouterNavigation:!0,clientContext:this.state.clientContext,cachedData:this.state.cachedData,pageContext:this._pageContext});break;case"create":this._initializedIcons||this._initializeFileTypeIcons(),e=this.props.tokenProvider?i.createElement(B,Object(a.__assign)({},t,{tokenProvider:this.props.tokenProvider})):null;break;case"lists":if(this.componentData.recentLists&&this.componentData.favoriteLists){var f=this.componentData.recentLists,p=this.componentData.favoriteLists;e=Object(c.b)(f.cacheStats.lastModified,c.i)&&Object(c.b)(p.cacheStats.lastModified,c.i)?i.createElement(W,Object(a.__assign)({},t,{recentLists:f.data,favoriteLists:p.data,countToRender:Object(d.e)(window.innerHeight,!1,"lists")})):i.createElement(K,Object(a.__assign)({},t,{sendUpdatedDataToParent:this.receivedNewData,clientContext:this.state.clientContext,cachedData:this.state.cachedData,countToRender:Object(d.e)(window.innerHeight,!1,"lists")}))}else e=i.createElement(K,Object(a.__assign)({},t,{sendUpdatedDataToParent:this.receivedNewData,clientContext:this.state.clientContext,cachedData:this.state.cachedData,countToRender:Object(d.e)(window.innerHeight,!1,"lists")}));break;default:e=null}return e?i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(Z,{content:i.createElement(i.Suspense,{fallback:i.createElement("div",null)},e)})):i.createElement(i.Fragment,null)},t}(i.PureComponent),te=n("KL1q"),ne="blank",ae="/_layouts/15/spappbar.aspx?workload=".concat(ne),ie=i.createContext([!1,function(){}]),re=function(e){function t(t){var n=e.call(this,t)||this;return n._isMobileEdgeFixKSActivated=r.i(),n._isSPAppBarIFrameCleanupFeatureEnabled=o.a(),n._preventDismissOnEvent=function(e){var t;return null!==(t=n.state.preventDismissal)&&void 0!==t&&t},n._onErrorBoundary=function(e,t){e&&n._qos&&n._qos.end({resultType:p.ResultTypeEnum.Failure,error:e.message,extraData:{errorInfo:t}})},n._handleEventFromAppBar=function(e){e.origin===window.location.origin&&e.data&&e.data.type&&("spAppBarWorkload"===e.data.type?n._isSPAppBarIFrameCleanupFeatureEnabled?e.data.payload!==n.state.workload?n.setState({showAppBarCallout:!0,workload:e.data.payload}):n.state.showAppBarCallout||(n.state.firstClose?n.setState({firstClose:!1}):n.setState({showAppBarCallout:!0,workload:e.data.payload})):e.data.payload!==n.state.appbarQueryString?n.setState({showAppBarCallout:!0,appbarQueryString:e.data.payload}):n.state.showAppBarCallout||(n.state.firstClose?n.setState({firstClose:!1}):n.setState({showAppBarCallout:!0,appbarQueryString:e.data.payload})):"CLOSE_CALLOUT"!==e.data.type&&"spAppBarCreateSite"!==e.data.type||n.state.showAppBarCallout&&n.setState({showAppBarCallout:!1}))},n._dismissAppBarPanel=function(e){if(n.state.showAppBarCallout&&(!e||!e.target||"sp-appBar-link"!==e.target.className)){if("focus"===(null==e?void 0:e.type))return;n.setState({showAppBarCallout:!1}),window.postMessage({type:"CLOSE_CALLOUT"},window.location.origin),window.postMessage({type:"spAppBarWorkloadBlank"},window.location.origin)}},window.addEventListener("message",n._handleEventFromAppBar),n.state={showAppBarCallout:!1,appbarQueryString:ae,workload:ne,firstClose:!1,preventDismissal:!1},n}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){this._qos=new p.Qos({name:"SPAppBar.Callout.Render"})},t.prototype.render=function(){var e=this,t=document.getElementById("sp-appBar");if(!t)return null;var n=t.classList.contains("sp-appBar-mobile"),a={root:{height:"100%",display:"flex",flexDirection:"column",minWidth:n?this._isMobileEdgeFixKSActivated?"100vw":"100%":"320px",maxWidth:n?"unset":"320px",borderRadius:0,boxShadow:"10px 5.4px 14.4px -10px rgb(0 0 0 / 13%), 10px 0.2px 3.6px -10px rgb(0 0 0 / 11%)",animation:"none",bottom:"0px !important"},container:{height:"100%",zIndex:11,minWidth:!this._isMobileEdgeFixKSActivated&&this.state.showAppBarCallout&&n?"100%":"unset"},calloutMain:{display:"flex",flexDirection:"column",height:"100%",borderRadius:0},beak:{height:"97%"},beakCurtain:{height:"96%"}},r=i.createElement(ie.Provider,{value:[this.state.preventDismissal,function(t){return e.setState({preventDismissal:t})}]},i.createElement(te.Callout,{className:"spappbar-callout",id:"sp-appBar-callout",gapSpace:0,target:".sp-appBar",isBeakVisible:!1,directionalHint:te.DirectionalHint.topCenter,setInitialFocus:!0,styles:a,doNotLayer:!0,minPagePadding:-1,hidden:!this.state.showAppBarCallout,onDismiss:this._dismissAppBarPanel,shouldUpdateWhenHidden:!0,dismissOnTargetClick:!0,preventDismissOnEvent:this._preventDismissOnEvent,role:"dialog"},i.createElement(ee,{query:this.state.appbarQueryString,workload:this.state.workload,onDismissAppBarPanel:this._dismissAppBarPanel,spPageContextInfo:this.props.spPageContextInfo,tokenProvider:this.props.tokenProvider,vroomDataRequestor:this.props.vroomDataRequestor})));return i.createElement(s,{onError:this._onErrorBoundary},r)},t}(i.Component);t.default=re},"O/6m":function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n("17wl"),i=function(e){void 0===e&&(e={});var t=new Error(e.message||e.innerError&&e.innerError.message);for(var n in this.message=t.message,this.innerError=e.innerError,this.stack=t.stack,this.name=t.name,this)Object.prototype.hasOwnProperty.call(this,n)&&(t[n]=this[n]);var a=Object.getPrototypeOf(this);if(Error.captureStackTrace&&Error.captureStackTrace(t,a),Object.setPrototypeOf)return Object.setPrototypeOf(t,a),t};Object.setPrototypeOf&&(i.prototype=Object.create(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf(i,Error));var r=function(e){function t(t){var n=e.call(this,t)||this;n.name="ApiError";var i=t.innerError,r=t.wrapErrorCode,o=i||void 0,s=o?Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},"string"==typeof o.correlationId?{correlationId:o.correlationId}:{}),"boolean"==typeof o.isExpected?{isExpected:o.isExpected}:{}),"string"==typeof o.name?{code:o.name}:{}),"string"==typeof o.code?{code:o.code}:{}),"object"==typeof o.extraData?{extraData:o.extraData}:{}):{},c=t.correlationId,d=void 0===c?s.correlationId:c,l=t.isExpected,u=void 0===l?s.isExpected:l,f=t.extraData;return n.correlationId=d,n.isExpected=!!u,n.code=r&&s.code&&t.code&&"".concat(t.code," (").concat(s.code,")")||t.code||s.code||"",n.extraData=Object(a.__assign)(Object(a.__assign)({},s.extraData||{}),f||{}),n}return Object(a.__extends)(t,e),t}(i)},PltX:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n("17wl"),i=n("1tKF"),r=n("w0LS"),o=n("K9kD"),s=function(e){function t(t){var n=e.call(this,{dataSourceName:"SPHomeDataSource",id:"SPHomeDataSource"},{pageContext:t})||this;return n.isMicroserviceToken=function(e){return!!e.access_token},n._isDataSourceParam=function(e){return!!e.spHomeClientContext},n._spHomeCacheKey="spHome"+"_".concat(t.aadUserId),n}return Object(a.__extends)(t,e),t.prototype.getFrequentSites=function(e,t,n,a,i,o,s,c){var d,l;if(void 0===n&&(n=!0),this._isDataSourceParam(e)){var u=e;d=u.spHomeClientContext,t=u.spHomeCachedItem,o=u.returnStatistics,s=u.cachingStrategy,c=u.cacheTimeoutTime}else d=e,s=r.e.useCacheAndUpdateInTheBackground,a?s=r.e.bypassCache:i&&(s=r.e.onlyCache);return l=(null==d?void 0:d.Urls)&&d.Urls[0]?"".concat(d.Urls[0],"/api/v1/sites/feed?start=0&count=30&acronyms=true"):"",this.getSPHomeData({spHomeClientContext:d,spHomeSitesCachedData:t,url:l,qosName:"spAppBarGetFrequentSites",cacheRequestKey:this._spHomeCacheKey+"frequentSites",returnStatistics:!!o,cachingStrategy:s,cacheTimeoutTime:c})},t.prototype.getFollowedSites=function(e,t,n,a,i,o,s,c){var d,l;if(void 0===n&&(n=!0),this._isDataSourceParam(e)){var u=e;d=u.spHomeClientContext,t=u.spHomeCachedItem,o=u.returnStatistics,s=u.cachingStrategy,c=u.cacheTimeoutTime}else d=e,s=r.e.useCacheAndUpdateInTheBackground,a?s=r.e.bypassCache:i&&(s=r.e.onlyCache);return l=(null==d?void 0:d.Urls)&&d.Urls[0]?"".concat(d.Urls[0],"/api/v1/sites/followed?mostRecentFirst=true&start=0&count=30&fillSiteData=true&fillSiteCount=10"):"",this.getSPHomeData({spHomeClientContext:d,spHomeSitesCachedData:t,url:l,qosName:"spAppBarGetFollowedSites",cacheRequestKey:this._spHomeCacheKey+"followedSites",returnStatistics:!!o,cachingStrategy:s,cacheTimeoutTime:c})},t.prototype.getRecentSites=function(e,t,n,a,i,o,s,c){var d,l;if(void 0===n&&(n=!0),this._isDataSourceParam(e)){var u=e;d=u.spHomeClientContext,t=u.spHomeCachedItem,o=u.returnStatistics,s=u.cachingStrategy,c=u.cacheTimeoutTime}else d=e,s=r.e.useCacheAndUpdateInTheBackground,a?s=r.e.bypassCache:i&&(s=r.e.onlyCache);return l=(null==d?void 0:d.Urls)&&d.Urls[0]?"".concat(d.Urls[0],"/api/v1/sites/recent?mostRecentFirst=true&start=0&count=30&fillSiteData=true&fillSiteCount=10"):"",this.getSPHomeData({spHomeClientContext:d,spHomeSitesCachedData:t,url:l,qosName:"spAppBarGetRecentSites",cacheRequestKey:this._spHomeCacheKey+"recentSites",returnStatistics:!!o,cachingStrategy:s,cacheTimeoutTime:c})},t.prototype.getHomeContext=function(){var e={url:"".concat(this._pageContext.webAbsoluteUrl,"/_api/sphomeservice/context?$expand=Token,Payload"),qosName:"spAppBarGetSPHomeToken",method:"GET",additionalHeaders:{accept:"application/json","SPHome-ClientType":"WebAppBar","Service-Worker-Navigation-Preload":"true"},cachingStrategy:r.e.bypassCache,cacheRequestKey:this._spHomeCacheKey+"token"};return this.getDataUtilizingPersistentCache(e)},t.prototype.shouldShowPostNewsTip=function(){return this.getDataUtilizingPersistentCache({url:"".concat(this._pageContext.webAbsoluteUrl,"/_api/sitepages/pages/feed?promotedstate=2&published=true&$top=3"),qosName:"GetFeedCount",method:"GET",cachingStrategy:r.e.bypassCache,parseResponse:function(e){var t,n;try{var a=JSON.parse(e);return(null===(n=null===(t=null==a?void 0:a.d)||void 0===t?void 0:t.results)||void 0===n?void 0:n.length)<2}catch(e){return!0}}})},t.prototype.getSPHomeData=function(e){var t=e.cachingStrategy,n={url:e.url,qosName:e.qosName,method:"GET",additionalHeaders:{"sphome-apicontext":e.spHomeClientContext.Payload,"sphome-cachecontext":e.spHomeSitesCachedData.cacheContext,"sphome-clienttype":"WebAppBar"},cacheRequestKey:e.cacheRequestKey,cachingStrategy:t,returnStatistics:e.returnStatistics},a=e.spHomeClientContext.Token;return a&&(this.isMicroserviceToken(a)?n.authToken=a.access_token:n.authToken=a.AccessToken),e.url&&0!==e.url.length||(n.getData=function(){return o.Promise.resolve()}),e.cacheTimeoutTime&&(n.cacheTimeoutTime=e.cacheTimeoutTime),this.getDataUtilizingPersistentCache(n)},t}(i.e)},"Q+Pn":function(e,t,n){"use strict";n.d(t,"r",function(){return i}),n.d(t,"o",function(){return r}),n.d(t,"s",function(){return o}),n.d(t,"i",function(){return s}),n.d(t,"n",function(){return c}),n.d(t,"a",function(){return d}),n.d(t,"c",function(){return l}),n.d(t,"e",function(){return u}),n.d(t,"t",function(){return f});var a=n("K9kD");function i(){return a.Killswitch.isActivated("12CAD4FC-9A1B-4B23-BB68-29EA398076DB","11/18/2021","populate followed sites from recent")}function r(){return a.Killswitch.isActivated("F063D9B0-7F69-418B-BF7C-A21F8690E273","03/11/2022","respect link target in app bar global nav")}function o(){return a.Killswitch.isActivated("E096F969-65F3-40C4-8FEB-36ADDC85C221","04/28/2022","send news data to parent")}function s(){return a.Killswitch.isActivated("7AB73E58-6A5C-4A5E-9B95-F644D41184BF","05/02/2022","Fix for cutoff app bar panel on iOS Edge")}function c(){return a.Killswitch.isActivated("26ECA8D5-6BF9-4A63-99FC-9BFD1386E75A","06/30/2022","fix teams panel blank render")}function d(){return a.Killswitch.isActivated("F9B556AD-4880-41BF-990B-4351B8707B44","05/27/2022","Fix create doc qos")}function l(){return a.Killswitch.isActivated("247CEB82-A9DC-4F58-A495-79FF50C5BA10","05/27/2022","use auth token from host app")}function u(){return a.Killswitch.isActivated("33F85DB2-BB78-4F02-9193-84CBC8C68A9B","06/17/2022","create page via the app bar")}function f(){return a.Killswitch.isActivated("4bc17620-80a4-4e26-aa56-f9b7d9db66de","07/13/2022","Enable links clicks from app-bar panel in FileBrowser in VCD")}},X15L:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n("17wl"),i=function(e){function t(t){var n=e.call(this,{dataSourceName:"SharePointDataSource",id:"SharePointDataSource"},{pageContext:t})||this;return n._isCachedResultWithStatistic=function(e){return!!e.cacheStats},n._parseResponse=function(e,t){var i,r=!1;n._isCachedResultWithStatistic(e)?(i=e.data,r=!0):i=e;var o=t(i);return r?Object(a.__assign)(Object(a.__assign)({},e),{data:o}):o},n._cacheKey="sharepointAppBar"+"_".concat(t.aadUserId),n.pageContext=t,n}return Object(a.__extends)(t,e),t.prototype.canCreatePage=function(e){var t=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return"".concat(e.siteUrl,"/_api/sitepages/cancreatepage")},qosName:"spAppBarCanCreatePage",method:"GET",noRedirect:!0,cacheRequestKey:"".concat(this._cacheKey,"_canCreatePage_").concat(e.siteCache),cachingStrategy:e.cachingStrategy,cacheTimeoutTime:e.cacheTimeoutTime,returnStatistics:e.returnStatistics}).then(function(e){return t._parseResponse(e,function(e){return!(!e||!e.d)&&e.d.CanCreatePage})})},t.prototype.canCreatePromotedPage=function(e){var t=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return"".concat(e.siteUrl,"/_api/sitepages/cancreatepromotedpage")},qosName:"spAppBarCanCreatePromotedPage",method:"GET",noRedirect:!0,cacheRequestKey:"".concat(this._cacheKey,"_canCreatePromotedPage_").concat(e.siteCache),cachingStrategy:e.cachingStrategy,cacheTimeoutTime:e.cacheTimeoutTime,returnStatistics:e.returnStatistics}).then(function(e){return t._parseResponse(e,function(e){return!(!e||!e.d)&&e.d.CanCreatePromotedPage})})},t.prototype.getRecentLists=function(e){var t=this;return this.getDataUtilizingPersistentCache({url:"".concat(this.pageContext.webAbsoluteUrl,"/_api/sp.RecentListProxy.GetRecentListsProxy/"),qosName:"spAppBarGetRecentLists",method:"GET",noRedirect:!0,cacheRequestKey:"".concat(this._cacheKey,"_getRecentLists"),cachingStrategy:e.cachingStrategy,cacheTimeoutTime:e.cacheTimeoutTime,returnStatistics:e.returnStatistics}).then(function(e){return e?t._parseResponse(e,function(e){var t;return(null===(t=null==e?void 0:e.value)||void 0===t?void 0:t.length)>0?e.value.map(function(e){var t=e.color,n=e.icon,a=e.listId,i=e.listUrl,r=e.listTitle,o=e.siteId,s=e.siteTitle,c=e.siteUrl;return{listColor:Number(t),listIcon:Number(n),listId:a,listUrl:i,listTitle:r,siteId:o,siteTitle:s,siteUrl:c}}):[]}):[]})},t.prototype.getFavoriteLists=function(e){var t=this;return this.getDataUtilizingPersistentCache({url:"".concat(this.pageContext.webAbsoluteUrl,"/_api/SP.FavoriteLists.GetListsBy"),qosName:"spAppBarGetFavoriteLists",method:"GET",noRedirect:!0,cacheRequestKey:"".concat(this._cacheKey,"_getFavoriteLists"),cachingStrategy:e.cachingStrategy,cacheTimeoutTime:e.cacheTimeoutTime,returnStatistics:e.returnStatistics}).then(function(e){return e?t._parseResponse(e,function(e){var t,n,a;return(null===(a=null===(n=null===(t=null==e?void 0:e.d)||void 0===t?void 0:t.GetListsBy)||void 0===n?void 0:n.results)||void 0===a?void 0:a.length)>0?e.d.GetListsBy.results.map(function(e){var t=e.color,n=e.icon,a=e.listId,i=e.listUrl,r=e.title,o=e.siteId,s=e.siteTitle,c=e.siteUrl;return{listColor:Number(t),listIcon:Number(n),listId:a,listUrl:i,listTitle:r,siteId:o,siteTitle:s,siteUrl:c}}):[]}):[]}).catch(function(e){if(e&&"-1, System.NotSupportedException"===(null==e?void 0:e.code))return[]})},t.prototype.getMySiteUrl=function(e){var t=this;return this._pageContext.isAnonymousGuestUser||this._pageContext.isEmailAuthenticationGuestUser||this._pageContext.isExternalGuestUser?Promise.resolve(void 0):this.getDataUtilizingPersistentCache({url:"".concat(this.pageContext.webAbsoluteUrl,"/_api/SP.Directory.DirectorySession/me?$select=mySite"),qosName:"spAppBarGetMySiteUrl",method:"GET",noRedirect:!0,cacheRequestKey:"".concat(this._cacheKey,"_getMySiteUrl"),cachingStrategy:e.cachingStrategy,cacheTimeoutTime:e.cacheTimeoutTime,returnStatistics:e.returnStatistics}).then(function(e){if(e)return t._parseResponse(e,function(e){return(null==e?void 0:e.d)?e.d.mySite&&e.d.mySite.replace(/\/$/,""):void 0})})},t.prototype.getDefaultDocumentLibraryName=function(e){var t=e.webAbsoluteUrl,n=e.authToken,i=e.cacheTimeoutTime,r=e.cachingStrategy;return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(e){return[2,this.getDataUtilizingPersistentCache({url:"".concat(t,"/_api/web/DefaultDocumentLibrary/RootFolder/Name"),authToken:n,method:"GET",qosName:"spAppBarGetDefaultDocumentLibrary",noRedirect:!0,parseResponse:function(e){return JSON.parse(e).d.Name},cachingStrategy:r,cacheRequestKey:"".concat(this._cacheKey,"_getDefaultDocumentLibrary"),cacheTimeoutTime:i})]})})},t.prototype.createDocumentAndGetEditLink=function(e){var t=e.apiUrl,n=e.authToken;return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,this.dataRequestor.getData({method:"POST",url:t,qosName:"spAppBarCreateDocumentAndGetEditLink",authToken:n,parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})];case 1:return[2,e.sent()]}})})},t}(n("1tKF").e)},f6ry:function(e,t,n){"use strict";n.d(t,"t",function(){return a}),n.d(t,"n",function(){return i}),n.d(t,"e",function(){return r});var a=function(e,t){return e.replace("spappbarwebpack/spappbarwebpack.js","odsp-media/images/spappbar/".concat(t))},i=function(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp(e+"=([^&]*)").exec(t);return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))},r=function(e,t,n){return e<768?"lists"===n?3:t?10:5:e<1024?"lists"===n?9:t?15:10:"lists"===n?14:t?20:15}},m1i4:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n("17wl"),i=n("y88i"),r=function(){function e(e){var t=e.webAbsoluteUrl,n=e.encodeWebAbsoluteUrl,a=void 0===n||n;this._webAbsoluteUrl=t,this._encodeWebAbsoluteUrl=a,this._segments=[],this._parameters=[],this._rawParameters=[],this._lastParameterId=0}return e.prototype.toString=function(){var e,t=[];this._parameters.length&&t.push(this._parameters.map(function(e){var t=e.name,n=e.serializedValue;return"".concat(t,"=").concat(n)}).join("&")),t.push.apply(t,this._rawParameters),e=t.length?"?".concat(t.join("&")):"";var n=this._webUrl,i=void 0===n?this._webAbsoluteUrl:n,r=Object(a.__spreadArray)([this._encodeWebAbsoluteUrl?encodeURI(i):i,"_api"],this._segments,!0);return"".concat(r.join("/")).concat(e)},e.prototype.segment=function(e){return this._extend({segments:[e]})},e.prototype.segments=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._extend({segments:e})},e.prototype.methodWithAliases=function(e,t){for(var n=this,a=[],i=0,r=Object.keys(t);i<r.length;i++){var o=r[i],s=t[o],c=n._autoParameter(s);n=c.apiUrl,a.push("".concat(o,"=").concat(c.name))}return n.segment("".concat(e,"(").concat(a.join(","),")"))},e.prototype.method=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var a=this,i=[],r=0,o=t;r<o.length;r++){var s=o[r],c=a._autoParameter(s);a=c.apiUrl,i.push(c.name)}return a.segment("".concat(e,"(").concat(i.join(","),")"))},e.prototype.parameter=function(e,t){return this._parameter(e,t)},e.prototype.parameters=function(e){for(var t=this,n=0,a=Object.keys(e);n<a.length;n++){var i=a[n],r=e[i];t=t.parameter(i,r)}return t},e.prototype.oDataParameter=function(e,t){return this.parameter(e,{raw:t})},e.prototype.rawParameter=function(e){return this._extend({rawParameters:[e]})},e.prototype._autoParameter=function(e){var t=this._lastParameterId+1,n="@a".concat(t);return{name:n,apiUrl:this._extend({lastParameterId:t})._parameter(n,e)}},e.prototype._parameter=function(e,t){var n;return n=function(e){return!!e&&"object"==typeof e&&"json"in e}(t)?i.UriEncoding.encodeRestUriStringToken(JSON.stringify(t.json)):function(e){return!!e&&"object"==typeof e&&"guid"in e}(t)?"guid'".concat(t.guid,"'"):function(e){return!!e&&"object"==typeof e&&"raw"in e}(t)?t.raw:"number"==typeof t||"boolean"==typeof t?"".concat(t):"'".concat(i.UriEncoding.encodeRestUriStringToken(t),"'"),this._extend({parameters:[{name:e,serializedValue:n}]})},e.prototype.clone=function(){return new e({webAbsoluteUrl:this._webAbsoluteUrl,encodeWebAbsoluteUrl:this._encodeWebAbsoluteUrl})},e.prototype._extend=function(e){var t,n,a,i,r,o;void 0===e&&(e={});var s=this.clone();return s._webUrl=this._webUrl,s._lastParameterId=this._lastParameterId,(t=s._parameters).push.apply(t,this._parameters),(n=s._segments).push.apply(n,this._segments),(a=s._rawParameters).push.apply(a,this._rawParameters),"webUrl"in e&&(s._webUrl=e.webUrl),"lastParameterId"in e&&(s._lastParameterId=e.lastParameterId),"parameters"in e&&(i=s._parameters).push.apply(i,e.parameters),"rawParameters"in e&&(r=s._rawParameters).push.apply(r,e.rawParameters),"segments"in e&&(o=s._segments).push.apply(o,e.segments),s},e}(),o=function(){function e(e){this._apiUrlType=function(t){function n(){return t.call(this,{webAbsoluteUrl:e.webAbsoluteUrl,encodeWebAbsoluteUrl:e.encodeWebAbsoluteUrl})||this}return Object(a.__extends)(n,t),n}(r)}return e.prototype.build=function(){return new this._apiUrlType},e.prototype.contextInfoUrl=function(e){var t,n=e.indexOf("/_layouts/");if(n>-1)t=e.substring(0,n);else{var a=e.lastIndexOf("/"),i=e.lastIndexOf(".");t=i>a?"".concat(e.substring(0,i),"_").concat(e.substring(i+1)):e}return"".concat(t,"/_api/contextinfo")},e}()},p5NW:function(e,t,n){"use strict";n.d(t,"o",function(){return c}),n.d(t,"c",function(){return d}),n.d(t,"t",function(){return l}),n.d(t,"i",function(){return u}),n.d(t,"r",function(){return f}),n.d(t,"e",function(){return p}),n.d(t,"a",function(){return m}),n.d(t,"n",function(){return _}),n.d(t,"s",function(){return h}),n.d(t,"b",function(){return g}),n.d(t,"h",function(){return v}),n.d(t,"v",function(){return y}),n.d(t,"g",function(){return S}),n.d(t,"x",function(){return D}),n.d(t,"p",function(){return I}),n.d(t,"y",function(){return x}),n.d(t,"S",function(){return C}),n.d(t,"D",function(){return O}),n.d(t,"d",function(){return w}),n.d(t,"I",function(){return E}),n.d(t,"f",function(){return A}),n.d(t,"_",function(){return L}),n.d(t,"l",function(){return k}),n.d(t,"u",function(){return M}),n.d(t,"m",function(){return P});var a=n("w0LS"),i=n("71k8"),r=n("K9kD"),o=n("KL1q"),s=36e5,c=3e5,d=4*s,l=9e5,u=1*s,f=4*s,p=4*s,m="SPHomeWeb:sites/feed",_="SPHomeWeb:sites/followed",h="SPHomeWeb:sites/recent",b=function(e){var t;switch(e){case"STS":t=i.t.teamSite;break;case"SPSPERS":t=i.t.mySite;break;case"GROUP":t=i.t.group;break;case"SITEPAGEPUBLISHING":t=i.t.sitePagePublishing;break;default:t=i.t.invalid}return t},g=function(e,t){return Date.now()-e<=t},v=function(e,t,n,i,r,o,s,c,d){if(e)return t({cachingStrategy:a.e.onlyCache,spHomeCachedItem:{cacheContext:null,cacheValue:""},spHomeClientContext:{Urls:[""],Token:{AccessToken:"",ExpiresOn:""}},returnStatistics:!0}).then(function(e){var t;return e&&(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.Items)&&e.data.Items.length>0?(d(e,i),g(e.cacheStats.lastModified,n)?{data:c(e.data),stale:!1,date:e.cacheStats.lastModified}:{data:c(e.data),stale:!0,date:e.cacheStats.lastModified}):{data:[],stale:!0,date:0}});var l=o&&o.find(function(e){return e.Key===s}),u=null;return l&&r?u=t({cachingStrategy:a.e.useCacheIfNotExpired,spHomeCachedItem:l.Value,spHomeClientContext:r,returnStatistics:!0,cacheTimeoutTime:n}):r&&r.Token&&(u=t({cachingStrategy:a.e.useCacheIfNotExpired,spHomeCachedItem:{cacheContext:null,cacheValue:""},spHomeClientContext:r,returnStatistics:!0,cacheTimeoutTime:n})),u?u.then(function(e){var t;return(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.Items)&&e.data.Items.length>0?(d(e,i),{data:c(e.data),stale:!1,date:Date.now()}):{data:[],stale:!0,date:0}}):Promise.resolve({data:[],stale:!0,date:0})},y=function(e,t){try{if(e){var n=JSON.parse(e);if(n)return t(n)}}catch(e){}},S=function(e){return function(t){1!==t.button&&2!==t.button||r.Engagement.logData({name:e})}},D=function(e){return e.which===Object(o.getRTLSafeKeyCode)(o.KeyCodes.right)},I=function(e){return function(t){if(t.which===o.KeyCodes.enter){var n=document.getElementById(e);null==n||n.click()}}},x=function(e){return e.map(function(e){var t,n,a,i,r,o,s,c,d;return{author:{Title:null!==(a=null===(n=null===(t=e.createdBy)||void 0===t?void 0:t.user)||void 0===n?void 0:n.displayName)&&void 0!==a?a:""},description:null!==(i=e.description)&&void 0!==i?i:"",publishDate:new Date(e.firstPublishedDate),title:null!==(r=e.title)&&void 0!==r?r:"",url:e.webUrl,isAuthoritative:!1,site:{id:null!==(o=e.sharepointIds.siteId)&&void 0!==o?o:"",serverRelativeUrl:null!==(s=e.parentReference.path)&&void 0!==s?s:"",title:null!==(c=e.parentReference.siteTitle)&&void 0!==c?c:"",webTemplateId:0},image:null===(d=e.thumbnails)||void 0===d?void 0:d[0].source.url}})},C=function(e){return e.map(function(e){var t,n,a,i;return{id:e.id,serverRelativeUrl:e.webUrl,title:e.title,WebTemplate:null===(t=e.template)||void 0===t?void 0:t.name,color:null===(n=e.resourceVisualization)||void 0===n?void 0:n.color,acronym:null===(a=e.resourceVisualization)||void 0===a?void 0:a.acronym,icon:null===(i=e.resourceVisualization)||void 0===i?void 0:i.previewImageUrl}})},O=function(e){return e.Items.map(function(e){var t=e.ItemReference,n=t.WebId,a=t.SiteId,r=t.IndexId,o=e.Title,s=e.IsExternalContent,c=e.ItemReference,d=e.BannerImageUrl,l=e.BannerColor,u=e.Acronym,f=e.Weight,p=e.PinOrder,m=e.WebTemplate;return{id:n,siteCollectionId:a,title:o,isExternal:s,serverRelativeUrl:e.OriginalUrl||e.Url,icon:d,color:l,acronym:u,indexId:r,itemReference:c,weight:f||0,pinOrder:p,allowPinning:!!c&&!!c.SiteId&&!!c.WebId,webTemplateId:m?b(m):i.t.invalid,WebTemplate:m}})},w=function(e,t,n,a){var i,r=null===(i=a?null==t?void 0:t.filter(function(e){return e.serverRelativeUrl!==a}):t)||void 0===i?void 0:i.slice(0,n);return[null==e?void 0:e.filter(function(e){return a?e.serverRelativeUrl!==a:null==r?void 0:r.reduce(function(t,n){return t&&n.serverRelativeUrl!==e.serverRelativeUrl},!0)}),r]};function E(e,t){var n;if(e&&t)if(e.name)this.componentData[t]=e;else{var a=this.componentData[t];(null===(n=null==a?void 0:a.cacheStats)||void 0===n?void 0:n.lastModified)?e.cacheStats.lastModified>a.cacheStats.lastModified?this.componentData[t]=e:isNaN(e.cacheStats.lastModified)&&(e.cacheStats.lastModified=Date.now(),this.componentData[t]=e):this.componentData[t]=e}}var A=function(e,t){return e.getNewsFeed({language:r.Locale.language,expandClause:"$expand=analytics($expand=allTime),thumbnails",section:"SharePointNewsFeedTargeted",webAbsoluteUrl:t,cacheRequestKey:"SPAppBarGetNewsFeed",cacheTimeoutTime:c,cachingStrategy:a.e.useCacheIfNotExpired,returnStatistics:!0,qosName:"SharePointDataSource.spAppBarGetNewsFeed"})},L=function(e,t){return e.getRecentSites({webAbsoluteUrl:t,top:30,cacheRequestKey:"SPAppBarGetRecentSites",cacheTimeoutTime:d,cachingStrategy:a.e.useCacheAndUpdateInTheBackground,returnStatistics:!0,qosName:"SharePointDataSource.spAppBarGetRecentSites"})},k=function(e,t){return e.getFollowedSites({webAbsoluteUrl:t,top:30,cacheRequestKey:"SPAppBarGetFollowedSites",cacheTimeoutTime:d,cachingStrategy:a.e.useCacheAndUpdateInTheBackground,returnStatistics:!0,qosName:"SharePointDataSource.spAppBarGetFollowedSites"})},M=function(e,t){return e.getFrequentSites({webAbsoluteUrl:t,top:30,cacheRequestKey:"SPAppBarGetFrequentSites",cacheTimeoutTime:d,cachingStrategy:a.e.useCacheAndUpdateInTheBackground,returnStatistics:!0,qosName:"SharePointDataSource.spAppBarGetFrequentSites"})},P=function(e,t,n){return e.getRecentFiles({webAbsoluteUrl:t,cachingStrategy:n?a.e.bypassCache:a.e.useCacheAndUpdateInTheBackground,cacheTimeoutTime:l,returnStatistics:!0,maxItems:30,cacheRequestKey:"SPAppBarGetRecentFiles",qosName:"SharePointDataSource.spAppBarGetRecentFiles"})}}}]);