define("af8be689-990e-492a-81f7-ba3e4cd3ed9c_1.2.2",["tslib","@ms/sp-telemetry","@microsoft/sp-component-base","@microsoft/sp-loader","@microsoft/office-ui-fabric-react-bundle","@microsoft/sp-lodash-subset","@ms/sp-webpart-shared","@microsoft/sp-core-library","@ms/sp-edit-customer-promise","react","react-dom","@ms/uifabric-styling-bundle","@ms/sp-component-utilities","@microsoft/load-themed-styles","@ms/sp-pages-core","@ms/sp-rich-image","@microsoft/sp-diagnostics","@ms/odsp-utilities-bundle"],function(n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v){return function(e){function t(t){for(var n,i,r=t[0],o=t[1],s=0,c=[];s<r.length;s++)i=r[s],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&c.push(a[i][0]),a[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(d&&d(t);c.length;)c.shift()()}var n={},a={11:0};function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.e=function(t){for(var n=[],o=function(e){return{4:[{i:"974a7777-0990-4136-8fa6-95d80114c2e0",v:"1.16.0",m:"br4S"},{i:"2c46c8f0-e214-4f49-951e-fd5b9d7b4ae1",v:"1.16.0",m:"8dK2"},{i:"1c4541f7-5c31-41aa-9fa8-fbc9dc14c0a8",v:"1.16.0",m:"X+PM"},{i:"c07208f0-ea3b-4c1a-9965-ac1b825211a6",v:"1.16.0",m:"vlQI"},{i:"1cea229f-b208-4202-8014-22503d92a019",v:"0.1.0",m:"QZHX"},{i:"c79b9f88-6338-40fb-b463-3aad22a88b15",v:"0.1.0",m:"9poL"}]}[e]||[]}(t),s=0;s<o.length;s++)e[o[s].m]||function(t){n.push(r.SPComponentLoader.loadComponentById(t.i,t.v).then(function(n){e[t.m]=function(e){e.exports=n}}))}(o[s]);var c=a[t];if(0!==c)if(c)n.push(c[2]);else{var d=new Promise(function(e,n){c=a[t]=[e,n]});n.push(c[2]=d);var l,u=document.createElement("script");u.charset="utf-8",u.timeout=120,i.nc&&u.setAttribute("nonce",i.nc),u.src=function(e){return i.p+"chunk."+({2:"dnd-wrappers",3:"image-gallery-brick-layout",4:"image-gallery-edit-mode",5:"image-gallery-grid-layout",15:"sp-light-box",26:"vendors~dnd-wrappers",27:"vendors~image-gallery-edit-mode",29:"vendors~sp-light-box"}[e]||e)+"_"+(["en-us","none"])[{"2":1,"3":1,"4":0,"5":1,"15":0,"26":1,"27":1,"29":1}[e]]+"_"+{2:"5243e2d484ac0f489971",3:"88b946fd377a8a6d2e91",4:"780b24f1bf8be1314414",5:"90c2ff536e138f6cc687",15:"df0c690f4200966efadf",26:"8d9b84485fd706fd4aeb",27:"5843afad9c733ab4fc90",29:"1b42817e7802ab0e2bfe"}[e]+".js"}(t),0!==u.src.indexOf(window.location.origin+"/")&&(u.crossOrigin="anonymous");var f=new Error;l=function(e){u.onerror=u.onload=null,clearTimeout(p);var n=a[t];if(0!==n){if(n){var i=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;f.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",f.name="ChunkLoadError",f.type=i,f.request=r,n[1](f)}a[t]=void 0}};var p=setTimeout(function(){l({type:"timeout",target:u})},12e4);u.onerror=u.onload=l,document.head.appendChild(u)}return Promise.all(n)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var r=i("I6O9");i.oe=function(e){throw console.error(e),e};var o=window.webpackJsonp_8c4a6a562ec36ed6536c907cfb0e02ee=window.webpackJsonp_8c4a6a562ec36ed6536c907cfb0e02ee||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var d=s;return function(){var e,t=document.getElementsByTagName("script"),n="undefined"!=typeof spScriptNamePattern?spScriptNamePattern:/sp-image-gallery-webpart-bundle_en-us_a8320e44cc54fb3f05ac\.js/i;if(t&&t.length)for(var a=0;a<t.length;a++)if(t[a]){var r=t[a].getAttribute("src");if(r&&r.match(n)){e=r.substring(0,r.lastIndexOf("/")+1);break}}if(!e)for(var o in window.__setWebpackPublicPathLoaderSrcRegistry__)if(o&&o.match(n)){e=o.substring(0,o.lastIndexOf("/")+1);break}i.p=e}(),i(i.s="Pxw3")}({"0fUf":function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n("Z95U");function i(e,t){return{errorModuleName:e,logFailure:t.consume(a._EditModeCustomerPromiseHandler.serviceKey).logFailure}}},"0uvb":function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"i",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"t",function(){return s}),n.d(t,"n",function(){return c});var a=n("UWqr"),i=function(){function e(){}return e.isAutoCycleKillSwitchActivated=function(){return a._SPKillSwitch.isActivated(a.Guid.parse("a3063379-c3c4-45b6-8751-bd68d628db59"),"11/27/2017","Image Gallery auto cycle feature")},e.isBulkEditEnabled=function(e){return a._SPFlight.isEnabled(967)||e},e.isAutoCycleEnabled=function(){return!e.isAutoCycleKillSwitchActivated()&&a._SPFlight.isEnabled(969)},e.isMasonryEnabled=function(){return a._SPFlight.isEnabled(942)},e.isDocLibSourceOnlyInPrivateCDNEnabled=function(){return a._SPFlight.isEnabled(1275)},e.isWEXWithinWebpartDragAndDropFlight=function(){return a._SPFlight.isEnabled(1982)},e.isClientSideWEXAssetsOnAFDAuthenticatedCacheEnabled=function(){return a._SPFlight.isEnabled(60157)},e}();function r(){return a._SPKillSwitch.isActivated("0b07391e-ffed-48b9-a78e-c869ccb03a4c")}function o(){return a._SPKillSwitch.isActivated("9022c1a0-3c75-4282-8448-94bd33aedf6d")}function s(){return a._SPKillSwitch.isActivated("f687e8b9-0f6d-45bc-b306-d5a3e3c9b7b9")}function c(){return a._SPFlight.isEnabled(60803)}},"17wl":function(e,t){e.exports=n},"2q6Q":function(e,t){e.exports=a},"5AJ/":function(e){e.exports=JSON.parse('{"e":"Add","v":"Add a title","n":"0||1||2-","l":"{0} images in selected library||{0} image in selected library||{0} images in selected library","h":"Add images","b":"Spotlight your favorite images in a gallery. Drag images here to upload.","c":"Uploading {0} image...||Uploading {0} images...","o":"1||2-","d":"All images uploaded successfully.","s":"Upload completed, but there was {0} error. Use the arrow keys to see the result for each image.||Upload completed, but there were {0} errors. Use the arrow keys to see the result for each image.","a":"Removed image {0}.","g":"Uploading image {0}","f":"\\n      Use left and right arrow keys to to move between images. Use up and down arrow keys to move between the buttons for Remove, Edit.\\n    ","t":"\\n      Press Enter to go into the carousel layout. Use left and right arrow keys to to move between images. Use up and down arrow keys to move between the buttons for Remove, Edit.\\n    ","p":"\\n      Use ctrl + left or ctrl + right arrow keys to reorder images.\\n    ","m":"\\n      Use left and right arrow keys to move between images.\\n    ","_":"Press enter to open a panel showing detailed information about this image.","i":"Image: {0}, {1}, {2}","r":"Image: {0} has been deleted from Image Gallery.","u":"\\n      There are {0} items in the Image Gallery as {1} layout. {2} {3}. {4}.\\n    "}')},"7Awa":function(e,t){e.exports=i},GBZ2:function(e){e.exports=JSON.parse('{"o":"Image gallery","e":"{0}","a":"You don\\u0027t have permissions to access the selected library. If you select a different library, you won\\u0027t be able to return to this selection.","i":"You don\\u0027t have permissions to access the selected library. Contact your site administrator.","t":"No images are available to show. The document library used as the source for the images may have been removed.","r":"Selected list was not enable private CDN, please contact admin to enable it.","n":"Can\\u0027t get document library information. Try again later."}')},"Hy/w":function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n("17wl"),i=n("cDcd"),r=n("hiL/"),o=n("tGpx");n("jOlS").loadStyles('.cg_ab_9f38462c{height:calc(100% - 60px);width:90%;align-content:center;position:relative;margin:30px auto}.ch_ab_9f38462c{height:100%;margin:auto;position:relative}.ci_ab_9f38462c{max-height:100%;max-width:100%;width:auto;height:auto;position:absolute;top:0;bottom:0;left:0;right:0;margin:auto}.cj_ab_9f38462c{color:#fff;padding:10px;text-align:center}.cj_ab_9f38462c,.cj_ab_9f38462c .ck_ab_9f38462c{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;word-wrap:normal}.cj_ab_9f38462c .ck_ab_9f38462c{font-size:"[theme:xxLargeFontSize, default: 28px]";font-weight:"[theme:xxLargeFontWeight, default: 600]";margin:12px}.cj_ab_9f38462c .cl_ab_9f38462c{font-size:16px}',!0);var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._getImageHeightStyle=function(){var e=t.props.image,n=20;return(e.title||e.description)&&(e.title&&(n+=62),e.description&&(n+=22*e.description.split("\n").length)),{height:"calc(100% - ".concat(n,"px)")}},t}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props.image;if(e&&e.imageUrl)return i.createElement("div",{className:"cg_ab_9f38462c"},i.createElement("div",{className:"ch_ab_9f38462c",style:this._getImageHeightStyle()},i.createElement(o.SPImg,{key:e.imageUrl,imageData:e,serviceScope:this.props.serviceScope,callerId:this.props.callerId,getDefaultImage:r.DefaultImageHelper.getDefaultImage,className:"ci_ab_9f38462c",thumbnailWidth:2560})),i.createElement("div",{className:"cj_ab_9f38462c"},e.title&&i.createElement("div",{className:"ck_ab_9f38462c","data-automation-id":"lightBoxTitle"},e.title),e.description&&i.createElement("span",{className:"cl_ab_9f38462c"},Object(o.newlineToBr)(e.description))))},t}(i.Component)},I6O9:function(e,t){e.exports=r},KL1q:function(e,t){e.exports=o},Pk8u:function(e,t){e.exports=s},Pxw3:function(e,t,n){"use strict";n.r(t);var a=n("17wl"),i=n("cDcd"),r=n("faye"),o=n("7Awa"),s=n("UWqr"),c=n("ut3N"),d=n("Pk8u"),l=n("y88i"),u=n("hiL/"),f=n("mMzb"),p=n("2q6Q"),m=n("U4ag"),_=n("lxgo"),h=n("0fUf"),b=n("I6O9"),g=function(){function e(){}return e.loadModule=function(){return b.SPComponentLoader.loadComponentById(e.componentId)},e.loadMasonryLayout=function(){return e.loadModule().then(function(e){return e.MasonryLayoutLoader.loadMasonryLayout()})},e.componentId="828b2762-67ad-4bfd-94e8-5f678fd83664",e}(),v=function(){function e(){}return Object.defineProperty(e,"componentId",{get:function(){return""},enumerable:!1,configurable:!0}),e.import=function(){return n.e(3).then(n.bind(null,"EZa7")).then(function(e){return e.BrickLayout})},e}(),y=n("acy6"),S=function(){function e(){}return e.import=function(){return Promise.all([n.e(27),n.e(4)]).then(n.bind(null,"eRmg"))},e}(),D=n("h92K"),I=n("Qeeh"),x=function(){function e(e){this._validExtensions=e.validExtensions,this._maxSizeBytes=e.maxSizeBytes}return e.prototype.validate=function(e){var t=[];return e instanceof File&&(this._hasValidExtension(e.name)||t.push(new Error(I.e)),this._isWithinSizeLimits(e.size)||t.push(new Error(I.t))),t},e.prototype._hasValidExtension=function(e){for(var t=0;t<this._validExtensions.length;t++)if(-1!==e.toLowerCase().indexOf(this._validExtensions[t],e.length-this._validExtensions[t].length))return!0;return!1},e.prototype._isWithinSizeLimits=function(e){return e<this._maxSizeBytes},e}(),C=n("dEWz"),O=n("KL1q"),w=n("r9Fm"),E=n("Hy/w"),A=n("oAO0"),L=n("jOlS");L.loadStyles('.hr_at_9f38462c div{outline:0}.hr_at_9f38462c .hs_at_9f38462c{display:inline-block}.hr_at_9f38462c .ht_at_9f38462c{background-color:"[theme:redDark, default: #a4262c]"}.hr_at_9f38462c .hu_at_9f38462c{font-size:28px;font-weight:100;color:"[theme:neutralPrimary, default: #323130]";margin:0}.hr_at_9f38462c .hv_at_9f38462c{text-decoration:none;font-size:14px;font-weight:400;color:"[theme:neutralPrimary, default: #323130]";border:0;background:none;cursor:pointer;height:16px;margin-bottom:23px}.hr_at_9f38462c .hw_at_9f38462c{color:"[theme:themePrimary, default: #0078d4]";font-size:16px}[dir=ltr] .hr_at_9f38462c .hw_at_9f38462c{margin-right:8px}[dir=rtl] .hr_at_9f38462c .hw_at_9f38462c{margin-left:8px}.hx_at_9f38462c{display:inline}.af_at_9f38462c{position:absolute;text-indent:-9999px;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;border:0}.cj_at_9f38462c{background:"[theme:neutralPrimary, default: #323130]";color:"[theme:white, default: #ffffff]";padding:10px}.cj_at_9f38462c,.cj_at_9f38462c .ck_at_9f38462c{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;word-wrap:normal}.cj_at_9f38462c:not(.v_at_9f38462c) .ck_at_9f38462c{font-size:28px;font-weight:lighter}.cj_at_9f38462c:not(.v_at_9f38462c) .cl_at_9f38462c{font-size:14px}.cj_at_9f38462c:not(.v_at_9f38462c) .cl_at_9f38462c,.cj_at_9f38462c:not(.v_at_9f38462c) .ck_at_9f38462c{font-weight:100}.cj_at_9f38462c.v_at_9f38462c .ck_at_9f38462c{font-size:"[theme:mediumPlusFontSize, default: 16px]";font-weight:"[theme:mediumPlusFontWeight, default: 400]";font-weight:600}.cj_at_9f38462c.v_at_9f38462c .cl_at_9f38462c{font-size:"[theme:smallFontSize, default: 12px]";font-weight:"[theme:smallFontWeight, default: 400]"}.cg_at_9f38462c{height:calc(100% - 60px);width:90%;align-content:center;position:relative;margin:30px auto}.ch_at_9f38462c{height:100%;margin:auto;position:relative}.ci_at_9f38462c{max-height:100%;max-width:100%;width:auto;height:auto;position:absolute;top:0;bottom:0;left:0;right:0;margin:auto}.hy_at_9f38462c:not(.v_at_9f38462c){font-size:14px}.hy_at_9f38462c.v_at_9f38462c{font-size:"[theme:mediumPlusFontSize, default: 16px]";font-weight:"[theme:mediumPlusFontWeight, default: 400]"}.hz_at_9f38462c{margin:12px 0 0;border-top:1px solid "[theme:neutrallight, default: #edebe9]";border-bottom:1px solid "[theme:neutrallight, default: #edebe9]"}.au_at_9f38462c{overflow:hidden;display:inline-block;margin:10px 0 15px;font-size:17px;font-weight:300;color:"[theme:neutralSecondary, default: #605e5c]"}.ia_at_9f38462c,.au_at_9f38462c{position:relative}.ia_at_9f38462c{margin-bottom:20px}',!0);var k="hr_at_9f38462c",M="v_at_9f38462c";function P(e){var t=function(e){if(e){var t=function(e){var t=Math.floor((e+20)/232)||1;return Math.min(4,t)}(e);return Math.min((e-20*(t-1))/t-3,283)}return 0}(e.width);return i.createElement("div",{className:"ia_at_9f38462c",style:{width:t}},e.children)}var T,U=n("0uvb"),F=function(){function e(){}return e.recordCountOfUploadingFile=function(e){var t=new c._LogEntry("ImageGalleryWP","DragAndDropUpload",c._LogType.Event,{files:e});p._EngagementLogger.logEventWithLogEntry(t)},e.recordClickCountInDifferentLayout=function(e){p._EngagementLogger.logEventWithLogEntry(new c._LogEntry("ImageGalleryWebPart","LightBoxShowedInDifferentLayout",c._LogType.Event,{layout:D.t[e]}))},e.recordReorderInGrid=function(e,t,n,a){p._EngagementLogger.logEventWithLogEntry(new c._LogEntry("ImageGalleryWebPart","ReorderGird",c._LogType.Event,{totalCount:String(e),oldIndex:String(t),newIndex:String(n),temporaryItemsCount:String(a)}))},e.recordOpenFilerPicker=function(){p._EngagementLogger.logEvent("ImageGalleryWP.FilePicker","Open")},e.recordCancelFilePicker=function(){p._EngagementLogger.logEvent("ImageGalleryWP.FilePicker","UserCancelled")},e.recordSelectItemInFilePicker=function(e,t,n){var a=new c._LogEntry("ImageGalleryWP","FilePicker",c._LogType.Event,{onFileSelectedSuccess:String(e),localUpload:String(t),numFilesSelected:String(n)});p._EngagementLogger.logEventWithLogEntry(a)},e}(),H=Object(O.classNamesFunction)(),R=function(e){var t=e.variantTheme;return t?{root:[{color:t.semanticColors.bodyText+" !important"}],focusHover:[{selectors:{"&:hover::after":{borderColor:t.semanticColors.variantBorderHovered+" !important"}}}],addImageButton:{borderColor:"transparent",selectors:{"& .ms-Button-label":{color:t.semanticColors.actionLink},"&:hover .ms-Button-label, &:focus .ms-Button-label, &:active .ms-Button-label":{color:t.semanticColors.actionLinkHovered+" !important"},"& .ms-Button-icon":{color:t.semanticColors.link},"&:hover .ms-Button-icon, &:focus .ms-Button-icon, &:active .ms-Button-icon":{color:t.semanticColors.linkHovered+" !important"}}}}:{root:void 0,focusHover:void 0,addImageButton:void 0}},N=[300,480,750,1024,1600,2560];function B(e){var t=e.pageContext,n=e.img,a=e.src,r=e.siteId,o=e.listId,s=e.webId,c=e.uniqueId;if(!a||""===a.trim())return n;var d=new u.SPResourcePath(a),f=d.domain,p=u.ExtensionHelper.getExtension(d)||"",m=".sharepointonline.com",_=Boolean(f)&&-1!==f.indexOf(m,f.length-m.length);if(!_&&!j(f,".sharepoint.com")&&!j(f,".spoppe.com")||!u.ThumbnailUrlGenerator.isFileTypeSupported(p))return n;for(var h=function(e){if(_){var n=new l.Uri(a);return n.setQueryParameter("width",String(e)),n.setQueryParameter("height",String(e)),n.toString()}var i={absoluteUrl:t&&t.web&&t.web.absoluteUrl,spResource:a,siteId:r,webId:s,listId:o,uniqueId:c,fileType:p,width:e,callerId:"imageGalleryGrid"};return u.ThumbnailUrlGenerator.getThumbnailUrl(i)},b=[],g=0;g<N.length;g++){var v="(max-width:".concat(N[g],"px)"),y=h(N[g]);b.push(i.createElement("source",{srcSet:y,media:v,key:N[g]}))}return b.length?i.createElement("picture",{onError:function(e){var t=e.target,n="srcSet";if(t&&null!==t.parentNode&&null!==t.parentNode.firstChild&&t.parentNode.firstChild.getAttribute&&t.parentNode.firstChild.getAttribute(n)!==a)for(var i=t.parentElement.getElementsByTagName("source"),r=0;r<i.length;r++)i[r].setAttribute(n,a)}},b,n):n}function j(e,t){return!e||-1!==e.indexOf(t,e.length-t.length)}!function(e){e[e.Parent=0]="Parent",e[e.Self=1]="Self"}(T||(T={}));var V=n("tGpx"),z=n("hUCW");L.loadStyles('.jl_av_9f38462c{position:absolute;height:100%;top:0;display:flex}[dir=ltr] .jl_av_9f38462c{right:0}[dir=rtl] .jl_av_9f38462c{left:0}.jm_av_9f38462c{position:absolute;bottom:0;background-color:"[theme:neutralQuaternaryAlt, default: #e1dfdd]";opacity:.8;width:100%;height:40px;color:#767676;transition:opacity .167s cubic-bezier(.1,.9,.2,1)}[dir=ltr] .jm_av_9f38462c{right:0}[dir=rtl] .jm_av_9f38462c{left:0}.jm_av_9f38462c .jn_av_9f38462c{font-size:15px;vertical-align:sub;padding:6px}.jm_av_9f38462c .jo_av_9f38462c{font-size:13px}.jm_av_9f38462c .jp_av_9f38462c{font-size:21px;vertical-align:sub;padding:8px}.jm_av_9f38462c .jq_av_9f38462c{font-size:17px}[dir=ltr] .jm_av_9f38462c .ee_av_9f38462c.v_av_9f38462c{padding-right:70px}[dir=rtl] .jm_av_9f38462c .ee_av_9f38462c.v_av_9f38462c{padding-left:70px}[dir=ltr] .jm_av_9f38462c .ee_av_9f38462c:not(.v_av_9f38462c){right:70px}[dir=rtl] .jm_av_9f38462c .ee_av_9f38462c:not(.v_av_9f38462c){left:70px}[dir=ltr] .jm_av_9f38462c .jr_av_9f38462c.v_av_9f38462c{padding-right:9px}[dir=rtl] .jm_av_9f38462c .jr_av_9f38462c.v_av_9f38462c{padding-left:9px}[dir=ltr] .jm_av_9f38462c .jr_av_9f38462c:not(.v_av_9f38462c){right:9px}[dir=rtl] .jm_av_9f38462c .jr_av_9f38462c:not(.v_av_9f38462c){left:9px}.jm_av_9f38462c .js_av_9f38462c{flex-direction:column}.jm_av_9f38462c .jt_av_9f38462c{flex-direction:row}.ju_av_9f38462c{font-size:21px;font-weight:100;color:"[theme:themePrimary, default: #0078d4]";padding:9px;vertical-align:top}.jv_av_9f38462c{font-size:17px;font-weight:300;box-sizing:border-box;margin:0;box-shadow:none;height:100%;cursor:pointer;display:inline-block;background-color:transparent;color:#767676;min-width:auto;border:0;padding:10px}.jv_av_9f38462c::-moz-focus-inner{border:0}.jv_av_9f38462c{outline:transparent;position:relative}.jv_av_9f38462c.ms-Fabric.is-focusVisible:focus:after,.ms-Fabric.is-focusVisible .jv_av_9f38462c:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;border:1px solid "[theme:neutralsecondary, default: #605e5c]";border-radius:inherit;pointer-events:none}.jv_av_9f38462c:hover{color:#333}.jw_av_9f38462c{font-size:17px;padding:9px}.jx_av_9f38462c{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;word-wrap:normal;color:"[theme:neutralPrimary, default: #323130]"}.jx_av_9f38462c:not(.v_av_9f38462c){font-size:17px;font-weight:300}.jx_av_9f38462c.v_av_9f38462c{font-size:"[theme:mediumPlusFontSize, default: 16px]";font-weight:"[theme:mediumPlusFontWeight, default: 400]";font-weight:600}[dir=ltr] .jx_av_9f38462c.v_av_9f38462c{padding-left:9px}[dir=rtl] .jx_av_9f38462c.v_av_9f38462c{padding-right:9px}.jy_av_9f38462c{position:absolute}[dir=ltr] .jy_av_9f38462c{left:9px}[dir=rtl] .jy_av_9f38462c{right:9px}.jz_av_9f38462c{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:inline-block;font-style:normal;font-weight:400;line-height:1;speak:none;color:"[theme:neutralPrimary, default: #323130]"}.ka_av_9f38462c:hover .jm_av_9f38462c{color:#333}.ka_av_9f38462c{height:100%;width:100%;position:relative}.kb_av_9f38462c{top:50%;transform:translateY(-50%)}.kc_av_9f38462c{position:absolute}[dir=ltr] .kc_av_9f38462c{left:0}[dir=rtl] .kc_av_9f38462c{right:0}.ke_av_9f38462c{width:100%;position:relative}.ke_av_9f38462c:not(.kf_av_9f38462c):hover:after,.ke_av_9f38462c[data-is-focused-in=true]:not(.kg_av_9f38462c):after{content:"";position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;border:2px solid "[theme:neutralsecondary, default: #605e5c]";border-radius:inherit;pointer-events:none}.kh_av_9f38462c{position:absolute;bottom:8px;visibility:hidden;opacity:0;transition:all .15s ease}[dir=ltr] .kh_av_9f38462c{right:8px}[dir=rtl] .kh_av_9f38462c{left:8px}.ke_av_9f38462c[data-is-focused-in=true] .kh_av_9f38462c{visibility:visible;opacity:1}.ki_av_9f38462c{outline-width:1px;outline-style:solid}.kj_av_9f38462c{border:1px solid "[theme:neutrallight, default: #edebe9]"}.kk_av_9f38462c{left:50%;top:50%;transform:translate(-50%,-50%)}.kl_av_9f38462c{position:absolute}.km_av_9f38462c{padding:9px}.kn_av_9f38462c{display:inline-block}.ko_av_9f38462c{vertical-align:super}.kp_av_9f38462c{color:"[theme:themePrimary, default: #0078d4]"}.kq_av_9f38462c{color:"[theme:redDark, default: #a4262c]"}.kr_av_9f38462c{font-size:17px;font-weight:300}.ks_av_9f38462c{position:relative;background-color:"[theme:neutralLighterAlt, default: #faf9f8]"}.ks_av_9f38462c .kt_av_9f38462c{position:absolute;top:50%;transform:translate(-50%,-50%);left:50%}.ku_av_9f38462c{position:relative;background-color:"[theme:neutralLighter, default: #f3f2f1]"}.kv_av_9f38462c{width:100%;height:100%;background-color:transparent;background-image:linear-gradient(180deg,transparent 15%,rgba(0,0,0,.7));position:absolute;display:flex;flex-direction:column;justify-content:flex-end;top:0;left:0}.kw_av_9f38462c{padding:32px;color:#fff}.kw_av_9f38462c .ck_av_9f38462c{margin:0;font-size:"[theme:xxLargePlusFontSize, default: 32px]";font-weight:"[theme:xxLargePlusFontWeight, default: 600]";-webkit-line-clamp:2;max-height:2.7em}.kw_av_9f38462c .kx_av_9f38462c,.kw_av_9f38462c .ck_av_9f38462c{display:-webkit-box;-webkit-box-orient:vertical;box-sizing:content-box;overflow:hidden}.kw_av_9f38462c .kx_av_9f38462c{margin-top:16px;font-size:"[theme:mediumPlusFontSize, default: 16px]";font-weight:"[theme:mediumPlusFontWeight, default: 400]";-webkit-line-clamp:3;max-height:4.05em}.ky_av_9f38462c{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;word-wrap:normal}[dir=ltr] .ky_av_9f38462c{padding-left:9px}[dir=rtl] .ky_av_9f38462c{padding-right:9px}.ky_av_9f38462c:not(.v_av_9f38462c){font-size:14px;font-weight:100}.ky_av_9f38462c.v_av_9f38462c{font-size:"[theme:smallFontSize, default: 12px]";font-weight:"[theme:smallFontWeight, default: 400]"}',!0);var G="jl_av_9f38462c",K="jz_av_9f38462c",W="ka_av_9f38462c",q="ke_av_9f38462c",Q="kl_av_9f38462c",Y="km_av_9f38462c",J="kq_av_9f38462c",X="kr_av_9f38462c";function Z(e){var t=Object(O.getTheme)(),n=t.effects,a=t.isInverted,r=t.palette;return i.createElement("div",{className:Object(O.mergeStyles)("kh_av_9f38462c",Object(U.n)()&&{borderRadius:n.roundedCorner4,backgroundColor:a?r.neutralQuaternary:r.neutralLighter,button:{borderRadius:n.roundedCorner4}})},e.shouldShowMoveButton&&i.createElement(u.ToolbarButton,{fabricIconKey:"Move",title:z.a}),i.createElement(u.ToolbarButton,{fabricIconKey:"Edit",title:z.t,automationId:"edit-button",onClick:e.onEdit}),i.createElement(u.ToolbarButton,{fabricIconKey:"Delete",title:z.e,automationId:"delete-button",onClick:e.onDelete}))}var $=function(e){function t(t){var n=e.call(this,t)||this;return n._isNewDndExperience=U.e.isWEXWithinWebpartDragAndDropFlight(),n._handleFocus=function(){n.props.onEdit(n.props.image,!0),n.setState({isFocusedInside:!0})},n._handleBlur=function(){n.setState({isFocusedInside:!1})},n._handleKeyDown=function(e){!n._isCarouselMode()||e.keyCode!==O.KeyCodes.left&&e.keyCode!==O.KeyCodes.right||e.preventDefault()},n._onImageLoad=function(e,t){var a,i;n.setState({serviceTypeWhenLoaded:t}),null===(i=(a=n.props).onImageLoadOrFail)||void 0===i||i.call(a,e)},n._onImageLoadFailure=function(e,t){var a,i;null===(i=(a=n.props).onImageLoadOrFail)||void 0===i||i.call(a,t)},n._onDeleteClick=function(){n.props.onDelete(n.props.image)},n._onEditClick=function(){n.props.onEdit(n.props.image)},n.state={serviceTypeWhenLoaded:void 0,isFocusedInside:!1},n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props.image.altText||this.props.image.title||this.props.image.url&&this.props.image.url.split("/").pop(),t=this.props.host===D.t.Carousel||this.props.edit?void 0:z.n,n={uniqueId:this.props.image.id,webId:this.props.image.webId,imageUrl:this.props.image.url,siteId:this.props.image.siteId,listId:this.props.image.listId},a=i.createElement(V.SPImg,{alt:e,"aria-label":t,callerId:7,height:this.props.renderHeightStyle,imageData:n,imageFit:this._getImageFit(),onInViewport:this.props.onInViewport,onLazyTimeout:this.props.onLazyTimeout,onImageLoad:this._onImageLoad,onImageLoadFailure:this._onImageLoadFailure,getDefaultImage:u.DefaultImageHelper.getDefaultImage,serviceScope:this.props.serviceScope,thumbnailWidth:this.props.thumbnailWidth,width:this.props.renderWidthStyle,draggable:!this._isNewDndExperience}),r=Object(O.css)(q,this._isCarouselMode()&&"kg_av_9f38462c","kf_av_9f38462c");return i.createElement("div",{className:r,key:this.props.image.id,"data-automation-id":"image-item","data-is-focusable":!0,onFocus:this._handleFocus,onBlur:this._handleBlur,"data-is-focused-in":this.state.isFocusedInside,onKeyDown:this._handleKeyDown},i.createElement(O.FocusZone,{className:W,direction:O.FocusZoneDirection.vertical,isCircularNavigation:!0},i.createElement("div",{"data-is-focus-item":!0,"aria-label":e,className:"ku_av_9f38462c"},a,this._renderTitleAndCaption(),this._renderToolBar())))},t.prototype._getImageFit=function(){return"stockImage"===this.state.serviceTypeWhenLoaded?"none":1===this.props.imageCropping?"cover":3===this.props.imageCropping?"contain":void 0},t.prototype._renderToolBar=function(){return this.props.edit&&i.createElement(Z,{shouldShowMoveButton:this.props.host===D.t.Grid,onEdit:this._onEditClick,onDelete:this._onDeleteClick})},t.prototype._isCarouselMode=function(){return this.props.host===D.t.Carousel},t.prototype._renderTitleAndCaption=function(){return this._isCarouselMode()&&(this.props.image.title||this.props.image.description)&&i.createElement("div",{className:"kv_av_9f38462c"},i.createElement("div",{className:"kw_av_9f38462c"},i.createElement("h3",{className:"ck_av_9f38462c"},i.createElement(O.TooltipHost,{content:this.props.image.title,overflowMode:T.Parent},this.props.image.title)),i.createElement("div",{className:"kx_av_9f38462c"},i.createElement(O.TooltipHost,{content:this.props.image.description,overflowMode:T.Parent},this.props.image.description))))},t}(i.Component),ee=n("wfAw"),te=function(e){function t(t){var n=e.call(this,t)||this;return n._dismissFailedUpload=n._dismissFailedUpload.bind(n),n._registerStateHandlers(t),n}return Object(a.__extends)(t,e),t.prototype.render=function(){return this._getUploadProgressContent.call(this)},t.prototype._registerStateHandlers=function(e){var t=this;this.state||(this.state={uploadState:1},e.uploadPromise.catch(function(e){t.setState({uploadState:3,errorMessage:e.message})}))},t.prototype._getUploadProgressContent=function(){var e=void 0,t=this.props.host===D.t.Carousel?"kk_av_9f38462c":"kb_av_9f38462c";switch(this.state.uploadState){case 1:e=i.createElement("div",null,i.createElement("div",{className:Object(O.css)(Q,Y,t)},i.createElement("div",{className:"kn_av_9f38462c"},i.createElement(O.Spinner,{type:O.SpinnerType.large})),i.createElement("span",{className:Object(O.css)("ko_av_9f38462c",Y)},ee.a)),i.createElement("div",{className:G},i.createElement("div",{className:"jw_av_9f38462c"},l.StringHelper.format(ee.n,this.props.currentIndex,this.props.totalUploading))));break;case 2:e=i.createElement("div",null,i.createElement("div",{className:Object(O.css)("kp_av_9f38462c",Q,X,t)},i.createElement(O.Icon,{className:Object(O.css)(K,"ju_av_9f38462c"),iconName:"CheckMark"}),ee.e));break;case 3:var n=void 0,a=void 0;this.props.host===D.t.Carousel?(n="jp_av_9f38462c",a="jq_av_9f38462c"):(n="jn_av_9f38462c",a="jo_av_9f38462c"),e=i.createElement("div",{role:"alert","aria-live":"assertive",className:J},i.createElement("div",{className:Object(O.css)(t,Q)},i.createElement(O.Icon,{className:Object(O.css)(K,J,n),iconName:"Info"}),i.createElement("span",{className:Object(O.css)(a,J)},this.state.errorMessage)),i.createElement("div",{className:G},i.createElement("button",{onClick:this._dismissFailedUpload,className:Object(O.css)("jv_av_9f38462c",X),title:ee.t,"data-automation-id":"remove-button"},i.createElement(O.Icon,{className:Object(O.css)(K,J),iconName:"Cancel"}))));break;default:c._TraceLogger.logVerbose(c._LogSource.create("ImageGallery.WP.GridItem"),"UploadState not handled")}return i.createElement("div",{className:q},i.createElement(O.FocusZone,{className:W,direction:O.FocusZoneDirection.vertical,isCircularNavigation:!0},i.createElement("div",{className:Object(O.css)("ks_av_9f38462c","ki_av_9f38462c"),style:{width:this.props.renderWidthStyle,height:this.props.renderHeightStyle}},i.createElement("img",{src:V.STOCK_IMAGE,className:"kt_av_9f38462c",alt:"",role:"presentation"})),i.createElement("div",{className:Object(O.css)("jm_av_9f38462c","itemActionsBar")},e)))},t.prototype._dismissFailedUpload=function(){this.props.id&&this.props.dismissItem(this.props.id,!0)},t}(i.Component),ne=function(){function e(){}return e.getThumbnailSource=function(e,t,n){var a=!!(t.url&&t.siteId&&t.webId&&t.id),i=u.ExtensionHelper.getExtension(new u.SPResourcePath(t.url))||"";return a?u.ThumbnailUrlGenerator.getThumbnailUrl({absoluteUrl:e,spResource:t.url,siteId:t.siteId,webId:t.webId,listId:t.listId,uniqueId:t.id,fileType:i,width:n,callerId:"imageGallery"}):t.url},e}(),ae=function(){function e(){}return e.renderLightBoxItem=function(e,t){if(e&&e.url){var n=e.url;u.PreviewUtility.getDefaultImage(new u.SPResourcePath(e.url))&&(n=ne.getThumbnailSource(t.web.absoluteUrl,e));var a=i.createElement("img",{src:n,alt:e.altText||e.title,className:"ci_at_9f38462c"}),r=0;(e.title||e.description)&&(e.title&&e.description?r=132:e.title?r=113:e.description&&(r=67));var o={height:"calc(100% - ".concat(r,"px)")},s=Object(O.mergeStyles)("cj_at_9f38462c",M);return i.createElement("div",{className:"cg_at_9f38462c"},i.createElement("div",{className:"ch_at_9f38462c",style:o},i.createElement(B,{pageContext:t,img:a,src:e.url,siteId:e.siteId,webId:e.webId,listId:e.listId,uniqueId:e.id})),i.createElement("div",{className:s},i.createElement("h3",{className:"ck_at_9f38462c","data-automation-id":"lightBoxTitle"},e.title),i.createElement("span",{className:"cl_at_9f38462c"},e.description)))}},e.renderLayoutItem=function(e,t,n,r,o,s){switch(t.renderWidthStyle=n,t.renderHeightStyle=r,t.host=e,t.type){case 1:return t.imageCropping=t.imageCropping||1,t.theme=o.theme,t.cdnBaseUrls=o.cdnBaseUrls,i.createElement($,Object(a.__assign)({},t,{thumbnailWidth:s}));case 2:return i.createElement(te,Object(a.__assign)({},t));default:throw new Error("ImageGridLayoutItemType is not handled in Image ".concat(D.t[e]," Layout renderItem"))}},e}(),ie=n("GBZ2"),re=n("5AJ/"),oe="ImageGallery",se=function(e){function t(a){var r=e.call(this,a)||this;return r._placeholderRef=i.createRef(),r._itemsCompleted=0,r._itemsLoading=0,r._renderCompleted=!1,r._maxWidthUsedForFetchingImages=0,r._addButtonRef=i.createRef(),r._galleryContainer=i.createRef(),r._eventListenersAdded=!1,r._isNewDndExperience=U.e.isWEXWithinWebpartDragAndDropFlight(),r._loadDndWrappers=function(){var e=r.props.edit,t=r.state,a=t.DndChildWrapper,i=t.DndParentWrapper;r._isNewDndExperience&&e&&!a&&!i&&Promise.all([n.e(26),n.e(2)]).then(n.bind(null,"+tbV")).then(function(e){r.setState({DndChildWrapper:e.Reorderable,DndParentWrapper:e.DragDropContextProviderWrapper})}).catch(function(e){c._TraceLogger.logError(c._LogSource.create("ImageGalleryWebPart"),e,"LoadImageGalleryDndWrapperComponents")})},r._renderMasonryItem=function(e,t){var n=r._itemsToDisplay[e];return 1===n.type&&(n.imageCropping=2),void 0!==t?i.createElement(P,{width:t},ae.renderLayoutItem(D.t.Masonry,n,"100%","auto",r.props,t)):void 0},r._renderBrickItem=function(e,t,n){return ae.renderLayoutItem(D.t.Brick,r._itemsToDisplay[e],t,n,r.props,t)},r._renderCarouselItem=function(e,t,n){var a=r._itemsToDisplay[t];return 1===a.type&&(a.imageCropping=3),ae.renderLayoutItem(D.t.Carousel,a,n,n?.5625*n:void 0,r.props,r.props.width)},r._clickLayoutItem=function(e){r.props.edit||r._clickLayoutItemOnViewMode(e)},r._getItemRatio=function(e){var t=r._itemsToDisplay[e];return 2===t.type?Promise.resolve(1):(t.thumbnailSource||(t.thumbnailSource=r._getThumbnailSource(t.image)),A.e.readThumbnailImageRatio({imageData:{uniqueId:t.image.id,webId:t.image.webId,imageUrl:t.image.url,siteId:t.image.siteId,listId:t.image.listId},serviceScope:r.props.serviceScope,thumbnailWidth:r._maxWidthUsedForFetchingImages,callerId:9,getDefaultImage:u.DefaultImageHelper.getDefaultImage,cdnBaseUrls:void 0}).catch(function(){return 1}))},r._getThumbnailSource=function(e){return r._maxWidthUsedForFetchingImages=Math.max(r._maxWidthUsedForFetchingImages,600),ne.getThumbnailSource(r.props.pageContext.web.absoluteUrl,e,r._maxWidthUsedForFetchingImages)},r._wrapDnDIfFlighted=function(e,t){var n=r.props.edit,a=r.state.DndChildWrapper;return r._isNewDndExperience&&n&&a?i.createElement(a,{dragDropType:"ImageItem",dropTargetPlaceholderZIndex:1,index:t,onReorder:r._onReorderGrid,renderDropTargetPlaceholder:!0,listId:"ImageGallery"},e):e},r._wrapGalleryControlInDnd=function(e){var t=r.state.DndParentWrapper;return r._isNewDndExperience&&t?i.createElement(i.Suspense,{fallback:!1},i.createElement(t,null,e)):e},r._setDelayedFocus=function(){setTimeout(r._setFocus,400)},r._setFocus=function(){return 0===r.props.images.length&&r._addButtonRef.current?r._addButtonRef.current.focus():r._currentFocusElement?r._currentFocusElement.focus():r._lastFocusElement?r._lastFocusElement.focus():void(r._focusZone&&r._focusZone.focus(!0))},r._onReorderGrid=function(e,t){F.recordReorderInGrid(r.props.images.length,e,t,r.state.items.length);var n=r.state.items.length;if(e-=n,t-=n,!r._getIsReorderIndexOutOfBoundary(e,t)){var a=r.props.images.splice(e,1)[0];r.props.images.splice(t,0,a),r.forceUpdate()}},r._onFileSelected=function(e){var n=Boolean(e&&e.localFilesPickedToUpload&&e.localFilesPickedToUpload.length>0),a=Boolean(e&&e.externalImagesPickedToUpload&&e.externalImagesPickedToUpload.length>0);if(n||a){var i=[];e.localFilesPickedToUpload&&i.push.apply(i,e.localFilesPickedToUpload.map(function(e){return e.file})),e.externalImagesPickedToUpload&&i.push.apply(i,e.externalImagesPickedToUpload),F.recordSelectItemInFilePicker(!0,Boolean(e.localFilesPickedToUpload),i.length),r._onUploadFiles(i)}else if(e&&e.selectedItems&&e.selectedItems.length>0){for(var o=!s._SPKillSwitch.isActivated("7739d32a-f8a0-4eb2-88ae-613acabbe39a"),c=0,d=e.selectedItems;c<d.length;c++){var l=d[c];if(l.Link){var u={siteId:l.SiteId,webId:l.WebId,listId:l.ListId,id:l.UniqueId,url:o&&l.ServerAbsoluteUrl||l.Link,title:"",isInList:!0,description:"",altText:"",imageTileWidth:t.getImageTileWidth(r.props.webPartProps.layout),dndId:r._isNewDndExperience?s.Guid.newGuid().toString():void 0};r.props.images.unshift(u)}}r.forceUpdate(),F.recordSelectItemInFilePicker(!0,!1,e.selectedItems.length)}else F.recordSelectItemInFilePicker(!1,!1,0);r._addButtonRef.current&&r._addButtonRef.current.focus()},r._onFileCanceled=function(){r._placeholderRef.current&&r._placeholderRef.current.focusOnPlaceHolderButton(),F.recordCancelFilePicker()},r._onTitleChange=function(e){r.props.onTitleSet(e)},r._openFilePicker=function(){r._ensureFilePicker().then(function(e){e.open(),F.recordOpenFilerPicker()}).catch(function(e){c._TraceLogger.logError(c._LogSource.create("ImageGalleryWebPart"),e,"OpenFilePicker")})},r._ensureFilePicker=function(){if(!r._filePickerPromise){var e={onSelect:r._onFileSelected,onCancel:r._onFileCanceled,selectionMode:C.SelectionMode.multiple,itemTypes:new Set([w.t.Images]),callerName:"ImageGalleryWebPart"};r._filePickerPromise=m.EditModeUtilitiesLoader.GetUtilities().then(function(t){return t.FilePickerLoader.load(r.props.serviceScope,e)})}return r._filePickerPromise},r._addDragAndDropListeners=function(){!r._eventListenersAdded&&r._galleryContainer.current&&r.props.edit&&(r._eventListenersAdded=!0,r._galleryContainer.current.addEventListener("drop",r._onDrop),r._galleryContainer.current.addEventListener("dragover",r._allowDrop))},r._removeDragAndDropListeners=function(){r._eventListenersAdded&&r._galleryContainer.current&&(r._eventListenersAdded=!1,r._galleryContainer.current.removeEventListener("drop",r._onDrop),r._galleryContainer.current.removeEventListener("dragover",r._allowDrop))},r._allowDrop=function(e){e.preventDefault(),e.stopPropagation()},r._onDrop=function(e){var t;(null===(t=e.dataTransfer)||void 0===t?void 0:t.files)&&(e.preventDefault(),e.stopPropagation(),F.recordCountOfUploadingFile(e.dataTransfer.files&&e.dataTransfer.files.length.toString()),r._onUploadFiles(e.dataTransfer.files,"DataTransferDropped"))},r._onUploadFiles=function(e,t){c._TraceLogger.logVerbose(r._logSource,l.StringHelper.format("Files uploaded: {0}",e.length));for(var n=Object(h.e)("ImageGallery Webpart ".concat(t||"UploadFiles"," Failure"),r.props.serviceScope),a=new c._QosMonitorShareFailureWithCP("".concat(oe,".").concat(t||"UploadFiles"),!1,[n]),i=e.length,o=0,d=function(t){var n=r.state.items,c=s.Guid.newGuid().toString(),d=r.props.onFileReadyToUpload(e[t]).then(function(e){return r.props.webPartProps.layout===D.t.Brick?A.e.loadThumbnailImage({imageData:{uniqueId:e.id,webId:e.webId,imageUrl:e.url,siteId:e.siteId,listId:e.listId},serviceScope:r.props.serviceScope,thumbnailWidth:r._maxWidthUsedForFetchingImages,cdnBaseUrls:void 0,callerId:10,getDefaultImage:u.DefaultImageHelper.getDefaultImage}).then(function(){return r._dismissTemporaryItem(c),null==a||a.writeSuccess(),e}):(r._dismissTemporaryItem(c),null==a||a.writeSuccess(),Promise.resolve(e))},function(e){return++r._failedItemCount===n.length&&r.setState({screenReaderAlert:r._createUploadStateMessage(n.length,r._failedItemCount)}),null==a||a.writeUnexpectedFailure("UploadFailure",e),Promise.reject(e)});o++,n.push({id:c,type:2,edit:r.props.edit,uploadPromise:d,totalUploading:i,currentIndex:o,dismissItem:r._dismissTemporaryItem}),r.setState({items:n,screenReaderAlert:l.StringHelper.formatWithLocalizedCountValue(re.c,re.o,e.length)})},f=0;f<e.length;f++)d(f)},r._dismissTemporaryItem=function(e,t){t&&r._failedItemCount--;var n=r.state.items.filter(function(t){return t.id!==e});r.setState({items:n,screenReaderAlert:r._createUploadStateMessage(n.length,r._failedItemCount)})},r._handleDeleteImage=function(e){r._currentFocusElement=void 0,r.props.onDeleteImage(e),u.ScreenReaderAlert.read(l.StringHelper.format(re.r,e.title||e.url&&e.url.split("/").pop()),u.ReadingMode.ReadImmediately),r._setStateAfterDeleteDialog(!0)},r._onLoadOrError=function(e){r._itemsCompleted++;var t=r.props,n=t.webPartProps,a=t.images;!r._renderCompleted&&(1===r._itemsCompleted&&n.layout===D.t.Carousel||a&&r._itemsCompleted===Math.min(a.length,20)||r._itemsCompleted>=r._itemsLoading)&&(r.props.renderCompleted(),r._renderCompleted=!0)},r._onInViewport=function(){r._itemsLoading++},r._onLazyTimeout=function(){0!==r._itemsCompleted||0!==r._itemsLoading||r._renderCompleted||(r.props.renderCompleted(),r._renderCompleted=!0)},r._logSource=c._LogSource.create("".concat(oe,".WP.Main")),r._failedItemCount=0,r.state={currentImage:void 0,items:[],screenReaderAlert:void 0},r}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"_classNames",{get:function(){return Boolean(this.props.theme)&&H(R,{variantTheme:this.props.theme})},enumerable:!1,configurable:!0}),t.getImageTileWidth=function(e){switch(e){case D.t.Grid:case D.t.Masonry:return 300;case D.t.Brick:return 600;case D.t.Carousel:default:return}},t._getItemAriaLabel=function(e,n){void 0===n&&(n=!1);var a=e;switch(a.type){case 1:return n?t._getLightBoxImageAriaLabel(a.image):t._getViewModeImageAriaLabel(a.image);case 2:return l.StringHelper.format(re.g,a.currentIndex)}},t._getLightBoxImageAriaLabel=function(e){return e.title||e.description||e.altText?l.StringHelper.format(re.i,e.title||"",e.description||"",e.altText||""):e.url&&e.url.split("/").pop()},t._getViewModeImageAriaLabel=function(e){return e.altText||e.title||e.url&&e.url.split("/").pop()},t._getAriaLabelForLayout=function(e,n,a){return l.StringHelper.format(re.u,n.toString(),D.t[a],t.getNavigationInstructionAriaLabel(e,a),e&&a===D.t.Grid?re.p:"",e||a!==D.t.Grid&&a!==D.t.Brick?"":re._)},t.getNavigationInstructionAriaLabel=function(e,t){return e?t===D.t.Carousel?re.t:re.f:re.m},t.prototype.render=function(){var e=this;return this._itemsToDisplay=Object(a.__spreadArray)(Object(a.__spreadArray)([],this.props.edit?this.state.items:[],!0),this.props.images.map(function(t){return{id:t.id?t.id:e._isNewDndExperience&&t.dndId?t.dndId:void 0,type:1,edit:e._isEditable,image:t,webAbsoluteUrl:e.props.webAbsoluteUrl,onDelete:e._handleDeleteImage,onEdit:e.props.onEditImage,onImageLoadOrFail:e._onLoadOrError,onInViewport:e._onInViewport,onLazyTimeout:e._onLazyTimeout,getDefaultImage:u.DefaultImageHelper.getDefaultImage,serviceScope:e.props.serviceScope}}),!0),this.props.edit?this._editModeContent:this._viewModeContent},t.prototype.componentDidMount=function(){this._addDragAndDropListeners(),this._loadDndWrappers()},t.prototype.componentDidUpdate=function(){this._addDragAndDropListeners(),this._loadDndWrappers()},t.prototype.componentWillUnmount=function(){this._removeDragAndDropListeners()},t.prototype._webPartTitle=function(){var e=this.props.edit&&this.props.webPartProps.imageSourceType===D.e.Curated,t=this._classNames?this._classNames.root:"";return i.createElement(m.WebPartTitle,{className:t,edit:this.props.edit,title:this.props.webPartProps.title,placeholder:re.v,onTitleChange:this._onTitleChange,marginBottomSize:e?"Middle":"Large",theme:this.props.theme})},t.prototype._clickLayoutItemOnViewMode=function(e){this._showLightBox(e),F.recordClickCountInDifferentLayout(this.props.webPartProps.layout)},Object.defineProperty(t.prototype,"_galleryControl",{get:function(){var e=this;if(0!==this._itemsToDisplay.length){var n={componentRef:function(t){return e._focusZone=t},onActiveElementChanged:function(t){e._lastFocusElement===t?e._lastFocusElement=void 0:e._lastFocusElement=e._currentFocusElement===t?e._lastFocusElement:e._currentFocusElement,e._currentFocusElement=t}};switch(this.props.edit?(n.direction=O.FocusZoneDirection.horizontal,n.isCircularNavigation=!0,n.isInnerZoneKeystroke=function(e){return e.which===O.KeyCodes.up||e.which===O.KeyCodes.down}):(n.direction=O.FocusZoneDirection.bidirectional,n.isCircularNavigation=!1),this.props.webPartProps.layout){case D.t.Grid:var a={width:this.props.width,items:this._itemsToDisplay,getReactKey:function(t,n){return e._getLayoutItemKey(n)},onRenderItem:function(t,n,a,i){var r=ae.renderLayoutItem(D.t.Grid,e._itemsToDisplay[n],a,i,e.props,a);return e._wrapDnDIfFlighted(r,n)},itemSize:this.props.webPartProps.gridSettings.imageSize,onItemClick:function(t,n){return e._clickLayoutItem(n)},canReorder:this.props.edit&&this.props.webPartProps.imageSourceType!==D.e.Dynamic,ariaLabel:t._getAriaLabelForLayout(this.props.edit,this.props.images.length,D.t.Grid),getItemAriaLabel:t._getItemAriaLabel,focusZoneProps:n,aspectRatio:this.props.webPartProps.gridSettings.imageAspectRatio,onReorder:this.props.edit?this._onReorderGrid:void 0,theme:this.props.theme};return this.props.gridComponentClass?i.createElement(this.props.gridComponentClass,a):void 0;case D.t.Carousel:var r=d.cloneDeep(this.props.webPartProps.carouselSettings);U.e.isAutoCycleKillSwitchActivated()&&(r.autoplay=!1);var o={items:this._itemsToDisplay,settings:r,edit:this.props.edit,onRenderItem:this._renderCarouselItem,strings:{containerAriaLabelEditMode:t._getAriaLabelForLayout(!0,this.props.images.length,D.t.Carousel),containerAriaLabelReadMode:t._getAriaLabelForLayout(!1,this.props.images.length,D.t.Carousel)},width:this.props.width,theme:this.props.theme,stopAutoplayAfterFirstRun:!1};return this.props.carouselComponentClass?i.createElement(this.props.carouselComponentClass,o):void 0;case D.t.Masonry:var s={items:this._itemsToDisplay.map(function(){return{}}),width:this.props.width,onRenderItem:function(t,n,a){return e._renderMasonryItem(n,a)},options:{horizontalOrder:!1}};return this.props.masonryComponentClass?i.createElement(this.props.masonryComponentClass,s):void 0;case D.t.Brick:var c={items:this._itemsToDisplay.map(function(t,n){return{index:n,key:e._getLayoutItemKey(n)}}),width:this.props.width,onRenderItem:this._renderBrickItem,onClickItem:this._clickLayoutItem,getItemRatio:this._getItemRatio,ariaLabel:t._getAriaLabelForLayout(this.props.edit,this.props.images.length,D.t.Brick),getItemAriaLabel:function(n){return t._getItemAriaLabel(e._itemsToDisplay[n])},focusZoneProps:n,theme:this.props.theme};return this.props.brickComponentClass?i.createElement(this.props.brickComponentClass,c):void 0;default:return}}},enumerable:!1,configurable:!0}),t.prototype._getLayoutItemKey=function(e){var t=this._itemsToDisplay[e],n=this._itemsToDisplay.filter(function(e){return e.id===(null==t?void 0:t.id)}).indexOf(t);return"".concat(t.id,"_").concat(n)},t.prototype._showLightBox=function(e){var r=this,o=[];this._itemsToDisplay.forEach(function(e){1===e.type&&o.push(e.image)});var s={items:o,startIndex:e,isShown:!0,showPagination:!0,lightDismiss:!0,onClose:this._setDelayedFocus,getItemAriaLabel:function(e){return t._getItemAriaLabel(r._itemsToDisplay[e],!0)||""},onRenderItem:function(e){return ae.renderLightBoxItem(e,r.props.pageContext)}};this._lightBox?this._lightBox.show(s):Promise.all([n.e(29),n.e(15)]).then(n.bind(null,"PiBD")).then(function(n){n.LightBox.show({callerId:8,items:o,startIndex:e,isShown:!0,onClose:r._setDelayedFocus,showPagination:!0,onRenderItem:function(e){var t=Object(a.__assign)({imageUrl:e.url},e);return i.createElement(E.e,{image:t,serviceScope:r.props.serviceScope,callerId:8})},getItemAriaLabel:function(e){return t._getItemAriaLabel(r._itemsToDisplay[e],!0)||""}})}).catch(function(e){c._TraceLogger.logError(c._LogSource.create("ImageGalleryWebPart"),e,"LoadLibraryLightBoxChunk")})},Object.defineProperty(t.prototype,"_editModeContent",{get:function(){var e=this._showPlaceholder&&i.createElement("div",null,i.createElement(m.Placeholder,{icon:"Picture",ref:this._placeholderRef,iconText:ie.o,buttonLabel:re.h,description:re.b,onAdd:this._openFilePicker,webpartWidth:this.props.width})),t=Object(O.css)(this._classNames&&this._classNames.addImageButton,"hv_at_9f38462c"),n=this.props.webPartProps.imageSourceType===D.e.Curated&&i.createElement(O.ActionButton,{className:t,"data-automation-id":"addImages-button",onClick:this._openFilePicker,"aria-label":re.h,iconProps:{iconName:"CalculatorAddition"},text:re.e,componentRef:this._addButtonRef}),a=i.createElement("h2",{className:"hu_at_9f38462c"},this._webPartTitle(),n);return U.e.isBulkEditEnabled(this.props.webPartProps.hasDynamicModeEnabled)||this.props.renderedFromPersistedData||!this._showPlaceholder||this._openFilePicker(),i.createElement("div",{className:k,"data-automation-id":"imageGallery"},a,this._imageCountHintText,this._errorMessage,i.createElement("div",{ref:this._galleryContainer},this._showPlaceholder?e:this._wrapGalleryControlInDnd(this._galleryControl)),this._screenReaderAlert)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_imageCountHintText",{get:function(){var e=l.StringHelper.formatWithLocalizedCountValue(re.l,re.n,this.props.images?this.props.images.length:0),t=Object(O.mergeStyles)("hy_at_9f38462c",M);return this._isImageSourceDynamic&&!this.props.errorMessage?i.createElement("p",{className:t},e):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_viewModeContent",{get:function(){return i.createElement("div",{onLoad:this._onLoadOrError,onError:this._onLoadOrError,className:k,"data-automation-id":"imageGallery"},this.props.webPartProps.title&&this._webPartTitle(),this._errorMessage,this._galleryControl)},enumerable:!1,configurable:!0}),t.prototype._getIsReorderIndexOutOfBoundary=function(e,t){return e<0||e>=this.props.images.length||t<0||t>=this.props.images.length},t.prototype._createUploadStateMessage=function(e,t){return 0===e?re.d:e===t?l.StringHelper.formatWithLocalizedCountValue(re.s,re.o,t):void 0},t.prototype._setStateAfterDeleteDialog=function(e){this._setDelayedFocus(),this.setState({screenReaderAlert:!0===e&&this.state.currentImage?l.StringHelper.format(re.a,this.state.currentImage.title):this.state.screenReaderAlert,currentImage:void 0})},Object.defineProperty(t.prototype,"_errorMessage",{get:function(){return this.props.errorMessage?i.createElement("div",{className:"hz_at_9f38462c"},i.createElement("p",{className:"au_at_9f38462c"},this.props.errorMessage)):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_screenReaderAlert",{get:function(){return void 0!==this.state.screenReaderAlert&&i.createElement("p",{role:"alert","aria-live":"assertive",className:"af_at_9f38462c"},this.state.screenReaderAlert)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_isImageSourceDynamic",{get:function(){return this.props.webPartProps.imageSourceType===D.e.Dynamic},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_isEditable",{get:function(){return this.props.edit&&this.props.webPartProps.imageSourceType===D.e.Curated},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_showPlaceholder",{get:function(){return 0===this._itemsToDisplay.length&&this.props.webPartProps.imageSourceType===D.e.Curated},enumerable:!1,configurable:!0}),t}(i.Component),ce=n("RxoY"),de=function(){function e(){}return Object.defineProperty(e,"componentId",{get:function(){return""},enumerable:!1,configurable:!0}),e.import=function(){return n.e(5).then(n.bind(null,"81fD")).then(function(e){return e.ImageGridLayout})},e}(),le=c._LogSource.create("ImageGalleryWebPart"),ue="ImageGalleryWebPart.CDN.{0}",fe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._hasDocumentLibrariesRetrieved=!1,t._delayedGetImagesFromDocLib=d.debounce(t._instantlyGetImagesFromDocLib,600),t._originalImageCount=void 0,t.dataReceived=function(e){if(t._isImageSourceDynamic){if(e.data&&e.data.length>0)t._imagesFromSelectedDocLib=e.data[0].images;else{var n=e.data;n&&n.data&&n.data.length>0&&(t._imagesFromSelectedDocLib=n.data[0].images)}t.render()}},t.fetchData=function(){return t._isImageSourceDynamic?t._instantlyGetImagesFromDocLib(!1).then(function(){return[{images:t._imagesFromSelectedDocLib}]}):Promise.resolve([{images:[]}])},t._clearInternalAndBaseWebpartErrors=function(){t._errorMessage=void 0,t.clearError()},t._selectDocumentLibrary=function(e){var n,a=null===(n=t._documentLibrariesEnabledPrivateCDN)||void 0===n?void 0:n.filter(function(t){return t.Id===e});if(null==a?void 0:a.length){t.properties.listId=a[0].Id,t.properties.listUrl=d.get(a[0],"RootFolder.ServerRelativeUrl");var i=a[0].RootFolder,r=i?i.ServerRelativeUrl:void 0;r?t._dataAggregator.then(function(e){return e.isDocumentLibraryCdnEnabled(r)}).then(function(e){t.properties.isCdnEnabledForList=e,p._EngagementLogger.logEvent(s.Text.format(ue,e?"Enabled":"Disabled")),e||(t.properties.maxImagesCount=Math.min(t.properties.maxImagesCount,y.e)),t.context.propertyPane.refresh()}).catch(function(e){return c._TraceLogger.logError(le,e,"ImageGalleryWebPart.CheckCdnStatus")}):t.properties.isCdnEnabledForList=!1,t.context.propertyPane.refresh(),t._delayedGetImagesFromDocLib(!0)}else t._handleNoPermissionAndRender()},t._handleNoEnablePrivateCDNAndRender=function(){t._errorMessage=ie.r,t.render()},t._handleNoPermissionAndRender=function(){t._errorMessage=t.displayMode===s.DisplayMode.Edit?ie.a:ie.i,t.render()},t._getDocumentLibrarySelectionsAndSetDefaultSelection=function(){t._documentLibrarySelections.then(function(){if(t._errorMessageFetchingDocLibs="",t._documentLibraries&&t._documentLibraries.length>0){if(!t._documentLibrariesEnabledPrivateCDN||t._documentLibrariesEnabledPrivateCDN.length<=0)return;var e=t._documentLibraries.filter(function(e){return e.Id===t.properties.listId}),n=t._documentLibrariesEnabledPrivateCDN.filter(function(e){return e.Id===t.properties.listId});if(n.length)return t._selectDocumentLibrary(n[0].Id);if(void 0===t.properties.listId)return t._selectDocumentLibrary(t._documentLibrariesEnabledPrivateCDN[0].Id);e.length?t._handleNoEnablePrivateCDNAndRender():t._handleNoPermissionAndRender()}}).catch(t.renderError)},t._logFirstViewData=function(){if(!t.renderedOnce&&t.displayMode!==s.DisplayMode.Edit){var e,n,a;switch(t.properties.imageSourceType){case D.e.Curated:case D.e.Dynamic:e=D.e[t.properties.imageSourceType];break;default:e="UnexpectedImageSourceType"}if(t.properties.imageSourceType===D.e.Dynamic){switch(t.properties.isRecursive){case!0:case!1:n=String(t.properties.isRecursive);break;default:n="UnexpectedIsRecursiveValue"}a=t.properties.maxImagesCount}var i=t.properties.carouselSettings&&t.properties.carouselSettings.autoplay,r=t.properties.carouselSettings&&t.properties.carouselSettings.autoplaySpeed,o=new c._LogEntry("ImageGalleryWebPart","FirstViewData",c._LogType.Event,{imageSourceType:String(e),isRecursive:String(n),layoutName:D.t[t.properties.layout],isAutoCycleEnabled:String(i),autoCycleSpeed:String(r),maxImagesCount:String(a),imagesCount:String(t._images&&t._images.length)});p._EngagementLogger.logEventWithLogEntry(o)}},t._onEditImage=function(e,n){t.properties.imageSourceType===D.e.Curated&&(t._editingImage=e,n?t.context.propertyPane.refresh():t.context.propertyPane.open())},t._onTitleSet=function(e){t.properties.title=e},t._onDeleteImage=function(e){return t.properties.imageSourceType===D.e.Curated?t._dataAggregator.then(function(t){return t.deleteImage(e)}).then(t.render,t.renderError):Promise.resolve()},t._handleUpload=function(e){return t._dataAggregator.then(function(t){return t.uploadImage(e)})},t._handleThemeChangedEvent=function(e){t._theme=e.theme,t.render()},t}return Object(a.__extends)(t,e),t._calculateItemSize=function(e){return e===ce.e.Wide?ce.t.Large:ce.t.Medium},Object.defineProperty(t.prototype,"previewImageUrl",{get:function(){var e=this._hasImages?this._images[0]:void 0;if(e)return Object(m.webPartPreviewThumbnail)({pageContext:this.context.pageContext,url:e.url,siteId:e.siteId,webId:e.webId,listId:e.listId,uniqueId:e.id})},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e=this;!this._isBulkEditEnabled||this.renderedOnce||this.renderedFromPersistedData||this.context.propertyPane.open();var t=this._getImageOverride();this._originalImageCount||(this._originalImageCount=t.length);var n={cdnBaseUrls:this._cdnBaseUrls,edit:this.displayMode===s.DisplayMode.Edit,errorMessage:this._errorMessage,images:t,onDeleteImage:this._onDeleteImage,onEditImage:this._onEditImage,onFileReadyToUpload:this._handleUpload,onTitleSet:this._onTitleSet,pageContext:this.context.pageContext,renderCompleted:this.renderCompleted.bind(this),renderedFromPersistedData:this.renderedFromPersistedData,serviceScope:this.context.serviceScope,theme:this._theme,webAbsoluteUrl:this.context.pageContext.web.absoluteUrl,webPartProps:this.properties,width:this.width},a=this.context.webPartTag;this.renderedOnce||p._EngagementLogger.logEventWithLogEntry(new c._LogEntry("ImageGalleryWebPart","LayoutAndCorrespondingImagesCountWhenRender",c._LogType.Event,{layoutType:String(D.t[n.webPartProps.layout]),imageCount:String(t.length)}));var o=n.webPartProps.layout;(p._PerformanceLogger.saveTempData("".concat(a,".loadLayoutStart"),p._PerformanceLogger.now()),o===D.t.Carousel?_.e.loadCarousel().then(function(e){n.carouselComponentClass=e}):o===D.t.Masonry?g.loadMasonryLayout().then(function(e){n.masonryComponentClass=e}):o===D.t.Brick?v.import().then(function(e){n.brickComponentClass=e}):de.import().then(function(e){n.gridComponentClass=e})).then(function(){r.render(i.createElement(se,n),e.domElement),p._PerformanceLogger.saveTempData("".concat(a,".syncLayoutRenderComplete"),p._PerformanceLogger.now())}).catch(function(e){c._TraceLogger.logError(c._LogSource.create("ImageGalleryWebPart"),e,"Load".concat(D.t[o],"LayoutDuringRender"))}),this._logFirstViewData()},Object.defineProperty(t.prototype,"dataVersion",{get:function(){return U.e.isDocLibSourceOnlyInPrivateCDNEnabled()?s.Version.parse("1.9"):s.Version.parse("1.8")},enumerable:!1,configurable:!0}),t.prototype.onBeforeSerialize=function(){var e,t=this.properties;t.imageSourceType!==D.e.Dynamic||t.hasDynamicModeEnabled||(t.hasDynamicModeEnabled=!0);var n=t.layout;if(n===D.t.Carousel)t.layoutComponentId=_.e.carouselComponentId;else if(n===D.t.Grid)t.layoutComponentId=de.componentId;else if(n===D.t.Masonry)t.layoutComponentId=g.componentId;else if(n===D.t.Brick)t.layoutComponentId=v.componentId;else if(n)throw new Error("Add component Id for new layout ".concat(n," here"));if(t.images&&t.images.filter(function(e){return!e.id&&!e.url}).length>0)throw new Error("One or more image is missing required property to identify image");var a=this._getImageOverride().length;(null===(e=this._originalProperties)||void 0===e?void 0:e.layout)===this.properties.layout&&this._originalImageCount===a||p._EngagementLogger.logEventWithLogEntry(new c._LogEntry("ImageGalleryWebPart","LayoutAndCorrespondingImagesCountWhenChanged",c._LogType.Event,{layoutType:String(D.t[this.properties.layout]),imageCount:String(a)})),this._updateImageTileWidth(t)},t.prototype.onAfterDeserialize=function(e,n){this._originalProperties=d.cloneDeep(e);var a=!!e.gridSettings&&1===n.major&&n.minor<3;return a&&!e.gridSettings.imageAspectRatio&&(e.gridSettings.imageAspectRatio=1),a&&e.gridSettings.imageAspectRatio&&(e.gridSettings.imageSize=t._calculateItemSize(e.gridSettings.imageAspectRatio)),n.lessThan(s.Version.parse("1.4"))&&(e.imageSourceType||(e.imageSourceType=D.e.Curated),void 0===e.isRecursive&&(e.isRecursive=!1),void 0===e.maxImagesCount&&(e.maxImagesCount=10)),!!e.carouselSettings&&1===n.major&&n.minor<5&&void 0===e.carouselSettings.autoplaySpeed&&(e.carouselSettings.autoplay=!1,e.carouselSettings.autoplaySpeed=5),e.carouselSettings&&n.lessThan(s.Version.parse("1.6"))&&(e.carouselSettings.lazyLoad=!0),e.images=e.images.filter(Boolean),U.e.isDocLibSourceOnlyInPrivateCDNEnabled()&&n.lessThan(s.Version.parse("1.9"))&&e.imageSourceType===D.e.Dynamic&&(e.canAlwaysSelectDocLibAsSource=!0),e},Object.defineProperty(t.prototype,"isRenderAsync",{get:function(){return this._hasImages},enumerable:!1,configurable:!0}),t.prototype.onPropertyPaneConfigurationStart=function(){this._isImageSourceDynamic&&this._getDocumentLibrarySelectionsAndSetDefaultSelection()},t.prototype.loadPropertyPaneResources=function(){var e=this;return S.import().then(function(t){e._imageGalleryPropertyPaneDefaultSettings=t.PropertyPaneSettings.getDefaultSettings,e._imageGalleryPropertyPaneItemEditSettings=t.PropertyPaneSettings.getItemEditSettings})},t.prototype.getPropertyPaneConfiguration=function(){var e=new p._QosMonitor("ImageGalleryWebPart.GetPropertyPaneConfiguration");try{if(this.context.propertyPane.isRenderedByWebPart()&&this._editingImage){var t=this._imageGalleryPropertyPaneItemEditSettings({image:this._editingImage,webPartProps:this.properties});return e.writeSuccess(),t}return t=this._imageGalleryPropertyPaneDefaultSettings({webPartProps:this.properties,documentLibrariesEnabledPrivateCDN:this._isBulkEditEnabled?this._documentLibrariesEnabledPrivateCDN:void 0,documentLibraries:this._isBulkEditEnabled?this._documentLibraries:void 0,hasDocumentLibrariesRetrieved:!!this._isBulkEditEnabled&&this._hasDocumentLibrariesRetrieved,errorMessageFetchingDocLibs:this._errorMessageFetchingDocLibs,isEnableSelectDocLibSourceOnlyInPrivateCDN:this._isEnableSelectDocLibSourceOnlyInPrivateCDN,isScribeHosted:this._isScribeHosted()}),e.writeSuccess(),t}catch(t){throw e.writeUnexpectedFailure("Failure",t),t}},t.prototype.onInit=function(){var t=this.properties.layout;return this._getEmphasisTheme(),p._PerformanceLogger.markComponent(this.context.webPartTag,"".concat(p._PerformanceDataDimensions.Layout).concat(D.t[t])),t===D.t.Carousel?_.e.loadModule().catch(function(e){c._TraceLogger.logError(c._LogSource.create("ImageGalleryWebPart"),e,"LoadCarouselLayoutDuringInit")}):t===D.t.Masonry?g.loadModule().catch(function(e){c._TraceLogger.logError(c._LogSource.create("ImageGalleryWebPart"),e,"LoadMasonryLayoutDuringInit")}):t===D.t.Brick?v.import().catch(function(e){c._TraceLogger.logError(c._LogSource.create("ImageGalleryWebPart"),e,"LoadBrickLayoutDuringInit")}):t===D.t.Grid&&de.import().catch(function(e){c._TraceLogger.logError(c._LogSource.create("ImageGalleryWebPart"),e,"LoadGridLayoutDuringInit")}),e.prototype.onInit.call(this)},Object.defineProperty(t.prototype,"accessibleTitle",{get:function(){return l.StringHelper.format(ie.e,this.properties.title||ie.o)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"propertiesMetadata",{get:function(){var e={title:{isSearchablePlainText:!0},"images[*].title":{isSearchablePlainText:!0},"images[*].description":{isSearchablePlainText:!0},"images[*].altText":{isSearchablePlainText:!0},"images[*].url":{isImageSource:!0}},t=this.properties,n={};return t&&(t.layout!==D.t.Carousel&&t.layout!==D.t.Grid&&t.layout!==D.t.Masonry&&t.layout!==D.t.Brick||(n.siteId="images[*].siteId",n.webId="images[*].webId",n.listId="images[*].listId",n.uniqueId="images[*].id",n.fixedWidth="images[*].imageTileWidth",n.minCanvasWidth="images[*].minCanvasWidth"),e["images[*].url"].customMetadata=n),e.layoutComponentId={isComponentDependency:!0},e},enumerable:!1,configurable:!0}),t.prototype.onAfterResize=function(e){this.render()},t.prototype.onPropertyPaneFieldChanged=function(n,a,i){if("gridSettings.imageAspectRatio"===n&&a!==i)this.properties.gridSettings.imageSize=t._calculateItemSize(i);else if(this._isBulkEditEnabled&&a!==i)switch(n){case"imageSourceType":i===D.e.Dynamic?this._getDocumentLibrarySelectionsAndSetDefaultSelection():i===D.e.Curated&&this._clearInternalAndBaseWebpartErrors();break;case"listId":this._selectDocumentLibrary(i);break;case"isRecursive":case"maxImagesCount":this._delayedGetImagesFromDocLib(!0);break;case"layout":this._updateImageTileWidth(this.properties)}e.prototype.onPropertyPaneFieldChanged.call(this,n,a,i)},t.prototype.onDispose=function(){r.unmountComponentAtNode(this.domElement),this.context.serviceScope.consume(o.ThemeProvider.serviceKey).themeChangedEvent.remove(this,this._handleThemeChangedEvent),e.prototype.onDispose.call(this)},t.prototype._instantlyGetImagesFromDocLib=function(e){var t=this,n=Object(h.e)("ImageGallery Webpart GetDocLibImages Failure",this.context.serviceScope),a=new c._QosMonitorShareFailureWithCP("ImageGalleryWebPart.GetDocLibImages",!1,[n]);return this._dataAggregator.then(function(e){return t.properties.listId?t._isEnableSelectDocLibSourceOnlyInPrivateCDN&&t.properties.listUrl?e.getEnabledPrivateCDNDocLibs([{Id:t.properties.listId,RootFolder:{ServerRelativeUrl:t.properties.listUrl}}]).then(function(n){return!n||n.length<=0?(a.writeExpectedFailure("SelectedListNoEnablePrivateCDN"),t._handleNoEnablePrivateCDNAndRender(),Promise.reject(void 0)):e.getImagesFromDocumentLibrary(String(t.properties.listId),{maxItemsCount:t.properties.maxImagesCount,isRecursive:t.properties.isRecursive})}):e.getImagesFromDocumentLibrary(t.properties.listId,{maxItemsCount:t.properties.maxImagesCount,isRecursive:t.properties.isRecursive}):(a.writeUnexpectedFailure("NoListId"),Promise.reject(void 0))}).then(function(n){t._imagesFromSelectedDocLib=n,t._clearInternalAndBaseWebpartErrors(),e&&t.render(),a.writeSuccess()}).catch(function(e){t._imagesFromSelectedDocLib=[],U.e.isDocLibSourceOnlyInPrivateCDNEnabled()&&!e||(403===e.status?(t._handleNoPermissionAndRender(),a.writeExpectedFailure("NoPermissionToAccessDocLib")):401===e.status?(t._handleNoPermissionAndRender(),a.writeExpectedFailure("UnAuthorizedUser")):404===e.status?(t._errorMessage=ie.t,a.writeExpectedFailure("DocLibRemoved"),t.render()):e.text().then(function(e){return Promise.reject(new Error(e))}).catch(function(e){t.renderError(e),a.writeUnexpectedFailure("UnexpectedError",e)}))})},t.prototype._getImageOverride=function(){return this._isBulkEditEnabled&&this.properties.imageSourceType===D.e.Dynamic?this._imagesFromSelectedDocLib||[]:this.properties.images},Object.defineProperty(t.prototype,"_images",{get:function(){return this.properties.imageSourceType===D.e.Dynamic?this._imagesFromSelectedDocLib:this.properties.images},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_hasImages",{get:function(){return this._images&&this._images.length>0},enumerable:!1,configurable:!0}),t.prototype._isScribeHosted=function(){return!Object(U.i)()&&f._ScribeUtilities.isScribeHosted(Number(this.context.pageContext.legacyPageContext.webTemplate))},Object.defineProperty(t.prototype,"_documentLibrarySelections",{get:function(){var e=this;return new Promise(function(t,n){if(!e._documentLibraries)return e._dataAggregator.then(function(a){return e._isEnableSelectDocLibSourceOnlyInPrivateCDN?e._getEnabledPrivateCDNDocLibs(a,t).catch(function(e){n(e)}):e._getDocumentLibraries(a,t).catch(function(e){n(e)})});t(void 0)}).catch(function(t){c._TraceLogger.logError(c._LogSource.create("ImageGalleryWebPart"),t,"GetDocumentLibraries"),e._isEnableSelectDocLibSourceOnlyInPrivateCDN&&(e._hasDocumentLibrariesRetrieved=!0),e._errorMessageFetchingDocLibs=ie.n,e.context.propertyPane.refresh()})},enumerable:!1,configurable:!0}),t.prototype._getEnabledPrivateCDNDocLibs=function(e,t){var n=this;return e.getDocumentLibraries().then(function(a){return n._documentLibraries=a,e.getEnabledPrivateCDNDocLibs(n._documentLibraries).then(function(e){n._documentLibrariesEnabledPrivateCDN=e,n._hasDocumentLibrariesRetrieved=!0,n.context.propertyPane.refresh(),t()})})},t.prototype._getDocumentLibraries=function(e,t){var n=this;return e.getDocumentLibraries().then(function(e){n._documentLibraries=e,n._documentLibrariesEnabledPrivateCDN=e,n._hasDocumentLibrariesRetrieved=!0,n.context.propertyPane.refresh(),t()})},Object.defineProperty(t.prototype,"_isBulkEditEnabled",{get:function(){return void 0===this._isBulkEditFlightEnabled&&(this._isBulkEditFlightEnabled=U.e.isBulkEditEnabled(this.properties.hasDynamicModeEnabled)),this._isBulkEditFlightEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_isImageSourceDynamic",{get:function(){return this._isBulkEditEnabled&&this.properties.imageSourceType===D.e.Dynamic},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_dataAggregator",{get:function(){var e=this;return this._imageGalleryDataAggregator||(this._imageGalleryDataAggregator=S.import().then(function(t){var n=new t.ImageGalleryDataProvider(e.context.serviceScope),a=new x({validExtensions:u.spConstants.imageExtensions,maxSizeBytes:2e8});return new t.ImageGalleryDataAggregator(n,e.properties,a,e.context.pageContext)})),this._imageGalleryDataAggregator},enumerable:!1,configurable:!0}),t.prototype._updateImageTileWidth=function(e){for(var t=0;e&&e.images&&t<e.images.length;t++)e.images[t].imageTileWidth=se.getImageTileWidth(e.layout),e.layout===D.t.Carousel&&t>0&&(e.images[t].minCanvasWidth=32767)},t.prototype._getEmphasisTheme=function(){var e=this;this.context.serviceScope.whenFinished(function(){var t=e.context.serviceScope.consume(o.ThemeProvider.serviceKey);e._theme=t.tryGetTheme(),t.themeChangedEvent.add(e,e._handleThemeChangedEvent)})},Object.defineProperty(t.prototype,"_cdnBaseUrls",{get:function(){var e=this.context.pageContext.legacyPageContext.publicCdnBaseUrl;return e?[e]:[]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_isEnableSelectDocLibSourceOnlyInPrivateCDN",{get:function(){return!this.properties.canAlwaysSelectDocLibAsSource&&U.e.isDocLibSourceOnlyInPrivateCDNEnabled()},enumerable:!1,configurable:!0}),t}(m.BaseDataWebPart);t.default=fe},Qeeh:function(e){e.exports=JSON.parse('{"e":"File type not supported","t":"The image is too large"}')},RxoY:function(e,t,n){"use strict";var a=n("vqeV");n.d(t,"e",function(){return a.e}),n.d(t,"t",function(){return a.t}),n("W6VI")},U4ag:function(e,t){e.exports=c},UWqr:function(e,t){e.exports=d},W6VI:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n("vqeV");function i(e,t){return e/function(e){switch(e){case a.e.Wide:return 16/9;case a.e.Standard:return 4/3;default:return 1}}(t)}},Z95U:function(e,t){e.exports=l},acy6:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=30},cDcd:function(e,t){e.exports=u},dEWz:function(e,t,n){var a=n("fglE");e.exports=a._Utilities},faye:function(e,t){e.exports=f},fglE:function(e,t){e.exports=p},h92K:function(e,t,n){"use strict";var a,i;n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i}),function(e){e[e.Curated=1]="Curated",e[e.Dynamic=2]="Dynamic"}(a||(a={})),function(e){e[e.Carousel=1]="Carousel",e[e.Grid=2]="Grid",e[e.Masonry=3]="Masonry",e[e.Brick=4]="Brick"}(i||(i={}))},hUCW:function(e){e.exports=JSON.parse('{"a":"Move item. When selected, use ctrl + left arrow or ctrl + right arrow to reorder items.","n":"Press enter to open a panel showing detailed information about this image.","t":"Edit details","e":"Remove"}')},"hiL/":function(e,t){e.exports=m},jOlS:function(e,t){e.exports=_},lxgo:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n("I6O9"),i=function(){function e(){}return e.loadModule=function(){return e._loadedModulePromise||(e._loadedModulePromise=a.SPComponentLoader.loadComponentById(e.carouselComponentId)),e._loadedModulePromise},e.loadCarousel=function(){return e.loadModule().then(function(e){return e.CarouselLayoutLoader.loadCarousel()})},e.carouselComponentId="8ac0c53c-e8d0-4e3e-87d0-7449eb0d4027",e}()},mMzb:function(e,t){e.exports=h},oAO0:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n("17wl"),i=n("cDcd"),r=n("faye"),o=n("tGpx"),s=function(){function e(){}return e.loadImage=function(e){return new Promise(function(t,n){var a=document.createElement("img");a.onload=function(e){t(a)},a.onerror=function(e){n(e)},a.setAttribute("src",e)})},e.readImageRatio=function(t){return Object(a.__awaiter)(this,void 0,void 0,function(){var n;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,e.loadImage(t)];case 1:return[2,(n=a.sent()).naturalWidth/n.naturalHeight]}})})},e.loadThumbnailImage=function(e){return new Promise(function(t,n){var s=document.createElement("div");e.disableBlobRevoke=!0,r.render(i.createElement(o.SPImg,Object(a.__assign)(Object(a.__assign)({},e),{onImageLoad:function(e){t(null==e?void 0:e.target),r.unmountComponentAtNode(s)},onImageLoadFailure:function(e,t){"stockImage"===e&&(n(e),r.unmountComponentAtNode(s))},renderedInDetachedDOM:!0})),s)})},e.readThumbnailImageRatio=function(t){return Object(a.__awaiter)(this,void 0,void 0,function(){var n;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,e.loadThumbnailImage(t)];case 1:return[2,(n=a.sent()).naturalWidth/n.naturalHeight]}})})},e}()},r9Fm:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return a}),n.d(t,"n",function(){return r}),n.d(t,"a",function(){return o});var a,i={Square:"Square",Wide:"Wide",Tall:"Tall",All:"All"};!function(e){e[e.Documents=1]="Documents",e[e.Images=2]="Images",e[e.Pages=3]="Pages",e[e.Videos=4]="Videos",e[e.Audios=5]="Audios",e[e.Models=6]="Models",e[e.BasicDocuments=7]="BasicDocuments",e[e.Transcripts=8]="Transcripts",e[e.VideosWithWebm=9]="VideosWithWebm"}(a||(a={}));var r={Files:1,FoldersOnly:2,FoldersAndFiles:3},o={Recent:1,OneDrive:2,DocLib:3,Local:4,Link:5,BingImageSearch:6,OrgAssets:7,StockAssets:8,Office3DCatalog:9,MultipleSites:10,Search:11}},tGpx:function(e,t){e.exports=b},ut3N:function(e,t){e.exports=g},vqeV:function(e,t,n){"use strict";var a,i;n.d(t,"t",function(){return a}),n.d(t,"e",function(){return i}),function(e){e[e.Small=1]="Small",e[e.Medium=2]="Medium",e[e.Large=3]="Large"}(a||(a={})),function(e){e[e.Square=1]="Square",e[e.Wide=2]="Wide",e[e.Standard=3]="Standard"}(i||(i={}))},wfAw:function(e){e.exports=JSON.parse('{"a":"Uploading...","n":"{0}/{1}","e":"Added","t":"Remove"}')},y88i:function(e,t){e.exports=v}})});